package com.astix.rajtraderssfasales.database;

import android.content.ContentValues;
import android.content.Context;
import android.content.ContextWrapper;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteException;
import android.database.sqlite.SQLiteStatement;
import android.os.Environment;
import android.text.TextUtils;
import android.util.Log;

import com.astix.Common.CommonInfo;
import com.astix.rajtraderssfasales.AllButtonActivity;
import com.astix.rajtraderssfasales.DistributorSocuting.ScoutingModels.TblPotentialDistributor;
import com.astix.rajtraderssfasales.DistributorSocuting.ScoutingModels.TblPotentialDistributorCompetitorBrandMstr;
import com.astix.rajtraderssfasales.DistributorSocuting.ScoutingModels.TblPotentialDistributorCompetitorCompanyMstr;
import com.astix.rajtraderssfasales.DistributorSocuting.ScoutingModels.TblPotentialDistributorRetailersFeedBackDetails;
import com.astix.rajtraderssfasales.DistributorSocuting.ScoutingModels.TblPotentialDistributorVehicleMasterList;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblProductMappedWithSchemeSlabApplied;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblProductRelatedScheme;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblSchemeMstr;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblSchemeSlabBenefitsBucketDetails;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblSchemeSlabBenefitsProductMappingDetail;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblSchemeSlabBenefitsValueDetail;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblSchemeSlabBucketDetails;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblSchemeSlabBucketProductMapping;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblSchemeSlabDetail;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblSchemeStoreMapping;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblStoreProductAddOnSchemeApplied;
import com.astix.rajtraderssfasales.SchemeTablesModelsSaving.TblStoreProductAppliedSchemesBenifitsRecords;
import com.astix.rajtraderssfasales.SplashScreen;
import com.astix.rajtraderssfasales.model.ActualVisitProductInfo;
import com.astix.rajtraderssfasales.model.InvoiceList;
import com.astix.rajtraderssfasales.model.StoreSummaryModel;
import com.astix.rajtraderssfasales.model.TblActualVsTargetReport;
import com.astix.rajtraderssfasales.model.TblAllSummaryDay;
import com.astix.rajtraderssfasales.model.TblAppMasterFlags;
import com.astix.rajtraderssfasales.model.TblAppliedOrderDiscount;
import com.astix.rajtraderssfasales.model.TblAttandanceDetails;
import com.astix.rajtraderssfasales.model.TblBankMaster;
import com.astix.rajtraderssfasales.model.TblBeatPlans;
import com.astix.rajtraderssfasales.model.TblBeatWiseSpokeStoreVisitSchedule;
import com.astix.rajtraderssfasales.model.TblBloodGroup;
import com.astix.rajtraderssfasales.model.TblCycleID;
import com.astix.rajtraderssfasales.model.TblDAGetAddedOutletSummaryOverallReport;
import com.astix.rajtraderssfasales.model.TblDAGetAddedOutletSummaryReport;
import com.astix.rajtraderssfasales.model.TblDailyDateWiseSalesManTargetVsAch;
import com.astix.rajtraderssfasales.model.TblDayStartAttendanceOption;
import com.astix.rajtraderssfasales.model.TblDayWiseActualVsTargetReportSalesMan;
import com.astix.rajtraderssfasales.model.TblDistributorProductStock;
import com.astix.rajtraderssfasales.model.TblEducationQuali;
import com.astix.rajtraderssfasales.model.TblFocusbrandSKU;
import com.astix.rajtraderssfasales.model.TblGetPDAQuestGrpMapping;
import com.astix.rajtraderssfasales.model.TblGetPDAQuestMstr;
import com.astix.rajtraderssfasales.model.TblGetPDAQuestOptionMstr;
import com.astix.rajtraderssfasales.model.TblGetPDAQuestionDependentMstr;
import com.astix.rajtraderssfasales.model.TblGetPDAStoreOrderHistory;
import com.astix.rajtraderssfasales.model.TblGetPDAStoreSummary;
import com.astix.rajtraderssfasales.model.TblGetPDAStoreVisitHistory;
import com.astix.rajtraderssfasales.model.TblInstrumentMaster;
import com.astix.rajtraderssfasales.model.TblInvoiceExecutionProductList;
import com.astix.rajtraderssfasales.model.TblInvoiceLastVisitDetails;
import com.astix.rajtraderssfasales.model.TblLastOutstanding;

import com.astix.rajtraderssfasales.model.TblLastRefreshTimeReport;
import com.astix.rajtraderssfasales.model.TblLocationDetails;
import com.astix.rajtraderssfasales.model.TblNoOrderReasonMaster;
import com.astix.rajtraderssfasales.model.TblOnlyCategoryMasterForRetriving;
import com.astix.rajtraderssfasales.model.TblPDAGetExecutionSummary;
import com.astix.rajtraderssfasales.model.TblPDAGetLODQty;
import com.astix.rajtraderssfasales.model.TblPDAGetLastOrderDate;
import com.astix.rajtraderssfasales.model.TblPDAGetLastOrderDetails;
import com.astix.rajtraderssfasales.model.TblPDAGetLastOrderDetailsTotalValues;
import com.astix.rajtraderssfasales.model.TblPDAGetLastVisitDate;
import com.astix.rajtraderssfasales.model.TblPDAGetLastVisitDetails;
import com.astix.rajtraderssfasales.model.TblPDAQuestOptionDependentMstr;
import com.astix.rajtraderssfasales.model.TblPDAQuestOptionValuesDependentMstr;
import com.astix.rajtraderssfasales.model.TblPendingInvoices;
import com.astix.rajtraderssfasales.model.TblPrdMstrTransactionUOMConfig;
import com.astix.rajtraderssfasales.model.TblPreAddedStores;
import com.astix.rajtraderssfasales.model.TblPreAddedStoresDataDetails;
import com.astix.rajtraderssfasales.model.TblProductCategoryUOMTypeList;
import com.astix.rajtraderssfasales.model.TblProductLevelData;
import com.astix.rajtraderssfasales.model.TblProductListLastVisitStockOrOrderMstr;
import com.astix.rajtraderssfasales.model.TblProductListMaster;
import com.astix.rajtraderssfasales.model.TblProductSectorMapping;
import com.astix.rajtraderssfasales.model.TblProductSegementMap;
import com.astix.rajtraderssfasales.model.TblProductTypeMasterForRetriving;
import com.astix.rajtraderssfasales.model.TblProductWiseInvoice;
import com.astix.rajtraderssfasales.model.TblQuestIDForName;
import com.astix.rajtraderssfasales.model.TblQuestIDForOutChannel;
import com.astix.rajtraderssfasales.model.TblReplenishmentSKU;
import com.astix.rajtraderssfasales.model.TblRouteListMaster;
import com.astix.rajtraderssfasales.model.TblSKUWiseDaySummary;
import com.astix.rajtraderssfasales.model.TblSchemePerProduct;
import com.astix.rajtraderssfasales.model.TblStateCityMaster;
import com.astix.rajtraderssfasales.model.TblStoreCartonDetails;
import com.astix.rajtraderssfasales.model.TblStoreCartonMaster;
import com.astix.rajtraderssfasales.model.TblStoreCloseReasonMaster;
import com.astix.rajtraderssfasales.model.TblStoreListForUpdateMstr;
import com.astix.rajtraderssfasales.model.TblStoreListMaster;
import com.astix.rajtraderssfasales.model.TblStoreListMasterDataRetrive;
import com.astix.rajtraderssfasales.model.TblStoreListWithPaymentAddress;
import com.astix.rajtraderssfasales.model.TblStoreProductMappingForDisplay;
import com.astix.rajtraderssfasales.model.TblStoreSKUWiseDaySummary;
import com.astix.rajtraderssfasales.model.TblStoreSomeProdQuotePriceMstr;
import com.astix.rajtraderssfasales.model.TblStoreSuggestedQtyMstr;
import com.astix.rajtraderssfasales.model.TblStoreSummaryDetails;
import com.astix.rajtraderssfasales.model.TblStoreWiseDaySummary;
import com.astix.rajtraderssfasales.model.TblSupplierMstrList;
import com.astix.rajtraderssfasales.model.TblUOMMapping;
import com.astix.rajtraderssfasales.model.TblUOMMaster;
import com.astix.rajtraderssfasales.model.TblUOMTypeConverstion;
import com.astix.rajtraderssfasales.model.TblValueVolumeTarget;
import com.astix.rajtraderssfasales.model.TblVanProductStock;
import com.allana.truetime.TimeUtils;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.math.BigInteger;
import java.text.DecimalFormat;
import java.text.NumberFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Locale;

import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;
import java.util.StringTokenizer;
import java.util.regex.Pattern;

import com.astix.rajtraderssfasales.model.TbltmpInvoiceHeaderCartonPlusOrder;
import com.astix.rajtraderssfasales.utils.AppUtils;
import com.astix.rajtraderssfasales.utils.PreferenceManager;

import static android.content.Context.MODE_PRIVATE;
import static com.astix.rajtraderssfasales.database.DBHelper.DATABASE_TABLE_MAIN203;
import static com.astix.rajtraderssfasales.database.DBHelper.DATABASE_TABLE_MAIN204;
import static com.astix.rajtraderssfasales.database.DBHelper.DATABASE_TABLE_MAIN205;
import static com.astix.rajtraderssfasales.database.DBHelper.DATABASE_TABLE_MAIN206;
import static com.astix.rajtraderssfasales.database.DBHelper.DATABASE_TABLE_MAIN207;
import static com.astix.rajtraderssfasales.database.DBHelper.DATABASE_TABLE_MAIN208;
import static com.astix.rajtraderssfasales.database.DBHelper.DATABASE_TABLE_MAIN209;
import static com.astix.rajtraderssfasales.database.DBHelper.DATABASE_TblStoreSuggestedQtyMstr;
import static com.astix.rajtraderssfasales.database.DBHelper.DATABASE_tblFocusbrandSKU;
import static com.astix.rajtraderssfasales.database.DBHelper.DATABASE_tblReplenishmentSKU;
import static com.astix.rajtraderssfasales.database.DBHelper.DateValue;
import static com.astix.rajtraderssfasales.database.DBHelper.DayName;
import static com.astix.rajtraderssfasales.database.DBHelper.MonthValue;
import static com.astix.rajtraderssfasales.database.DBHelper.TABLE_PotentialDistributorRetailersFeedBackDetails;
import static com.astix.rajtraderssfasales.database.DBHelper.TABLE_tblCompetitorBrand;
import static com.astix.rajtraderssfasales.database.DBHelper.TABLE_tblCompetitorBrandMstr;
import static com.astix.rajtraderssfasales.database.DBHelper.TABLE_tblCompetitorCompany;
import static com.astix.rajtraderssfasales.database.DBHelper.TABLE_tblCompetitorCompanyMstr;
import static com.astix.rajtraderssfasales.database.DBHelper.TABLE_tblDistRetAddressDetail;
import static com.astix.rajtraderssfasales.database.DBHelper.TABLE_tblPotentialDistributorList;
import static com.astix.rajtraderssfasales.database.DBHelper.TABLE_tblSupplierMstrList;
import static com.astix.rajtraderssfasales.database.DBHelper.TABLE_tblVehicalType;
import static com.astix.rajtraderssfasales.database.DBHelper.Table_TblBeatWiseSpokeStoreVisitSchedule;
import static com.astix.rajtraderssfasales.database.DBHelper.Table_tblBeatPlan;
import static com.astix.rajtraderssfasales.database.DBHelper.Week1;
import static com.astix.rajtraderssfasales.database.DBHelper.Week2;
import static com.astix.rajtraderssfasales.database.DBHelper.Week3;
import static com.astix.rajtraderssfasales.database.DBHelper.Week4;
import static com.astix.rajtraderssfasales.database.DBHelper.Week5;
import static com.astix.rajtraderssfasales.database.DBHelper.Week6;
import static com.astix.rajtraderssfasales.utils.AppUtils.checkNullOrEmpty;

public class AppDataSource {

    private static final String TAG = "AppDataSource";

    public static int gblQuestIDForOutChannel = 0;
    public static SharedPreferences sPref, sharedPrefReport;
    public static final String KEY_PHID = "phID";

    private static Context mContext;
    public static Cursor cursor;
    public static int checkNumberOfStore = 1;
    Locale locale = new Locale("en", "UK");
    String pattern = "###.##";
    DecimalFormat decimalFormat = (DecimalFormat) NumberFormat.getNumberInstance(locale);
    private boolean isDBOpenflag = false;
    public static SQLiteDatabase db;
    private static AppDataSource sInstance;
    public DBHelper dbHelper;
    private PreferenceManager mPreferencesManager;

    public AppDataSource(Context context) {
        mContext = context;
        dbHelper = new DBHelper(context);
        db = dbHelper.getWritableDatabase();
        mPreferencesManager = PreferenceManager.getInstance(context);
    }

    public static synchronized AppDataSource getInstance(Context context) {

        // Use the application context, which will ensure that you
        // don't accidentally leak an Activity's context.
        // See this article for more information: http://bit.ly/6LRzfx
        mContext = context;
        if (sInstance == null) {
            sInstance = new AppDataSource(context.getApplicationContext());

        }
        return sInstance;
    }


    public boolean isDBOpen() {
        this.isDBOpenflag = false;
        return this.isDBOpenflag;
    }


    public void saveOutletChammetQstnIdGrpId(List<TblQuestIDForOutChannel> tblQuestIDForOutChannel) {
//    public static void saveOutletChammetQstnIdGrpId(int grpQstId, int qstId, String optId, int section_count) {

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_QSTOUTCHANNEL + " (GrpQstId, QuestID, OptID, SectionCount) VALUES (?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);
            for (TblQuestIDForOutChannel tbl : tblQuestIDForOutChannel) {
                stmt.bindLong(1, tbl.getGrpQuestID());
                stmt.bindLong(2, tbl.getQuestID());
                stmt.bindString(3, tbl.getOptionID());
                stmt.bindLong(4, tbl.getSectionCount());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
//        ContentValues values = new ContentValues();
//        values.put("GrpQstId", grpQstId);
//        values.put("QuestID", qstId);
//        values.put("OptID", optId);
//        values.put("SectionCount", section_count);
//        gblQuestIDForOutChannel = qstId;
//        db.insert(DBHelper.TABLE_QSTOUTCHANNEL, null, values);

    }

    public String getAttendanceDateTime() {
        String attandanceDateTime = "";
        Cursor cursor = db.query(DBHelper.TABLE_tblUserAuthenticationMstr_Define, new String[]{"AttenDatetime"}, null, null, null, null, null, null);
        try {
            if (cursor != null && cursor.moveToFirst()) {
                attandanceDateTime = cursor.getString(0);
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null)
                cursor.close();
        }

        return attandanceDateTime;
    }

    public void UpdateStoreStoreClose(String StoreID, int StoreClose) {


        final ContentValues values = new ContentValues();
        values.put("StoreClose", StoreClose);

        int affected = db.update("tblStoreVisitMstr", values, "StoreID=?", new String[]{StoreID});
        //   int affected1 = db.update("tblStoreList", values, "StoreID=?",new String[] { StoreID });
        // int affected21 = db.update("tblOutletQuestAnsMstr", values,"OutletID=?", new String[] { StoreID });

        //  int affected261 = db.update("tblNewAddedStoreLocationDetails", values,"StoreID=?", new String[] { StoreID });

    }


    // function for new store master data start

    public void savetblQuestIDForName(List<TblQuestIDForName> tblQuestIDForName) {
//    public void savetblQuestIDForName(int id, int grpQstId, int qstId, String QuestDesc) {

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_QST_NAME + " (ID, QuestID, GrpQstId, QuestDesc) VALUES (?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblQuestIDForName tbl : tblQuestIDForName) {
                stmt.bindLong(1, tbl.getID());
                stmt.bindLong(2, tbl.getQuestID());
                stmt.bindLong(3, tbl.getGrpQuestID());
                stmt.bindString(4, tbl.getQuestDesc());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }

//        ContentValues values = new ContentValues();
//        values.put("ID", id);
//        values.put("QuestID", qstId);
//        values.put("GrpQstId", grpQstId);
//        values.put("QuestDesc", QuestDesc);
//        db.insert(DBHelper.TABLE_QST_NAME, null, values);

    }


    public void savetblPDAQuestOptionValuesDependentMstr(List<TblPDAQuestOptionValuesDependentMstr> tblPDAQuestOptionValuesDependentMstr) {
//    public void savetblPDAQuestOptionValuesDependentMstr(int DepQstId, String DepAnswValId, int QstId, String AnswValId, String OptDescr, int Sequence, int GrpQuestID, int GrpDepQuestID) {

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_QuestOptionValuesDependentMstr + " (DepQstId, DepAnswValId, QstId, AnswValId, OptDescr, Sequence, GrpQuestID, GrpDepQuestID)" +
                    " VALUES (?,?,?,?,?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);
            for (TblPDAQuestOptionValuesDependentMstr tbl : tblPDAQuestOptionValuesDependentMstr) {
                stmt.bindLong(1, tbl.getDepQstId());
                stmt.bindString(2, tbl.getDepOptID());
                stmt.bindLong(3, tbl.getQuestId());
                stmt.bindString(4, tbl.getOptID());
                stmt.bindString(5, tbl.getOptDescr());
                stmt.bindLong(6, tbl.getSequence());
                stmt.bindLong(7, tbl.getGrpQuestID());
                stmt.bindLong(8, tbl.getGrpDepQuestID());
                stmt.execute();
            }
            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
//        ContentValues values = new ContentValues();
//        values.put("DepQstId", DepQstId);
//        values.put("DepAnswValId", DepAnswValId);
//        values.put("QstId", QstId);
//        values.put("AnswValId", AnswValId);
//        values.put("OptDescr", OptDescr);
//        values.put("Sequence", Sequence);
//        values.put("GrpQuestID", GrpQuestID);
//        values.put("GrpDepQuestID", GrpDepQuestID);
//        db.insert(DBHelper.TABLE_QuestOptionValuesDependentMstr, null, values);

    }

    public void Delete_tblMessageTextFileContainer() {
        db.execSQL("DELETE FROM tblMessageTextFileContainer");
    }


    // function for new store master data end

    public void Delete_tblDsrRegDetails() {
        db.execSQL("DELETE FROM tblDsrRegDetails");
    }

    public void Delete_tblUserRegistarationStatus() {
        db.execSQL("DELETE FROM tblUserRegistarationStatus");
    }

    //tblStockUploadedStatus
    public void Delete_tblStockUploadedStatus() {
        db.execSQL("DELETE FROM tblStockUploadedStatus");
    }

    public int countNumberOFTextFile() throws IOException {
        // int entryCount;sdfsfsf

        Cursor cursorE2 = db.rawQuery("SELECT Count(*) from tblMessageTextFileContainer where FileFlag=0", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String[] returnTextFileName() {

        String qry = "select FileName from tblMessageTextFileContainer where FileFlag=0";
        Cursor cur = db.rawQuery(qry, null);
        String TextFileUpload[] = new String[cur.getCount()];
        try {
            if (cur.moveToFirst()) {
                //for(int i=0;i<cur.getCount();i++)
                for (int i = 0; i < cur.getCount(); i++) {
                    TextFileUpload[i] = (String) cur.getString(0).toString();
                    cur.moveToNext();

                }


            }
            return TextFileUpload;
        } finally {
            cur.close();
        }
    }

    public void upDateTextFileFlag(String FileName, int FileFlag) {

        try {

            //initialValues.put("FileName", FileName);
            //initialValues.put("FileFlag", FileFlag);

            final ContentValues values = new ContentValues();
            values.put("FileFlag", FileFlag);

            int affected = db.update("tblMessageTextFileContainer", values, "FileName=?",
                    new String[]{FileName});

            Log.w(TAG, "Record(s) Updated..");

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void deleteTextFileRow(String fileName) {

        db.execSQL("DELETE FROM tblMessageTextFileContainer WHERE FileName ='" + fileName + "'");
    }

    public void deleteViewAddedStore() {
        //open();
        db.execSQL("DELETE FROM tblViewOutletQuestAnsMstr");
        db.execSQL("DELETE FROM tblViewOutletNameAndId");
        // close();
    }

    public void deleteAllSingleCallWebServiceTable() {
        //open();
        db.execSQL("DELETE FROM tblNewStoreSalesQuotePaymentDetails");

        db.execSQL("DELETE FROM tblGetPDAQuestMstr");
        db.execSQL("DELETE FROM tblOutletChannelBusinessSegmentMaster");
        db.execSQL("DELETE FROM tblGetPDAQuestOptionMstr");
        db.execSQL("DELETE FROM tblPDAQuestOptionDependentMstr");
        db.execSQL("DELETE FROM tblPDAQuestOptionValuesDependentMstr");
        //db.execSQL("DELETE FROM tblLatLongDetails");
        //  db.execSQL("DELETE FROM tblOutletMstr");
        //  db.execSQL("DELETE FROM tblOutletQuestAnsMstr");

      /*  db.execSQL("DELETE FROM tblStoreList WHERE Sstat ="+ 4);
        db.execSQL("DELETE FROM tblOutletQuestAnsMstr WHERE Sstat ="+ 4);

        db.execSQL("DELETE FROM tblNewAddedStoreLocationDetails WHERE Sstat ="+ 4);


        db.execSQL("DELETE FROM tblOutletPhotoDetail WHERE Sstat ="+ 4);*/


        //  db.execSQL("DELETE FROM tblOutletPhotoDetail");
        //db.execSQL("DELETE FROM tblAvailableVersion");
        db.execSQL("DELETE FROM tblGetPDAQuestionDependentMstr");
        db.execSQL("DELETE FROM tblGetPDAQuestGrpMapping");
        db.execSQL("DELETE FROM tblGetReturnsReasonForPDAMstr");

        // db.execSQL("DELETE FROM tblViewOutletNameAndId");

        db.execSQL("DELETE FROM tblsameLocationForStoreRestartDone");

        //close();
    }

    public void deleteAllSingleCallWebServiceTableWhole() {
        //open();
        //db.execSQL("DELETE FROM tblNewStoreSalesQuotePaymentDetails");

        //db.execSQL("DELETE FROM tblGetPDAQuestMstr");
        //db.execSQL("DELETE FROM tblOutletChannelBusinessSegmentMaster");
        //db.execSQL("DELETE FROM tblGetPDAQuestOptionMstr");
        //db.execSQL("DELETE FROM tblPDAQuestOptionDependentMstr");
        //db.execSQL("DELETE FROM tblPDAQuestOptionValuesDependentMstr");
        //db.execSQL("DELETE FROM tblLatLongDetails");
        //  db.execSQL("DELETE FROM tblOutletMstr");
        //  db.execSQL("DELETE FROM tblOutletQuestAnsMstr");

        //db.execSQL("DELETE FROM tblStoreList");
        //	db.execSQL("DELETE FROM tblOutletQuestAnsMstr");


        // db.execSQL("DELETE FROM tblOutletPhotoDetail");


        //  db.execSQL("DELETE FROM tblOutletPhotoDetail");
        //db.execSQL("DELETE FROM tblAvailableVersion");
        //db.execSQL("DELETE FROM tblGetPDAQuestionDependentMstr");
        //db.execSQL("DELETE FROM tblGetPDAQuestGrpMapping");
        //db.execSQL("DELETE FROM tblGetReturnsReasonForPDAMstr");

        // db.execSQL("DELETE FROM tblViewOutletNameAndId");

        db.execSQL("DELETE FROM tblsameLocationForStoreRestartDone");

        // close();
    }




	/* private static final String DATABASE_CREATE_TABLE_231 = "create table tblSKUWiseDaySummary (AutoId int not null,ProductId text null," +
		 		"Product text null,MRP text null,Rate text null,NoofStores text null,OrderQty text null,FreeQty text null," +
		 		"DiscValue text null,ValBeforeTax text null,TaxValue text null,ValAfterTax text null,Lvl text null," +
		 		"Category text null,UOM text null);";*/

    // change by sunil for Summary Report

    public int checkCountIntblSalesQuotePersonMeetMstr(String StoreId) {

        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblSalesQuotePersonMeetMstr WHERE  StoreId ='" + StoreId + "'", null);

        try {

            int check = 0;

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        check = 1;
                        cursor.moveToNext();
                    }
                }

            }
            return check;

        } finally {
            cursor.close();
        }

    }

    public long savetbltblUOMMstr(String UOMID, String UOM) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("UOMID", UOMID.toString().trim());
        initialValues.put("UOM", UOM.toString().trim());

        return db.insert(DBHelper.DATABASE_TABLE_UOMMstr, null, initialValues);
    }

    public long saveSalesQuotePrcsMstr(String SalesQuotePrcsId, String SalesQuotePrcs) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuotePrcsId", SalesQuotePrcsId.toString().trim());
        initialValues.put("SalesQuotePrcs", SalesQuotePrcs.toString().trim());

        return db.insert(DBHelper.DATABASE_TABLE_SalesQuotePrcsMstr, null, initialValues);
    }

    public long SavetblSalesQuotePaymentModeMstr(String PymtModeId, String PymtMode) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("PymtModeId", PymtModeId.toString().trim());
        initialValues.put("PymtMode", PymtMode.toString().trim());

        return db.insert(DBHelper.DATABASE_TABLE_tblSalesQuotePaymentModeMstr, null, initialValues);
    }

    public long SavetblSalesQuotePaymentStageMstr(String PymtStageId, String PymtStage, String PymtModeId) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("PymtStageId", PymtStageId.toString().trim());
        initialValues.put("PymtStage", PymtStage.toString().trim());
        initialValues.put("PymtModeId", PymtModeId.toString().trim());

        return db.insert(DBHelper.DATABASE_TABLE_tblSalesQuotePaymentStageMstr, null, initialValues);
    }

    //surbhi
    public long SavetblSalesQuoteTypeMstr(String SalesQuotetypeId, String SalesQuoteType) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuotetypeId", SalesQuotetypeId);
        initialValues.put("SalesQuoteType", SalesQuoteType);

        return db.insert(DBHelper.DATABASE_TABLE_tblSalesQuoteTypeMstr, null, initialValues);
    }

    public long SavetblSalesQuotePaymentStageModeMapMstr(String PymtStageId, String PymtModeId) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("PymtStageId", PymtStageId);
        initialValues.put("PymtModeId", PymtModeId);

        return db.insert(DBHelper.DATABASE_TABLE_tblSalesQuotePaymentStageModeMapMstr, null, initialValues);
    }

    public LinkedHashMap<String, String> fnGettblUOMMstr() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'

        // (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            Cursor cursor = db.rawQuery("SELECT UOMID,UOM from tblUOMMaster   ", null);// Where PNodeID='"+TSIID+"'
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put(cursor.getString(1), cursor.getString(0));
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            //close();
            return hmapQuestionMstr;
        }
    }

    public String fngettblSalesQuotePersonMeetMstr(String SalesQuoteId) {
        String flag = "0";
        try {
            //open();
            Cursor cursor = db.rawQuery("SELECT SalesQuotePrcsId,SalesQuotePrcs,SalesQuoteValidFrom,SalesQuoteValidTo,SalesQuoteType from tblSalesQuotePersonMeetMstr where SalesQuoteId = '" + SalesQuoteId + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    flag = cursor.getString(0).toString() + "^" + cursor.getString(1).toString() + "^" + cursor.getString(2).toString() + "^" + cursor.getString(3).toString() + "^" + cursor.getString(4).toString();
                }

            }
            return flag;
        } catch (Exception e) {

        } finally {

            //close();
            return flag;
        }
    }

    public long SalesQuoteProductsMstr(String SalesQuoteId, String Row_No, String PrdId, String StandardRate, String StandardRateBeforeTax, String RateOffer, String InclusiveTax, String ValidFrom, String ValidTo, String MinDlvryQty, String UOMID, String Remarks, String LastTranscRate, String ProductTaxRateBK) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuoteId", SalesQuoteId.toString().trim());
        initialValues.put("Row_No", Row_No.toString().trim());
        initialValues.put("PrdId", PrdId.toString().trim());
        initialValues.put("StandardRate", StandardRate.toString().trim());
        initialValues.put("StandardRateBeforeTax", StandardRateBeforeTax.toString().trim());
        initialValues.put("RateOffer", RateOffer.toString().trim());
        initialValues.put("InclusiveTax", InclusiveTax.toString().trim());
        initialValues.put("ValidFrom", ValidFrom.toString().trim());
        initialValues.put("ValidTo", ValidTo.toString().trim());
        initialValues.put("MinDlvryQty", MinDlvryQty.toString().trim());
        initialValues.put("UOMID", UOMID.toString().trim());
        initialValues.put("Remarks", Remarks.toString().trim());
        initialValues.put("LastTranscRate", LastTranscRate.toString().trim());
        initialValues.put("TaxRate", ProductTaxRateBK.toString().trim());
        initialValues.put("Sstat", "1");

        //LastTranscRate

        return db.insert(DBHelper.DATABASE_TABLE_SalesQuoteProductsMstr, null, initialValues);
    }

    public void deleteAllQuotationTables() {

        db.execSQL("DELETE FROM tblUOMMstr");
        db.execSQL("DELETE FROM tblSalesQuotePrcsMstr");
        db.execSQL("DELETE FROM tblSalesQuotePersonMeetMstr");
        db.execSQL("DELETE FROM tblSalesQuoteProductsMstr");
        db.execSQL("DELETE FROM tblSalesQuotePaymentModeMstr");
        db.execSQL("DELETE FROM tblSalesQuotePaymentStageMstr");
        db.execSQL("DELETE FROM tblSalesQuoteTypeMstr");
        db.execSQL("DELETE FROM tblSalesQuotePaymentStageModeMapMstr");
        db.execSQL("DELETE FROM tblSalesQuoteSponsorMstr");
        db.execSQL("DELETE FROM tblManufacturerMstrMain");

    }

    public void deletetblSalesQuoteProductsMstr(String PrdId, String SalesQuoteId) {

        db.execSQL("DELETE FROM tblSalesQuoteProductsMstr WHERE PrdId ='" + PrdId + "' and SalesQuoteId='" + SalesQuoteId + "' ");
    }

    public void deletetblRateDistribution(String SalesQuoteId, String StoreId) {

        db.execSQL("DELETE FROM tblRateDistribution WHERE SalesQuoteId ='" + SalesQuoteId + "' and StoreId='" + StoreId + "' ");
    }

    public String[] fetchAllDataFromtblSKUWiseDaySummary() {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT AutoId,ifnull(ProductId ,0),ifnull(Product ,0),ifnull(MRP ,0),ifnull(Rate ,0),ifnull(NoofStores ,0),ifnull(OrderQty ,0),ifnull(FreeQty ,0),ifnull(DiscValue ,0),ifnull(ValBeforeTax ,0),ifnull(TaxValue ,0),ifnull(ValAfterTax ,0),ifnull(Lvl ,0),ifnull(Category ,0),ifnull(UOM ,0),ifnull(OrderStr,'NA')  FROM tblSKUWiseDaySummary", null);

        try {
            String allData[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;
                    allData[i] = (String) cursor.getString(0).toString().trim() + "^" + (String) cursor.getString(1).toString().trim() + "^" + (String) cursor.getString(2).toString().trim() + "^" + (String) cursor.getString(3).toString().trim() + "^" + (String) cursor.getString(4).toString().trim() + "^" + (String) cursor.getString(5).toString().trim() + "^" + (String) cursor.getString(6).toString().trim() + "^" + (String) cursor.getString(7).toString().trim() + "^" + (String) cursor.getString(8).toString().trim() + "^" + (String) cursor.getString(9).toString().trim() + "^" + (String) cursor.getString(10).toString().trim() + "^" + (String) cursor.getString(11).toString().trim() + "^" + (String) cursor.getString(12).toString().trim() + "^" + (String) cursor.getString(13).toString().trim() + "^" + (String) cursor.getString(14).toString().trim() + "^" + (String) cursor.getString(15).toString().trim();
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
        }

    }





	/* private static final String DATABASE_CREATE_TABLE_232 = "create table tblStoreWiseDaySummary (AutoId int not null,Store text null," +
		 		"LinesperBill text null,StockValue text null,DiscValue text null,ValBeforeTax text null,TaxValue text null," +
		 		"ValAfterTax text null,Lvl text null);";*/

    public String[] fetchAllDataFromtblStoreWiseDaySummary() {

        Cursor cursor = db.rawQuery("SELECT ifnull(AutoId ,0),ifnull(Store ,0),ifnull(LinesperBill ,0),ifnull(StockValue ,0),ifnull(DiscValue ,0),ifnull(ValBeforeTax ,0),ifnull(TaxValue ,0),ifnull(ValAfterTax ,0),ifnull(Lvl ,0)  FROM tblStoreWiseDaySummary", null);


        try {
            String allData[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {

                    allData[i] = (String) cursor.getString(0).toString().trim() + "^" + (String) cursor.getString(1).toString().trim() + "^" + (String) cursor.getString(2).toString().trim() + "^" + (String) cursor.getString(3).toString().trim() + "^" + (String) cursor.getString(4).toString().trim() + "^" + (String) cursor.getString(5).toString().trim() + "^" + (String) cursor.getString(6).toString().trim() + "^" + (String) cursor.getString(7).toString().trim() + "^" + (String) cursor.getString(8).toString().trim();
                    //// System.out.println("Value inserting 232 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
        }

    }

    /*private static final String DATABASE_CREATE_TABLE_233 = "create table tblStoreSKUWiseDaySummary (AutoId int not null,
	 * ProductId text null," +
	 		"Product text null,MRP text null,Rate text null,OrderQty text null,FreeQty text null," +
	 		"DiscValue text null,ValBeforeTax text null,TaxValue text null,ValAfterTax text null,Lvl text null,
	 		StoreId text null);";

	*/

    public void deleteSalesQuotePersonMeetMstr(String SalesQuoteId) {

        db.execSQL("DELETE FROM tblSalesQuotePersonMeetMstr WHERE SalesQuoteId ='" + SalesQuoteId + "'");
    }

    public long saveSalesQuotePersonMeetMstr(String SalesQuoteId, String SalesQuoteCode, String SalesQuotePrcsId, String SalesQuotePrcs,
                                             String StoreName, String Remarks, String StoreId, String CreditLimit, String CreditDays,
                                             String ExpectedBusinessValue, String SalesQuoteValidFrom, String SalesQuoteValidTo, String SalesQuoteDate,
                                             String SalesQuoteType, String ContactPerson, String ContactPersonEmail, String ContactPersonPhone,
                                             String PaymentModeId, String PaymentStageId, String ManufacturerID, String ManufacturerName) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuoteId", SalesQuoteId.toString().trim());
        initialValues.put("SalesQuoteCode", SalesQuoteCode.toString().trim());
        initialValues.put("SalesQuotePrcsId", SalesQuotePrcsId.toString().trim());
        initialValues.put("SalesQuotePrcs", SalesQuotePrcs.toString().trim());
        initialValues.put("StoreName", StoreName.toString().trim());
        initialValues.put("Remarks", Remarks.toString().trim());
        initialValues.put("StoreId", StoreId.toString().trim());
        initialValues.put("CreditLimit", CreditLimit.toString().trim());
        initialValues.put("CreditDays", CreditDays.toString().trim());
        initialValues.put("ExpectedBusinessValue", ExpectedBusinessValue.toString().trim());
        initialValues.put("SalesQuoteValidFrom", SalesQuoteValidFrom.toString().trim());
        initialValues.put("SalesQuoteValidTo", SalesQuoteValidTo.toString().trim());
        initialValues.put("SalesQuoteDate", SalesQuoteDate.toString().trim());
        initialValues.put("SalesQuoteType", SalesQuoteType.toString().trim());
        initialValues.put("ContactPerson", ContactPerson.toString().trim());
        initialValues.put("ContactPersonEmail", ContactPersonEmail.toString().trim());
        initialValues.put("ContactPersonPhone", ContactPersonPhone.toString().trim());
        initialValues.put("PaymentModeId", PaymentModeId.toString().trim());
        initialValues.put("PymtStageId", PaymentStageId.toString().trim());
        initialValues.put("ManufacturerID", ManufacturerID.toString().trim());
        initialValues.put("ManufacturerName", ManufacturerName.toString().trim());
        initialValues.put("Sstat", "1");

        return db.insert(DBHelper.DATABASE_TABLE_SalesQuotePersonMeetMstr, null, initialValues);
    }

    public String fngetPaymentModeIDsBasedOnStageID(String PaymentStageID) {

        String flag = "0";
        try {
            ////open();
            Cursor cursor = db.rawQuery("SELECT PymtModeId from tblSalesQuotePaymentStageMstr where PymtStageId= '" + PaymentStageID + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    flag = cursor.getString(0).toString();
                }

            }
            return flag;
        } catch (Exception e) {

        } finally {

            //close();
            return flag;
        }

    }

    public LinkedHashMap<String, String> fnGettblSalesQuotePaymentStageMstr() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
        Cursor cursor = db.rawQuery("SELECT PymtStageId,PymtStage from tblSalesQuotePaymentStageMstr", null);// Where PNodeID='"+TSIID+"'
        //(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            //   close();
        }
    }

    public LinkedHashMap<String, String> fnGettblSalesQuoteTypeMstr() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
        Cursor cursor = db.rawQuery("SELECT SalesQuotetypeId,SalesQuoteType from tblSalesQuoteTypeMstr", null);// Where PNodeID='"+TSIID+"'
        //(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(1).toString(), (String) cursor.getString(0).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            //close();
        }
    }

    public String[] fetchAllDataFromtblStoreSKUWiseDaySummary() {

        Cursor cursor = db.rawQuery("SELECT AutoId ,ifnull(ProductId,0) ,ifnull(Product,0) ,ifnull(MRP,0) ,ifnull(Rate,0) ,ifnull(OrderQty,0) ,ifnull(FreeQty,0) ,ifnull(DiscValue,0) ,ifnull(ValBeforeTax,0) ,ifnull(TaxValue,0) ,ifnull(ValAfterTax,0) ,ifnull(Lvl,0) ,ifnull(StoreId,0) ,ifnull(StockQty,0),ifnull(OrderStr,'NA')  FROM tblStoreSKUWiseDaySummary", null);

        try {
            String allData[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {

                    allData[i] = (String) cursor.getString(0).toString().trim() + "^" + (String) cursor.getString(1).toString().trim() + "^" + (String) cursor.getString(2).toString().trim() + "^" + (String) cursor.getString(3).toString().trim() + "^" + (String) cursor.getString(4).toString().trim() + "^" + (String) cursor.getString(5).toString().trim() + "^" + (String) cursor.getString(6).toString().trim() + "^" + (String) cursor.getString(7).toString().trim() + "^" + (String) cursor.getString(8).toString().trim() + "^" + (String) cursor.getString(9).toString().trim() + "^" + (String) cursor.getString(10).toString().trim() + "^" + (String) cursor.getString(11).toString().trim() + "^" + (String) cursor.getString(12).toString().trim() + "^" + (String) cursor.getString(13).toString().trim() + "^" + (String) cursor.getString(14).toString().trim();
                    //// System.out.println("Value inserting 233 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
        }

    }

    public long savetblAllSummary(int AutoId, String Measures, String TodaysSummary, String MTDSummary) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("AutoId", AutoId);
        initialValues.put("Measures", Measures.trim());
        initialValues.put("TodaysSummary", TodaysSummary.trim());
        initialValues.put("MTDSummary", MTDSummary.trim());


        return db.insert(DBHelper.DATABASE_TABLE_MAIN234, null, initialValues);
    }

    public String[] fetchAllDataFromtblAllSummary() {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT *  FROM tblAllSummary", null);
        try {
            String allData[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;
                    allData[i] = (String) cursor.getString(0).toString().trim() + "^" + (String) cursor.getString(1).toString().trim() + "^" + (String) cursor.getString(2).toString().trim() + "^" + (String) cursor.getString(3).toString().trim();
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
        }

    }


	/* private static final String DATABASE_CREATE_TABLE_234 = "create table tblAllSummary (AutoId int not null,Measures text null," +
		 		"TodaysSummary text null,MTDSummary text null);";*/

    public HashMap<String, String> getProductPicInfo(File[] fileImageName, String storeId, String TmpInvoiceCodePDA) {
        HashMap<String, String> pathForPhotoInfo = new HashMap<String, String>();//=null;
        //open();
        for (int position = 0; position < fileImageName.length; position++) {
            Cursor cur = db.rawQuery("Select PhotoName,ProductID,ReasonForReturn from tblStoreProductPhotoDetail where PhotoName = '" + fileImageName[position].getName().toString() + "' and StoreID = '" + storeId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                    pathForPhotoInfo.put(cur.getString(0), cur.getString(1) + "~" + cur.getString(2));

                }

            }
        }

        return pathForPhotoInfo;
    }

    public long insertPhotoDetail(String storeId, String productId, String clickedDate, String photoName,
                                  String reasonForPhotoReturn, String photoValidation, String pdaPhotoPath, int Sstat, String OrderPDAID, String TmpInvoiceCodePDA) {

        //open();
        ContentValues initialValues = new ContentValues();
        // StoreID ,ProductID ,ClickedDateTime ,PhotoName ,PhotoValidation ,PDAPhotoPath ,outstat
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("ProductID", productId.trim());
        initialValues.put("ClickedDateTime", clickedDate.trim());
        initialValues.put("PhotoName", photoName.trim());
        initialValues.put("ReasonForReturn", reasonForPhotoReturn.trim());

        initialValues.put("PhotoValidation", photoValidation.trim());
        initialValues.put("PDAPhotoPath", pdaPhotoPath.trim());
        initialValues.put("Sstat", Sstat);
        initialValues.put("OrderIDPDA", OrderPDAID);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        long inserted = db.insert(DBHelper.DATABASE_TABLE_Main212, null, initialValues);
        //close();
        return inserted;
    }

    public long insertMaterialPhotoDetail(String storeId, String MaterialID, String clickedDate, String photoName,
                                          String reasonForPhotoReturn, String photoValidation, String pdaPhotoPath, int Sstat) {

        //open();

        String RouteID = GetActiveRouteID();
        ContentValues initialValues = new ContentValues();
        // StoreID ,ProductID ,ClickedDateTime ,PhotoName ,PhotoValidation ,PDAPhotoPath ,outstat
        initialValues.put("RouteID", RouteID.trim());
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("MaterialID", MaterialID.trim());
        initialValues.put("ClickedDateTime", clickedDate.trim());
        initialValues.put("PhotoName", photoName.trim());

        initialValues.put("PhotoValidation", photoValidation.trim());
        initialValues.put("PDAPhotoPath", pdaPhotoPath.trim());
        initialValues.put("Sstat", Sstat);

        long inserted = db.insert(DBHelper.DATABASE_TABLE_Main164, null, initialValues);
        //close();
        return inserted;
    }


/* tblStoreMaterialPhotoDetail (RouteID text null,StoreID text null,MaterialID text null,ClickedDateTime text null,
		 PhotoName text null,PhotoValidation text null,PDAPhotoPath text null,Sstat integer null)*/

    public long insertStoreMaterialDetail(String storeId, String MaterialID, int ExistStock, int ReturntoDistributor,
                                          int FreshOrder, int DiscardDamage, int Sstat) {

        //open();

        String RouteID = GetActiveRouteID();
        ContentValues initialValues = new ContentValues();
        // StoreID ,ProductID ,ClickedDateTime ,PhotoName ,PhotoValidation ,PDAPhotoPath ,outstat
        initialValues.put("RouteID", RouteID.trim());
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("MaterialID", MaterialID.trim());
        initialValues.put("ExistStock", ExistStock);
        initialValues.put("ReturntoDistributor", ReturntoDistributor);

        initialValues.put("FreshOrder", FreshOrder);
        initialValues.put("DiscardDamage", DiscardDamage);
        initialValues.put("Sstat", Sstat);

        long inserted = db.insert(DBHelper.DATABASE_TABLE_Main163, null, initialValues);
        //close();
        return inserted;
    }




 /*private static final String DATABASE_CREATE_TABLE_163 = "create table tblStoreMaterialDetail" +
 		" (RouteID text null,StoreID text null,MaterialID text null,ExistStock integer null,ReturntoDistributor integer null," +
 		"FreshOrder integer null,DiscardDamage integer null,Sstat integer null);";*/

    public void updatePhotoValidation(String validation, String imageNameToUpdate) {

        //open();
        final ContentValues values = new ContentValues();
        values.put("PhotoValidation", validation);
        int affected = db.update("tblStoreProductPhotoDetail", values, "PhotoName=?",
                new String[]{imageNameToUpdate});
        //close();

    }

    public void updatePhotoValidationMaterial(String validation, String imageNameToUpdate) {

        //open();
        final ContentValues values = new ContentValues();
        values.put("PhotoValidation", validation);
        int affected = db.update("tblStoreMaterialPhotoDetail", values, "PhotoName=?",
                new String[]{imageNameToUpdate});
        //close();

    }

    public String[] deletFromSDcCardPhotoValidation(String storeId) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  PhotoName from tblStoreProductPhotoDetail where StoreID='" + storeId + "'", null);
        try {
            if (cursor.getCount() > 0) {
                imageNameToBeDeleted = new String[cursor.getCount()];
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        imageNameToBeDeleted[i] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            } else {
                imageNameToBeDeleted = new String[1];
                imageNameToBeDeleted[0] = "No Data";
            }
        } finally {
            cursor.close();
            //close();
        }


        //	Log.w(TAG, "affected records: " + affected);


        return imageNameToBeDeleted;
    }

    public long insertPhotoDetail(String storeId, String productId, String clickedDate, String photoName, String photoValidation, String pdaPhotoPath, String outstat) {

        ContentValues initialValues = new ContentValues();
        // StoreID ,ProductID ,ClickedDateTime ,PhotoName ,PhotoValidation ,PDAPhotoPath ,outstat
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("ProductID", productId.trim());
        initialValues.put("ClickedDateTime", clickedDate.trim());
        initialValues.put("PhotoName", photoName.trim());
        initialValues.put("PhotoValidation", photoValidation.trim());
        initialValues.put("PDAPhotoPath", pdaPhotoPath.trim());
        initialValues.put("outstat", outstat.trim());


        return db.insert(DBHelper.DATABASE_TABLE_Main212, null, initialValues);
    }

    public long savetblStoreTypeMstr(int AutoIdStore, int StoreTypeID, String StoreTypeDescr) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("AutoIdStore", AutoIdStore);
        initialValues.put("StoreTypeID", StoreTypeID);
        initialValues.put("StoreTypeDescr", StoreTypeDescr.trim());

        //// System.out.println("Arjun data insert properly tblStoreTypeMstrr ");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN221, null, initialValues);
    }

    public String fetchStoreTypeDescrBasicOfStoreTypeID(int StoreTypeID) {

        int SnamecolumnIndex1 = 0;
        String LocIDDesc = "0";
        Cursor cursor = db.rawQuery("SELECT  StoreTypeDescr from tblStoreTypeMstr where StoreTypeID='" + StoreTypeID + "'", null);
        try {

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    LocIDDesc = (String) cursor.getString(SnamecolumnIndex1).toString().trim();

                    //// System.out.println("Fetching StoreTypeDescr:"+LocIDDesc);
                    cursor.moveToNext();
                }

            }
            return LocIDDesc;
        } finally {
            cursor.close();
        }


    }

    public long savetblTradeChannelMstr(int AutoIdStore, int TradeChannelID, String TradeChannelName) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("AutoIdStore", AutoIdStore);
        initialValues.put("TradeChannelID", TradeChannelID);
        initialValues.put("TradeChannelName", TradeChannelName.trim());

        //// System.out.println("Arjun data insert properly tblTradeChannelMstr ");
        return db.insert(DBHelper.DATABASE_TABLE_MAIN223, null, initialValues);
    }

    public String[] fnGetAllTradeChannelNames() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT TradeChannelName FROM tblTradeChannelMstr", null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount() + 1];
            if (cursor2.getCount() == 0) {
                strStoreTypeNamesDetais[0] = "Please Select Trade Channel";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (i == 0) {
                        strStoreTypeNamesDetais[i] = "Please Select Trade Channel";
                    }
                    strStoreTypeNamesDetais[i + 1] = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public String[] fnGetAllTradeChannelIDs() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT TradeChannelID FROM tblTradeChannelMstr", null);
        try {
            String strStoreTypeIdsDetais[] = new String[cursor2.getCount() + 1];
            if (cursor2.getCount() == 0) {
                strStoreTypeIdsDetais[0] = "0";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (i == 0) {
                        strStoreTypeIdsDetais[i] = "0";
                    }
                    strStoreTypeIdsDetais[i + 1] = cursor2
                            .getString(LoncolumnIndex);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStoreTypeIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    // Start Fifth Table Working
    public long savetblStoreProductClassificationTypeListMstr(int AutoIdStore, int CategoryNodeID,
                                                              int CategoryNodeType, String Category, int ProductTypeNodeID, int ProductTypeNodeType, String ProductType, int IsCategorySeleted, int IsSubCategorySeleted, String SubCategoryValue) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("AutoIdStore", AutoIdStore);
        initialValues.put("CategoryNodeID", CategoryNodeID);
        initialValues.put("CategoryNodeType", CategoryNodeType);
        initialValues.put("Category", Category);
        initialValues.put("ProductTypeNodeID", ProductTypeNodeID);
        initialValues.put("ProductTypeNodeType", ProductTypeNodeType);
        initialValues.put("ProductType", ProductType);
        initialValues.put("IsCategorySeleted", IsCategorySeleted);
        initialValues.put("IsSubCategorySeleted", IsSubCategorySeleted);
        initialValues.put("SubCategoryValue", SubCategoryValue);

        //	// System.out.println("Arjun data insert properly StoreProductClassificationType ");
        return db.insert(DBHelper.DATABASE_TABLE_MAIN222, null, initialValues);
    }

    public void fnCheckCategoryIds() {
        try {
            db.execSQL("UPDATE tblStoreProductClassificationTypeListMstr SET IsCategorySeleted=0");
            // // System.out.println("Anil Dangi SET flgTodayRoute= 0 :");
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    public void fnTickCheckCategoryId(int CatId) {
        try {
            db.execSQL("UPDATE tblStoreProductClassificationTypeListMstr SET IsCategorySeleted=1 where CategoryNodeID=" + CatId);
            // // System.out.println("Anil Dangi SET flgTodayRoute= 0 :");
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    public void funInsertDataStoreCategoryProductWise(String RouteID, String StoreID) {
        db.execSQL("INSERT INTO tblTemp (ProductType,RouteID,StoreID,CategoryNodeID,CategoryNodeType,Category,ProductTypeNodeID,ProductTypeNodeType,IsCategorySeleted,IsSubCategorySeleted,SubCategoryValue,Sstat) SELECT DISTINCT ProductType,'" + RouteID + "','" + StoreID + "',CategoryNodeID,CategoryNodeType,Category,ProductTypeNodeID,ProductTypeNodeType,IsCategorySeleted,IsSubCategorySeleted,ifnull(SubCategoryValue,'0'),1 FROM   tblStoreProductClassificationTypeListMstr where tblStoreProductClassificationTypeListMstr.IsCategorySeleted=1 and tblStoreProductClassificationTypeListMstr.IsSubCategorySeleted=1");
    }

    public void funResetMainTables() {
        db.execSQL("Update tblStoreProductClassificationTypeListMstr Set IsCategorySeleted=0");
        db.execSQL("Update tblStoreProductClassificationTypeListMstr Set IsSubCategorySeleted=0");
        db.execSQL("Update tblStoreProductClassificationTypeListMstr Set SubCategoryValue=''");
    }

    public void fnCheckUnCheckSubCategoryId(int CatId, int SubCatId, int SelectStatus) {
		/*try
        {*/
        db.execSQL("UPDATE tblStoreProductClassificationTypeListMstr SET IsSubCategorySeleted=" + SelectStatus + " where CategoryNodeID=" + CatId + " and ProductTypeNodeID=" + SubCatId);
        // // System.out.println("Anil Dangi SET flgTodayRoute= 0 :");
		/*}
      catch (Exception ex)
        {
			Log.e(TAG, ex.toString());
		}*/
    }

    public void fnUpdateSubCategoryValue(int CatId, int SubCatId, String SubCatValue) {
		/*try
        {*/
        db.execSQL("UPDATE tblStoreProductClassificationTypeListMstr SET SubCategoryValue='" + SubCatValue + "' where CategoryNodeID=" + CatId + " and ProductTypeNodeID=" + SubCatId);
        // // System.out.println("Anil Dangi SET flgTodayRoute= 0 :");
		/*}
      catch (Exception ex)
        {
			Log.e(TAG, ex.toString());
		}*/
    }

    public String[] fnGetAllSubCategoryNames(String CategoryNodeID) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductType  FROM tblStoreProductClassificationTypeListMstr where CategoryNodeID='" + CategoryNodeID + "'", null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];
			/*if(cursor2.getCount()==0)
			{
				strStoreTypeNamesDetais[0]="Please select Store Product Classification";
			}*/
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
					/*if(i==0)
					{
						strStoreTypeNamesDetais[i]="Please select Store Product Classification";
					}*/
                    //strStoreTypeNamesDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    strStoreTypeNamesDetais[i] = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public String[] fnGetAllSubCategoryCheckStatus(String CategoryNodeID) {

        int LoncolumnIndex = 1;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductType,IsSubCategorySeleted  FROM tblStoreProductClassificationTypeListMstr where CategoryNodeID=" + CategoryNodeID, null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];
			/*if(cursor2.getCount()==0)
			{
				strStoreTypeNamesDetais[0]="Please select Store Product Classification";
			}*/
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
					/*if(i==0)
					{
						strStoreTypeNamesDetais[i]="Please select Store Product Classification";
					}*/
                    //strStoreTypeNamesDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    strStoreTypeNamesDetais[i] = cursor2.getString(LoncolumnIndex);

                    //	// System.out.println("Sunil SubCategory check  strStoreTypeNamesDetais[i] :"+strStoreTypeNamesDetais[i]);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public String[] fnGetAllSubCategoryValues(String CategoryNodeID) {

        int LoncolumnIndex = 1;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductType,SubCategoryValue  FROM tblStoreProductClassificationTypeListMstr where CategoryNodeID=" + CategoryNodeID, null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];
			/*if(cursor2.getCount()==0)
			{
				strStoreTypeNamesDetais[0]="Please select Store Product Classification";
			}*/
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
					/*if(i==0)
					{
						strStoreTypeNamesDetais[i]="Please select Store Product Classification";
					}*/
                    //strStoreTypeNamesDetais[i+1] = cursor2.getString(LoncolumnIndex);
                    strStoreTypeNamesDetais[i] = cursor2.getString(LoncolumnIndex);

                    //	// System.out.println("Sunil SubCategory check  strStoreTypeNamesDetais[i] :"+strStoreTypeNamesDetais[i]);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public String[] fnGetAllSubCategoryIds(String CategoryNodeID) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductTypeNodeID FROM tblStoreProductClassificationTypeListMstr where CategoryNodeID='" + CategoryNodeID + "'", null);
        try {
            String strStoreTypeIdsDetais[] = new String[cursor2.getCount()];
			/*if(cursor2.getCount()==0)
			{
				strStoreTypeIdsDetais[0]="0";
			}*/
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
					/*if(i==0)
					{
						strStoreTypeIdsDetais[i]="0";
					}*/
                    strStoreTypeIdsDetais[i] = cursor2
                            .getString(LoncolumnIndex);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStoreTypeIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    public String fetchStoreProductClassificationDescrBasicOfStoreProductClassificationID(int StoreProductClassificationID) {

        int SnamecolumnIndex1 = 0;
        String LocIDDesc = "0";
        Cursor cursor = db.rawQuery("SELECT  StoreProductClassificationDescr from tblStoreProductClassificationTypeListMstr where StoreProductClassificationID='" + StoreProductClassificationID + "'", null);
        try {

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    LocIDDesc = (String) cursor.getString(SnamecolumnIndex1).toString().trim();

                    //	// System.out.println("Fetching StoreTypeDescr:"+LocIDDesc);
                    cursor.moveToNext();
                }

            }
            return LocIDDesc;
        } finally {
            cursor.close();
        }


    }

    public String[] fnGetAllStoreProductClassificationTypeNames() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT Category  FROM tblStoreProductClassificationTypeListMstr order by CategoryNodeID", null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStoreTypeNamesDetais[i] = cursor2.getString(LoncolumnIndex);
                    //// System.out.println("Abhiav Raj New :"+strStoreTypeNamesDetais[i]);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public String[] fnGetAllStoreProductClassificationTypeIds() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT CategoryNodeID FROM tblStoreProductClassificationTypeListMstr order by CategoryNodeID", null);
        try {
            String strStoreTypeIdsDetais[] = new String[cursor2.getCount()];

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strStoreTypeIdsDetais[i] = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    public String[] fnGetAllRouteDescrNewStore() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster", null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount() + 1];
            if (cursor2.getCount() == 0) {
                strStoreTypeNamesDetais[0] = "Please Select Route";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (i == 0) {
                        strStoreTypeNamesDetais[i] = "Please Select Route";
                    }
                    strStoreTypeNamesDetais[i + 1] = cursor2.getString(LoncolumnIndex);
                    //	// System.out.println("Fetching Data from tblRouteListMaster is Desc :"+strStoreTypeNamesDetais[i+1]);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    // End Second Table Working

    public String[] fnGetAllRouteIDNewStore() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster", null);
        try {
            String strStoreTypeIdsDetais[] = new String[cursor2.getCount() + 1];
            if (cursor2.getCount() == 0) {
                strStoreTypeIdsDetais[0] = "0";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (i == 0) {
                        strStoreTypeIdsDetais[i] = "0";
                    }
                    strStoreTypeIdsDetais[i + 1] = cursor2.getString(LoncolumnIndex);
                    //// System.out.println("Fetching Data from tblRouteListMaster is ID :"+strStoreTypeIdsDetais[i+1]);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStoreTypeIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    //tblRouteListMaster(AutoIdStore integer null,RouteID integer null, RouteDescr text null);";

    public String[] fnGetAllStoreTypeNames() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT StoreTypeDescr FROM tblStoreTypeMstr", null);
        try {
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount() + 1];
            if (cursor2.getCount() == 0) {
                strStoreTypeNamesDetais[0] = "Please Select Store Type";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (i == 0) {
                        strStoreTypeNamesDetais[i] = "Please Select Store Type";
                    }
                    strStoreTypeNamesDetais[i + 1] = cursor2.getString(LoncolumnIndex);
                    //	// System.out.println("Fetching tblStoreTypeMstr from tblRouteListMaster is Desc :"+strStoreTypeNamesDetais[i+1]);
                    cursor2.moveToNext();

                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }

    }

    public String[] fnGetAllStoreTypeIds() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT StoreTypeID FROM tblStoreTypeMstr", null);
        try {
            String strStoreTypeIdsDetais[] = new String[cursor2.getCount() + 1];
            if (cursor2.getCount() == 0) {
                strStoreTypeIdsDetais[0] = "0";
            }
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (i == 0) {
                        strStoreTypeIdsDetais[i] = "0";
                    }
                    strStoreTypeIdsDetais[i + 1] = cursor2.getString(LoncolumnIndex);
                    //	// System.out.println("Fetching tblStoreTypeMstr from tblStoreTypeMstr is Desc :"+strStoreTypeIdsDetais[i+1]);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStoreTypeIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    public void fnReleaseTableUnReuqiredData() {
        try {
            db.execSQL("Delete from tblTemp where Sstat=4");
            db.execSQL("Delete from tblNewStoreEntries where Sstat=4");
            //   // System.out.println("Anil Dangi SET flgTodayRoute= 0 :");
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public long savetblStoreMainAfterCountNUmberOfStore(String RouteID, String StoreID, String StoreName, String RetailerName, String emailID, String TinNo,
                                                        String RetailerContactNo, String StoreAddress, String StorePincode, String City, String KeyAccount, int TradeChannelID, int StoreTypeId,
                                                        int StoreCategoryId, int RetailSalesTypeId, int StorePotentialId, String StoreProductClassificationId,
                                                        String VisitStartTS, String Imei, String BatteryStatus, int Sstat, int CityId,
                                                        String ActualLatitude, String ActualLongitude, String Accuracy, String LocProvider) {

        long syncTIMESTAMP = System.currentTimeMillis();
        Date dateobj = new Date(syncTIMESTAMP);
        SimpleDateFormat df = new SimpleDateFormat("dd-MMM-yyyy HH:mm:ss", Locale.ENGLISH);
        String StampEndsTime = TimeUtils.getNetworkDateTime(mContext, TimeUtils.DATE_TIME_FORMAT);


        ContentValues initialValues = new ContentValues();

        initialValues.put("RouteID", RouteID);
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("StoreName", StoreName.trim());
        initialValues.put("RetailerName", RetailerName.trim());
        initialValues.put("emailID", emailID);
        initialValues.put("TinNo", TinNo);
        initialValues.put("RetailerContactNo", RetailerContactNo.trim());
        initialValues.put("StoreAddress", StoreAddress);
        initialValues.put("StorePincode", StorePincode);
        initialValues.put("City", City);
        initialValues.put("KeyAccount", KeyAccount);
        initialValues.put("TradeChannelID", TradeChannelID);

        initialValues.put("StoreAttrHierID", StoreTypeId);

        initialValues.put("StoreProductClassificationId", StoreProductClassificationId.trim());


        initialValues.put("ActualLatitude", ActualLatitude.trim());
        initialValues.put("ActualLongitude", ActualLongitude.trim());
        initialValues.put("LocProvider", LocProvider.trim());
        initialValues.put("Accuracy", Accuracy.trim());
        //initialValues.put("Accuracy", LocProvider.trim());
        //// System.out.println("DateTime fnDBKenya savetblStoreMainAfterCountNUmberOfStore = "+VisitStartTS);
        initialValues.put("VisitStartTS", VisitStartTS.trim());
        initialValues.put("VisitEndTS", StampEndsTime.trim());


        initialValues.put("PDACode", Imei.trim());
        initialValues.put("BatteryStatus", BatteryStatus.trim());
        initialValues.put("Sstat", Sstat);
        initialValues.put("CityId", CityId);


        initialValues.put("AppVersion", DBHelper.DATABASE_VERSION);


        checkNumberOfStore++;

        //// System.out.println("Data insert Properly in DATABASE_TABLE_MAIN21");


        return db.insert(DBHelper.DATABASE_TABLE_MAIN21, null, initialValues);
    }

    public void deletetblstoreMstrOnStoreIDBasis(String StoreID) {

        db.execSQL("DELETE FROM tblStoreList WHERE StoreID ='" + StoreID + "'");
        db.execSQL("DELETE FROM tblNewAddedStoreLocationDetails WHERE StoreID ='" + StoreID + "'");
        db.execSQL("DELETE FROM tblNewStoreListEntries WHERE StoreID ='" + StoreID + "'");


    }






/*	public static void deletetblstoreMstrOnStoreIDBasis(String StoreID) {

		db.execSQL("DELETE FROM tblStoreList WHERE StoreID ='"+ StoreID +"'");
		db.execSQL("DELETE FROM tblNewStoreListEntries WHERE StoreID ='"+ StoreID +"'");

	}*/

    public void savetblStoreMain(String RouteID, String StoreID, String StoreName, String RetailerName, String emailID,
                                 String TinNo,
                                 String RetailerContactNo, String StoreAddress, String StorePincode, String City, String KeyAccount,
                                 int TradeChannelID, int StoreTypeId,
                                 int StoreCategoryId, int RetailSalesTypeId, int StorePotentialId, String StoreProductClassificationId,
                                 String VisitStartTS, String Imei, String BatteryStatus, int Sstat, int CityId, String ActualLatitude,
                                 String ActualLongitude, String Accuracy, String LocProvider, int IsNewStoreDataCompleteSaved,
                                 String fetchAddress, String PaymentStage, int flgHasQuote, int flgAllowQuotation,
                                 int flgSubmitFromQuotation, String flgGSTCapture, String flgGSTCompliance, String GSTNumber, int flgGSTRecordFromServer, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgRestart, int flgStoreOrder, String StoreCity, String StorePinCode, String StoreState, String DBR, String OwnerName, String StoreContactNo, String StoreCatType, int flgRuleTaxVal, int flgTransType, String mobileFnl, String SalesPersonName, String SalesPersonContactNo, int IsComposite, int StoreStateID, int StoreCityID,int IsDiscountApplicable,int RegionID,String IsDiscountAllowed,String selectedDistributorDisText,String selectedStoreTypeDesc) {

        int MaxAutoStore = 0;
        int cntTotStore = 0;
        cntTotStore = fnGetCountForNewStore();
        String strGetMaxIDForNewStore = "0";
        //String activeRid;
        //activeRid = GetActiveRouteID();
        if (cntTotStore > 0) {
            MaxAutoStore = fnGetMaxAutoStoreIncrementForNewStore();
            MaxAutoStore = MaxAutoStore + 1;
            strGetMaxIDForNewStore = fnGetMaxIdWithIncrementForNewStore(MaxAutoStore);
        } else {
            MaxAutoStore = 0;
            MaxAutoStore = MaxAutoStore + 1;

            strGetMaxIDForNewStore = "-000^" + (1) + "$" + MaxAutoStore;

        }

        if (!StoreID.equals("") && !StoreID.equals(null) && !StoreID.equals(0)) {

            String prevDate2Send = fnGetDateTimeString();//GetPrevDate();

            if (prevDate2Send.equals("") || prevDate2Send.equals("NA")) {
                long syncTIMESTAMP = System.currentTimeMillis();
                Date dateobj = new Date(syncTIMESTAMP);
                SimpleDateFormat df = new SimpleDateFormat("dd-MMM-yyyy", Locale.ENGLISH);
                prevDate2Send = TimeUtils.getNetworkDateTime(mContext, TimeUtils.DATE_FORMAT);
            }

            //saveSOAPdataStoreList = DBR,flgRetailerCredit
            saveSOAPdataStoreListNewStore(StoreID, "" + StoreTypeId, StoreName, Double.parseDouble(ActualLatitude.trim()), Double.parseDouble(ActualLongitude.trim()), "", "", prevDate2Send, MaxAutoStore, Sstat, Accuracy.trim(), LocProvider.trim(), RouteID, BatteryStatus, IsNewStoreDataCompleteSaved, fetchAddress, PaymentStage, flgHasQuote, flgAllowQuotation, flgSubmitFromQuotation, flgGSTCapture, flgGSTCompliance, GSTNumber, flgGSTRecordFromServer, flgLocationServicesOnOff, flgGPSOnOff, flgNetworkOnOff, flgFusedOnOff, flgInternetOnOffWhileLocationTracking, flgRestart, flgStoreOrder, StoreCity, StorePinCode, StoreState, DBR, OwnerName, StoreContactNo, StoreCatType, flgRuleTaxVal, flgTransType, SalesPersonName, SalesPersonContactNo, IsComposite, StoreStateID, StoreCityID, Imei,IsDiscountApplicable,RegionID,IsDiscountAllowed,selectedDistributorDisText,selectedStoreTypeDesc); // in last parameter Fdate

            fnInsert_tblNewAddedStoreLocationDetails(StoreID, Sstat, ActualLatitude, ActualLongitude, prevDate2Send, LocProvider, Accuracy, BatteryStatus, flgLocationServicesOnOff, flgGPSOnOff, flgNetworkOnOff, flgFusedOnOff, flgInternetOnOffWhileLocationTracking);
        }


    }

    public int checkRouteIDExistInStoreListTable(int StoreRouteID) {

        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblStoreList WHERE StoreRouteID=" + StoreRouteID, null);

        try {

            int check = 0;

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        check = 1;
                        cursor.moveToNext();
                    }
                }

            }
            return check;

        } finally {
            cursor.close();
        }

    }

    public int counttblForPDAGetLastVisitDate(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDAGetLastVisitDate WHERE StoreID ='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public int getVisitisLocationRadioChecked(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT isLocationRadioChecked FROM tblStoreVisitMstr WHERE StoreID ='" + StoreID + "'", null);
        int chkI = -1;
        try {
            if (cursorE2.moveToFirst()) {
                chkI =cursorE2.getInt(0);
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String fnGetVisitDateAndflgOrderFromtblForPDAGetLastVisitDate(String StoreID) {

        Cursor cursorE2 = db.rawQuery("SELECT VisitDate,flgOrder FROM tblPDAGetLastVisitDate WHERE StoreID ='"
                + StoreID + "'", null);
        String LastTransDate = "";
        int ScodecolumnIndex = 0;
        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                    LastTransDate = (String) cursorE2.getString(0).toString() + "^" + (String) cursorE2.getString(1).toString();
                    // // System.out.println("Sunil Jai Testing LastTransDate :"+LastTransDate);
                    cursorE2.moveToNext();
                }
            }
            return LastTransDate;
        } finally {
            cursorE2.close();
        }

    }


    public int counttblForPDAGetLastOrderDate(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDAGetLastOrderDate WHERE StoreID ='"
                + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String fnGettblForPDAGetLastOrderDate(String StoreID) {
        int ScodecolumnIndex = 0;

        Cursor cursorE2 = db.rawQuery("SELECT OrderDate,flgExecutionSummary FROM tblPDAGetLastOrderDate WHERE StoreID ='" + StoreID + "' Limit 1", null);
        String LastTransDate = "";

        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                    LastTransDate = (String) cursorE2.getString(0).toString() + "^" + (String) cursorE2.getString(1).toString();
                    cursorE2.moveToNext();
                }
            }
            return LastTransDate;
        } finally {
            cursorE2.close();
        }

    }

    public int counttblForPDAGetLastVisitDetails(String StoreID) {
        Cursor cursorE2 = db.rawQuery("select Count(*) from tblPDAGetLastVisitDetails WHERE StoreID ='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String[] fetchDateFromtblForPDAGetLastVisitDetails(String StoreID) {

        Cursor cursor = db
                .rawQuery("SELECT Date123 FROM tblPDAGetLastVisitDetails WHERE StoreID ='" + StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String[] fetchAllDataFromtblForPDAGetLastVisitDetails(String StoreID) {

        Cursor cursor = db
                .rawQuery("SELECT SKUName, Stock, Order123, ExecutionQty FROM tblPDAGetLastVisitDetails WHERE StoreID ='" + StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "^"
                                + (String) cursor.getString(1).toString()
                                + "^"
                                + (String) cursor.getString(2).toString()
                                + "^"
                                + (String) cursor.getString(3).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public HashMap<String, String> getProductPicInfoMaterial(File[] fileImageName, String storeId) {
        HashMap<String, String> pathForPhotoInfo = new HashMap<String, String>();//=null;
        //open();
        for (int position = 0; position < fileImageName.length; position++) {
            Cursor cur = db.rawQuery("Select PhotoName,MaterialID from tblStoreMaterialPhotoDetail where PhotoName = '" + fileImageName[position].getName().toString() + "' and StoreID = '" + storeId + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                    pathForPhotoInfo.put(cur.getString(0), cur.getString(1));

                }

            }
        }

        // close();
        return pathForPhotoInfo;
    }

    public ArrayList<HashMap<String, String>> fetch_matID_ReturnData(String storeId) {
        // System.out.println("Abhinav Raj is 2");
        //open();
        ArrayList<HashMap<String, String>> totalProductDetail = new ArrayList<HashMap<String, String>>(4);

        HashMap<String, String> hmapMatIDExistingStock = new HashMap<String, String>();
        HashMap<String, String> hmapMatIDReturntoDistributor = new HashMap<String, String>();
        HashMap<String, String> hmapMatIDFreshOrder = new HashMap<String, String>();

        HashMap<String, String> hmapMatIDDiscardDamage = new HashMap<String, String>();




		    /*  private static final String DATABASE_CREATE_TABLE_163 = "create table tblStoreMaterialDetail " +
		      		"(RouteID text null,StoreID text null,MaterialID text null,ExistStock integer null," +
		      		"ReturntoDistributor integer null,FreshOrder integer null,DiscardDamage integer null,Sstat integer null);";*/

        //Cursor cursor = db.rawQuery("SELECT ProductID,CategoryID,ProductShortName FROM tblProductListMaster",null);
        Cursor cursor = db.rawQuery("SELECT MaterialID,ExistStock,ReturntoDistributor,FreshOrder,DiscardDamage FROM tblStoreMaterialDetail where StoreID='" + storeId + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapMatIDExistingStock.put(cursor.getString(0), cursor.getString(1));

                        hmapMatIDReturntoDistributor.put(cursor.getString(0), cursor.getString(2));
                        hmapMatIDFreshOrder.put(cursor.getString(0), cursor.getString(3));
                        hmapMatIDDiscardDamage.put(cursor.getString(0), cursor.getString(4));
                        cursor.moveToNext();

                    }
                    totalProductDetail.add(0, hmapMatIDExistingStock);
                    totalProductDetail.add(1, hmapMatIDReturntoDistributor);
                    totalProductDetail.add(2, hmapMatIDFreshOrder);
                    totalProductDetail.add(3, hmapMatIDDiscardDamage);

                }
            }


            return totalProductDetail;
        } finally {
            cursor.close();

            // close();
        }


    }


    public int counttblForPDAGetLastOrderDetails(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDAGetLastOrderDetails WHERE StoreID ='"
                + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String[] fetchOrderDateFromtblForPDAGetLastOrderDetails(String StoreID) {

        Cursor cursor = db
                .rawQuery(
                        "SELECT OrderDate FROM tblPDAGetLastOrderDetails WHERE StoreID ='" + StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String[] fetchAllDataFromtblForPDAGetLastOrderDetails(String StoreID) {

        Cursor cursor = db
                .rawQuery(
                        "SELECT PrdName, OrderQty, FreeQty, ExecutionQty FROM tblPDAGetLastOrderDetails WHERE StoreID ='" + StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "^"
                                + (String) cursor.getString(1).toString()
                                + "^"
                                + (String) cursor.getString(2).toString()
                                + "^"
                                + (String) cursor.getString(3).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public int counttblspForPDAGetLastOrderDetails_TotalValues(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDAGetLastOrderDetailsTotalValues WHERE StoreID ='"
                + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String[] fetchAllDataFromtblspForPDAGetLastOrderDetails_TotalValues(String StoreID) {

        Cursor cursor = db
                .rawQuery(
                        "SELECT OrderValue,ExecutionValue FROM tblPDAGetLastOrderDetailsTotalValues WHERE StoreID ='" + StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "_"
                                + (String) cursor.getString(1).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String[] fetchOrderDateFromtblForPDAGetExecutionSummary(String StoreID) {

        Cursor cursor = db
                .rawQuery(
                        "SELECT DISTINCT OrderDate FROM tblPDAGetExecutionSummary WHERE StoreID ='" + StoreID + "' Limit 3", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String DateResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        DateResult[i] = (String) cursor.getString(0)
                                .toString();

                        // // System.out.println("Aajtak value DateResult :"+DateResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return DateResult;

        } finally {
            cursor.close();
        }

    }

	/*SELECT DISTINCT Category, MAX(CreationDate)
	FROM MonitoringJob
	GROUP BY Category
	ORDER BY MAX(CreationDate) DESC, Category*/

    public int fnfetchMinNoOfSKUFromtblCouponMasterNewFormat() {


        Cursor cursorE2 = db.rawQuery(
                "SELECT MinNoOfSKU FROM tblCouponMasterNewFormat", null);

        //////////// // System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++) {
                    if (!cursorE2.isNull(0)) {
                        chkI = Integer.parseInt(cursorE2.getString(0));
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// // System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public Double fnfetchAdditionalAmountFromtblCouponSlabNewFormat() {

        Cursor cursorE2 = db.rawQuery(
                "SELECT AdditionalAmount FROM tblCouponSlabNewFormat", null);

        //////////// // System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        Double chkI = 0.0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++) {
                    if (!cursorE2.isNull(0)) {
                        chkI = Double.parseDouble((cursorE2.getString(0)));
                    } else {
                        chkI = 0.0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// // System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public int countCouponNewFormatApplyOrNot(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT ProductID,flgMust,Qty FROM tblTempNewFormat WHERE flgMust=1 AND Qty>=MinQty_Value And StoreID='" + StoreID + "'", null);
        //Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblTempNewFormat WHERE (flgMust ="+1+" AND Qty>=MinQty_Value)", null);
        //Cursor cursorE2 = db.rawQuery("SELECT Qty,MinQty_Value FROM tblTempNewFormat WHERE flgMust = 1", null);
        //Cursor cursorE2 = db.rawQuery("SELECT Qty,MinQty_Value,flgMust FROM tblTempNewFormat", null);
        int chkI = 0;
        try {
            // // System.out.println("Sunil grater value getCount"+cursorE2.getCount());
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = 1;
					/*for (int i = 0; i < cursorE2.getCount(); i++)
					{


						// // System.out.println("Sunil grater value ProductID"+cursorE2.getString(0).toString());
						// // System.out.println("Sunil grater value flgMust"+cursorE2.getString(1).toString());
						// // System.out.println("Sunil grater value Qty"+cursorE2.getString(2).toString());
							cursorE2.moveToNext();

					}*/
                    cursorE2.moveToNext();
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public long fninsertPDAProductReturnDetails(int AutoReturnIdMstr,
                                                int AutoReturnIdDetails, String strProductId,
                                                String strProdReturnQty, Double ProdRate, Double ProdReturnValue,
                                                int proSingleAdjQty, Double proSingleAdjAmt, String CatId) {

        ContentValues initialValues = new ContentValues();

        //////////// // System.out.println("Saved AutoReturnIdMstr:" + AutoReturnIdMstr+ "Saved AutoReturnIdDetails:" + "" + AutoReturnIdDetails);

        String activeRid;
        activeRid = GetActiveRouteID();

        initialValues.put("AutoReturnDetailsId", AutoReturnIdDetails);
        initialValues.put("ReturnIdMstr", AutoReturnIdMstr);
        initialValues.put("ProductId", strProductId.trim());
        initialValues.put("ProdReturnQty", strProdReturnQty.trim());
        initialValues.put("ProdRate", ProdRate);
        initialValues.put("ProdReturnValue", ProdReturnValue);

        initialValues.put("AdjustReturnQty", proSingleAdjQty);
        initialValues.put("AdjustReturnValue", proSingleAdjAmt);


        initialValues.put("ProdReturnReason", " ");
        initialValues.put("ProdReturnReasonDescr", " ");
        initialValues.put("ProdLastOrderDate", " ");
        initialValues.put("ProdLastOrderQyt", " ");
        initialValues.put("CatId", CatId.trim());
        initialValues.put("RouteID", Integer.parseInt(activeRid));


        return db.insert(DBHelper.DATABASE_TABLE_MAIN20, null, initialValues);
    }

    public int fnCheckflgToShowCouponNewFormat() {


        Cursor cursorE2 = db.rawQuery(
                "SELECT CouponApplicable FROM tblCouponApplicableNewFormat", null);

        //////////// // System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++) {
                    if (!cursorE2.isNull(0)) {
                        chkI = Integer.parseInt(cursorE2.getString(0));
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// // System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public Double fnfetchMinInvoiceAmountFromtblCouponMasterNewFormat() {

        Cursor cursorE2 = db.rawQuery(
                "SELECT MinInvoiceAmount FROM tblCouponMasterNewFormat", null);

        //////////// // System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        Double chkI = 0.0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++) {
                    if (!cursorE2.isNull(0)) {
                        chkI = Double.parseDouble((cursorE2.getString(0)));
                    } else {
                        chkI = 0.0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// // System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public String[] fetchProductIDFromtblForPDAGetExecutionSummary(String StoreID) {

        Cursor cursor = db
                .rawQuery(
                        "SELECT DISTINCT ProductID FROM tblPDAGetExecutionSummary WHERE StoreID ='" + StoreID + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String DateResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        DateResult[i] = (String) cursor.getString(0)
                                .toString();

                        // // System.out.println("Aajtak value DateResult :"+DateResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return DateResult;

        } finally {
            cursor.close();
        }

    }

    public String[] fetchPrdNameFromtblForPDAGetExecutionSummary(String StoreID) {

        Cursor cursor = db
                .rawQuery(
                        "SELECT DISTINCT PrdName FROM tblPDAGetExecutionSummary WHERE StoreID ='" + StoreID + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String DateResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        DateResult[i] = (String) cursor.getString(0)
                                .toString();

                        // // System.out.println("Aajtak value DateResult :"+DateResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return DateResult;

        } finally {
            cursor.close();
        }

    }

    public String[] fetchAllDataNewFromtbltblForPDAGetExecutionSummary(String StoreID, String OrderDate, String ProductID) {

        Cursor cursor = db
                .rawQuery(
                        "SELECT  OrderQty,ProductQty FROM tblPDAGetExecutionSummary WHERE StoreID ='" + StoreID.trim() + "' and OrderDate ='" + OrderDate.trim() + "' and ProductID ='" + ProductID.trim() + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "_"
                                + (String) cursor.getString(1).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String[] fetchAllDataFromtbltblForPDAGetExecutionSummary(String StoreID) {

        Cursor cursor = db
                .rawQuery(
                        "SELECT PrdName, OrderQty, flgInvStatus, ProductQty FROM tblPDAGetExecutionSummary WHERE StoreID ='" + StoreID + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "_"
                                + (String) cursor.getString(1).toString()
                                + "_"
                                + (String) cursor.getString(2).toString()
                                + "_"
                                + (String) cursor.getString(3).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String fetchNoti_textFromtblPDANotificationMaster() {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;

        Cursor cursor2 = db.rawQuery("SELECT MsgServerID,Noti_text  FROM tblPDANotificationMaster where Noti_NewOld=1 and Noti_ReadStatus=1", null);

        try {
            String UniqueProductShortName = "Null";

            if (cursor2.getCount() > 0) {

                if (cursor2.moveToFirst()) {

                    UniqueProductShortName = cursor2.getString(LoncolumnIndex).toString() + "_" + cursor2.getString(LoncolumnIndex1).toString();


                    cursor2.moveToNext();
                }

            }


            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public void updatetblPDANotificationMaster(int MsgServerID, String Noti_text, int Noti_ReadStatus, String Noti_ReadDateTime, int Sstat) {

        final ContentValues values = new ContentValues();
        values.put("Noti_ReadStatus", Noti_ReadStatus);
        values.put("Noti_ReadDateTime", Noti_ReadDateTime.trim());
        values.put("Sstat", Sstat);


        int affected = db.update(DBHelper.TABLE_tblPDANotificationMaster_Define, values, "MsgServerID=?", new String[]{"" + MsgServerID});

        Log.w(TAG, "tblPDANotificationMaster Updated..");
    }

    public int countNoRowIntblPDANotificationMaster() {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDANotificationMaster", null);
        int chkI = 0;
        try {
            // // System.out.println("Sunil LastNitificationrList cursorE2.getCount() SerialNo : "+cursorE2.getCount());

            if (cursorE2.getCount() > 0) {
                cursorE2.moveToFirst();
                // // System.out.println("Sunil LastNitificationrList cursorE2.getCount() SerialNo value : "+cursorE2.getString(0).toString());

                chkI = Integer.parseInt(cursorE2.getString(0).toString());
            }


        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String[] LastNitificationrListDB() {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;

        Cursor cursor2 = db.rawQuery("SELECT Noti_DateTime,Noti_text  FROM tblPDANotificationMaster Order By SerialNo desc ", null);

        try {
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            // // System.out.println("Sunil Prev Noti List cursor2.getCount() :"+cursor2.getCount());
            if (cursor2.getCount() > 0) {
                // // System.out.println("Sunil Prev Noti List H1:");
                if (cursor2.moveToFirst()) {
                    // // System.out.println("Sunil Prev Noti List H2:");
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        // // System.out.println("Sunil Prev Noti List H3:");
                        if (!cursor2.isNull(LoncolumnIndex)) {
                            // // System.out.println("Sunil Prev Noti List H4:");
                            UniqueProductShortName[i] = cursor2.getString(LoncolumnIndex).toString() + "_" + cursor2.getString(LoncolumnIndex1).toString();
                            // // System.out.println("Sunil Prev Noti List :"+UniqueProductShortName[i]);

                            cursor2.moveToNext();
                        }

                    }

                }
            }

            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public void deletetblPDANotificationMasterOneRow(int SerialNo) {

        db.execSQL("DELETE FROM tblPDANotificationMaster WHERE SerialNo =" + SerialNo);
        for (int i = 0; i < 9; i++) {
            final ContentValues values = new ContentValues();
            values.put("SerialNo", i + 1);

            int affected = db.update(DBHelper.TABLE_tblPDANotificationMaster_Define, values, "SerialNo=?", new String[]{"" + (i + 2)});

        }

    }


    public void updateInvoiceButtonRecordsSyncd(String flag) {

        try {

            Log.w(TAG, "Updating Synced Records..");
            //String flag1="3";

            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected = db.update("tblInvoiceButtonTransac", values, "Sstat=?",
                    new String[]{flag});

            int affected1 = db.update("tblPendingInvoices", values, "Sstat=?",
                    new String[]{flag});



			/*db.execSQL("Update tblInvoiceButtonTransac Set Sstat=4 where Sstat=7");
			db.execSQL("Update tblPendingInvoices Set Sstat=4 where Sstat=7");*/


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public String fnGetPdaDate() {

        int LoncolumnIndex = 0;
        String strPDADate = "";
        Cursor cursor2 = db.rawQuery("SELECT PdaDate FROM tblPdaDate", null);

        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    strPDADate = cursor2.getString(LoncolumnIndex).toString();
                }
            }

            return strPDADate;
        } finally {
            cursor2.close();
        }
    }

    public String fnGetServerDate() {

        int LoncolumnIndex = 0;
        String strServerDate = "";
        Cursor cursor2 = db.rawQuery("SELECT ServerDate FROM tblAvailableVersion", null);

        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    strServerDate = cursor2.getString(LoncolumnIndex).toString();
                }
            }

            return strServerDate;
        } finally {
            cursor2.close();
        }
    }

    public long maintainPDADate() {
        db.execSQL("DELETE FROM tblPdaDate");
        Date pdaDate = new Date();
        SimpleDateFormat sdfPDaDate = new SimpleDateFormat("dd-MMM-yyyy", Locale.ENGLISH);
        String fDatePda = TimeUtils.getNetworkDateTime(mContext, TimeUtils.DATE_FORMAT);
        ContentValues initialValues = new ContentValues();
        initialValues.put("PdaDate", fDatePda);

        return db.insert("tblPdaDate", null, initialValues);
    }

    public long maintainSplashPDADate() {
        db.execSQL("DELETE FROM tblPdaDate");
        Date pdaDate = new Date();
        SimpleDateFormat sdfPDaDate = new SimpleDateFormat("dd-MMM-yyyy", Locale.ENGLISH);
        String fDatePda = TimeUtils.getNetworkDateTime(mContext, TimeUtils.DATE_FORMAT);
        ContentValues initialValues = new ContentValues();
        initialValues.put("PdaDate", fDatePda);

        return db.insert("tblPdaDate", null, initialValues);
    }

    public int fnCheckPdaDateExistOrNot() {

        int strReturnPDADateExistOrNot = 0;

        Cursor cursor2 = db.rawQuery("SELECT PdaDate FROM  tblPdaDate", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnPDADateExistOrNot = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnPDADateExistOrNot;
        } finally {
            cursor2.close();
        }
    }

    public String[] fnGetStoreListForInvoice(String DistID, String RouteID, String ForDate) {


        Cursor cursor = null;
        if (Integer.parseInt(DistID) != 0 && Integer.parseInt(RouteID) == 0 && ForDate.equals("")) {
            cursor = db.rawQuery("SELECT StoreName || '(Route:'|| RouteName || ',Date:'|| InvoiceForDate ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel from tblPendingInvoices Where DistId='" + DistID + "' and Sstat<>4  Order BY StoreName", null);
        } else if (Integer.parseInt(DistID) != 0 && Integer.parseInt(RouteID) != 0 && ForDate.equals("")) {
            cursor = db.rawQuery("SELECT StoreName || '(Date:'|| InvoiceForDate ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where DistId='" + DistID + "' and RouteId='" + RouteID + "' and Sstat<>4  Order BY StoreName", null);
        } else if (Integer.parseInt(DistID) != 0 && Integer.parseInt(RouteID) != 0 && !ForDate.equals("")) {
            cursor = db.rawQuery("SELECT StoreName  AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where DistId='" + DistID + "' and RouteId='" + RouteID + "' and InvoiceForDate='" + ForDate + "' and Sstat<>4 Order BY StoreName", null);
        } else if (Integer.parseInt(DistID) == 0 && Integer.parseInt(RouteID) != 0 && ForDate.equals("")) {
            cursor = db.rawQuery("SELECT StoreName || '(Date:'|| InvoiceForDate ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where RouteId='" + RouteID + "' and Sstat<>4 Order BY StoreName", null);
        } else if (Integer.parseInt(DistID) == 0 && Integer.parseInt(RouteID) != 0 && !ForDate.equals("")) {
            cursor = db.rawQuery("SELECT StoreName  AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where RouteId='" + RouteID + "' and InvoiceForDate='" + ForDate + "' and Sstat<>4 Order BY StoreName", null);
        } else if (Integer.parseInt(DistID) == 0 && Integer.parseInt(RouteID) == 0 && !ForDate.equals("")) {
            cursor = db.rawQuery("SELECT StoreName || '(Route:'|| RouteName ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where InvoiceForDate='" + ForDate + "' and Sstat<>4 Order BY StoreName", null);
        } else if (Integer.parseInt(DistID) != 0 && Integer.parseInt(RouteID) == 0 && !ForDate.equals("")) {
            cursor = db.rawQuery("SELECT StoreName || '(Route:'|| RouteName ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices Where DistId='" + DistID + "' and InvoiceForDate='" + ForDate + "' and Sstat<>4 Order BY StoreName", null);
        } else if (Integer.parseInt(DistID) == 0 && Integer.parseInt(RouteID) == 0 && ForDate.equals("")) {
            cursor = db.rawQuery("SELECT StoreName || '(Route:'|| RouteName || ',Date:'|| InvoiceForDate ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel from tblPendingInvoices Where Sstat<>4  Order BY StoreName", null);
            // cursor=db.rawQuery("SELECT StoreName || '(Route:'|| RouteName ||',Date:'|| InvoiceForDate ||')' AS StoreList,StoreId||'_'||OrderID||'_'||RouteId||'_'||DistId||'_'||InvoiceForDate||'_'||Sstat||'_'||flgCancel AS SRDITag,Sstat,flgCancel As flgCancel  from tblPendingInvoices WHERE   Sstat<>4 AND StoreName<>null Order BY StoreName", null);
        }

        try {
            String StoreInvoiceList[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        // // System.out.println("getDataListAdapter = "+cursor.getString(1));

                        StoreInvoiceList[i] = cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2) + "^" + cursor.getString(3);
                        cursor.moveToNext();
                    }
                }

            }

            return StoreInvoiceList;

        } finally {
            cursor.close();
        }

    }


    public String[] fnGetDistinctDistributorsID() {

        Cursor cursor = db.rawQuery("SELECT DISTINCT DistID from tblPendingInvoices Order BY DistId", null);

        try {
            String DistinctDistributorsID[] = new String[cursor.getCount() + 1];
            if (cursor.getCount() == 0) {
                DistinctDistributorsID[0] = "0";
            } else {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        if (i == 0) {
                            DistinctDistributorsID[i] = "0";
                        }

                        DistinctDistributorsID[i + 1] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }

            }
            return DistinctDistributorsID;

        } finally {
            cursor.close();
        }

    }

    public String[] fnGetDistinctDistributorsName() {
        Cursor cursor = db.rawQuery("SELECT DISTINCT DistName from tblPendingInvoices Order BY DistId", null);

        try {
            String DistinctDistributorsName[] = new String[cursor.getCount() + 1];
            if (cursor.getCount() == 0) {
                DistinctDistributorsName[0] = "Please Select Distributor";
            } else {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        if (i == 0) {
                            DistinctDistributorsName[i] = "Please Select Distributor";
                        }

                        DistinctDistributorsName[i + 1] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }


            }
            return DistinctDistributorsName;

        } finally {
            cursor.close();
        }

    }

    public long saveInvoiceButtonStoreTransac(String IMEIno, String TransDate,
                                              String StoreID, String ProdID, String ProductShortName, Double ProductRate, int OrderQty,
                                              int DelQty, int FreeQty, String OrderID, String CatID, String Sstat, int flgCancel, Double DiscountVal, String RutID
            , String additionalDiscount, String CancelRemarks, String cancelReasonId, String InvNumber, String InvDate, String LineValue) {


        ContentValues initialValues = new ContentValues();

        initialValues.put("PDACode", IMEIno.trim());
        initialValues.put("TransDate", TransDate.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProdID", ProdID.trim());
        initialValues.put("ProductShortName", ProductShortName.trim());
        initialValues.put("ProductPrice", ProductRate);
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("DelQty", DelQty);
        initialValues.put("FreeQty", FreeQty);


        initialValues.put("Sstat", Sstat.trim());

        initialValues.put("RouteID", Integer.parseInt(RutID));
        initialValues.put("OrderID", OrderID.trim());
        initialValues.put("CatID", CatID.trim());
        initialValues.put("flgCancel", flgCancel);
        initialValues.put("DiscountVal", DiscountVal);
        initialValues.put("additionalDiscount", additionalDiscount);
        initialValues.put("CancelRemarks", CancelRemarks);
        initialValues.put("CancelReasonId", cancelReasonId);
        initialValues.put("InvNumber", InvNumber);
        initialValues.put("InvDate", InvDate);
        initialValues.put("LineValue", LineValue);
        //initialValues.put("CancelRemarks", CancelRemarks);

        //initialValues.put(Key_DisplayUnit, DisplayUnit);

        ////// // System.out.println("inserting saveStoreTransac records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN114, null, initialValues);
    }

    public String[] ProcessCancelStoreReq() {

        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;

        Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblPendingInvoices WHERE (Sstat=10) and Sstat<>4", null);
        //// // System.out.println("Nitish Invoice :"+cursor2.getCount());
        try {
            String strAreaIdsDetais[] = new String[cursor2.getCount()];

            ////// // System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());
            //// // System.out.println("Nitish Invoice 2 :"+cursor2.getCount());
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strAreaIdsDetais[i] = (String) cursor2.getString(LoncolumnIndex) + "%" + (String) cursor2.getString(LoncolumnIndex2);

                    ////// // System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }

            }
            return strAreaIdsDetais;
        } finally {

            cursor2.close();
        }

    }

    public int CheckNonSubmitDataIntblPendingInvoices() {

        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;

        Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblPendingInvoices WHERE (Sstat = 7 ) or (Sstat = 9 )  ", null);
        try {
            int check = 0;

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    check = 1;
                    cursor2.moveToNext();
                }

            }
            return check;
        } finally {
            cursor2.close();
        }

    }

    public HashMap<String, String> FetchtblStoreProductClassificationType() {

        //open();
        Cursor cursor = db.rawQuery("SELECT ProductTypeNodeID,CategoryNodeID,CategoryNodeType,Category,ProductTypeNodeType,ProductType FROM tblStoreProductClassificationTypeListMstr", null);
        try {
            HashMap<String, String> SchemeIDFreePRodQtyDetails = new HashMap<String, String>();
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        SchemeIDFreePRodQtyDetails.put(cursor.getString(0).toString(), cursor.getString(1).toString() + "^" + cursor.getString(2).toString() + "^" + cursor.getString(3).toString() + "^" + cursor.getString(0).toString() + "^" + cursor.getString(4).toString() + "^" + cursor.getString(5).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return SchemeIDFreePRodQtyDetails;
        } finally {
            cursor.close();
            //close();
        }


    }

	/*private static final String DATABASE_CREATE_TABLE_222 = "create table tblStoreProductClassificationTypeListMstr(AutoIdStore integer null," +
			"CategoryNodeID integer null,CategoryNodeType integer null, Category text null,ProductTypeNodeID integer null,ProductTypeNodeType integer null,ProductType text null,IsCategorySeleted int null,IsSubCategorySeleted int null,SubCategoryValue text null);";
*/

    public String[] ProcessConformStoreReq() {

        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;    //tblPendingInvoices

        Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblPendingInvoices WHERE (Sstat=10) and Sstat<>4", null);
        try {
            String strAreaIdsDetais[] = new String[cursor2.getCount()];

            ////// // System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strAreaIdsDetais[i] = (String) cursor2.getString(LoncolumnIndex) + "%" + (String) cursor2.getString(LoncolumnIndex2);

                    ////// // System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }

            }
            return strAreaIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    public String[] fnGetDistinctRouteId(String DistId) {
        //String[] DistinctDistributorsID;
        Cursor cursor = db.rawQuery("SELECT DISTINCT RouteId from tblPendingInvoices Where DistId='" + DistId + "'  Order BY RouteId", null);

        try {
            String DistinctRouteId[] = new String[cursor.getCount() + 1];
            if (cursor.getCount() == 0) {
                DistinctRouteId[0] = "0";
            } else {
                if (cursor.getCount() > 0) {

                    if (cursor.moveToFirst()) {

                        for (int i = 0; i < cursor.getCount(); i++) {
                            if (cursor.getCount() == 0) {
                                DistinctRouteId[0] = "0";
                            }
                            DistinctRouteId[i + 1] = cursor.getString(0);
                            cursor.moveToNext();
                        }
                    }

                }
            }
            return DistinctRouteId;

        } finally {
            cursor.close();
        }

    }

    public String[] fnGetDistinctRouteName(String DistId) {
        //String[] DistinctDistributorsID;
        Cursor cursor = db.rawQuery("SELECT DISTINCT RouteName from tblPendingInvoices Where DistId='" + DistId + "'  Order BY RouteId", null);

        try {
            String DistinctRouteName[] = new String[cursor.getCount() + 1];
            if (cursor.getCount() == 0) {
                DistinctRouteName[0] = "Please Select Route";
            } else {


                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        if (i == 0) {
                            DistinctRouteName[0] = "Please Select Route";
                        }
                        DistinctRouteName[i + 1] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }


            }
            return DistinctRouteName;

        } finally {
            cursor.close();
        }

    }

    public void deleteOldInvoiceButtonStoreTransac(String sID2del) {
        // int entryCount;
        db.execSQL("DELETE FROM tblPendingInvoices WHERE StoreID ='" + sID2del + "'");


    }

    //public static void UpdateInvoiceButtonStoreFlag(String sID, int flag2set, String RouteId, String DistId, String Invdate,int flgCancel)
    public void UpdateInvoiceButtonStoreFlag(String sID, int flag2set, int flgCancel, String OrderID) {

        try {


            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            values.put("flgCancel", flgCancel);
            ////// // System.out.println("Updating Status for Store ID: " + sID);
            //int affected = db.update("tblPendingInvoices", values, "StoreID=? AND RouteId=? AND DistId=? AND InvoiceForDate=?",new String[] { sID,RouteId,DistId,Invdate });

            int affected = db.update("tblPendingInvoices", values, "StoreID=? AND OrderID=?", new String[]{sID, OrderID});

            //int affected2 = db.update("tblPendingInvoices", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });
            //int affected1 = db.update("tblPendingInvoices", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void UpdatetblInvoiceButtonTransac(String sID, int flag2set, int flgCancel, String OrderID, String strReason, String idSelectedRsn) {

        try {


            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            values.put("flgCancel", flgCancel);

            values.put("CancelRemarks", strReason);
            values.put("CancelReasonId", idSelectedRsn);

            int affected1 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?", new String[]{sID, OrderID});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void deleteInvoiceRelatedTableEtrySavedData(String sID, String OrderID) {

        try {


            db.execSQL("DELETE FROM tblInvoiceButtonTransac WHERE StoreID='" + sID + "' and OrderID='" + OrderID + "'");


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void UpdateInvoiceButtonCancelStoreSynFlag(String sID, int flag2set, int flgCancel) {

        try {

            final ContentValues values = new ContentValues();
            // // System.out.println("After Sync Successful Sstat: " + flag2set);
            // // System.out.println("After Sync Successful flgCancel: " + flgCancel);
            values.put("Sstat", flag2set);
            values.put("flgCancel", flgCancel);

            int affected = db.update("tblPendingInvoices", values, "StoreID=?", new String[]{sID});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public String FetchPNameInvoice(String ProductId)
    //public static String FetchPNameInvoice()
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT ProductName FROM tblInvoiceExecutionProductList where ProductId='" + ProductId + "'", null);
        //Cursor cursor = db.rawQuery("SELECT ProductName FROM tblInvoiceExecutionProductList", null);

        try {
            String StoreName = "0";// = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName = (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    ////// // System.out.println("product short name :"+StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public String[] FetchCategoryIDfromInvoiceProduct() {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT CatID FROM tblProductWiseInvoice", null);
        try {
            String TaxRate[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                ////// // System.out.println("CategoryID Sunil Available");
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    TaxRate[i] = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }
            ////// // System.out.println("CategoryID Sunil: not");
            return TaxRate;
        } finally {
            cursor.close();
        }
    }

    public int FetchOrderQtySum(String StoreID, String InvoiceForDate, String OrderID) {

        int sum = 0;


        Cursor cursor = db.rawQuery("SELECT sum(OrderQty) FROM tblProductWiseInvoice where StoreID='" + StoreID + "'  and OrderID='" + OrderID + "'", null);
        try {

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    sum = cursor.getInt(0);
                    // // System.out.println("Sunil data OrderQty FROM tblProductWiseInvoice: "+ StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return sum;
        } finally {
            cursor.close();
        }
    }

    public String[] FetchOrderQtyInvoice(String StoreID, String InvoiceForDate, String OrderID) {

        int ScodecolumnIndex = 0;


        Cursor cursor = db.rawQuery("SELECT OrderQty FROM tblProductWiseInvoice where StoreID='" + StoreID + "'  and OrderID='" + OrderID + "'", null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    // // System.out.println("Sunil data OrderQty FROM tblProductWiseInvoice: "+ StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public String[] FetchOrderDiscountInvoice(String StoreID, String InvoiceForDate, String OrderID) {

        int ScodecolumnIndex = 0;


        Cursor cursor = db.rawQuery("SELECT TotLineDiscVal FROM tblProductWiseInvoice where StoreID='" + StoreID + "'  and OrderID='" + OrderID + "'", null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    // // System.out.println("Sunil data OrderQty FROM tblProductWiseInvoice: "+ StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public String[] FetchOrderFreeQtyInvoice(String StoreID, String InvoiceForDate, String OrderID) {

        int ScodecolumnIndex = 0;


        Cursor cursor = db.rawQuery("SELECT Freeqty FROM tblProductWiseInvoice where StoreID='" + StoreID + "'  and OrderID='" + OrderID + "'", null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    // // System.out.println("Sunil data OrderQty FROM tblProductWiseInvoice: "+ StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public String[] FetchRateInvoice(String StoreID, String InvoiceForDate, String OrderID)
    //public static String[] FetchRateInvoice()
    {

        int ScodecolumnIndex = 0;


        Cursor cursor = db.rawQuery("SELECT ProductPrice FROM tblProductWiseInvoice where StoreID='" + StoreID + "' and OrderID='" + OrderID + "'", null);
        //Cursor cursor = db.rawQuery("SELECT ProductPrice FROM tblProductWiseInvoice",null);

        try {
            String StoreName[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    // // System.out.println("Sunil data ProductPrice FROM tblProductWiseInvoice: "+ StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public String[] FetchPidInvoice(String StoreID, String InvoiceForDate, String OrderID)
    //public static String[] FetchPidInvoice()

    {
        int ScodecolumnIndex = 0;
        ////// // System.out.println("a");
        // // System.out.println("Sameer cursor StoreID :"+ StoreID);
        // // System.out.println("Sameer cursor InvoiceForDate :"+ InvoiceForDate);

        //Cursor cursor = db.rawQuery("SELECT ProductID FROM tblProductListMaster where CategoryID='"+CATID+"'",null);
        Cursor cursor = db.rawQuery("SELECT ProductId FROM tblProductWiseInvoice where StoreID='" + StoreID + "'  and OrderID='" + OrderID + "'", null);
        //Cursor cursor = db.rawQuery("SELECT ProductId FROM tblProductWiseInvoice",null);

        ////// // System.out.println("b");
        try {
            String ProductId[] = new String[cursor.getCount()];

            // // System.out.println("Sameer cursor count in DBAdapter1"+ cursor.getCount());
            ////// // System.out.println("c");
            if (cursor.moveToFirst()) {
                ////// // System.out.println("d");
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ////// // System.out.println("e");
                    ProductId[i] = (String) cursor.getString(ScodecolumnIndex).toString();

                    // // System.out.println("Sunil data ProductID FROM tblProductWiseInvoice: "+ ProductId[i]);
                    cursor.moveToNext();
                }
            }
            ////// // System.out.println("f");
            return ProductId;
        } finally {
            cursor.close();
        }
    }

    public String FetchStoreNameBasedStoreID(String StoreID, String Data) {

        int ScodecolumnIndex = 0;
        int ScodecolumnIndex1 = 1;
        int ScodecolumnIndex2 = 2;

        Cursor cursor = db.rawQuery("SELECT StoreName,RouteName,InvoiceForDate FROM tblPendingInvoices where StoreID='" + StoreID + "' and InvoiceForDate='" + Data + "'", null);
        //Cursor cursor = db.rawQuery("SELECT ProductName FROM tblInvoiceExecutionProductList", null);

        try {
            String StoreName = "0";// = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName = (String) cursor.getString(ScodecolumnIndex)
                            .toString() + "(" + (String) cursor.getString(ScodecolumnIndex1)
                            .toString() + ")(" + (String) cursor.getString(ScodecolumnIndex2)
                            .toString() + ")";
                    ////// // System.out.println("product short name :"+StoreName[i]);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public String FetchDistNameBasedDistID(String DistId) {

        int ScodecolumnIndex = 0;
// // System.out.println("Sanjay testing DistID :"+DistId);

        //Cursor cursor = db.rawQuery("SELECT DistName FROM tblPendingInvoices where DistId='"+DistId+"'", null);
        Cursor cursor = db.rawQuery("SELECT DistName FROM tblPendingInvoices where DistId='" + DistId + "'", null);
        try {
            String StoreName = "NA";// = new String[cursor.getCount()];
            // // System.out.println("Sanjay testing cursor.getCount() :"+cursor.getCount());
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName = (String) cursor.getString(ScodecolumnIndex)
                            .toString();
                    // // System.out.println("Sanjay testing StoreName :"+StoreName);
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public void inserttblPendingInvoices(List<TblPendingInvoices> tblPendingInvoicesData, HashMap<String, String> hmapInvoiceOrderIDandStatus, String imei)//String StoreID,String StoreName,String RouteID, //String RouteName,String DistID,String DistName,String InvoiceForDate,String flgSubmit,String IMEIno,String OrderID)

    {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblPendingInvoices tblPendingInvoicesDataData : tblPendingInvoicesData) {
            int flgToInsrtOrNot = 0;
            if (hmapInvoiceOrderIDandStatus.containsKey(tblPendingInvoicesDataData.getOrderID())) {
                if (hmapInvoiceOrderIDandStatus.get(tblPendingInvoicesDataData.getOrderID()).equals("4") || hmapInvoiceOrderIDandStatus.get(tblPendingInvoicesDataData.getOrderID()).equals("7") || hmapInvoiceOrderIDandStatus.get(tblPendingInvoicesDataData.getOrderID()).equals("9")) {

                } else {
                    flgToInsrtOrNot = 1;
                    fnDeletetblInvoiceSubmittedRecords(tblPendingInvoicesDataData.getOrderID());
                }
            } else {
                flgToInsrtOrNot = 1;
            }
            if (flgToInsrtOrNot == 1) {
                initialValues.put("StoreID", tblPendingInvoicesDataData.getStoreId());
                initialValues.put("StoreName", tblPendingInvoicesDataData.getStoreName());
                initialValues.put("RouteID", tblPendingInvoicesDataData.getRouteID());
                initialValues.put("RouteNodeType", tblPendingInvoicesDataData.getRouteNodeType());
                initialValues.put("RouteName", tblPendingInvoicesDataData.getRouteName());
                initialValues.put("DistID", tblPendingInvoicesDataData.getDistID());
                initialValues.put("DistName", tblPendingInvoicesDataData.getDistName());
                initialValues.put("InvoiceForDate", tblPendingInvoicesDataData.getInvoiceForDate());
                initialValues.put("flgSubmit", tblPendingInvoicesDataData.getFlgSubmit());
                initialValues.put("Sstat", 0);
                initialValues.put("PDACode", imei);
                initialValues.put("OrderID", "NA");
                initialValues.put("flgCancel", 0);
                initialValues.put("OrderID", tblPendingInvoicesDataData.getOrderID());
                initialValues.put("ServerOrdersFlg", 0);

                db.insert(DBHelper.DATABASE_TABLE_MAIN111, null, initialValues);
            }

        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    public int getOverAllSampleQty(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;
        int OverAllSampleQty = 0;
        // int Stock,int OrderQty, Double OrderVal, int FreeQty, Double DisVal

        Cursor cursor = db.rawQuery("SELECT Sum(SampleQuantity)  FROM tblTransac WHERE StoreID ='"
                + sID2Fetch + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        OverAllSampleQty = Integer.parseInt(cursor.getString(SnamecolumnIndex1).toString());

                        cursor.moveToNext();
                        // cursor.close();

                    }

                }
            }
            return OverAllSampleQty;
        } finally {
            cursor.close();
        }

    }

    public int counttblCountRoute() {
        Cursor cursorE2 = null;
        int chkI = 0;
        try {
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblRouteListMaster", null);
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }


        } catch (Exception ex) {

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }

    public long savetblAvailbUpdatedVersion(String VersionID, String VersionSerialNo, String VersionDownloadStatus, String ServerDate) {

        db.execSQL("DELETE FROM " + DBHelper.TABLE_tblAvailableVersionMstr_Define);
//        db.delete(DBHelper.TABLE_tblAvailableVersionMstr_Define, null, null);
        ContentValues initialValues = new ContentValues();

        initialValues.put("VersionID", VersionID.trim());
        initialValues.put("VersionSerialNo", VersionSerialNo.trim());
        initialValues.put("VersionDownloadStatus", VersionDownloadStatus.trim());
        initialValues.put("ServerDate", ServerDate.trim());
        return db.insert(DBHelper.TABLE_tblAvailableVersionMstr_Define, null, initialValues);
    }

    public String FetchInvoiceButtonSstat1(String StoreID, String OrderID)
    //public static String[] FetchInvoiceButtonStoreStatus()
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Sstat FROM tblPendingInvoices WHERE StoreID ='" + StoreID.trim() + "' and  OrderID ='" + OrderID.trim() + "'", null);
        //Cursor cursor = db.rawQuery("SELECT Sstat FROM tblPendingInvoices", null);
        // // System.out.println("Arjun cursor.getCount() :"+cursor.getCount());
        try {
            String StoreName = "0";// new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }
	/*public static String getVersionNumber() {
		Cursor cursor = SQLiteDatabase.openOrCreateDatabase(":memory:", null).rawQuery("select sqlite_version() AS sqlite_version", null);
		String sqliteVersion = "";
		while(cursor.moveToNext()){
		   sqliteVersion += cursor.getString(0);
		}
		return sqliteVersion;

	}*/

    //token,startTS,rID,getVersionNumber,DayEndFlg,ChangeRouteFlg

    public String FetchInvoiceButtonSstat(String StoreID, String OrderID)
    //public static String[] FetchInvoiceButtonStoreStatus()
    {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Sstat FROM tblInvoiceButtonTransac WHERE StoreID ='" + StoreID.trim() + "' and  OrderID ='" + OrderID.trim() + "'", null);
        //Cursor cursor = db.rawQuery("SELECT Sstat FROM tblPendingInvoices", null);
        // // System.out.println("Arjun cursor.getCount() :"+cursor.getCount());
        try {
            String StoreName = "0";// new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public String[] fngetDistictOrderIdsForSubmission()
    //public static String[] FetchInvoiceButtonStoreStatus()
    {

        int ScodecolumnIndex = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT DISTINCT OrderID FROM tblInvoiceButtonTransac  order by OrderID Desc", null);
        //Cursor cursor = db.rawQuery("SELECT Sstat FROM tblPendingInvoices", null);
        // // System.out.println("Arjun cursor.getCount() :"+cursor.getCount());
        try {
            String[] StoreName = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
            //close();
        }
    }

    public void UpdateTblDayStartEndDetails(int rID, int btnClickFlg) {//btnClickFlg=1(clicked on Day End) , btnClickFlg=1(clicked on ChangeRoute)

        final ContentValues values = new ContentValues();
        long syncTIMESTAMP = System.currentTimeMillis();
        Date dateobj = new Date(syncTIMESTAMP);
        SimpleDateFormat df = new SimpleDateFormat(
                "dd-MMM-yyyy HH:mm:ss", Locale.ENGLISH);
        String EndTS = TimeUtils.getNetworkDateTime(mContext, TimeUtils.DATE_TIME_FORMAT);
        values.put("EndTime", EndTS);
        if (btnClickFlg == 1) {
            values.put("DayEndFlag", 1);
            values.put("ChangeRouteFlg", 0);
        }
        if (btnClickFlg == 2) {
            values.put("DayEndFlag", 0);
            values.put("ChangeRouteFlg", 1);
        }
        int cycleId = fetchtblVanCycleId();
        if (cycleId != -1) {
            values.put("CycleId", String.valueOf(cycleId));
            int affected = db.update("tblDayStartEndDetails", values, "RouteID=?",
                    new String[]{"" + rID});
        } else {
            values.put("CycleId", "0");
            int affected = db.update("tblDayStartEndDetails", values, "RouteID=?",
                    new String[]{"" + rID});
        }


        //Log.w(TAG, "affected records: " + affected);

        Log.w(TAG, "UpdatetblDayStartEndDetails Updated..");
    }

    public long insertTblDayStartEndDetails(String imei, String startTS, String rID, int DayEndFlg, int ChangeRouteFlg, String ForDate, String strAppVersionID, int dayEndButtonOrCycleEnd,String LatiCode, String LongiCode,String Address,String PinCode,String City,String State)//,int AppVersionID//, String getVersionNumber
    {
        db.execSQL("DELETE FROM tblDayStartEndDetails");
        ContentValues initialValues = new ContentValues();


        initialValues.put("PDACode", imei);
        initialValues.put("SyncTime", startTS.trim());
        initialValues.put("RouteID", rID);
        //initialValues.put("VersionNo", getVersionNumber.trim());
        initialValues.put("DayEndFlag", DayEndFlg);
        initialValues.put("ChangeRouteFlg", ChangeRouteFlg);
        initialValues.put("ForDate", ForDate);
        //initialValues.put("AppVersionID", AppVersionID);
        initialValues.put("AppVersionID", strAppVersionID.trim());
        initialValues.put("dayEndButtonOrCycleEnd", dayEndButtonOrCycleEnd);
        initialValues.put("Sstat", 3);
        initialValues.put("LatCode", Double.parseDouble(LatiCode));
        initialValues.put("LongCode",  Double.parseDouble(LongiCode));
        initialValues.put("Address",  Address);
        initialValues.put("PinCode",  PinCode);
        initialValues.put("City",  City);
        initialValues.put("State", State);


        //initialValues.put("StoreID", StoreID);

        //initialValues.put("Sstat", 0);

        ////// // System.out.println("inserting records in Details  TblDayStartEndDetails..");
        ////// // System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN12, null, initialValues);
    }

    public int FetchVersionDownloadStatus() {
        int SnamecolumnIndex1 = 0;
        int CatId = 0;

        Cursor cursor = db.rawQuery("SELECT VersionDownloadStatus from tblAvailableVersion", null);
        try {
            //String OldDateInfo[] = new String[cursor.getCount() ];
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    //CatId = cursor.getString(SnamecolumnIndex1).toString();
                    String abc = (String) cursor.getString(SnamecolumnIndex1).toString();
                    CatId = Integer.parseInt(abc);
                    cursor.moveToNext();
                }

            }
            return CatId;
        } finally {
            cursor.close();
        }

    }

    public long inserttblFirstOrderDetailsOnLastVisitDetailsActivity(String StoreID, String Date, String SKUID, int OrderQty, String FreeQty,
                                                                     int Stock, String SKUName) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("Date", Date.trim());
        initialValues.put("SKUID", SKUID);
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("FreeQty", FreeQty.trim());
        initialValues.put("Stock", Stock);
        initialValues.put("SKUName", SKUName);

        //// // System.out.println("Aaaj insert  value table 101");
        //// // System.out.println("Ashish and Anuj insert  value table 101 : "+SKUName);

        return db.insert(DBHelper.DATABASE_TABLE_MAIN101, null, initialValues);
    }

    public long inserttblSecondVisitDetailsOnLastVisitDetailsActivity(String StoreID, String Date, String SKUID, int OrderQty, String SKUName) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("Date", Date.trim());
        initialValues.put("SKUID", SKUID);
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("SKUName", SKUName.trim());


        //// // System.out.println("Aaaj insert  value table 102");
        return db.insert(DBHelper.DATABASE_TABLE_MAIN102, null, initialValues);
    }


    public String fnGettblFirstOrderDetailsOnLastVisitDetailsActivity(String StoreID) {
        int ScodecolumnIndex = 0;

        Cursor cursorE2 = db.rawQuery("SELECT Date FROM tblFirstOrderDetailsOnLastVisitDetailsActivity WHERE StoreID ='" + StoreID + "' Limit 1", null);
        String LastTransDate = "";

        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                    LastTransDate = (String) cursorE2.getString(
                            ScodecolumnIndex).toString();
                    cursorE2.moveToNext();
                }
            }
            return LastTransDate;
        } finally {
            cursorE2.close();
        }

    }

    public String[] fetchAllDataFromtblFirstOrderDetailsOnLastVisitDetailsActivity(String strStoreID) {
		/*StoreID text null, " +
		"Date string null,SKUID text  null,OrderQty integer null,FreeQty integer null,Stock integer null,SKUName text null);";
		*/
        Cursor cursor = db
                .rawQuery(
                        "SELECT SKUName, Stock, OrderQty, FreeQty FROM tblFirstOrderDetailsOnLastVisitDetailsActivity WHERE StoreID ='" + strStoreID + "'", null);

        try {

            //// // System.out.println("Aajtak value CompleteResult coung:"+cursor.getCount());
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "_"
                                + (String) cursor.getString(1).toString()
                                + "_"
                                + (String) cursor.getString(2).toString()
                                + "_"
                                + (String) cursor.getString(3).toString();

                        ////// // System.out.println("Aajtak value CompleteResult :"+CompleteResult[i]);
                        //// // System.out.println("Ashish and Anuj CompleteResult[i] : "+CompleteResult[i]);


                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public int counttblSecondVisitDetailsOnLastVisitDetailsActivity(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblSecondVisitDetailsOnLastVisitDetailsActivity WHERE StoreID ='"
                + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String fnGettblSecondVisitDetailsOnLastVisitDetailsActivity(String StoreID) {

        Cursor cursorE2 = db.rawQuery("SELECT Date FROM tblSecondVisitDetailsOnLastVisitDetailsActivity WHERE StoreID ='"
                + StoreID + "'", null);
        String LastTransDate = "";
        int ScodecolumnIndex = 0;
        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                    LastTransDate = (String) cursorE2.getString(
                            ScodecolumnIndex).toString();
                    cursorE2.moveToNext();
                }
            }
            return LastTransDate;
        } finally {
            cursorE2.close();
        }

    }

    public String[] fetchtblSecondVisitDetailsOnLastVisitDetailsActivity(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;
        int SnamecolumnIndex2 = 1;

        Cursor cursor = db
                .rawQuery(
                        "SELECT SKUName, OrderQty  FROM tblSecondVisitDetailsOnLastVisitDetailsActivity WHERE StoreID ='"
                                + sID2Fetch + "'", null);
        try {

            String ProductTarget[] = new String[cursor.getCount()];
            ;

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    ProductTarget[i] = (String) cursor.getString(
                            SnamecolumnIndex1).toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex2)
                            .toString();

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return ProductTarget;
        } finally {
            cursor.close();
        }

    }


    public void truncateAllSummaryDataTable() {
        db.execSQL("DELETE FROM tblAllSummary");

    }

    public void reTruncateRouteTbl() {
        db.execSQL("DELETE FROM tblRouteListMaster");
        //db.execSQL("DELETE FROM tblAvailableVersion");
    }

    public void reCreateDB() {
        sPref = mContext.getSharedPreferences(CommonInfo.Preference, MODE_PRIVATE);
        Editor editor = sPref.edit();
        editor.clear();
        editor.commit();

        sharedPrefReport = mContext.getSharedPreferences("Report", MODE_PRIVATE);
        Editor editorReport = sharedPrefReport.edit();
        editorReport.clear();
        editorReport.commit();

        SplashScreen.sPrefVanStockChanged = mContext.getSharedPreferences(CommonInfo.sPrefVanLoadedUnloaded, 0);
        Editor editorVanStockChanged = SplashScreen.sPrefVanStockChanged.edit();
        editorVanStockChanged.clear();
        editorVanStockChanged.commit();

        SharedPreferences sPrefAttandance;
        sPrefAttandance = mContext.getSharedPreferences(CommonInfo.AttandancePreference, MODE_PRIVATE);

        SharedPreferences.Editor editorAttendance = sPrefAttandance.edit();
        editorAttendance.clear();
        editorAttendance.commit();


        if (AllButtonActivity.isPerformDayEndFirst == 1) {
            mPreferencesManager.clear();
            // AllButtonActivity.isPerformDayEndFirst=0;

            db.execSQL("DELETE FROM tblAttandanceDetails");
        }
        mPreferencesManager.setValue(AppUtils.flgPersonDayStartDayEnd, 1);


        Log.w(TAG, "Table re-creation completed..");
    }


    public void fnDeleteOldDataOnDayStart() {
        db.execSQL("Delete from tblLastRefreshTimeReport");
        db.execSQL("Delete FROM tblDistributorSavedData");
        db.execSQL("Delete FROM tblSuplierDetail");
        db.execSQL("Delete FROM tblSuplierMapping");

        db.execSQL("Delete FROM tblBeatPlan");
        db.execSQL("Delete FROM tblBeatWiseSpokeStoreVisitSchedule");
        db.execSQL("DELETE FROM tblStoreDSROverAllDiscountApplied");
        db.execSQL("DELETE FROM tblAppliedOrderDiscount");
        db.execSQL("DELETE FROM tblTmpInvoiceDetailsTCOrder");
        db.execSQL("DELETE FROM tblTmpInvoiceDetailsLocalOrder");
        db.execSQL("DELETE FROM tblTmpInvoiceHeaderTCOrder");

        db.execSQL("Delete from tblStoreCartonMaster");
        db.execSQL("DELETE FROM tblStoreCartonDetails");
        db.execSQL("DELETE FROM tblStoreSummaryDetails");
        db.execSQL("DELETE FROM tblStoreListForUpdateMstr");
        db.execSQL("Delete from tblReplenishmentSKU");
        db.execSQL("Delete from tblFocusbrandSKU");
        db.execSQL("DELETE FROM tblStoreSuggestedQtyMstr");
        db.execSQL("DELETE FROM tblNoOrderReasonMaster");


        db.execSQL("DELETE FROM tblStoreImageDetail");
        db.execSQL("DELETE FROM tblRouteChangeListMstr");
        db.execSQL("DELETE FROM tblRouteChangeListDeatils");
        db.execSQL("DELETE FROM tblStoreEdit");
        db.execSQL("DELETE FROM tblStoreEditImages");
        db.execSQL("DELETE FROM  tblProductADDONScheme");
        db.execSQL("DELETE FROM  tblReasonOrderCncl");
        db.execSQL("DELETE FROM tblExecutionImages");
        db.execSQL("DELETE FROM tblSuplierDetail");

        db.execSQL("DELETE FROM tblAllServicesCalledSuccessfull");
        db.execSQL("DELETE FROM tblStoreOrderVisitDayActivity");
        db.execSQL("DELETE FROM  tblCollectionReportCashChange");
        db.execSQL("DELETE FROM  tblCollectionReportChequeChange");

        db.execSQL("DELETE FROM  tblStoreCheckInPic");

        db.execSQL("DELETE FROM  tblActualVisitStock");
        // db.execSQL("DELETE FROM tblAttandanceDetails");
        db.execSQL("DELETE FROM tblInvoiceDetails");
        db.execSQL("DELETE FROM tblTmpInvoiceHeader");
        db.execSQL("DELETE FROM tblStoreVisitMstr");
        db.execSQL("DELETE FROM tblInvoiceHeader");
        db.execSQL("DELETE FROM tblStockUploadedStatus");
        db.execSQL("DELETE FROM tblCycleID");
        db.execSQL("DELETE FROM tblStockConfirm");

        db.execSQL("DELETE FROM tblVanProductStock");
        db.execSQL("DELETE FROM tblVanProductAdjStock");
        db.execSQL("DELETE FROM tblTmpDistributorStock");

        db.execSQL("DELETE FROM tblAllCollectionData");

        db.execSQL("DELETE FROM tblDayCheckIn");
        db.execSQL("DELETE FROM tblPriceApplyType");
        db.execSQL("DELETE FROM tblInvoiceCaption");
        db.execSQL("DELETE FROM tblLastOutstanding");
        db.execSQL("DELETE FROM tblInvoiceLastVisitDetails");
        db.execSQL("DELETE FROM tblStockConfirm");
        db.execSQL("DELETE FROM tblStoreList");
        db.execSQL("DELETE FROM tblNewAddedStoreLocationDetails");
        // db.execSQL("DELETE FROM tblProductListMaster");
        db.execSQL("DELETE FROM tblProductSegementMap");
        db.execSQL("DELETE FROM tblCategoryMaster");

        db.execSQL("DELETE FROM tblVisibilityMstr");
        db.execSQL("DELETE FROM tblVisibilityDetails");


        db.execSQL("DELETE FROM tblNewStoreListEntries");
        db.execSQL("DELETE FROM tblPDALastInvoiceDet");
        db.execSQL("DELETE FROM tblPDATargetQtyForSecondPage");
        db.execSQL("DELETE FROM tblPDAProductReturnMstr");
        db.execSQL("DELETE FROM tblPDAProductReturnDetails");

        db.execSQL("DELETE FROM tblTransac");
        db.execSQL("DELETE FROM tblTmpInvoiceHeader");
        db.execSQL("DELETE FROM tblStoreProductMap");
        db.execSQL("DELETE FROM tblSchemeList");
        db.execSQL("DELETE FROM tblSchemeDetails");
        db.execSQL("DELETE FROM tblschemeStoreTypeMap");
        db.execSQL("DELETE FROM tblschemeProductMap");
        db.execSQL("DELETE FROM tblspForPDASchemeApplicableList");
        db.execSQL("DELETE FROM tblPDAIsSchemeApplicable");
        db.execSQL("DELETE FROM tblLastTransactionDetails");
        db.execSQL("DELETE FROM tblPDALastTranDateForSecondPage");
        db.execSQL("DELETE FROM tblStorTypeMstr");
        db.execSQL("DELETE FROM tblSyncSummuryDetails");

        db.execSQL("DELETE FROM tblSyncSummuryForProductDetails");
        db.execSQL("DELETE FROM tblStrachApplicableOnScheme");
        db.execSQL("DELETE FROM tblStrachOnSchemeDetails");
        db.execSQL("DELETE FROM tblOutLetInfoOnQuadVolumeCategoryBasis");
        db.execSQL("DELETE FROM tblSelectedStoreIDinChangeRouteCase");
        db.execSQL("DELETE FROM tblSysVisitID");
        db.execSQL("DELETE FROM tblDaySummaryNew");

        db.execSQL("DELETE FROM tblFirstOrderDetailsOnLastVisitDetailsActivity");
        db.execSQL("DELETE FROM tblSecondVisitDetailsOnLastVisitDetailsActivity");
        db.execSQL("DELETE FROM tblPDAGetLODQty");


        //db.execSQL("DELETE FROM tblPendingInvoices");
        db.execSQL("DELETE FROM tblInvoiceExecutionProductList");
        //db.execSQL("DELETE FROM tblProductWiseInvoice");
        //db.execSQL("DELETE FROM tblInvoiceButtonTransac");

        db.execSQL("DELETE FROM  tblPDAGetLastVisitDate");
        db.execSQL("DELETE FROM  tblPDAGetLastOrderDate");
        db.execSQL("DELETE FROM  tblPDAGetLastVisitDetails");
        db.execSQL("DELETE FROM  tblPDAGetLastOrderDetails");
        db.execSQL("DELETE FROM  tblPDAGetLastOrderDetailsTotalValues");
        db.execSQL("DELETE FROM  tblPDAGetExecutionSummary");
        db.execSQL("DELETE FROM  tblStoreSchemeFreeProQtyOtherDetails");


        db.execSQL("DELETE FROM  tblSchemeStoreMapping");
        db.execSQL("DELETE FROM  tblSchemeMstr");
        db.execSQL("DELETE FROM  tblSchemeSlabDetail");
        db.execSQL("DELETE FROM  tblSchemeSlabBucketDetails");
        db.execSQL("DELETE FROM  tblSchemeSlabBucketProductMapping");
        db.execSQL("DELETE FROM  tblSchemeSlabBenefitsBucketDetails");
        db.execSQL("DELETE FROM  tblSchemeSlabBenefitsProductMappingDetail");
        db.execSQL("DELETE FROM  tblSchemeSlabBenefitsValueDetail");
        db.execSQL("DELETE FROM  tblProductRelatedScheme");
        db.execSQL("DELETE FROM  tblTmpInvoiceDetails");
        db.execSQL("DELETE FROM  tblStoreProductAppliedSchemesBenifitsRecords");

        db.execSQL("DELETE FROM  tblStoreProductPhotoDetail");
        db.execSQL("DELETE FROM  tblStoreReturnDetail");


        db.execSQL("DELETE FROM  tblAlrtVal");
        db.execSQL("DELETE FROM  tblProductMappedWithSchemeSlabApplied");

        db.execSQL("DELETE FROM tblPOSMaterialMstr");
        db.execSQL("DELETE FROM tblStoreIDAndMaterialIDMap");
        db.execSQL("DELETE FROM  tblStoreMaterialDetail");
        db.execSQL("DELETE FROM  tblStoreMaterialPhotoDetail");
    }

    public void refreshDataFromDB() {
        //db.execSQL("DELETE FROM tblProductListMaster");
        //db.execSQL("DELETE FROM tblPDAProductReturnMstr");
        //db.execSQL("DELETE FROM tblStoreProductMap");
        //db.execSQL("DELETE FROM tblSchemeList");
        //db.execSQL("DELETE FROM tblSchemeDetails");

        //db.execSQL("DELETE FROM tblschemeProductMap");
        //db.execSQL("DELETE FROM tblspForPDASchemeApplicableList");
        //db.execSQL("DELETE FROM tblLastTransactionDetails");
        //db.execSQL("DELETE FROM tblPDALastTranDateForSecondPage");
        //db.execSQL("DELETE FROM tblSyncSummuryForProductDetails");

    }

    // ---opens the database---
	/*public static AppDataSource open() throws SQLException {
		db = DBHelper.getWritableDatabase();
		return this;
	}
*/
    // ---closes the database---
	/*public static void close() {
		DBHelper.close();
	}*/

    public void Delete_tblProductList_for_refreshData() {
        db.execSQL("DELETE FROM tblProductListMaster");
        db.execSQL("DELETE FROM tblProductSegementMap");
        db.execSQL("DELETE FROM tblPriceApplyType");
        db.execSQL("Delete From tblUOMMaster");
        db.execSQL("Delete From tblUOMMapping");
    }

    public void Delete_tblLastOutstanding_for_refreshData() {
        db.execSQL("DELETE FROM tblLastOutstanding");
        db.execSQL("DELETE FROM tblInvoiceLastVisitDetails");

    }

    //
    public void Delete_tblCategory_for_refreshData() {
        db.execSQL("DELETE FROM tblCategoryMaster");
    }

    public void Delete_tblStore_for_refreshData() {
        db.execSQL("DELETE FROM tblStoreList");
    }

    public void Delete_tblStore_for_refreshDataButNotNewStore() {
        db.execSQL("DELETE FROM tblStoreList");// where ISNewStore<>1
        db.execSQL("DELETE FROM tblNewAddedStoreLocationDetails where Sstat=4");
    }

    public void Delete_tblMaterialAndStoreIDMap() {
        db.execSQL("DELETE FROM tblPOSMaterialMstr");

        db.execSQL("DELETE FROM tblStoreIDAndMaterialIDMap");
    }

    public void Delete_tblStoreProductMap_for_refreshData() {
        db.execSQL("DELETE FROM tblSchemeStoreMapping where IsNewStore=0");

        db.execSQL("DELETE FROM tblSchemeMstr");

        db.execSQL("DELETE FROM tblSchemeSlabDetail");

        db.execSQL("DELETE FROM tblSchemeSlabBucketDetails");

        db.execSQL("DELETE FROM tblSchemeSlabBucketProductMapping");

        db.execSQL("DELETE FROM tblSchemeSlabBenefitsBucketDetails");

        db.execSQL("DELETE FROM tblSchemeSlabBenefitsProductMappingDetail");

        db.execSQL("DELETE FROM tblSchemeSlabBenefitsValueDetail");

        db.execSQL("DELETE FROM tblProductRelatedScheme");

        db.execSQL("DELETE FROM tblProductADDONScheme");
    }

    public void Delete_tblSchemeList_for_refreshData() {
        db.execSQL("DELETE FROM tblSchemeList");
    }

    public void Delete_tblSchemeDetails_for_refreshData() {
        db.execSQL("DELETE FROM tblLastTransactionDetails");
    }

    public void Delete_tblschemeProductMap_for_refreshData() {
        db.execSQL("DELETE FROM tblschemeProductMap");
    }

    public void Delete_tblspForPDASchemeApplicableList_for_refreshData() {
        db.execSQL("DELETE FROM tblspForPDASchemeApplicableList");
    }

    public void Delete_tblLastTransactionDetails_for_refreshData() {
        db.execSQL("DELETE FROM tblLastTransactionDetails");
    }

    public void Delete_tblPDALastTranDateForSecondPage_for_refreshData() {

        db.execSQL("DELETE FROM tblPDALastTranDateForSecondPage");
    }

    public void Delete_tblSyncSummuryForProductDetails_for_refreshData() {
        db.execSQL("DELETE FROM tblSyncSummuryForProductDetails");
    }

    public boolean doesDatabaseExist(ContextWrapper context, String dbName) {
        File dbFile = context.getDatabasePath(dbName);

        return dbFile.exists();
    }

    public void dropAvailbUpdatedVersionTBL() {
        db.execSQL("DROP TABLE IF EXISTS tblAvailableVersion");

    }

    public void createAvailbUpdatedVersionTBL() {
        try {
            db.execSQL(DBHelper.TABLE_tblAvailableVersionMstr_Definition);
        } catch (Exception e) {

        }

    }

    public long insertTblDaySummaryNew(int TargetCalls, int ActualCallOnRoute, int ActualCallOffRoute, int ProdCallOnRoute, int ProdCallOffRoute, Double TargetSalesForDay, Double TotalSalesForDay, int CallsRemaining, Double TargetSalesMTD, Double AchievedSalesMTD, int ProdStoresMTD, Double RunRate) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("TargetCalls", TargetCalls);
        initialValues.put("ActualCallOnRoute", ActualCallOnRoute);
        initialValues.put("ActualCallOffRoute", ActualCallOffRoute);
        initialValues.put("ProdCallOnRoute", ProdCallOnRoute);
        initialValues.put("ProdCallOffRoute", ProdCallOffRoute);
        initialValues.put("TargetSalesForDay", TargetSalesForDay);
        initialValues.put("TotalSalesForDay", TotalSalesForDay);
        initialValues.put("CallsRemaining", CallsRemaining);
        initialValues.put("TargetSalesMTD", TargetSalesMTD);
        initialValues.put("AchievedSalesMTD", AchievedSalesMTD);
        initialValues.put("ProdStoresMTD", ProdStoresMTD);
        initialValues.put("RunRate", RunRate);
        return db.insert(DBHelper.DATABASE_TABLE_SummaryDayTableSummaryNew, null, initialValues);
    }

    public int getTargetCall() {
        int LoncolumnIndex = 0;
        int TargetCall = 0;


        Cursor cursor2 = db.rawQuery("SELECT TargetCalls FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            if (Integer.parseInt(cursor2.getString(LoncolumnIndex).toString()) > 0) {
                                TargetCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                                ////// // System.out.println("Summary Target Call :"+TargetCall);
                            }

                            //TotSalesValueStoreBasis =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }


                    }

                }
            }

            return TargetCall;
        } finally {
            cursor2.close();
        }
    }

    public int fnChkFlgTodayRoute(String CurrentRouteID) {
        int LoncolumnIndex = 0;
        int FchkFlgOnRoute = 0;
        Cursor cursor2 = db.rawQuery("SELECT ifnull(Active,0) FROM tblRouteListMaster where ID='" + CurrentRouteID + "'", null);
        try {
            if (cursor2 != null && cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    if (!cursor2.isNull(LoncolumnIndex)) {
                        FchkFlgOnRoute = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                        cursor2.moveToNext();
                    }
                }
            }


        } catch (Exception ex) {

        } finally {
            if (cursor2 != null)
                cursor2.close();
        }
        return FchkFlgOnRoute;
    }

    public int fnGetActualCallOnRouteFromSummaryTable()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ActualCall = 0;
        Cursor cursor2 = db.rawQuery("SELECT ActualCallOnRoute FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            ActualCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ActualCall;
        } finally {
            cursor2.close();
        }
    }

    public int fnGetActualCallOffRouteFromSummaryTable()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ActualCall = 0;
        Cursor cursor2 = db.rawQuery("SELECT ActualCallOffRoute FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            ActualCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ActualCall;
        } finally {
            cursor2.close();
        }
    }

    public int fnGetProductiveCallOnRoute()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ProductiveCall = 0;
        Cursor cursor2 = db.rawQuery("SELECT ProdCallOnRoute FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            ProductiveCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ProductiveCall;
        } finally {
            cursor2.close();
        }
    }

    public int fnGetProductiveCallOffRoute()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ProductiveCall = 0;
        Cursor cursor2 = db.rawQuery("SELECT ProdCallOffRoute FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            ProductiveCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ProductiveCall;
        } finally {
            cursor2.close();
        }
    }

    public int fnGetActualCallOnOffRoute()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ActualCall = 0;
        Cursor cursor2 = db.rawQuery("SELECT Count(StoreID) FROM tblTmpInvoiceHeader", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            ActualCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ActualCall;
        } finally {
            cursor2.close();
        }
    }

    public int fnGetProductiveCallOnOffRoute()//If fnChkFlgTodayRoute=1 it will get added to Productive Call On Route Else get Added in Off Route
    {

        int LoncolumnIndex = 0;
        int ActualProductiveCall = 0;
        Double TotInvoiceValCall = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT Count(StoreID) FROM tblTmpInvoiceHeader where InvoiceVal>" + TotInvoiceValCall, null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            ActualProductiveCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ActualProductiveCall;
        } finally {
            cursor2.close();
        }
    }

    public double fnGetTargetSalesforDayRoute() {
        int LoncolumnIndex = 0;
        Double TargetSalesForDay = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT TargetSalesForDay FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            TargetSalesForDay = Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return TargetSalesForDay;
        } finally {
            cursor2.close();
        }
    }

    public double fnGetTotalSalesforDay() {

        int LoncolumnIndex = 0;
        Double TotalSalesForDay = fnGetTotalSalesforDayRouteFromtblSummaryNew();// 0.00;
        String TotalSalesInvoice = fnGetTotalSales();
        ////// // System.out.println("Abhinav Raj Summary New TotSalesValue from function now: "+TotalSalesInvoice);
        Double OverAllSalesForDay = 0.00;
        Double ckk11 = Double.parseDouble(TotalSalesInvoice.replace(",", ""));
        //// // System.out.println("Abhinav Raj Summary New ckk11 from function now: "+ckk11);
        //// // System.out.println("Abhinav Raj Summary New OverAllSalesForDay from function now: "+TotalSalesForDay);

        OverAllSalesForDay = TotalSalesForDay + ckk11;


        //// // System.out.println("Abhinav Raj Summary New OverAllSalesForDay from function now: "+OverAllSalesForDay);
        //OverAllSalesForDay=Double.parseDouble(new DecimalFormat("##.##").format(OverAllSalesForDay));
        //OverAllSalesForDay=Double.parseDouble(decimalFormat.format(OverAllSalesForDay));
        ////// // System.out.println("Abhinav Raj Summary New OverAllSalesForDay from function 2 now: "+OverAllSalesForDay);
        return OverAllSalesForDay;

    }

    public double fnGetTotalSalesforDayRouteFromtblSummaryNew() {
        int LoncolumnIndex = 0;
        Double TotalSalesForDay = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT TotalSalesForDay FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            TotalSalesForDay = Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                            ////// System.out.println("Abhinav Raj Summary New TotalSalesForDay from function: "+TotalSalesForDay);
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return TotalSalesForDay;
        } finally {
            cursor2.close();
        }
    }

    public double fnGetTargetSalesMTDforDayRouteFromtblSummaryNew() {
        int LoncolumnIndex = 0;
        Double TotalSalesForDay = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT TargetSalesMTD FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            TotalSalesForDay = Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return TotalSalesForDay;
        } finally {
            cursor2.close();
        }
    }

    public double fnGetAchivedSalesMTDforDayRouteFromtblSummaryNew() {
        int LoncolumnIndex = 0;
        Double TotalSalesForDay = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT AchievedSalesMTD FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            TotalSalesForDay = Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
							/*////// System.out.println("Abhinav Raj Summary New TotalSalesForDay from function what 1 now: "+TotalSalesForDay);
							TotalSalesForDay=Double.parseDouble(decimalFormat.format(TotalSalesForDay));
							////// System.out.println("Abhinav Raj Summary New TotalSalesForDay from function what 2 now: "+TotalSalesForDay);*/
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return TotalSalesForDay;
        } finally {
            cursor2.close();
        }
    }

    public double fnGetOverAllAchivedSalesMTD() {

        int LoncolumnIndex = 0;
        Double TotalSalesForDay = fnGetAchivedSalesMTDforDayRouteFromtblSummaryNew();// 0.00;
        String TotalSalesInvoice = fnGetTotalSales();
        Double OverAchivedSalesForDay = 0.00;
        Double chk11 = Double.parseDouble(TotalSalesInvoice);
        OverAchivedSalesForDay = TotalSalesForDay + chk11;
        //Sval= Double.parseDouble(new DecimalFormat("##.##").format(Sval));
        //OverAchivedSalesForDay=Double.parseDouble(decimalFormat.format(OverAchivedSalesForDay));
        //OverAchivedSalesForDay=Double.parseDouble(new DecimalFormat("###.##").format(OverAchivedSalesForDay));
        ////// System.out.println("Abhinav Raj Summary New What 3 OverAchivedSalesForDay:"+OverAchivedSalesForDay);
        return OverAchivedSalesForDay;

    }

    public int fnGetProdStoresMTD() {

        int LoncolumnIndex = 0;
        int ProdStoresMTD = 0;
        Cursor cursor2 = db.rawQuery("SELECT ProdStoresMTD FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            ProdStoresMTD = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ProdStoresMTD;
        } finally {
            cursor2.close();
        }
    }

    public double fnGetRunRate() {

        int LoncolumnIndex = 0;
        Double RunRate = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT RunRate FROM tblDaySummaryNew", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(LoncolumnIndex)) {
                            RunRate = Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return RunRate;
        } finally {
            cursor2.close();
        }
    }

    public HashMap<String, String> fetchHmapInvoiceOrderIDandStatus() {

        HashMap<String, String> hmapOrderIDandClickStatus = new HashMap<String, String>();
        //open();
        Cursor cursor = db.rawQuery("SELECT OrderID,ifnull(Sstat,0) FROM tblPendingInvoices", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        if(cursor.getString(0)!=null)
                        hmapOrderIDandClickStatus.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapOrderIDandClickStatus;
        } finally {
            cursor.close();
            // close();
        }

    }

    public String[] fnGetServerOrdersFlgWith1() {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT OrderID  FROM tblPendingInvoices Where ServerOrdersFlg=1", null);
        try {
            String allData[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;
                    allData[i] = (String) cursor.getString(0).toString().trim();
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
        }
    }

    public void fnDeletetblInvoiceExecutionProductList() {
        try {
            db.execSQL("DELETE FROM tblInvoiceExecutionProductList");
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void fnAllServerOrdersFlgWith0() {
        try {
            //open();
            db.execSQL("Update tblPendingInvoices Set ServerOrdersFlg=1 where ServerOrdersFlg=0");
            // close();

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void fnDeleteUnWantedSubmitedInvoiceOrders() {
        try {
            String[] arrOrdersServerOrdersFlg = fnGetServerOrdersFlgWith1();
            if (arrOrdersServerOrdersFlg.length > 0) {
                for (int i = 0; i < arrOrdersServerOrdersFlg.length; i++) {
                    db.execSQL("Delete from tblPendingInvoices where OrderID='" + arrOrdersServerOrdersFlg[i] + "'");
                    db.execSQL("Delete from tblProductWiseInvoice where OrderID='" + arrOrdersServerOrdersFlg[i] + "'");
                    db.execSQL("Delete from tblInvoiceButtonTransac where OrderID='" + arrOrdersServerOrdersFlg[i] + "'");
                }
            }

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void fnDeletetblInvoiceSubmittedRecords(String OrderID) {
        try {
            db.execSQL("Delete from tblPendingInvoices where OrderID='" + OrderID + "'");
            db.execSQL("Delete from tblProductWiseInvoice where OrderID='" + OrderID + "'");
            db.execSQL("Delete from tblInvoiceButtonTransac where OrderID='" + OrderID + "'");
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void reTruncateInvoiceButtonTable() {
        db.execSQL("DELETE FROM tblPendingInvoices");
        //db.execSQL("DELETE FROM tblInvoiceExecutionProductList");
        db.execSQL("DELETE FROM tblProductWiseInvoice");
        db.execSQL("DELETE FROM tblInvoiceButtonTransac");
    }

    public int counttblCatagoryMstr() {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblCategoryMaster", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    /*	public static int fnChkStoreIdExistInDaySumaryTbl(String StrID)//On Store Selection VisitStart Activity
	{
		int flgChkStatus=0;

		int LoncolumnIndex = 0;


		Cursor cursor2 = db.rawQuery("SELECT StoreID FROM  tblDaySummary where StoreID='"+ StrID + "'", null);
		try {


			if(cursor2.getCount()>0)
			{
				if (cursor2.moveToFirst()) {

					for (int i = 0; i < cursor2.getCount(); i++) {
						flgChkStatus = 1;
						cursor2.moveToNext();
						// cursor.close();
					}

				}
			}
			return flgChkStatus;
		} finally {
			cursor2.close();
		}
	}

	public static long fnInsertStoreIfNotExistIntblDaySummary(String StrID)//On Store Selection VisitStart Activity/Add Store Activity
	{
		//This function will get called if fnChkStoreIdExistInDaySumaryTbl returns 0.

		ContentValues initialValues = new ContentValues();


		initialValues.put("StoreID", StrID);
		initialValues.put("flgTarget", 0);
		initialValues.put("flgActualVisited", 0);
		initialValues.put("flgProductiveDay", 0);
		initialValues.put("flgProductiveMTD", 0);
		initialValues.put("DaySales", 0.00);
		initialValues.put("MTDSales", 0.00);

		//////// System.out.println("inserting records..");

		return db.insert(DATABASE_TABLE_Summarytable, null, initialValues);

	}

	public static void updatePDAStoreFlgActualVisitIntblDaySummary(String StrID) //On Store Selection VisitStart Activity
	{
		final ContentValues values = new ContentValues();
		values.put("flgActualVisited", 1);

		int affected = db.update(DATABASE_TABLE_Summarytable, values,"StoreID=?", new String[] { StrID });
		Log.w(TAG, "affected records: " + affected);

		Log.w(TAG, "UpdateStoreStartVisit Updated..");
	}

	public static void updatePDAStoreFlgProductiveDayVisitIntblDaySummary(String StrID,int flgProductiveDay,int flgProductiveMTD)
	{
		final ContentValues values = new ContentValues();
		values.put("flgProductiveDay", flgProductiveDay);
		values.put("flgProductiveMTD", flgProductiveMTD);

		int affected = db.update(DATABASE_TABLE_Summarytable, values,"StoreID=?", new String[] { StrID });
		Log.w(TAG, "affected records: " + affected);

		Log.w(TAG, "UpdateStoreStartVisit Updated..");
	}
	public static void updatePDAStoreProductiveDaySalesIntblDaySummary(String StrID,Double DaySales)
	{
		final ContentValues values = new ContentValues();
		values.put("DaySales", DaySales);


		int affected = db.update(DATABASE_TABLE_Summarytable, values,"StoreID=?", new String[] { StrID });
		Log.w(TAG, "affected records: " + affected);

		Log.w(TAG, "UpdateStoreStartVisit Updated..");
	}
	public static void updatePDAStoreProductiveMTDSalesIntblDaySummary(String StrID,Double MTDSales)
	{
		final ContentValues values = new ContentValues();
		values.put("MTDSales", MTDSales);


		int affected = db.update(DATABASE_TABLE_Summarytable, values,"StoreID=?", new String[] { StrID });
		Log.w(TAG, "affected records: " + affected);

		Log.w(TAG, "UpdateStoreStartVisit Updated..");
	}
	public static void fnChkStoreInvoiceUpdateProductiveFlgsAndSales(String StrID)//On Order Activity --Submit, Save, Save Exit
	{//TotInv=is the total invoice on activity create method will be one time when ever the Order Activity Starts
		//This should be done before deleting transaction table
		String flgChkStoreInvoiceStatusAmount="";
		flgChkStoreInvoiceStatusAmount=fnGetStoreBasiscTotalSalesForSummarytbl(StrID);
		if(Integer.parseInt(flgChkStoreInvoiceStatusAmount.split("^")[0])==1)//1= Means Sales is greater then 0
		{
			updatePDAStoreFlgProductiveDayVisitIntblDaySummary(StrID,1,1);
		}
		if(Integer.parseInt(flgChkStoreInvoiceStatusAmount.split("^")[0])==0)
		{
			updatePDAStoreFlgProductiveDayVisitIntblDaySummary(StrID,0,0);
		}
		updatePDAStoreProductiveDaySalesIntblDaySummary(StrID,0.00);
		String storeMTDSales="0.00";
		storeMTDSales=fnGetStoreBasiscMTDSalesInSummarytbl(StrID);
		Double dblTotInv=Double.parseDouble(decimalFormat.format(flgChkStoreInvoiceStatusAmount.split("^")[1]));
		Double dblstoreMTDSales=Double.parseDouble(decimalFormat.format(storeMTDSales));
		dblstoreMTDSales=dblstoreMTDSales-dblTotInv;
		dblstoreMTDSales=Double.parseDouble(decimalFormat.format(dblstoreMTDSales));
		updatePDAStoreProductiveMTDSalesIntblDaySummary(StrID,dblstoreMTDSales);
	}
	public static void fnUpdatetblSumrySalesColumn(String StrID)
	{//This will called after the Saving insertion of records in Transaction table
		String StoreNewTotInvoice="";
		StoreNewTotInvoice=fnGetStoreBasiscTotalSalesForSummarytbl(StrID);
		if(Integer.parseInt(StoreNewTotInvoice.split("^")[0])==1)//1= Means Sales is greater then 0
		{
			Double dblTotInv=Double.parseDouble(decimalFormat.format(StoreNewTotInvoice.split("^")[1]));
			updatePDAStoreProductiveDaySalesIntblDaySummary(StrID,dblTotInv);
			String storeMTDSales="0.00";
			storeMTDSales=fnGetStoreBasiscMTDSalesInSummarytbl(StrID);
			Double dblstoreMTDSales=Double.parseDouble(decimalFormat.format(storeMTDSales));
			dblstoreMTDSales=dblstoreMTDSales+dblTotInv;
			dblstoreMTDSales=Double.parseDouble(decimalFormat.format(dblstoreMTDSales));
			updatePDAStoreProductiveMTDSalesIntblDaySummary(StrID,dblstoreMTDSales);
		}


	}
	public static String fnGetStoreBasiscMTDSalesInSummarytbl(String StrID)
	{

		int LoncolumnIndex = 0;
		String TotMTDSalesStore = "0.00";


		Cursor cursor2 = db.rawQuery("SELECT MTDSales FROM tblDaySummary where StoreID'"+StrID+"'", null);
		try {
			if(cursor2.getCount()>0)
			{
				if (cursor2.moveToFirst())
				{

					for (int i = 0; i < cursor2.getCount(); i++)
					{

						if (!cursor2.isNull(LoncolumnIndex))
						{
							if(Integer.parseInt(cursor2.getString(LoncolumnIndex).toString())>0)
							{
								TotMTDSalesStore =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
							}

							//TotSalesValueStoreBasis =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
							cursor2.moveToNext();
						}


					}

				}
			}
			else
			{
				TotMTDSalesStore ="0.00";
				cursor2.moveToNext();
			}
			return TotMTDSalesStore;
		} finally {
			cursor2.close();
		}

	}

	public static String fnGetStoreBasiscTotalSalesForSummarytbl(String StrID)
	{
		int LoncolumnIndex = 0;
		String TotSalesValueStoreBasis = "0^0.00";


		Cursor cursor2 = db.rawQuery("SELECT SUM(InvoiceVal) FROM tblTmpInvoiceHeader where StoreID'"+StrID+"'", null);
		try {
			if(cursor2.getCount()>0)
			{
				if (cursor2.moveToFirst())
				{

					for (int i = 0; i < cursor2.getCount(); i++)
					{

						if (!cursor2.isNull(LoncolumnIndex))
						{
							if(Integer.parseInt(cursor2.getString(LoncolumnIndex).toString())>0)
							{
								TotSalesValueStoreBasis ="1^"+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
							}

							//TotSalesValueStoreBasis =""+ Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
							cursor2.moveToNext();
						}


					}

				}
			}
			else
			{
				TotSalesValueStoreBasis ="0^0.00";

			}
			return TotSalesValueStoreBasis;
		} finally {
			cursor2.close();
		}
	}


	public static String fnGetSummaryTargetCalls()//TargetCalls For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Count(StoreID) FROM tblDaySummary where flgTarget=1", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}
	public static String fnGetActualCallsOnRoute()//ActualCallsOnRoute For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Count(StoreID) FROM tblDaySummary where flgTarget=1 and flgActualVisited=1", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}

	public static String fnGetActualCallsOffRoute()//ActualCallsOffRoute For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Count(StoreID) FROM tblDaySummary where flgTarget=0 and flgActualVisited=1", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}
	public static String fnGetProductiveCallsOnRoute()//ProductiveCallsOnRoute For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Count(StoreID) FROM tblDaySummary where flgTarget=1 and flgActualVisited=1 and flgProductiveDay=1", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}
	public static String fnGetProductiveCallsOffRoute()//ProductiveCallsOffRoute For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Count(StoreID) FROM tblDaySummary where flgTarget=0 and flgActualVisited=1 and flgProductiveDay=1", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}
	public static String fnGetTotalSalesValueForDay()//TotalSalesValueForDay For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Sum(DaySales) FROM tblDaySummary", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}

	public static String fnGetAchievedSalesValueTillDate()//AchievedSalesValueTillDate For Summary Activity
	{
		Cursor cursorE2 = db.rawQuery("SELECT Sum(MTDSales) FROM tblDaySummary", null);
		String TotalTargetCalls = "0";
		int ScodecolumnIndex = 0;
		try {
			if(cursorE2.getCount()>0)
			{
				if (cursorE2.moveToFirst()) {

					for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
						TotalTargetCalls = (String) cursorE2.getString(ScodecolumnIndex).toString();
						cursorE2.moveToNext();
					}
				}
			}
			return TotalTargetCalls;
		} finally {
			cursorE2.close();
		}
	}
	*/
    public int fnGetAutoIdStoreOnReturnPAge(String StoreID) {
        // int chkValue=fnChkStoreIdExistsInReturnMstr(StoreID);
        // ////// System.out.println("chkValue :" + chkValue);
        // int inAutoIdForInsert=1;
        // if(chkValue==0)
        // {
        // ////// System.out.println("inAutoIdForInsert before function call when chkValue is 0:"
        // + inAutoIdForInsert);
        // inAutoIdForInsert=fnGetMaxAutoIncrementForReturnMstr();
        // ////// System.out.println("inAutoIdForInsert after function call when chkvalue is 0:"
        // + inAutoIdForInsert);
        // insertPDAProductReturnMstr(inAutoIdForInsert,StoreID);
        // }
        /*
         * else { ////// System.out.println(
         * "inAutoIdForInsert before function call when chkValue is 1:" +
         * inAutoIdForInsert);
         * inAutoIdForInsert=fnGetMaxAutoIncrementForReturnMstr();
         * ////// System.out.println
         * ("inAutoIdForInsert after function call when chkvalue is 1:" +
         * inAutoIdForInsert);
         * insertPDAProductReturnMstr(inAutoIdForInsert,StoreID); }
         */
        int autoid = fnGetAutoIDReturnMstr(StoreID);
        ////// System.out.println("autoid :" + autoid);
        return autoid;
    }

    public int fnGetMaxAutoIncrementForReturnMstr() {

        int LoncolumnIndex = 0;
        int strAutoReturnIdMstr = 1;
        String strAutoReturnMstrText;

        Cursor cursor2 = db.rawQuery(
                "SELECT Max(AutoReturnIdMstr) FROM  tblPDAProductReturnMstr",
                null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    // strAutoReturnMstrText= cursor2.getString(LoncolumnIndex);
                    // ////// System.out.println("strAutoReturnMstrText :"
                    // +strAutoReturnMstrText);
                    if (cursor2.getString(LoncolumnIndex) != null) {
                        strAutoReturnIdMstr = Integer.parseInt(cursor2
                                .getString(LoncolumnIndex)) + 1;
                    } else {
                        strAutoReturnIdMstr = 1;
                    }
                    // strAutoReturnIdMstr
                    // =Integer.parseInt(cursor2.getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("strAutoReturnIdMstr :" + strAutoReturnIdMstr);
            return strAutoReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    public int fnChkAutoIdMstrForReturnDetails(int ReturnIdMstr, String pdaOrderID, String TmpInvoiceCodePDA) {

        int LoncolumnIndex = 0;
        int strReturnIdDetails = 0;

        Cursor cursor2 = db
                .rawQuery(
                        "SELECT AutoReturnDetailsId FROM  tblPDAProductReturnDetails where ReturnIdMstr='" + ReturnIdMstr + "'   AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdDetails = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdDetails;
        } finally {
            cursor2.close();
        }

    }

    /*public static int fnGetAutoIdStoreOnReturnPAgeMain(String StoreID,
			String Returndate, Double previousCreditAmt) {
		int chkValue = fnChkStoreIdExistsInReturnMstr(StoreID);
		////// System.out.println("chkValue :" + chkValue);
		int inAutoIdForInsert = 1;
		if (chkValue == 0) {
			inAutoIdForInsert = fnGetMaxAutoIncrementForReturnMstr();
			insertPDAProductReturnMstr(inAutoIdForInsert, StoreID, Returndate,
					previousCreditAmt);
		}

		int autoid = fnGetAutoIDReturnMstr(StoreID);
		////// System.out.println("autoid :" + autoid);
		return autoid;
	}*/
    public void deletetblPDAProductReturnDetailsOnReturnIdMstr(int autoid) {

        db.execSQL("DELETE FROM tblPDAProductReturnDetails WHERE ReturnIdMstr ="
                + autoid);

    }

    public String[] fnGetRecordsReturnDetails(int ReturnIdMstr) {

        /*
         * Cursor cursorALL = db.rawQuery("SELECT * FROM tblStoreList", null);
         *
         * ////// System.out.println("PrevDateChk - ALL Records Count: "+
         * cursorALL.getCount());
         */

        Cursor cursor = db
                .rawQuery(
                        "SELECT ReturnIdMstr, ProductId, ProdReturnQty, ProdReturnValue, ProdReturnReason, ProdReturnReasonDescr, ProdLastOrderDate, ProdLastOrderQyt, AdjustReturnQty, AdjustReturnValue FROM tblPDAProductReturnDetails WHERE ReturnIdMstr ="
                                + ReturnIdMstr, null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String mvalue = "NA";
                        if (i > 3 && i < 8) {
                            if (cursor.getString(i).equals(" ")
                                    || cursor.getString(i).isEmpty()
                                    || cursor.getString(i).equals("")) {
                                mvalue = "NA";
                            } else {
                                mvalue = cursor.getString(i);
                            }
                        }
                        CompleteResult[i] = cursor.getString(0) + "_"
                                + cursor.getString(1) + "_"
                                + cursor.getString(2) + "_"
                                + cursor.getString(3) + "_" + mvalue + "_"
                                + mvalue + "_" + mvalue + "_" + mvalue + "_"
                                + cursor.getString(8) + "_"
                                + cursor.getString(9);
                        ////// System.out.println("fnGetRecordsReturnDetails: "+ CompleteResult[i]);
                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public int fnGetAutoIdStoreOnReturnDeatils() {
        int inReturnDetailsAutoIdForInsert = fnGetMaxAutoIncrementForReturnDetails();
        return inReturnDetailsAutoIdForInsert;
    }

    public int fnGetMaxAutoIncrementForReturnDetails() {

        int LoncolumnIndex = 0;
        int strAutoReturnIdDetails = 1;
        String strAutoReturnDetailsText;

        Cursor cursor2 = db
                .rawQuery(
                        "SELECT Max(AutoReturnDetailsId) FROM  tblPDAProductReturnDetails",
                        null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    // strAutoReturnDetailsText=cursor2.getString(LoncolumnIndex);
                    if (cursor2.getString(LoncolumnIndex) != null) {
                        strAutoReturnIdDetails = Integer.parseInt(cursor2
                                .getString(LoncolumnIndex)) + 1;
                    } else {
                        strAutoReturnIdDetails = 1;
                    }
                    // strAutoReturnIdMstr
                    // =Integer.parseInt(cursor2.getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strAutoReturnIdDetails;
        } finally {
            cursor2.close();
        }

    }

    public long fninsertPDAProductReturnDetails(int AutoReturnIdMstr,
                                                int AutoReturnIdDetails, String strProductId,
                                                String strProdReturnQty, Double ProdRate, Double ProdReturnValue,
                                                int proSingleAdjQty, Double proSingleAdjAmt) {

        ContentValues initialValues = new ContentValues();

        ////// System.out.println("Saved AutoReturnIdMstr:" + AutoReturnIdMstr+ "Saved AutoReturnIdDetails:" + "" + AutoReturnIdDetails);

        initialValues.put("AutoReturnDetailsId", AutoReturnIdDetails);
        initialValues.put("ReturnIdMstr", AutoReturnIdMstr);
        initialValues.put("ProductId", strProductId.trim());
        initialValues.put("ProdReturnQty", strProdReturnQty.trim());
        initialValues.put("ProdRate", ProdRate);
        initialValues.put("ProdReturnValue", ProdReturnValue);

        initialValues.put("AdjustReturnQty", proSingleAdjQty);
        initialValues.put("AdjustReturnValue", proSingleAdjAmt);


        initialValues.put("ProdReturnReason", " ");
        initialValues.put("ProdReturnReasonDescr", " ");
        initialValues.put("ProdLastOrderDate", " ");
        initialValues.put("ProdLastOrderQyt", " ");

        /*
         * ////// System.out.println(
         * "fninsertPDAProductReturnDetails  proSingleReturnQty: "+
         * strProdReturnQty);
         * ////// System.out.println("fninsertPDAProductReturnDetails  proSingleRateQty: "
         * +ProdReturnValue);
         *
         * ////// System.out.println("fninsertPDAProductReturnDetails  proSingleAdjQty: "
         * + proSingleAdjQty);
         * ////// System.out.println("fninsertPDAProductReturnDetails  proSingleAdjAmt: "
         * +proSingleAdjAmt);
         */

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN20, null, initialValues);
    }


    // tblPDAProductReturnDetails (AutoReturnDetailsId int null,ReturnIdMstr int null, ProductId text null,
    //ProdReturnQty text null, ProdRate real null, ProdReturnValue real null, ProdReturnReason text null,
    //ProdReturnReasonDescr text null, ProdLastOrderDate text null, ProdLastOrderQyt text null, Sstat integer null,
    //AdjustReturnQty integer null,AdjustReturnValue real null);";

    public int fnGetAutoIDReturnMstr(String ReturnStoreId) {

        int LoncolumnIndex = 0;
        int strReturnIdMstr = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT AutoReturnIdMstr FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdMstr = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    public void updatePDAProductReturnMstr(int AutoReturnIdMstr,
                                           String ReturnDate, String Comment, int TotalReturnQty,
                                           Double TotalReturnValue, int TotalAdjustQty,
                                           Double TotalAdujustValue, Double FinalBalanceAmount,
                                           Double LastCreditAmount) {

        String strAutoReturnIdMstr = "" + AutoReturnIdMstr;
        final ContentValues values = new ContentValues();
        values.put("ReturnDate", ReturnDate.trim());
        values.put("Comment", Comment);
        values.put("TotalReturnQty", TotalReturnQty);
        values.put("TotalReturnValue", TotalReturnValue);

        values.put("TotalAdjustQty", TotalAdjustQty);
        values.put("TotalAdjustValue", TotalAdujustValue);
        values.put("FinalBalanceAmount", FinalBalanceAmount);
        values.put("LastCreditAmount", LastCreditAmount);

        int affected = db.update("tblPDAProductReturnMstr", values,
                "AutoReturnIdMstr=?", new String[]{strAutoReturnIdMstr});
        Log.w(TAG, "affected records: " + affected);

        //Log.w(TAG, "UpdateStoreStartVisit Updated..");
    }
    //tblPDAProductReturnMstr (AutoReturnIdMstr int null,StoreID text null, ReturnDate text null, Comment text null,
    //TotalReturnQty int null, TotalReturnValue real null, Sstat integer null,TotalAdjustQty integer null,
    //TotalAdjustValue real null,FinalBalanceAmount real null,LastCreditAmount real null);";

    public int fnGetStockAgainstProduct(String StoreID, String Pid) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery(
                "SELECT Stock FROM tblTransac where StoreID='" + StoreID
                        + "' and ProdID ='" + Pid + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(
                                ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public int fnChkStoreIdExistsInReturnMstr(String ReturnStoreId, String pdaOrderID, String TmpInvoiceCodePDA) {

        int LoncolumnIndex = 0;
        int strReturnIdMstr = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT AutoReturnIdMstr FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdMstr = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    public String[] fnGetRecordsReturnMaster(String strStoreID) {

        /*
         * Cursor cursorALL = db.rawQuery("SELECT * FROM tblStoreList", null);
         *
         * ////// System.out.println("PrevDateChk - ALL Records Count: "+
         * cursorALL.getCount());
         */

        Cursor cursor = db
                .rawQuery(
                        "SELECT Comment, TotalReturnQty, TotalReturnValue,TotalAdjustQty,TotalAdjustValue FROM tblPDAProductReturnMstr WHERE StoreID ='"
                                + strStoreID + "'", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        CompleteResult[i] = cursor.getString(0) + "_"
                                + cursor.getString(1) + "_"
                                + cursor.getString(2) + "_"
                                + cursor.getString(3) + "_"
                                + cursor.getString(4);
                        // ////// System.out.println(cursor.getString(0) + "_" +
                        // cursor.getString(1)+ "_" + cursor.getString(2));
                        cursor.moveToNext();

                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    /*public static long insertPDAProductDistributionDetails(int CatId,int ProductID, String Stock, String StoreID)
	{
		ContentValues initialValues = new ContentValues();


		initialValues.put("CatId",CatId);
		initialValues.put("ProductID",ProductID);
		initialValues.put("Stock", Stock.trim());
		initialValues.put("StoreID", StoreID.trim());


		//initialValues.put("StoreID", StoreID);

		initialValues.put("Sstat", 0);

		////// System.out.println("inserting records in Details  Stock..");
		////// System.out.println("inserting records..");

		return db.insert(DATABASE_TABLE_MAIN7, null, initialValues);
	}
	*/
    public int fnGetAutoIDReturnMstr(String DistribtutionStoreId, String DistributionProductId) {

        int LoncolumnIndex = 0;
        int strReturnIdMstr = 0;

        Cursor cursor2 = db.rawQuery("SELECT AutoId FROM  tblReturnProductMstr where StoreID='"
                + DistribtutionStoreId + "' and ProductId='" + DistributionProductId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdMstr = Integer.parseInt(cursor2.getString(LoncolumnIndex));
                    cursor2.moveToNext();

                }

            }

            return strReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    //tblDistributionStoreProductWiseDetails (CatId integer not null,ProductID integer not null,StoreID text not null,
    //Stock text null,ProductMfgDate text null,Sstat integer not null);";
	/*public int counttblDistributionStoreProductWiseDetails()
		{
			int check=0;

			Cursor cursor2 = db.rawQuery("SELECT Count(*) FROM tblDistributionStoreProductWiseDetails", null);
			try {

				if (cursor2.getCount()>0)
				{

					check=1;

				}
				return check;
			} finally {
				cursor2.close();
			}
		}
	*/

    public String[] FetcReturnProductIdOverAllStock(String StoreID) {
        int ScodecolumnIndex = 0;
        int ScodecolumnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT ProductId, OverallStock FROM tblReturnProductMstr where StoreId='" + StoreID + "'", null);
        try {
            String StoreProductIdStock[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreProductIdStock[i] = (String) cursor.getString(ScodecolumnIndex).toString() + "_" + (String) cursor.getString(ScodecolumnIndex1).toString();
                    ////// System.out.println("product short name :"+StoreProductIdStock[i]);
                    cursor.moveToNext();
                }
            }
            return StoreProductIdStock;
        } finally {
            cursor.close();
        }
    }

    public String[] FetcReturnProductIdOverAllStockDetails(int AutoDistributionIdMstr) {
        int ScodecolumnIndex = 0;
        int ScodecolumnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT Stock, ProductMfgDate FROM tblReturnStoreProductWiseDetails where AutoID=" + AutoDistributionIdMstr, null);
        try {
            String StoreProductIdStock[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreProductIdStock[i] = (String) cursor.getString(ScodecolumnIndex).toString() + "_" + (String) cursor.getString(ScodecolumnIndex1).toString();
                    ////// System.out.println("product tblReturnStoreProductWiseDetails :"+StoreProductIdStock[i]);
                    cursor.moveToNext();
                }
            }
            return StoreProductIdStock;
        } finally {
            cursor.close();
        }
    }

    public int counttblOutLetInfoOnQuadVolumeCategoryBasis() {
        int check = 0;

        Cursor cursor2 = db.rawQuery("SELECT Count(*) FROM tblOutLetInfoOnQuadVolumeCategoryBasis", null);
        try {

            ////// System.out.println("Sunil check data in table :"+cursor2.getCount());
            if (cursor2.getCount() > 0) {

                check = 1;

            }
            return check;
        } finally {
            cursor2.close();
        }
    }

    public long saveOutLetInfoOnQuadVolumeCategoryBasis(String OutID, String OutletName, String OwnerName, String ContactNo,
                                                        String MarketAreaName, String Latitude, String Longitutde) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("OutID", OutID.trim());
        initialValues.put("OutletName", OutletName.trim());
        initialValues.put("OwnerName", OwnerName.trim());
        initialValues.put("ContactNo", ContactNo.trim());
        initialValues.put("MarketAreaName", MarketAreaName.trim());
        initialValues.put("Latitude", Latitude.trim());
        initialValues.put("Longitutde", Longitutde.trim());


        ////// System.out.println("jai data  stoe in teable 3");
        return db.insert(DBHelper.DATABASE_TABLE_MAIN91, null, initialValues);
    }

    public String[] fetchParticularStoreInfo(String OutID) {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        int LoncolumnIndex3 = 3;
        int LoncolumnIndex4 = 4;
        int LoncolumnIndex5 = 5;

        //Latitude text null,Longitutde
        Cursor cursor2 = db.rawQuery("SELECT OutletName,OwnerName,ContactNo,MarketAreaName,Latitude,Longitutde  FROM tblOutLetInfoOnQuadVolumeCategoryBasis where OutID='" + OutID + "'", null);
        try {
            ////// System.out.println("ajay total Store cursor2.getCount() :"+cursor2.getCount());
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        UniqueProductShortName[i] = cursor2.getString(LoncolumnIndex).toString() + "^" +
                                cursor2.getString(LoncolumnIndex1).toString() + "^" + cursor2.getString(LoncolumnIndex2).toString() + "^"
                                + cursor2.getString(LoncolumnIndex3).toString() + "^"
                                + cursor2.getString(LoncolumnIndex4).toString() + "^"
                                + cursor2.getString(LoncolumnIndex5).toString();
                        ////// System.out.println("Sunil OutletName :"+cursor2.getString(LoncolumnIndex).toString());
                        ////// System.out.println("Sunil OwnerName :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("Sunil ContactNo :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("Sunil MarketAreaName :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("Sunil total :"+UniqueProductShortName[i]);
                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public String[] fetchStorelatLong() {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        int LoncolumnIndex3 = 3;
        ////// System.out.println("ajay one");
        //store_longitude text null,store_latitude text null
        //Cursor cursor21 = db.rawQuery("SELECT count(*) FROM tblOutLetInfoOnQuadVolumeCategoryBasis", null);
        ////// System.out.println("ajay two");
        Cursor cursor2 = db.rawQuery("SELECT Latitude,Longitutde,OutletName,OutID FROM tblOutLetInfoOnQuadVolumeCategoryBasis", null);


        //Cursor cursor2 = db.rawQuery("SELECT store_longitude,store_latitude,name,StoreID FROM tblOutLetInfoOnQuadVolumeCategoryBasis", null);
        ////// System.out.println("ajay three");
        try {
            ////// System.out.println("ajay total Store cursor2.getCount() :"+cursor2.getCount());
            //////// System.out.println("ajay total Store cursor21.getCount() :"+cursor21.getCount());
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        UniqueProductShortName[i] = cursor2.getString(LoncolumnIndex).toString() + "^" + cursor2.getString(LoncolumnIndex1).toString() + "^" + cursor2.getString(LoncolumnIndex2).toString() + "^" + cursor2.getString(LoncolumnIndex3).toString();
                        ////// System.out.println("ajay lat :"+cursor2.getString(LoncolumnIndex).toString());
                        ////// System.out.println("ajay lon :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("ajay OutletName :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("ajay OutID :"+cursor2.getString(LoncolumnIndex1).toString());
                        ////// System.out.println("ajay total :"+UniqueProductShortName[i]);
                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public void deleteAlertValueProduct(String storeId, String _schmAlrtId, String pdaOrderID, String TmpInvoiceCodePDA) {
        //open();
        Cursor cur = db.rawQuery("Select ProductID from tblAlrtVal where StoreId ='" + storeId + "' and schmAlrtId = '" + _schmAlrtId + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.DATABASE_TABLE_Main214, "StoreID=? AND schmAlrtId=? AND TmpInvoiceCodePDA=? ", new String[]{storeId, _schmAlrtId, TmpInvoiceCodePDA});
        }

        //close();
    }

    public void deleteProductOldSlab215(String storeId, String _schmId, String pdaOrderID, String TmpInvoiceCodePDA,int flgInCarton) {
        //open();
        //DATABASE_CREATE_TABLE_215 =tblProductMappedWithSchemeSlabApplied (StoreId,ProductID,schSlabId,schmIdMapped

        Cursor cur = db.rawQuery("Select ProductID from tblProductMappedWithSchemeSlabApplied where StoreId ='" + storeId + "'  and schmIdMapped ='" + _schmId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
        if (cur.getCount() > 0) {
            // System.out.println("DATABASE_TABLE_Main215 Delete : StoreId = "+storeId+" schmIdMapped = "+_schmId+" cur.getCount()= "+cur.getCount());
            db.delete(DBHelper.DATABASE_TABLE_Main215, "StoreId=? AND schmIdMapped=? AND  TmpInvoiceCodePDA=?", new String[]{storeId, _schmId, TmpInvoiceCodePDA});
        }

        // close();
    }

    public void deleteProductSchemeType3(String storeId, String _productId, String pdaOrderID, String TmpInvoiceCodePDA, int flgInCarton) {
        //open();
        //DATABASE_CREATE_TABLE_215 =tblProductMappedWithSchemeSlabApplied (StoreId,ProductID,schSlabId,schmIdMapped

        Cursor cur = db.rawQuery("Select ProductID from tblProductMappedWithSchemeSlabApplied where StoreId ='" + storeId + "'  and ProductID='" + _productId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
        if (cur.getCount() > 0) {
            // System.out.println("DATABASE_TABLE_Main215 Delete : StoreId = "+storeId+" ProductID = "+_productId+" cur.getCount()= "+cur.getCount());
            db.delete(DBHelper.DATABASE_TABLE_Main215, "StoreId=? AND ProductID=? AND  TmpInvoiceCodePDA=?", new String[]{storeId, _productId, TmpInvoiceCodePDA});
        }

        // close();
    }

    public void deleteAllStoreAlertValueProduct(String storeId, String pdaOrderID, String TmpInvoiceCodePDA) {
        //open();
        Cursor cur = db.rawQuery("Select ProductID from tblAlrtVal where StoreId ='" + storeId + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.DATABASE_TABLE_Main214, "StoreID=?  AND TmpInvoiceCodePDA=?", new String[]{storeId, TmpInvoiceCodePDA});
        }

        // close();
    }

    public void deleteProductBenifitSlabApplieddeleteProductBenifitSlabApplied(String storeId, String pdaOrderID, String TmpInvoiceCodePDA,int flgInCarton) {
        //open();
        Cursor cur = db.rawQuery("Select ProductID from tblProductMappedWithSchemeSlabApplied where StoreId ='" + storeId + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.DATABASE_TABLE_Main215, "StoreID=? AND TmpInvoiceCodePDA=?", new String[]{storeId, TmpInvoiceCodePDA});


        }

        //close();
    }

    public void deletetblOutLetInfoOnQuadVolumeCategoryBasis() {
        db.execSQL("DELETE FROM tblOutLetInfoOnQuadVolumeCategoryBasis ");

    }

    public void dropRoutesTBL() {
        //db.execSQL("DROP TABLE IF EXISTS tblRouteListMaster");
        db.execSQL("DELETE FROM tblRouteListMaster");
        //db.execSQL("DROP TABLE IF EXISTS tblAvailableVersion");

    }

    public void fnFinaldropRoutesTBL() {
        db.execSQL("DROP TABLE IF EXISTS tblRouteListMaster");
        //db.execSQL("DELETE FROM tblRouteListMaster");
        //db.execSQL("DROP TABLE IF EXISTS tblAvailableVersion");

    }

    public String[] fnGetRouteIdsForDDL() {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster", null);
        try {
            String strLocationIDDetais[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strLocationIDDetais[i] = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("[ROUTE] Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strLocationIDDetais;
        } finally {
            cursor2.close();
        }

    }

    public String[] fnGetRouteInfoForDDL() {

        int LoncolumnIndex = 0;
        Cursor cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster", null);
        try {
            String strLocationNameDetais[] = new String[cursor2.getCount()];
            ////// System.out.println("[Route] Count : " + cursor2.getCount());
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strLocationNameDetais[i] = cursor2
                            .getString(LoncolumnIndex);
                    ////// System.out.println("[Route] Route Name : "+ cursor2.getString(LoncolumnIndex).toString().trim());

                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strLocationNameDetais;
        } finally {
            cursor2.close();
        }

    }

    public String[] FetchStorePDATargetQtyForSecondPage(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;
        int SnamecolumnIndex2 = 1;

        // int Stock,int OrderQty, Double OrderVal, int FreeQty, Double DisVal

        Cursor cursor = db
                .rawQuery(
                        "SELECT SKUShortName, TargetQty  FROM tblPDATargetQtyForSecondPage WHERE StoreID ='"
                                + sID2Fetch + "'", null);
        try {

            String ProductTarget[] = new String[cursor.getCount()];
            ;

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    ProductTarget[i] = (String) cursor.getString(
                            SnamecolumnIndex1).toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex2)
                            .toString();

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return ProductTarget;
        } finally {
            cursor.close();
        }

    }

    public String[] fnGetAllSchSlabDescbasedOnSchemeSlabID(String SchemeSlabID) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT SchemeSlabDesc FROM tblSchemeSlabDetail WHERE SchemeSlabID ='" + SchemeSlabID + "'", null);
        String AllSchemeSlabID[] = new String[cursorE2.getCount()];

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllSchemeSlabID[i] = (String) cursorE2.getString(0).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public String[] fnGetAllBenifitDescrbasedOnSchemeSlabID(String SchemeSlabID) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT BenifitDescr FROM tblSchemeSlabDetail WHERE SchemeSlabID ='"
                + SchemeSlabID + "'", null);
        String AllSchemeSlabID[] = new String[cursorE2.getCount()];

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllSchemeSlabID[i] = (String) cursorE2.getString(0).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public String[] fnGetSchemeIdsAppliedOnStore(String strStoreID) {
        int ScodecolumnIndex = 0;
        Cursor cursor = db.rawQuery("SELECT SchemeID FROM tblSchemeStoreMapping Where StoreID='" + strStoreID + "'", null);
        try {
            String SchemeIds[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    SchemeIds[i] = (String) (cursor.getString(ScodecolumnIndex).toString());
                    ////// System.out.println("DB-ADAP: PROD RLP: "+ (String) cursor.getString(ScodecolumnIndex).toString());
                    cursor.moveToNext();
                }
            }
            return SchemeIds;
        } finally {
            cursor.close();
        }
    }

    public String[] PrevPDASchemeApplicableSecondPage(String strStoreID) {


        String[] strSchemeIds = fnGetSchemeIdsAppliedOnStore(strStoreID);
        String CompleteResult[] = new String[strSchemeIds.length];
        ;
        if (strSchemeIds.length >= 1) {
            String myQuery = "SELECT SchemeID,SchemeName FROM tblSchemeMstr WHERE SchemeID in (" + makePlaceholders(strSchemeIds.length) + ")";
            Cursor cursor = db.rawQuery(myQuery, strSchemeIds);

            try {
                //CompleteResult = new String[cursor.getCount()];
                if (cursor.getCount() > 0) {

                    if (cursor.moveToFirst()) {

                        for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                            CompleteResult[i] = (String) cursor.getString(0).toString() + "_" + (String) cursor.getString(1).toString();
                            cursor.moveToNext();
                        }
                    }

                }


            } finally {
                cursor.close();
            }
        }

        return CompleteResult;
    }

    public String makePlaceholders(int len) {
        if (len < 1) {
            // It will lead to an invalid query anyway ..
            throw new RuntimeException("No placeholders");
        } else {
            StringBuilder sb = new StringBuilder(len * 2 - 1);
            sb.append("?");
            for (int i = 1; i < len; i++) {
                sb.append(",?");
            }
            return sb.toString();
        }
    }

    public String[] PrevPDASchemeApplicableSecondPageSpecialScheme(String strStoreID) {

        /*
         * Cursor cursorALL = db.rawQuery("SELECT * FROM tblStoreList", null);
         *
         * ////// System.out.println("PrevDateChk - ALL Records Count: "+
         * cursorALL.getCount());
         */
        String strMystoretype = "";
        strMystoretype = fnGetStoreTypeOnStoreIdBasis(strStoreID);
        Cursor cursor = db.rawQuery(
                "SELECT SchemeDesc FROM tblspForPDASchemeApplicableList WHERE StoreType ='"
                        + strMystoretype + "' and flgSpecialScheme=1", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString();
                        //// System.out.println("strMystoretype : " + strMystoretype);
                        ////// System.out.println("CompleteResult[i] : "+ CompleteResult[i].toString().trim());
                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String[] PrevPDALastTranDetForSecondPage(String strStoreID) {

        /*
         * Cursor cursorALL = db.rawQuery("SELECT * FROM tblStoreList", null);
         *
         * ////// System.out.println("PrevDateChk - ALL Records Count: "+
         * cursorALL.getCount());
         */

        Cursor cursor = db
                .rawQuery(
                        "SELECT SKUName, LastTransDate, Stock, OrderQty, FreeQty FROM tblPDALastTranDateForSecondPage WHERE StoreID ='"
                                + strStoreID + "'", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString()
                                + "_"
                                + (String) cursor.getString(1).toString()
                                + "_"
                                + (String) cursor.getString(2).toString()
                                + "_"
                                + (String) cursor.getString(3).toString()
                                + "_"
                                + (String) cursor.getString(4).toString();
                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String fnGetPDALastInvoiceDetlastDate(String strStoreID) {

        Cursor cursorE2 = db.rawQuery(
                "SELECT LastTransDate FROM tblPDALastInvoiceDet WHERE StoreID ='"
                        + strStoreID + "'", null);
        String LastTransDate = "";
        int ScodecolumnIndex = 0;
        try {

            if (cursorE2.moveToFirst()) {

                for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                    LastTransDate = (String) cursorE2.getString(
                            ScodecolumnIndex).toString();
                    cursorE2.moveToNext();
                }
            }
            return LastTransDate;
        } finally {
            cursorE2.close();
        }

    }

    public long insertPDAProductReturnMstr(int AutoReturnIdMstr,
                                           String StoreID, String ReturnDate, Double previousCreditAmt) {
        ContentValues initialValues = new ContentValues();

        ////// System.out.println("Saved AutoReturnIdMstr:" + AutoReturnIdMstr+ "Saved StoreID:" + "" + StoreID);

        initialValues.put("AutoReturnIdMstr", AutoReturnIdMstr);
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ReturnDate", ReturnDate.trim());
        initialValues.put("Comment", "Not Available");
        // initialValues.put(KEY_TotalReturnQty, 0);
        // initialValues.put(KEY_TotalReturnValue, 0.00);

        // initialValues.put(KEY_TotalAdjustQty, 0);
        // initialValues.put(KEY_TotalAdjustValue, 0.00);
        initialValues.put("FinalBalanceAmount", previousCreditAmt);
        // initialValues.put(KEY_LastCreditAmount, 0.00);

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN19, null, initialValues);
    }
    //tblPDAProductReturnMstr (AutoReturnIdMstr int null,StoreID text null, ReturnDate text null, Comment text null,
    //TotalReturnQty int null, TotalReturnValue real null, Sstat integer null,TotalAdjustQty integer null,
    //TotalAdjustValue real null,FinalBalanceAmount real null,LastCreditAmount real null);";

    public int getExistingPicNos(String StoreID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblStoreMaterialPhotoDetail where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }


    public int getExistingPicNosAttendance() {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT SelfieURL FROM tblAttandanceDetails", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex) && !cursor.getString(ScodecolumnIndex).equals("NA")) {
                        if(cursor.getInt(ScodecolumnIndex)>0)
                            strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public Double fnGetDiscountValueOnRealSlabBasis(String strSchemeID, String SlabFrom) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        Double strSchemeIDFreeProductId = 0.00;
        Cursor cursor2 = db.rawQuery(
                "SELECT Discount FROM tblSchemeDetails where  SchemeID = '" + strSchemeID
                        + "' and SlabFrom='" + SlabFrom + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = Double.parseDouble(cursor2
                            .getString(LoncolumnIndex));
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public int fnGetFreeQuantityOnRealSlabBasis(String strSchemeID, String SlabFrom) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int strSchemeIDFreeProductId = 0;
        Cursor cursor2 = db.rawQuery(
                "SELECT FreeQuantity FROM tblSchemeDetails where  SchemeID = '" + strSchemeID
                        + "' and SlabFrom='" + SlabFrom + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public String fnGetFreeProdIDOnRealSlabBasis(String strSchemeID, String SlabFrom) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strSchemeIDFreeProductId = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT FreeProductID FROM tblSchemeDetails where  SchemeID = '" + strSchemeID
                        + "' and SlabFrom='" + SlabFrom + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = cursor2
                            .getString(LoncolumnIndex);
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public String fnGetMProdIDAccordingToSchemeID(String SchID) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strSchemeIDFreeProductId = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT ProductID FROM tblschemeProductMap where SchemeID='"
                        + SchID + "' LIMIT 1", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = cursor2
                            .getString(LoncolumnIndex);
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public String fnGetMaxSlabofProductAccordingToOrder(
            String strSchemType, String strSchemeID, int strOrderValue) {
        int LoncolumnIndex = 0;
        //////// System.out.println("strFPIDSlb strMaxSlb :" + strMaxSlb);
        String strProductSabFreeOrDiscount = "";

        if (Integer.parseInt(strSchemType) == 1
                || Integer.parseInt(strSchemType) == 2) {
            Cursor cursor2 = db.rawQuery(
                    "SELECT Max(SlabFrom) FROM tblSchemeDetails where SlabFrom<="
                            + strOrderValue + " and SchemeID = '" + strSchemeID
                            + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }

                        cursor2.moveToNext();
                        // cursor.close();
                    }

                    strProductSabFreeOrDiscount = strProductSabFreeOrDiscount;

                }

            } finally {
                cursor2.close();
            }
        }
        if (Integer.parseInt(strSchemType) == 3) {
            Cursor cursor2 = db.rawQuery(
                    "SELECT Max(SlabFrom) FROM tblSchemeDetails where SlabFrom<="
                            + strOrderValue + " and SchemeID = '" + strSchemeID
                            + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }

                        ////// System.out.println("Discount Abhinav = "+ strProductSabFreeOrDiscount);
                        cursor2.moveToNext();
                        // cursor.close();
                    }

                    strProductSabFreeOrDiscount = strProductSabFreeOrDiscount;

                }

            } finally {
                cursor2.close();
            }
        }
        return strProductSabFreeOrDiscount;
    }

    public String fnGetSchemeTypeonSchemeIDBasis(String strSchemeID) {
        int LoncolumnIndex = 0;
        //////// System.out.println("strFPIDSlb strMaxSlb :" + strMaxSlb);
        String strProductSabFreeOrDiscount = "";

        Cursor cursor2 = db.rawQuery(
                "SELECT  SchemeType FROM tblSchemeList where SchemeID = '" + strSchemeID
                        + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (strProductSabFreeOrDiscount == "") {
                        strProductSabFreeOrDiscount = cursor2
                                .getString(LoncolumnIndex);
                    }

                    ////// System.out.println("Discount Abhinav = "+ strProductSabFreeOrDiscount);
                    cursor2.moveToNext();
                    // cursor.close();
                }

                strProductSabFreeOrDiscount = strProductSabFreeOrDiscount;

            }

        } finally {
            cursor2.close();
        }

        return strProductSabFreeOrDiscount;
    }

    // changes by sunil for Summary in Tab
    public int fnCountDataIntblSyncSummuryForProductDetails() {


        Cursor cursorE2 = db.rawQuery("SELECT Count(SkuName) FROM tblSyncSummuryForProductDetails", null);

        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++) {
                    if (!cursorE2.isNull(0)) {
                        chkI = Integer.parseInt(cursorE2.getString(0));
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public int fnCountDataIntblStoreProdcutPurchaseDetails(int Sstat) {
        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT ProductShortName FROM tblTmpInvoiceDetails where Sstat='" + Sstat + "' and  (OrderQty<>0 OR SampleQuantity<>0 OR FreeQty<>0)", null);

        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++) {
                    if (!cursorE2.isNull(0)) {
                        chkI = cursorE2.getCount();
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public int fnCountNumberOfSKUForBothServerAndPDATable() {
        int returnvalue = 0;

        //int ServerTableCount=fnCountDataIntblSyncSummuryForProductDetails();
        //int PDATableCount=fnCountDataIntblStoreProdcutPurchaseDetails(4);


        Cursor cursorE1 = db.rawQuery("SELECT DISTINCT SkuName FROM  tblSyncSummuryForProductDetails", null);


        try {
            // System.out.println("Number of row for Value from Server Table Data :"+cursorE1.getCount());
            if (cursorE1.getCount() > 0) {
                returnvalue = cursorE1.getCount();
            }
        } finally {
            cursorE1.close();
        }


        //Cursor cursorE2;
        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT ProductShortName FROM tblTmpInvoiceDetails where Sstat='" + 4 + "' and  (OrderQty<>0 OR SampleQuantity<>0 OR FreeQty<>0)", null);


        try {
            // System.out.println("Number of row for Value from PDA Table Data :"+cursorE2.getCount());
            if (cursorE2.getCount() > 0) {
                returnvalue = returnvalue + cursorE2.getCount();
            }
        } finally {
            cursorE2.close();
        }


        Cursor cursorE3 = db.rawQuery("SELECT DISTINCT SkuName FROM tblSyncSummuryForProductDetails  a INNER JOIN tblTmpInvoiceDetails b ON a.SkuName = b.ProductShortName where b.Sstat='" + 4 + "' and  (b.OrderQty<>0 OR SampleQuantity<>0 OR b.FreeQty<>0)", null);


        try {
            // System.out.println("Number of row for Value from Common Table Data :"+cursorE3.getCount());
            if (cursorE3.getCount() > 0) {
                returnvalue = returnvalue - cursorE3.getCount();
            }
        } finally {
            cursorE3.close();
        }

        return returnvalue;

    }

    public HashMap<String, String> fnAllProductnameForShowingInTable() {

        HashMap<String, String> map = new HashMap<String, String>();

        Cursor cursorE1 = db.rawQuery("SELECT DISTINCT SkuName FROM  tblSyncSummuryForProductDetails", null);

        try {
            if (cursorE1.getCount() > 0) {
                if (cursorE1.moveToFirst()) {

                    for (int i = 0; i < cursorE1.getCount(); i++) {

                        // System.out.println("Ajeet and Amit row with Server Table Product Name"+ (String) cursorE1.getString(0).toString().trim() );
                        map.put((String) cursorE1.getString(0).toString().trim(), "1");
                        cursorE1.moveToNext();
                    }
                }
            }
        } finally {
            cursorE1.close();
        }

        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT SkuName FROM tblSyncSummuryForProductDetails  a INNER JOIN tblTmpInvoiceDetails b ON a.SkuName = b.ProductShortName where b.Sstat='" + 4 + "' and  (b.OrderQty<>0 OR SampleQuantity<>0 OR b.FreeQty<>0)", null);


        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i < cursorE2.getCount(); i++) {

                        // System.out.println("Ajeet and Amit row with Server Table Product Name Remove"+ (String) cursorE2.getString(0).toString().trim() );
                        map.remove((String) cursorE2.getString(0).toString().trim());
                        cursorE2.moveToNext();
                    }
                }
            }
        } finally {
            cursorE2.close();
        }


        //Cursor cursorE2;
        Cursor cursorE3 = db.rawQuery("SELECT DISTINCT ProductShortName FROM tblTmpInvoiceDetails where Sstat='" + 4 + "' and  (OrderQty<>0 OR SampleQuantity<>0 OR FreeQty<>0)", null);


        try {

            if (cursorE3.getCount() > 0) {
                if (cursorE3.moveToFirst()) {

                    for (int i = 0; i < cursorE3.getCount(); i++) {
                        // System.out.println("Ajeet and Amit with PDA Table Product Name"+ (String) cursorE3.getString(0).toString().trim() );

                        map.put((String) cursorE3.getString(0).toString().trim(), "1");
                        cursorE3.moveToNext();
                    }
                }
            }
        } finally {
            cursorE3.close();
        }



				/*Cursor cursorE4 = db.rawQuery("SELECT DISTINCT SkuName FROM tblSyncSummuryForProductDetails  a INNER JOIN tblTmpInvoiceDetails b ON a.SkuName = b.ProductShortName where b.Sstat='"+4+"' and  (b.OrderQty<>0 OR SampleQuantity<>0 OR b.FreeQty<>0)", null);


				try
				{
					if(cursorE4.getCount()>0)
					{
						if (cursorE4.moveToFirst())
				         {

				             for (int i = 0; i < cursorE4.getCount(); i++)
				                 {

				            	 // System.out.println("Ajeet and Amit with PDA Table Product Name remove "+ (String) cursorE4.getString(0).toString().trim() );
						          map.remove((String) cursorE4.getString(0).toString().trim());
					                  cursorE4.moveToNext();
				                 }
			              }
					}
				}
				finally
				{
					cursorE4.close();
				}*/

        return map;

    }

    public String fnGetTotalSales(int Sstat) {
        int LoncolumnIndex = 0;
        String TotSalesValue = "0.0";


        Cursor cursor2 = db.rawQuery("SELECT SUM(InvoiceVal) FROM tblTmpInvoiceHeader where Sstat='" + Sstat + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        TotSalesValue = "" + Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                        ////// System.out.println("Abhinav Raj Summary New TotSalesValue from function: "+TotSalesValue);
                        cursor2.moveToNext();
                    }

                }

            }
            return TotSalesValue.replace(",", "");//(TotSalesValue, ",");
        } finally {
            cursor2.close();
        }
    }

    public String fnGetTotalDiscount(int Sstat) {
        int LoncolumnIndex = 0;
        String TotDiscountValue = "0.0";


        Cursor cursor2 = db.rawQuery("SELECT SUM(TotalDis) FROM tblTmpInvoiceHeader where Sstat='" + Sstat + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        TotDiscountValue = "" + Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                        cursor2.moveToNext();
                    }

                }

            }
            return TotDiscountValue;
        } finally {
            cursor2.close();
        }
    }

    public String fnCalculateKGLitersForTabOne() {
        int Sstat = 4;
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String[] UniqueKgLiters;
        UniqueKgLiters = fnarrUniqueKgLiters();//fnarrUniqueKgLitersDisplayUnit();
        String val = "";
        String totalKGSales = "0.0";
        String totalSampleSalesKG = "0.0";
        String totalFreeQtySalesKG = "0.0";
        String totalLitersSales = "0.0";
        String totalSampleSalesLT = "0.0";
        String totalFreeQtySalesLT = "0.0";
        String totalDiscountLT = "0.0";
        String totalDiscountKG = "0.0";


        String totalOverallKGSales = "0.0";
        String totalOverallSampleSalesKG = "0.0";
        String totalOverallFreeQtySalesKG = "0.0";
        String totalOverallLitersSales = "0.0";
        String totalOverallSampleSalesLT = "0.0";
        String totalOverallFreeQtySalesLT = "0.0";
        String totalOverallDiscountLT = "0.0";
        String totalOverallDiscountKG = "0.0";

        String FinalReturnValue = "";
        String ppName = "";
        String pDisplayUnit = "";
        for (int kk = 0; kk < UniqueKgLiters.length; kk++) {
            StringTokenizer tokensUniqueKgLiters = new StringTokenizer(String.valueOf(UniqueKgLiters[kk]), "^");

            ppName = tokensUniqueKgLiters.nextToken().trim();

            val = "";
            val = tokensUniqueKgLiters.nextToken().trim();//UniqueKgLiters[kk].toString().trim();

            // change by sunil
            //val="0";
            //// System.out.println("Abhi UniqueKgLiters[kk] :"+UniqueKgLiters[kk]);

            pDisplayUnit = tokensUniqueKgLiters.nextToken().trim();
            //// System.out.println("Abhi pDisplayUnit:" +pDisplayUnit);
            //if(val.contains("0g"))
            if (pDisplayUnit.contains("Kg")) {
                //// System.out.println("Abhi getting Kg");
                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName='" + ppName + "' and Sstat='" + Sstat + "'", null);
                try {
                    //val=val.replace("g", "");
                    if (cursor2.getCount() > 0) {


                        if (cursor2.moveToFirst()) {

                            for (int i = 0; i < cursor2.getCount(); i++) {
                                totalKGSales = "0.0";
                                totalFreeQtySalesKG = "0.0";
                                totalSampleSalesKG = "0.0";
                                if (!cursor2.isNull(LoncolumnIndex)) {
                                    totalKGSales = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalKGSales-:"+ totalKGSales);
                                }

                                if (!cursor2.isNull(LoncolumnIndex1)) {
                                    totalFreeQtySalesKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();
                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalFreeQtySalesKG-:"+ totalFreeQtySalesKG);
                                }
                                if (!cursor2.isNull(LoncolumnIndex2)) {
                                    totalSampleSalesKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalSampleSalesKG-:"+ totalSampleSalesKG);
                                    //
                                }


                                //Write Here

                                totalOverallKGSales = "" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(totalKGSales));
                                //////// System.out.println("AbhiSunil  totalOverallKGSales-:"+ totalOverallKGSales);
                                totalOverallFreeQtySalesKG = "" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(totalFreeQtySalesKG));
                                //////// System.out.println("AbhiSunil  totalOverallFreeQtySalesKG-:"+ totalOverallFreeQtySalesKG);
                                totalOverallSampleSalesKG = "" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(totalSampleSalesKG));
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
            //if(val.contains("0ml"))
            if (pDisplayUnit.contains("Lt")) {
                //// System.out.println("Abhi getting Liter");

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName ='" + ppName + "' and Sstat='" + Sstat + "'", null);
                try {
                    //// System.out.println("Abhi  cursor2.getCount() :"+cursor2.getCount());
                    //val=val.replace("ml", "");
                    if (cursor2.getCount() > 0) {


                        if (cursor2.moveToFirst()) {

                            for (int i = 0; i < cursor2.getCount(); i++) {
                                totalLitersSales = "0.0";
                                totalSampleSalesLT = "0.0";
                                totalFreeQtySalesLT = "0.0";

                                if (!cursor2.isNull(LoncolumnIndex)) {

                                    totalLitersSales = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	////// System.out.println("totalLitersSales :"+totalLitersSales);
                                    totalOverallLitersSales = "" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(totalLitersSales));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }

                                if (!cursor2.isNull(LoncolumnIndex1)) {
                                    totalFreeQtySalesLT = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //////// System.out.println("totalFreeQtySalesLT :"+totalFreeQtySalesLT);
                                    totalOverallFreeQtySalesLT = "" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(totalFreeQtySalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }
                                if (!cursor2.isNull(LoncolumnIndex2)) {
                                    totalSampleSalesLT = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    totalOverallSampleSalesLT = "" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(totalSampleSalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //	////// System.out.println("totalSampleSalesLT :"+totalSampleSalesLT);
                                }


                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }


            }
        }

        //// System.out.println("Abhi Sunil  totalOverallKGSales Before:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG Before:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG Before:" +totalOverallSampleSalesKG);

        totalOverallKGSales = ConvertGramToKilo(totalOverallKGSales);

        totalOverallFreeQtySalesKG = ConvertGramToKilo(totalOverallFreeQtySalesKG);

        totalOverallSampleSalesKG = ConvertGramToKilo(totalOverallSampleSalesKG);

        //// System.out.println("Abhi Sunil  totalOverallKGSales After:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG After:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG After:" +totalOverallSampleSalesKG);

        totalOverallLitersSales = ConvertMLToLiters(totalOverallLitersSales);

        totalOverallFreeQtySalesLT = ConvertMLToLiters(totalOverallFreeQtySalesLT);

        totalOverallSampleSalesLT = ConvertMLToLiters(totalOverallSampleSalesLT);


        String strGettblSyncSummuryDetailsKGLitersDetails = "";
        strGettblSyncSummuryDetailsKGLitersDetails = fnGettblSyncSummuryDetailsKGLitersDetails();

        StringTokenizer tokensGettblSyncSummuryDetailsKGLitersDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsKGLitersDetails), "_");

        totalOverallKGSales = "" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesKG = "" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesKG = "" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallLitersSales = "" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesLT = "" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesLT = "" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));


        Double DtotalOverallKGSales = Double.parseDouble(totalOverallKGSales);
        DtotalOverallKGSales = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));

        Double DtotalOverallFreeQtySalesKG = Double.parseDouble(totalOverallFreeQtySalesKG);
        DtotalOverallFreeQtySalesKG = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));

        Double DtotalOverallSampleSalesKG = Double.parseDouble(totalOverallSampleSalesKG);
        DtotalOverallSampleSalesKG = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));

        Double DtotalOverallLitersSales = Double.parseDouble(totalOverallLitersSales);
        DtotalOverallLitersSales = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));

        Double DtotalOverallFreeQtySalesLT = Double.parseDouble(totalOverallFreeQtySalesLT);
        DtotalOverallFreeQtySalesLT = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));

        Double DtotalOverallSampleSalesLT = Double.parseDouble(totalOverallSampleSalesLT);
        DtotalOverallSampleSalesLT = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));


        //DtotalOverallKGSales = Double.parseDouble(decimalFormat.format(DtotalOverallKGSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));
        FinalReturnValue = FinalReturnValue + DtotalOverallKGSales + " Units";

        // DtotalOverallFreeQtySalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallFreeQtySalesKG + " Units";

        // DtotalOverallSampleSalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallSampleSalesKG + " Units";

        // DtotalOverallLitersSales = Double.parseDouble(decimalFormat.format(DtotalOverallLitersSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallLitersSales + " LT";

        // DtotalOverallFreeQtySalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallFreeQtySalesLT + " LT";

        //DtotalOverallSampleSalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallSampleSalesLT + " LT";


        //FinalReturnValue= "" + DtotalOverallKGSales + " KG" + "^" + DtotalOverallFreeQtySalesKG + " KG" + "^" + DtotalOverallSampleSalesKG + " KG" + "^" + DtotalOverallLitersSales + " LT" + "^" + DtotalOverallFreeQtySalesLT + " LT" + "^" + DtotalOverallSampleSalesLT + " LT";
        //// System.out.println("Abhi  FinalReturnValue :"+FinalReturnValue);
        return FinalReturnValue;

    }

    public String[] fnarrUniqueProductsSaleSummry_NewWay(int Sstat) {

        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductShortName FROM tblTmpInvoiceDetails where Sstat='" + Sstat + "' and  (OrderQty<>0 OR SampleQuantity<>0 OR Stock<>0 OR FreeQty<>0) ", null);
        //Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductShortName, KGLiter, DisplayUnit FROM tblProductListMaster", null);
        try {
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(0)) {
                        UniqueProductShortName[i] = cursor2.getString(0).toString();
                        //// System.out.println("Anuj ProductShortName sunil: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"KGLiter sunil: "+(String) cursor2.getString(LoncolumnIndex1));

                        String aa[] = fnarrUniqueKGLiterAndDisplayUnitBasedProductName(UniqueProductShortName[i]);
                        UniqueProductShortName[i] = UniqueProductShortName[i] + "^" + aa[0];

                        // System.out.println("Aajad ProductShortName sunil: "+UniqueProductShortName[i]);


                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public String[] fnarrUniqueKGLiterAndDisplayUnitBasedProductName(String ProductShortName) {

        Cursor cursor2 = db.rawQuery("SELECT  KGLiter, DisplayUnit FROM tblProductListMaster where ProductShortName= '" + ProductShortName + "' ", null);
        try {
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(0)) {
                        UniqueProductShortName[i] = cursor2.getString(0).toString() + "^" + cursor2.getString(1).toString();
                        // System.out.println("Aajad123 ProductShortName sunil: "+UniqueProductShortName[i]);

                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public String fnCalculateKGLitersNotSync(int Sstat) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String[] UniqueKgLiters;
        UniqueKgLiters = fnarrUniqueProductsSaleSummry_NewWay(Sstat);//fnarrUniqueKgLitersDisplayUnit();
        String val = "";
        String totalKGSales = "0.0";
        String totalSampleSalesKG = "0.0";
        String totalFreeQtySalesKG = "0.0";
        String totalLitersSales = "0.0";
        String totalSampleSalesLT = "0.0";
        String totalFreeQtySalesLT = "0.0";
        String totalDiscountLT = "0.0";
        String totalDiscountKG = "0.0";


        String totalOverallKGSales = "0.0";
        String totalOverallSampleSalesKG = "0.0";
        String totalOverallFreeQtySalesKG = "0.0";
        String totalOverallLitersSales = "0.0";
        String totalOverallSampleSalesLT = "0.0";
        String totalOverallFreeQtySalesLT = "0.0";
        String totalOverallDiscountLT = "0.0";
        String totalOverallDiscountKG = "0.0";

        String FinalReturnValue = "";
        String ppName = "";
        String pDisplayUnit = "";
        for (int kk = 0; kk < UniqueKgLiters.length; kk++) {
            StringTokenizer tokensUniqueKgLiters = new StringTokenizer(String.valueOf(UniqueKgLiters[kk]), "^");

            ppName = tokensUniqueKgLiters.nextToken().trim();

            val = "";
            val = tokensUniqueKgLiters.nextToken().trim();//UniqueKgLiters[kk].toString().trim();

            // change by sunil
            //val="0";
            //// System.out.println("Abhi UniqueKgLiters[kk] :"+UniqueKgLiters[kk]);

            pDisplayUnit = tokensUniqueKgLiters.nextToken().trim();
            //// System.out.println("Abhi pDisplayUnit:" +pDisplayUnit);
            //if(val.contains("0g"))
            if (pDisplayUnit.contains("Kg")) {
                //// System.out.println("Abhi getting Kg");
                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName='" + ppName + "' and Sstat='" + Sstat + "'", null);
                try {
                    //val=val.replace("g", "");
                    if (cursor2.getCount() > 0) {


                        if (cursor2.moveToFirst()) {

                            for (int i = 0; i < cursor2.getCount(); i++) {
                                totalKGSales = "0.0";
                                totalFreeQtySalesKG = "0.0";
                                totalSampleSalesKG = "0.0";
                                if (!cursor2.isNull(LoncolumnIndex)) {
                                    totalKGSales = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalKGSales-:"+ totalKGSales);
                                }

                                if (!cursor2.isNull(LoncolumnIndex1)) {
                                    totalFreeQtySalesKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();
                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalFreeQtySalesKG-:"+ totalFreeQtySalesKG);
                                }
                                if (!cursor2.isNull(LoncolumnIndex2)) {
                                    totalSampleSalesKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalSampleSalesKG-:"+ totalSampleSalesKG);
                                    //
                                }


                                //Write Here

                                totalOverallKGSales = "" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(totalKGSales));
                                //////// System.out.println("AbhiSunil  totalOverallKGSales-:"+ totalOverallKGSales);
                                totalOverallFreeQtySalesKG = "" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(totalFreeQtySalesKG));
                                //////// System.out.println("AbhiSunil  totalOverallFreeQtySalesKG-:"+ totalOverallFreeQtySalesKG);
                                totalOverallSampleSalesKG = "" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(totalSampleSalesKG));
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
            //if(val.contains("0ml"))
            if (pDisplayUnit.contains("Lt")) {
                //// System.out.println("Abhi getting Liter");

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName ='" + ppName + "' and Sstat='" + Sstat + "'", null);
                try {
                    //// System.out.println("Abhi  cursor2.getCount() :"+cursor2.getCount());
                    //val=val.replace("ml", "");
                    if (cursor2.getCount() > 0) {


                        if (cursor2.moveToFirst()) {

                            for (int i = 0; i < cursor2.getCount(); i++) {
                                totalLitersSales = "0.0";
                                totalSampleSalesLT = "0.0";
                                totalFreeQtySalesLT = "0.0";

                                if (!cursor2.isNull(LoncolumnIndex)) {

                                    totalLitersSales = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	////// System.out.println("totalLitersSales :"+totalLitersSales);
                                    totalOverallLitersSales = "" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(totalLitersSales));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }

                                if (!cursor2.isNull(LoncolumnIndex1)) {
                                    totalFreeQtySalesLT = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //////// System.out.println("totalFreeQtySalesLT :"+totalFreeQtySalesLT);
                                    totalOverallFreeQtySalesLT = "" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(totalFreeQtySalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }
                                if (!cursor2.isNull(LoncolumnIndex2)) {
                                    totalSampleSalesLT = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    totalOverallSampleSalesLT = "" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(totalSampleSalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //	////// System.out.println("totalSampleSalesLT :"+totalSampleSalesLT);
                                }


                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }


            }
        }

        //// System.out.println("Abhi Sunil  totalOverallKGSales Before:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG Before:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG Before:" +totalOverallSampleSalesKG);

        totalOverallKGSales = ConvertGramToKilo(totalOverallKGSales);

        totalOverallFreeQtySalesKG = ConvertGramToKilo(totalOverallFreeQtySalesKG);

        totalOverallSampleSalesKG = ConvertGramToKilo(totalOverallSampleSalesKG);

        //// System.out.println("Abhi Sunil  totalOverallKGSales After:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG After:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG After:" +totalOverallSampleSalesKG);

        totalOverallLitersSales = ConvertMLToLiters(totalOverallLitersSales);

        totalOverallFreeQtySalesLT = ConvertMLToLiters(totalOverallFreeQtySalesLT);

        totalOverallSampleSalesLT = ConvertMLToLiters(totalOverallSampleSalesLT);


        String strGettblSyncSummuryDetailsKGLitersDetails = "0.0_0.0_0.0_0.0_0.0_0.0_0.0_0.0";
        //strGettblSyncSummuryDetailsKGLitersDetails=fnGettblSyncSummuryDetailsKGLitersDetails();

        StringTokenizer tokensGettblSyncSummuryDetailsKGLitersDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsKGLitersDetails), "_");

        totalOverallKGSales = "" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesKG = "" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesKG = "" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallLitersSales = "" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesLT = "" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesLT = "" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));


        Double DtotalOverallKGSales = Double.parseDouble(totalOverallKGSales);
        DtotalOverallKGSales = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));

        Double DtotalOverallFreeQtySalesKG = Double.parseDouble(totalOverallFreeQtySalesKG);
        DtotalOverallFreeQtySalesKG = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));

        Double DtotalOverallSampleSalesKG = Double.parseDouble(totalOverallSampleSalesKG);
        DtotalOverallSampleSalesKG = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));

        Double DtotalOverallLitersSales = Double.parseDouble(totalOverallLitersSales);
        DtotalOverallLitersSales = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));

        Double DtotalOverallFreeQtySalesLT = Double.parseDouble(totalOverallFreeQtySalesLT);
        DtotalOverallFreeQtySalesLT = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));

        Double DtotalOverallSampleSalesLT = Double.parseDouble(totalOverallSampleSalesLT);
        DtotalOverallSampleSalesLT = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));


        //DtotalOverallKGSales = Double.parseDouble(decimalFormat.format(DtotalOverallKGSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));
        FinalReturnValue = FinalReturnValue + DtotalOverallKGSales + " Units";

        // DtotalOverallFreeQtySalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallFreeQtySalesKG + " Units";

        // DtotalOverallSampleSalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallSampleSalesKG + " Units";

        // DtotalOverallLitersSales = Double.parseDouble(decimalFormat.format(DtotalOverallLitersSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallLitersSales + " LT";

        // DtotalOverallFreeQtySalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallFreeQtySalesLT + " LT";

        //DtotalOverallSampleSalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallSampleSalesLT + " LT";


        //FinalReturnValue= "" + DtotalOverallKGSales + " KG" + "^" + DtotalOverallFreeQtySalesKG + " KG" + "^" + DtotalOverallSampleSalesKG + " KG" + "^" + DtotalOverallLitersSales + " LT" + "^" + DtotalOverallFreeQtySalesLT + " LT" + "^" + DtotalOverallSampleSalesLT + " LT";
        //// System.out.println("Abhi  FinalReturnValue :"+FinalReturnValue);
        return FinalReturnValue;

    }

    public String[] fnCalculateProductsSaleSummryForSubmitAndNotSentToServer(int Sstat) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String[] UniqueProductsSaleSummry;
        UniqueProductsSaleSummry = fnarrUniqueProductsSaleSummry_NewWay(Sstat);   // 121 Product will come


        // System.out.println("Check data 1 UniqueProductsSaleSummry :"+UniqueProductsSaleSummry.length);

        String val = "";
        String SummryPName = "";
        String SDisplayName = "";
        String SDisplayUnit = "";


        String SumOQty[] = new String[UniqueProductsSaleSummry.length];
        String SumFQty[] = new String[UniqueProductsSaleSummry.length];
        String SumSQty[] = new String[UniqueProductsSaleSummry.length];


        String SumOQtyKG[] = new String[UniqueProductsSaleSummry.length];
        String SumFQtyKG[] = new String[UniqueProductsSaleSummry.length];
        String SumSQtyKG[] = new String[UniqueProductsSaleSummry.length];


        String SummryProductName[] = new String[UniqueProductsSaleSummry.length];
        String SummryDisplayUnit[] = new String[UniqueProductsSaleSummry.length];

        String FinalReturnValue[] = new String[UniqueProductsSaleSummry.length];

        String LineSkuWise[] = new String[UniqueProductsSaleSummry.length];


        for (int kk = 0; kk < UniqueProductsSaleSummry.length; kk++) {
            val = "";
            SummryPName = "";
            SDisplayUnit = "";
            String getVal = "";
            getVal = UniqueProductsSaleSummry[kk].toString().trim();

            StringTokenizer tokens = new StringTokenizer(String.valueOf(getVal), "^");
            SummryPName = tokens.nextToken().trim();
            val = tokens.nextToken().trim();
            SDisplayUnit = tokens.nextToken().trim();


            SummryProductName[kk] = SummryPName;
            SummryDisplayUnit[kk] = SDisplayUnit;


            LineSkuWise[kk] = fnCalculateLinesSkuWise(SummryPName);

            // by sunil
            // Sstat = 3

            //if(val.contains("0g"))
            if (SDisplayUnit.contains("Kg")) {

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity) FROM  tblTmpInvoiceDetails where ProductShortName ='" + SummryPName + "' and Sstat='" + Sstat + "'", null);
                try {
                    //val=val.replace("g", "");
                    if (cursor2.getCount() > 0) {


                        if (cursor2.moveToFirst()) {

                            for (int i = 0; i < cursor2.getCount(); i++) {

                                if (!cursor2.isNull(LoncolumnIndex)) {
                                    SumOQty[kk] = "" + Integer.parseInt(cursor2.getString(LoncolumnIndex));
                                    //////////// System.out.println("SummryPName SumOQty[kk]"+SumOQty[kk]);
                                    String OrderKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //////////// System.out.println("SummryPName OrderKG"+OrderKG);
                                    SumOQtyKG[kk] = ConvertGramToKilo(OrderKG);
                                    //	cursor2.moveToNext();
                                } else {
                                    SumOQty[kk] = "" + "0";
                                    SumOQtyKG[kk] = "" + "0.0";
                                }

                                if (!cursor2.isNull(LoncolumnIndex1)) {
                                    SumFQty[kk] = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)));
                                    String FreeKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));

                                    SumFQtyKG[kk] = ConvertGramToKilo(FreeKG);

                                    //	cursor2.moveToNext();
                                } else {
                                    SumFQty[kk] = "" + "0";
                                    SumFQtyKG[kk] = "0.0";
                                }
                                if (!cursor2.isNull(LoncolumnIndex2)) {
                                    SumSQty[kk] = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)));
                                    String SampleKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    SumSQtyKG[kk] = ConvertGramToKilo(SampleKG);

                                } else {
                                    SumSQty[kk] = "0";
                                    SumSQtyKG[kk] = "0.0";
                                }
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
            //if(val.contains("0ml"))
            if (SDisplayUnit.contains("Lt")) {

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity) FROM  tblTmpInvoiceDetails where ProductShortName ='" + SummryPName + "' and Sstat='" + Sstat + "'", null);
                try {
                    //val=val.replace("ml", "");
                    if (cursor2.getCount() > 0) {


                        if (cursor2.moveToFirst()) {

                            for (int i = 0; i < cursor2.getCount(); i++) {

                                if (!cursor2.isNull(LoncolumnIndex)) {
                                    SumOQty[kk] = "" + Integer.parseInt(cursor2.getString(LoncolumnIndex));
                                    String OrderKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    SumOQtyKG[kk] = ConvertMLToLiters(OrderKG);

                                } else {
                                    SumOQty[kk] = "" + "0";
                                    SumOQtyKG[kk] = "" + "0.0";
                                }

                                if (!cursor2.isNull(LoncolumnIndex1)) {
                                    SumFQty[kk] = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)));
                                    String FreeKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    SumFQtyKG[kk] = ConvertMLToLiters(FreeKG);

                                } else {
                                    SumFQty[kk] = "" + "0";
                                    SumFQtyKG[kk] = "0.0";
                                }
                                if (!cursor2.isNull(LoncolumnIndex2)) {
                                    SumSQty[kk] = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)));
                                    String SampleKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    SumSQtyKG[kk] = ConvertMLToLiters(SampleKG);

                                } else {
                                    SumSQty[kk] = "0";
                                    SumSQtyKG[kk] = "0.0";
                                }
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
        }


        for (int kk = 0; kk < UniqueProductsSaleSummry.length; kk++) {

            //////////// System.out.println("Sunil Check Line UniqueProductsSaleSummry :"+UniqueProductsSaleSummry[kk]);

            if (false) {
            } else {
                FinalReturnValue[kk] = SummryProductName[kk] + "^" + SumOQty[kk] + "^" + SumFQty[kk] + "^" + SumSQty[kk] + "^" + SumOQtyKG[kk] + "^" + SumFQtyKG[kk] + "^" + SumSQtyKG[kk] + "^" + LineSkuWise[kk];
                //////////// System.out.println("FinalReturnValue[kk] :" + FinalReturnValue[kk]);
            }

        }


        return FinalReturnValue;

    }

    public String fnGetFullSummryDetailsForSaleForTabTwoAndTabThree(int Sstat) {

        String FullSummryDetailsForSale;
        FullSummryDetailsForSale = "";

        int TotActualCall = 0;
        TotActualCall = fnGetActualCall();

        ////// System.out.println("TotActualCall: "	+ TotActualCall);

        int TotProductiveCall = 0;
        TotProductiveCall = fnGetProductiveCall();

        ////// System.out.println("TotProductiveCall: "	+ TotProductiveCall);

        String TotSalesValue = "0.00";
        TotSalesValue = fnGetTotalSales(Sstat);//fnGetTotalDiscount


        String TotDiscountValue = "0.00";
        TotDiscountValue = fnGetTotalDiscount(Sstat);


        ////// System.out.println("TotSalesValue: "	+ TotSalesValue);
        ////// System.out.println("fnGetTotalDiscount: "	+ TotDiscountValue);
        //String strGettblSyncSummuryDetailsCallDetails="";
        //strGettblSyncSummuryDetailsCallDetails=fnGettblSyncSummuryDetailsCallDetails();
        ////// System.out.println("strGettblSyncSummuryDetailsCallDetails: "	+ strGettblSyncSummuryDetailsCallDetails);
        //StringTokenizer tokensGettblSyncSummuryDetailsCallDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsCallDetails), "_");

				/*TotActualCall= TotActualCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
				TotProductiveCall= TotProductiveCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
				TotSalesValue="" + (Double.parseDouble(TotSalesValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
				TotDiscountValue="" + (Double.parseDouble(TotDiscountValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
				*/
        FullSummryDetailsForSale = TotActualCall + "_" + TotProductiveCall + "_" + TotSalesValue + "_" + TotDiscountValue;


        ////// System.out.println("FullSummryDetailsForSale: "	+ FullSummryDetailsForSale);

        return FullSummryDetailsForSale;
    }

    public String fnGetFullSummryDetailsForSaleForTabOne() {

        String FullSummryDetailsForSale;
        FullSummryDetailsForSale = "";

        int TotActualCall = 0;
        TotActualCall = fnGetActualCall();

        ////// System.out.println("TotActualCall: "	+ TotActualCall);

        int TotProductiveCall = 0;
        TotProductiveCall = fnGetProductiveCall();

        ////// System.out.println("TotProductiveCall: "	+ TotProductiveCall);

        String TotSalesValue = "0.00";
        TotSalesValue = fnGetTotalSales(4);//fnGetTotalDiscount


        String TotDiscountValue = "0.00";
        TotDiscountValue = fnGetTotalDiscount(4);


        ////// System.out.println("TotSalesValue: "	+ TotSalesValue);
        ////// System.out.println("fnGetTotalDiscount: "	+ TotDiscountValue);
        String strGettblSyncSummuryDetailsCallDetails = "";
        strGettblSyncSummuryDetailsCallDetails = fnGettblSyncSummuryDetailsCallDetails();
        ////// System.out.println("strGettblSyncSummuryDetailsCallDetails: "	+ strGettblSyncSummuryDetailsCallDetails);
        StringTokenizer tokensGettblSyncSummuryDetailsCallDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsCallDetails), "_");

        TotActualCall = TotActualCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
        TotProductiveCall = TotProductiveCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
        TotSalesValue = "" + (Double.parseDouble(TotSalesValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
        TotDiscountValue = "" + (Double.parseDouble(TotDiscountValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
        FullSummryDetailsForSale = TotActualCall + "_" + TotProductiveCall + "_" + TotSalesValue + "_" + TotDiscountValue;


        ////// System.out.println("FullSummryDetailsForSale: "	+ FullSummryDetailsForSale);

        return FullSummryDetailsForSale;
    }

    public String[] fnCalculateProductsSaleSummryForTabOneNew() {
        int Sstat = 4;
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        //String[] UniqueProductsSaleSummry;
        //UniqueProductsSaleSummry=fnarrUniqueProductsSaleSummry();


        int ServerTableCount = fnCountDataIntblSyncSummuryForProductDetails();
        int PDATableCount = fnCountDataIntblStoreProdcutPurchaseDetails(4);
        int noOfRow = 0;

		/*// System.out.println("Testing Sunil Value by new function ServerTableCount :"+ServerTableCount);
		// System.out.println("Testing Sunil Value by new function PDATableCount :"+PDATableCount);*/

        if (ServerTableCount > 0 && PDATableCount > 0) {
            noOfRow = fnCountNumberOfSKUForBothServerAndPDATable();
        } else if (ServerTableCount > 0) {
            noOfRow = fnCountDataIntblSyncSummuryForProductDetails();
        } else if (PDATableCount > 0) {
            noOfRow = fnCountDataIntblStoreProdcutPurchaseDetails(4);
        }

        String SummryProductName[] = new String[noOfRow];

        // System.out.println("Checking the number of row "+noOfRow);

        HashMap<String, String> hmapProductName = new HashMap<String, String>();

        hmapProductName = fnAllProductnameForShowingInTable();
        // System.out.println("Ajeet and Amit row with Product name length"+ hmapProductName.size() );
        int ii = 0;
        for (String s : hmapProductName.keySet()) {
            // System.out.println("Ajeet and Amit row with final  "+ s );
            SummryProductName[ii] = s;
            ii++;
        }


        String val = "";
        String SummryPName = "";
        String SDisplayName = "";
        String SDisplayUnit = "";


        String SumOQty[] = new String[noOfRow];
        String SumFQty[] = new String[noOfRow];
        String SumSQty[] = new String[noOfRow];
        String SumOVal[] = new String[noOfRow];
        String SumDVal[] = new String[noOfRow];


        String SummryDisplayUnit[] = new String[noOfRow];

        String FinalReturnValue[] = new String[noOfRow];

        String LineSkuWise[] = new String[noOfRow];


        for (int kk = 0; kk < noOfRow; kk++) {

            String SumOfOQtyValue = "0";
            String SumOfFQtyValue = "0";
            String SumOfSQtyValue = "0";

            String ProductPrice = "0";
            String SumOfOrderValue = "0.0";
            String SumOfDiscountValue = "0.0";


            Cursor cursor1 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),ProductPrice,OrderVal,DisVal FROM  tblTmpInvoiceDetails where ProductShortName ='" + SummryProductName[kk] + "' and Sstat='" + Sstat + "'", null);
            try {
                if (cursor1.getCount() > 0) {
                    if (cursor1.moveToFirst()) {

                        for (int i = 0; i < cursor1.getCount(); i++) {

                            if (!cursor1.isNull(0)) {
                                SumOfOQtyValue = "" + Integer.parseInt(cursor1.getString(0));
                            }


                            if (!cursor1.isNull(1)) {
                                SumOfFQtyValue = "" + Integer.parseInt(cursor1.getString(1));
                            }


                            if (!cursor1.isNull(2)) {
                                SumOfSQtyValue = "" + Integer.parseInt(cursor1.getString(2));
                            }
                            if (!cursor1.isNull(3)) {
                                ProductPrice = cursor1.getString(3).toString().trim();
                            }
                            if (!cursor1.isNull(4)) {
                                SumOfOrderValue = cursor1.getString(4).toString().trim();
                            }
                            if (!cursor1.isNull(5)) {
                                SumOfDiscountValue = cursor1.getString(5).toString().trim();
                            }

                            cursor1.moveToNext();
                        }

                    }
                }

            } finally {
                cursor1.close();
            }

            Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQty),ProductPrice,OrderVal,DisVal FROM  tblSyncSummuryForProductDetails where SkuName ='" + SummryProductName[kk] + "'", null);
            try {
                if (cursor2.getCount() > 0) {
                    if (cursor2.moveToFirst()) {

                        for (int i = 0; i < cursor2.getCount(); i++) {

                            if (!cursor2.isNull(0)) {

                                SumOfOQtyValue = "" + (Integer.parseInt(SumOfOQtyValue) + Integer.parseInt(cursor2.getString(0)));
                            }


                            if (!cursor2.isNull(1)) {
                                SumOfFQtyValue = "" + (Integer.parseInt(SumOfFQtyValue) + Integer.parseInt(cursor2.getString(1)));
                            }


                            if (!cursor2.isNull(LoncolumnIndex2)) {
                                SumOfSQtyValue = "" + (Integer.parseInt(SumOfSQtyValue) + Integer.parseInt(cursor2.getString(2)));
                            }
                            if (!cursor2.isNull(3)) {
                                ProductPrice = cursor2.getString(3).toString().trim();
                            }
                            if (!cursor2.isNull(4)) {
                                SumOfOrderValue = "" + (Double.parseDouble(SumOfOrderValue) + Double.parseDouble(cursor2.getString(4)));
                            }
                            if (!cursor2.isNull(5)) {
                                SumOfDiscountValue = "" + (Double.parseDouble(SumOfDiscountValue) + Double.parseDouble(cursor2.getString(5)));
                            }


                            cursor2.moveToNext();
                        }

                    }
                }

            } finally {
                cursor2.close();
            }

			/*String SumOfOQtyValue="0";
			String SumOfFQtyValue="0";
			String SumOfSQtyValue="0";

			String ProductPrice;
			String SumOfOrderValue="0";
			String SumOfDiscountValue="0";*/

            SumOQty[kk] = SumOfOQtyValue;
            SumFQty[kk] = SumOfFQtyValue;
            SumSQty[kk] = SumOfSQtyValue;
            SumOVal[kk] = SumOfOrderValue;
            SumDVal[kk] = SumOfDiscountValue;

            FinalReturnValue[kk] = SummryProductName[kk] + "^" + SumOQty[kk] + "^" + SumFQty[kk] + "^" + SumSQty[kk] + "^" + ProductPrice + "^" + SumOVal[kk] + "^" + SumDVal[kk] + "^" + "0";


        }


        return FinalReturnValue;

    }

    public void deleteAlrtProductWithSlab(String storeId, String _productID, String _schSlabId, String pdaOrderID, String TmpInvoiceCodePDA) {
        //open();
        Cursor cur = db.rawQuery("Select ProductID from tblAlrtVal where StoreId ='" + storeId + "' and ProductID = '" + _productID + "' and schSlabId = '" + _schSlabId + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.DATABASE_TABLE_Main214, "StoreID=? AND ProductID=? AND schSlabId=? AND TmpInvoiceCodePDA=?", new String[]{storeId, _productID, _schSlabId, TmpInvoiceCodePDA});
        }

        // close();
    }

    public void deleteAlertValueSlab(String storeId, String _schSlabId, String pdaOrderID, String TmpInvoiceCodePDA) {
        //open();
        Cursor cur = db.rawQuery("Select ProductID from tblAlrtVal where StoreId ='" + storeId + "'  and schSlabId = '" + _schSlabId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.DATABASE_TABLE_Main214, "StoreID=? AND schSlabId=? AND  TmpInvoiceCodePDA=?", new String[]{storeId, _schSlabId, TmpInvoiceCodePDA});
        }

        //close();
    }

    public String fnGetMinSlabofSchemeID(String strSchemeID) {
        int LoncolumnIndex = 0;
        //////// System.out.println("strFPIDSlb strMaxSlb :" + strMaxSlb);
        String strProductSabFreeOrDiscount = "";

        Cursor cursor2 = db.rawQuery(
                "SELECT Min(SlabFrom) FROM tblSchemeDetails where SchemeID = '" + strSchemeID
                        + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (strProductSabFreeOrDiscount == "") {
                        strProductSabFreeOrDiscount = cursor2
                                .getString(LoncolumnIndex);
                    }

                    ////// System.out.println("Discount Abhinav = "+ strProductSabFreeOrDiscount);
                    cursor2.moveToNext();
                    // cursor.close();
                }

                strProductSabFreeOrDiscount = strProductSabFreeOrDiscount;

            }

        } finally {
            cursor2.close();
        }

        return strProductSabFreeOrDiscount;
    }

    public void reTruncateRouteMstrTbl() {
        db.execSQL("DELETE FROM tblRouteListMaster");
    }

    public String[] fnGetProductIDIDOnSchemeIdBasisNew(String SchemeID) {

        Cursor cursor = db.rawQuery("SELECT ProductID  FROM tblschemeProductMap where SchemeID='" + SchemeID + "'", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = cursor.getString(0);
                        ////// System.out.println("Abhi121 ProductID:" + CompleteResult[i].toString());
                        cursor.moveToNext();
                    }

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String[] fnGetAllProductIDsAgainstSchemeIDsofClickedProductScheme(String AllSchmeIDs) {

        Cursor cursor = db.rawQuery("SELECT ProductId FROM tblschemeProductMap where SchemeID  IN (" + AllSchmeIDs + ")", null); // where FreeProductID IN ("+AllFreeProductgainstSchemeID+")
        ////// System.out.println("New Logic SELECT ProductId FROM tblschemeProductMap where SchemeID  IN ("+AllSchmeIDs+")");
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = cursor.getString(0);
                        ////// System.out.println("Abhi121 fnGetAllProductIDsAgainstSchemeIDsofClickedProductScheme DISTINCT ProductID:" + CompleteResult[i].toString());
                        cursor.moveToNext();
                    }

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String[] fnGetAllSchemeIDsAgainstCommonFreeIDsofClickedProductScheme(String AllFreeProductgainstSchemeID) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT SchemeID FROM tblSchemeDetails where FreeProductID IN (" + AllFreeProductgainstSchemeID + ")", null); // where FreeProductID IN ("+AllFreeProductgainstSchemeID+")

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = cursor.getString(0);
                        ////// System.out.println("Abhi121 fnGetAllSchemeIDsAgainstCommonFreeIDs DISTINCT SchemeID:" + CompleteResult[i].toString());
                        cursor.moveToNext();
                    }

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String fnGetProdswithnewlogicNewNEw(String AllSchemeIds) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT FreeProductID FROM tblSchemeDetails where SchemeID IN (" + AllSchemeIds + ")", null);

        try {
            String CompleteResult = "";
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (CompleteResult.equals("")) {
                            CompleteResult = "'" + cursor.getString(0) + "'";
                        } else {
                            CompleteResult = CompleteResult + ",'" + cursor.getString(0) + "'";
                        }


                        cursor.moveToNext();
                    }
                    ////// System.out.println("All Products Against All Schemes:" + CompleteResult);
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String fnGetFreeProductIDetailswithnewlogicNew(String AllSchemeIds) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT FreeProductID FROM tblSchemeDetails where SchemeID IN (" + AllSchemeIds + ")", null);

        try {
            String CompleteResult = "";
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (CompleteResult.equals("")) {
                            CompleteResult = "'" + cursor.getString(0) + "'";
                        } else {
                            CompleteResult = CompleteResult + ",'" + cursor.getString(0) + "'";
                        }


                        cursor.moveToNext();
                    }
                    ////// System.out.println("All FreeProductID Against Scheme:" + CompleteResult);
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String[] fnGetDistinctFreeProductIDetails(String AllSchemeIds) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT FreeProductID FROM tblSchemeDetails where SchemeID IN (" + AllSchemeIds + ")", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = cursor.getString(0);
                        ////// System.out.println("Abhi121 FreeProductID:" + CompleteResult[i].toString());
                        cursor.moveToNext();
                    }

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String fnGetSchemeswithnewlogic(String AllFreeProductgainstSchemeID) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT SchemeID FROM tblSchemeDetails where FreeProductID IN (" + AllFreeProductgainstSchemeID + ")", null);

        try {
            String CompleteResult = "";
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (CompleteResult.equals("")) {
                            CompleteResult = "'" + cursor.getString(0) + "'";
                        } else {
                            CompleteResult = CompleteResult + ",'" + cursor.getString(0) + "'";
                        }


                        cursor.moveToNext();
                    }
                    ////// System.out.println("All SchemeIDs Against FreeProducts:" + CompleteResult);
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String fnGetFreeProductIDetailswithnewlogic(String SchemeID) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT FreeProductID FROM tblSchemeDetails where SchemeID='" + SchemeID + "'", null);

        try {
            String CompleteResult = "";
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (CompleteResult.equals("")) {
                            CompleteResult = "'" + cursor.getString(0) + "'";
                        } else {
                            CompleteResult = CompleteResult + ",'" + cursor.getString(0) + "'";
                        }


                        cursor.moveToNext();
                    }
                    ////// System.out.println("All FreeProductID Against Scheme:" + CompleteResult);
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public boolean countStockExists(String sID) {
        // int entryCount;
        Cursor cursorE2 = db.rawQuery(
                "SELECT SUM(Stock) FROM tblTransac WHERE StoreID ='" + sID
                        + "'", null);
        boolean chkI = false;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    ////// System.out.println("Stock prev.. entered!");

                    chkI = true;
                } else {
                    chkI = false;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String[] FetchStoreTransacFreeSampleQty(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;

        // int Stock,int OrderQty, Double OrderVal, int FreeQty, Double DisVal

        Cursor cursor = db.rawQuery(
                "SELECT SampleQuantity  FROM tblTransac WHERE StoreID ='"
                        + sID2Fetch + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];
            ;

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public String[] FetchStoreInvoiceData(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;
        int SnamecolumnIndex2 = 1;
        int SnamecolumnIndex3 = 2;
        int SnamecolumnIndex4 = 3;
        int SnamecolumnIndex5 = 4;
        int SnamecolumnIndex6 = 5;
        int SnamecolumnIndex7 = 6;
        int SnamecolumnIndex8 = 7;
        int SnamecolumnIndex9 = 8;
        int SnamecolumnIndex10 = 9;
        int SnamecolumnIndex11 = 10;
        int SnamecolumnIndex12 = 11;


        /*werewr
         * int SnamecolumnIndex11 = 10; int SnamecolumnIndex12 = 11; int
         * SnamecolumnIndex13 = 12;
         */

        // TotalBeforeTaxDis real not null, TaxAmt real not null, TotalDis real
        // not null, InvoiceVal real not null, FreeTotal integer not null);";

        // Cursor cursor =
        // db.rawQuery("SELECT TotalBeforeTaxDis, TaxAmt, TotalDis, InvoiceVal, FreeTotal, InvAfterDis, AddDis, AmtPrevDue, AmtColl, AmtOut, CreditAmt, InvoiceAfterCreditAmt, InvoiceOrginal FROM tblTmpInvoiceHeader WHERE StoreID ='"
        // + sID2Fetch + "'", null);
        Cursor cursor = db
                .rawQuery(
                        "SELECT TotalBeforeTaxDis, TaxAmt, TotalDis, InvoiceVal, FreeTotal, InvAfterDis, AddDis, AmtPrevDue, AmtColl, AmtOut, NoCoupon,TotalCoupunAmount FROM tblTmpInvoiceHeader WHERE StoreID ='" + sID2Fetch + "'", null);
        ////// System.out.println("FetchStoreInvoiceData store ............... called");
        try {

            String StoreName[] = new String[cursor.getCount()];


            if (cursor.moveToFirst()) {
                ////// System.out.println("FetchStoreInvoiceData store ............... cursor.getCount()" + cursor.getCount());
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex2)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex3)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex4)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex5)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex6)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex7)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex8)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex9)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex10)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex11)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex12)
                            .toString();// + "_" + (String)
                    // cursor.getString(SnamecolumnIndex11).toString()
                    // + "_" + (String)
                    // cursor.getString(SnamecolumnIndex12).toString()
                    // + "_" + (String)
                    // cursor.getString(SnamecolumnIndex13).toString();
                    ////// System.out.println("FetchStoreInvoiceData store ..............." + StoreName[i]);
                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public String[] FetchStoreTransacData(String sID2Fetch) {

        // id = getAllEntries();

        int SnamecolumnIndex1 = 0;
        int SnamecolumnIndex2 = 1;
        int SnamecolumnIndex3 = 2;
        int SnamecolumnIndex4 = 3;
        int SnamecolumnIndex5 = 4;
        int SnamecolumnIndex6 = 5;

        // int Stock,int OrderQty, Double OrderVal, int FreeQty, Double DisVal

        Cursor cursor = db
                .rawQuery(
                        "SELECT Stock, OrderQty, OrderVal, FreeQty, DisVal, SampleQuantity  FROM tblTransac WHERE StoreID ='"
                                + sID2Fetch + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];
            ;

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex2)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex3)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex4)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex5)
                            .toString()
                            + "_"
                            + (String) cursor.getString(SnamecolumnIndex6)
                            .toString();

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public String fnGetSchemeIdOnStoreTypeBasis(String strStoreType) {
        int LoncolumnIndex = 0;
        String strSchemeID = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT SchemeID FROM tblschemeStoreTypeMap where StoreTypeID="
                        + Integer.parseInt(strStoreType), null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strSchemeID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeID;
        } finally {
            cursor2.close();
        }

        /*
         * Double myLons[] = new Double[cursor2.getCount()];; if
         * (cursor2.moveToFirst()) { for (int i = 0; i < cursor2.getCount();
         * i++) { myLons[i] = cursor2.getDouble(LoncolumnIndex);
         * cursor2.moveToNext(); //cursor2.close(); //third try } // second
         * tried here: cursor2.close(); } cursor2.close(); // Original location
         * for cursor2.close() //db.close();
         *
         * return myLons;
         */
    }

    public String fnGetStoreTypeOnStoreIdBasis(String strStoreID) {

        Cursor cursorE2 = db.rawQuery("SELECT ifnull(StoreType,'0') FROM tblStoreList WHERE StoreID ='" + strStoreID + "'", null);
        String StoreType = "0";
        int ScodecolumnIndex = 0;
        try {

            if (cursorE2!=null && cursorE2.getCount()>0  && cursorE2.moveToFirst()) {
/*
                for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {*/
                    StoreType = (String) cursorE2.getString(ScodecolumnIndex)
                            .toString();
                /*    cursorE2.moveToNext();
                }*/
            }

        }
        catch (Exception ex)
        {

        }
        finally {
            if(cursorE2!=null)
            cursorE2.close();
        }
        return StoreType;
    }

    //public static String[] FetchLODqty(String ssStoreID,String CatID)
    public HashMap<String, String> FetchLODqty(String ssStoreID) {

        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;

        //hmapCtgryPrdctDetail= key=prdctId,val=CategoryID
        HashMap<String, String> hmapCtgryPrdctDetail = new HashMap<String, String>();


        //open();
        //tblPDAGetLODQty(StoreID text null,Date text null,SKUID text  null,Qty integer null,SKUName text null);";

		/*Cursor cursor = db.rawQuery("SELECT LastTransDate, Quantity FROM tblLastTransactionDetails where StoreID= '"
								+ ssStoreID + "' and CategoryID='"+CatID+"'", null);*/
		/*Cursor cursor = db.rawQuery("SELECT LastTransDate, Quantity FROM tblLastTransactionDetails where StoreID= '"
				+ ssStoreID + "'", null);*/
        Cursor cursor = db.rawQuery("SELECT Date,Qty,SKUID FROM tblPDAGetLODQty where StoreID= '"
                + ssStoreID + "'", null);

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {

                        if (cursor.getString(ScodecolumnIndex).toString().equals("NA")) {
                            hmapCtgryPrdctDetail.put((String) cursor.getString(2).toString(), "NA" + "-" + (String) cursor.getString(SnamecolumnIndex).toString());

                        } else {
                            String fullDate;
                            String convertedTXTdate;
                            String exDay;
                            String exMonth;
                            //// System.out.println("Sunil Total else part: ");

                            SimpleDateFormat format1 = new SimpleDateFormat("dd-MMM-yyyy", Locale.ENGLISH);
                            //SimpleDateFormat format2 = new SimpleDateFormat("dd-MMM-yyyy",Locale.ENGLISH);

                            Date date;
                            fullDate = (String) cursor.getString(ScodecolumnIndex).toString();
                            fullDate = tViewDate(fullDate);

                            StringTokenizer tokens = new StringTokenizer(String.valueOf(fullDate), "-");

                            exDay = tokens.nextToken().trim();
                            exMonth = tokens.nextToken().trim();
                            hmapCtgryPrdctDetail.put((String) cursor.getString(2).toString(), exDay + "-" + exMonth + "/" + (String) cursor.getString(SnamecolumnIndex).toString());
                            //StoreName[i] = exDay+"/"+exMonth+ "-"+(String)cursor.getString(SnamecolumnIndex).toString();

                        }
                        cursor.moveToNext();
                    }
                }
            }

		/*try {
			String StoreName[] = new String[cursor.getCount()];
			//// System.out.println("Sunil Total cursor.getCount() :"+cursor.getCount());

			if(cursor.getCount()>0)
			{
			if (cursor.moveToFirst()) {

				for (int i = 0; i <= (cursor.getCount() - 1); i++) {




					//// System.out.println("Sunil Total cursor :"+cursor.getString(ScodecolumnIndex).toString());

					try {
						} catch (Exception e) {
					}
						// TODO Auto-generated catch block
						e.printStackTrace();
					}

					cursor.moveToNext();
				}
			}
		}*/
            return hmapCtgryPrdctDetail;
        } finally {
            cursor.close();
            //close();
        }

    }

    public String tViewDate(String PrevDate) {

        //// System.out.println("PrevDate :"+PrevDate);
        StringTokenizer tokennewPdate = new StringTokenizer(PrevDate, "-");
        String md1e = tokennewPdate.nextToken().trim();
        String md2e = tokennewPdate.nextToken().trim();
       /* if(md2e.toLowerCase().equals("Jan".toLowerCase()))
        {
            md2e="01";
        }
        if(md2e.toLowerCase().equals("Feb".toLowerCase()))
        {
            md2e="02";
        }
        if(md2e.toLowerCase().equals("Mar".toLowerCase()))
        {
            md2e="03";
        }
        if(md2e.toLowerCase().equals("Apr".toLowerCase()))
        {
            md2e="04";
        }
        if(md2e.toLowerCase().equals("May".toLowerCase()))
        {
            md2e="05";
        }
        if(md2e.toLowerCase().equals("Jun".toLowerCase()))
        {
            md2e="06";
        }
        if(md2e.toLowerCase().equals("Jul".toLowerCase()))
        {
            md2e="07";
        }
        if(md2e.toLowerCase().equals("Aug".toLowerCase()))
        {
            md2e="08";
        }
        if(md2e.toLowerCase().equals("Sep".toLowerCase()))
        {
            md2e="09";
        }
        if(md2e.toLowerCase().equals("Oct".toLowerCase()))
        {
            md2e="10";
        }
        if(md2e.toLowerCase().equals("Nov".toLowerCase()))
        {
            md2e="11";
        }
        if(md2e.toLowerCase().equals("Dec".toLowerCase()))
        {
            md2e="12";
        }*/
        String md3e = tokennewPdate.nextToken().trim();
        PrevDate = md1e + "-" + md2e + "-" + md3e;

        return PrevDate;
    }

    /*public static String[] FetchRate() {

		// id = getAllEntries();

		int ScodecolumnIndex = 0;


		Cursor cursor = db.rawQuery("SELECT ProductRLP FROM tblProductListMaster",null);
		try {
			String StoreName[] = new String[cursor.getCount()];
			;
			if (cursor.moveToFirst()) {

				for (int i = 0; i <= (cursor.getCount() - 1); i++) {
					StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
							.toString();
					////// System.out.println("DB-ADAP: PROD RLP: "+ (String) cursor.getString(ScodecolumnIndex).toString());
					cursor.moveToNext();
				}
			}
			return StoreName;
		} finally {
			cursor.close();
		}
	}*/
    public Double fnGetLastCreditAmountFromLastInvoiceTable(String strStoreID) {

        int ScodecolumnIndex = 0;
        Double strLastBalanceAmt = 0.00;
        Cursor cursor = db.rawQuery(
                "SELECT CreditPreviousDue FROM tblPDALastInvoiceDet where StoreID='"
                        + strStoreID + "'", null);
        try {
            ////// System.out.println("Raja babu Abhivan Raj strLastBalanceAmt 1a :"+strLastBalanceAmt);
            if (cursor.getCount() > 0) {
                ////// System.out.println("Raja babu Abhivan Raj strLastBalanceAmt 2a :"+strLastBalanceAmt);
                if (cursor.moveToFirst()) {
                    if (!cursor.getString(ScodecolumnIndex).toString().equals("")) {
                        for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                            if (!cursor.isNull(ScodecolumnIndex)) {
                                strLastBalanceAmt = Double.parseDouble(cursor
                                        .getString(ScodecolumnIndex).toString());
                                ////// System.out.println("Raja babu Abhivan Raj strLastBalanceAmt 3a :"+strLastBalanceAmt);
                                cursor.moveToNext();
                            }

                        }
                    }


                }
            }
            ////// System.out.println("Raja babu Abhivan Raj strLastBalanceAmt 4a :"+strLastBalanceAmt);
            return strLastBalanceAmt;
        } finally {
            cursor.close();
        }
    }

    public Double fnGetActualValueTotalReturnValue(String ReturnStoreId) {

        int LoncolumnIndex = 0;
        Double strActualValueTotalReturnValue = 0.00;

        Cursor cursor2 = db.rawQuery(
                "SELECT TotalReturnValue FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (!cursor2.isNull(LoncolumnIndex)) {
                        strActualValueTotalReturnValue = Double
                                .parseDouble(cursor2.getString(LoncolumnIndex));
                    }

                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strActualValueTotalReturnValue;
        } finally {
            cursor2.close();
        }

    }

    public Double fnGetActualValueAdjAmt(String ReturnStoreId) {

        int LoncolumnIndex = 0;
        Double strActualValueTotalAdjAmt = 0.00;
        Cursor cursor2 = db.rawQuery(
                "SELECT TotalAdjustValue FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (!cursor2.isNull(LoncolumnIndex)) {
                        strActualValueTotalAdjAmt = Double.parseDouble(cursor2
                                .getString(LoncolumnIndex));
                    }

                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strActualValueTotalAdjAmt;
        } finally {
            cursor2.close();
        }

    }

    public int fnCkhTotalReturnValue(String ReturnStoreId) {

        int LoncolumnIndex = 0;
        int strReturnIdMstr = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT TotalReturnValue FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdMstr = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    public Double fnGetAdjAmtProdReturns(String StoreID) {
        Double TotalAdjAmt = 0.00;
        int chkValue = fnCkhTotalReturnValue(StoreID);
        if (chkValue == 1) {
            TotalAdjAmt = fnGetActualValueAdjAmt(StoreID);

        }

        return TotalAdjAmt;
    }

    public Double fnGetTotalReturnValueOnOrderPage(String StoreID) {
        Double TotalReturnValue = 0.00;
        int chkValue = fnCkhTotalReturnValue(StoreID);
        if (chkValue == 1) {
            TotalReturnValue = fnGetActualValueTotalReturnValue(StoreID);

        }

        return TotalReturnValue;
    }

    public int fnCheckflgToShowStrachRowOrNot() {


        Cursor cursorE2 = db.rawQuery(
                "SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme", null);

        ////// System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++) {
                    if (!cursorE2.isNull(0)) {
                        chkI = Integer.parseInt(cursorE2.getString(0));
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        ////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }

    public int checkStoreIdForNewStore(String ssStoreID) {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery(
                "SELECT *  FROM tblNewStoreListEntries where StoreID= '"
                        + ssStoreID + "'", null);
        try {
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return ScodecolumnIndex;
        } finally {
            cursor.close();
        }

    }

    public String fnGetPDALastInvoiceDetDueAmt(String strStoreID) {

        Cursor cursorE2 = db.rawQuery(
                "SELECT BalanceAmount FROM tblPDALastInvoiceDet WHERE StoreID ='"
                        + strStoreID + "'", null);
        String StoreType = "0.0";
        int ScodecolumnIndex = 0;
        try {
            if (cursorE2.getCount() > 0) {

                if (cursorE2.moveToFirst()) {
                    if (!cursorE2.getString(ScodecolumnIndex).toString().equals("")) {
                        for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                            StoreType = (String) cursorE2.getString(ScodecolumnIndex)
                                    .toString();
                            cursorE2.moveToNext();
                        }
                    }
                }
            }
            return StoreType;
        } finally {
            cursorE2.close();
        }

    }

    public int fnGetStrachIDMinSlabQtyForCalculation(int strSchemeID) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;

        int strProductSabCardStrachIDQty = 0;


        Cursor cursor2 = db.rawQuery("SELECT Min(Slab) FROM tblStrachOnSchemeDetails where SchID = " + strSchemeID, null);
        try {
            if (cursor2.moveToFirst()) {
                if (!cursor2.isNull(LoncolumnIndex)) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabCardStrachIDQty == 0) {
                            strProductSabCardStrachIDQty = Integer.parseInt(cursor2
                                    .getString(LoncolumnIndex));
                        }

                        cursor2.moveToNext();
                        // cursor.close();
                    }
                }


            }

        } finally {
            cursor2.close();
        }
        return strProductSabCardStrachIDQty;
    }

	/*public static Double[] FetchProdTaxAmt() {

		// id = getAllEntries();

		int ScodecolumnIndex = 0;

		Cursor cursor = db.rawQuery(
				"SELECT ProductTaxAmount FROM tblProductListMaster", null);
		try {
			Double StoreName[] = new Double[cursor.getCount()];
			;
			if (cursor.moveToFirst()) {

				for (int i = 0; i <= (cursor.getCount() - 1); i++) {
					StoreName[i] = (Double) cursor.getDouble(ScodecolumnIndex);
					cursor.moveToNext();
				}
			}
			return StoreName;
		} finally {
			cursor.close();
		}
	}*/

    public String fnGetStrachIDSlabQtyForCalculation(int Slab, int strSchemeID) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;

        String strProductSabCardStrachIDQty = "";


        Cursor cursor2 = db.rawQuery("SELECT Slab,cardStrachID,Qty FROM tblStrachOnSchemeDetails where Slab=" + Slab + " and SchID = " + strSchemeID, null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (strProductSabCardStrachIDQty == "") {
                        strProductSabCardStrachIDQty = cursor2
                                .getString(LoncolumnIndex) + "_" + cursor2
                                .getString(LoncolumnIndex1) + "_" + cursor2
                                .getString(LoncolumnIndex2);
                    }

                    cursor2.moveToNext();
                    // cursor.close();
                }


            }

        } finally {
            cursor2.close();
        }
        return strProductSabCardStrachIDQty;
    }

    public int fnGetStrachIDMaxSlabQtyForCalculation(int strSchemeID, int strOrderValue) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;

        int strProductSabCardStrachIDQty = 0;


        Cursor cursor2 = db.rawQuery("SELECT Max(Slab) FROM tblStrachOnSchemeDetails where Slab<=" + strOrderValue + " and SchID = " + strSchemeID, null);
        try {
            if (cursor2.moveToFirst()) {
                if (!cursor2.isNull(LoncolumnIndex)) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabCardStrachIDQty == 0) {
                            strProductSabCardStrachIDQty = Integer.parseInt(cursor2
                                    .getString(LoncolumnIndex));
                        }

                        cursor2.moveToNext();
                        // cursor.close();
                    }
                }


            }

        } finally {
            cursor2.close();
        }
        return strProductSabCardStrachIDQty;
    }

    public String[] fnGetOtherProductIdForStrachCoupons(int strSchemID) {


        int ScodecolumnIndex = 0;
        Cursor cursor = db.rawQuery(
                "SELECT ProductId FROM tblSchemeProductMap where SchemeID='"
                        + strSchemID + "'", null);
        try {
            String ProductComboIds[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ProductComboIds[i] = (String) cursor.getString(
                            ScodecolumnIndex).toString();
                    cursor.moveToNext();
                    //// System.out.println("fnGetOtherProductIdOfCombo : Product  Id  that Returns"+ ProductComboIds[i].trim());
                }
            }
            return ProductComboIds;
        } finally {
            cursor.close();
        }
    }

    public int fnCheckIsStrachCardApplicableonSlabOrValue(int SchemeID) {

        int LoncolumnIndex = 0;
        Cursor cursorE2 = db.rawQuery("SELECT ProductValueOrSlabBased FROM tblStrachOnSchemeDetails where SchID=" + SchemeID, null);

        ////// System.out.println("fnCheckIsStrachCardApplicableonSlabOrValue : " +"SELECT ProductValueOrSlabBased FROM tblStrachOnSchemeDetails where SchID="+ SchemeID);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {


                chkI = Integer.parseInt(cursorE2.getString(LoncolumnIndex).toString());

                cursorE2.moveToNext();


            }

        } finally {
            cursorE2.close();
        }
        ////// System.out.println("fnCheckIsStrachCardApplicableonSlabOrValue : " +chkI);
        return chkI;

    }

    public int fnCheckIsStrachCardApplicableonSchemeID(int SchemeID) {


        Cursor cursorE2 = db.rawQuery(
                "SELECT flgIsStrachApplicable FROM tblStrachApplicableOnScheme where SchID=" + SchemeID, null);

        ////// System.out.println("fnCheckIsStrachCardApplicableonSchemeID : " +"SELECT flgIsStrachApplicable FROM tblStrachApplicableOnScheme where SchID="+ SchemeID);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {
                for (int i = 0; i < cursorE2.getCount(); i++) {
                    if (!cursorE2.isNull(0)) {
                        chkI = 1;
                    } else {
                        chkI = 0;
                    }
                    cursorE2.moveToNext();
                }

            }

        } finally {
            cursorE2.close();
        }
        ////// System.out.println("fnCheckIsStrachCardApplicableonSchemeID : " +chkI);
        return chkI;

    }

    public String[] fnGetUniqueSchemeId() {
        int LoncolumnIndex = 0;


        Cursor cursor2 = db.rawQuery("SELECT DISTINCT SchID FROM tblStrachOnSchemeDetails", null);
        try {
            String UniqueSchemeId[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        UniqueSchemeId[i] = cursor2.getString(LoncolumnIndex).toString();
                        ////// System.out.println("abccc  :"+UniqueSchemeId[i]);
                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueSchemeId;
        } finally {
            cursor2.close();
        }
    }

    public String fnGetFreeProductNameOnProcutIdBasisCombo(String strProductId) {

        int ScodecolumnIndex = 0;


        Cursor cursor = db.rawQuery(
                "SELECT ProductShortName FROM tblProductListMaster where ProductID='"
                        + strProductId + "'", null);
        try {
            String ProductComboId = "";
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ProductComboId = (String) cursor
                            .getString(ScodecolumnIndex).toString();

                    cursor.moveToNext();
                }
            }
            return ProductComboId;
        } finally {
            cursor.close();
        }
    }

    public HashMap<String, String> checkForStoreIdSstat() {
        Cursor cursor = db.rawQuery("Select StoreID,Sstat from tblStoreList", null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapStoreIDSstat = new HashMap<String, String>();
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapStoreIDSstat.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapStoreIDSstat;
    }

    public HashMap<String, String> checkForStoreIdIsNewStore() {
        Cursor cursor = db.rawQuery("Select StoreID,ISNewStore from tblStoreList", null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapStoreIdNewStore = new HashMap<String, String>();
        if (cursor != null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapStoreIdNewStore.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapStoreIdNewStore;
    }

    public HashMap<String, String> checkForPreAddedStoreIdSstat() {
        Cursor cursor = db.rawQuery("Select StoreID,Sstat from tblStoreList", null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapStoreIDSstat = new HashMap<String, String>();
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapStoreIDSstat.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapStoreIDSstat;
    }

    public HashMap<String, String> checkForStoreflgOrderType() {
        Cursor cursor = db.rawQuery("Select StoreID,flgOrderType from tblStoreList", null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapflgOrderType = new HashMap<String, String>();
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapflgOrderType.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapflgOrderType;
    }

    public String fnValueFreeQtyOrDiscountForCaculation(String strSchemType,
                                                        String strSchemeID, int MaxValue) {
        int LoncolumnIndex = 0;

        String strProductSabFreeOrDiscount = "";

        if (Integer.parseInt(strSchemType) == 1
                || Integer.parseInt(strSchemType) == 2) {
            Cursor cursor2 = db
                    .rawQuery(
                            "SELECT FreeQuantity FROM tblSchemeDetails where SlabFrom ="
                                    + MaxValue + " and SchemeID ='"
                                    + strSchemeID + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }
                        ////// System.out.println("SabFree - called = "+ strProductSabFreeOrDiscount);
                        cursor2.moveToNext();
                        // cursor.close();

                    }

                    // strProductSabFreeOrDiscount =
                    // strProductSabFreeOrDiscount;

                }

            } finally {
                cursor2.close();
            }
        }
        if (Integer.parseInt(strSchemType) == 3) {
            Cursor cursor2 = db
                    .rawQuery(
                            "SELECT Discount FROM tblSchemeDetails where SlabFrom ="
                                    + MaxValue + " and SchemeID ='"
                                    + strSchemeID + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }

                        ////// System.out.println("DiscountFree - called = "+ strProductSabFreeOrDiscount);
                        cursor2.moveToNext();
                        // cursor.close();

                    }

                    // strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                    // + "_" + strSchemType;

                }

            } finally {
                cursor2.close();
            }
        }
        return strProductSabFreeOrDiscount;
    }

    public String fnGetSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisNew(
            String strSchemType, String strSchemeID, String strFreeProductID,
            String strCombTypeID, String strSchemeName) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;
        int LoncolumnIndex3 = 2;
        String strProductSabFreeOrDiscount = "";

        if (Integer.parseInt(strSchemType) == 1
                || Integer.parseInt(strSchemType) == 2) {
            ////// System.out.println("STR SCH TYPE: "+ Integer.parseInt(strSchemType)); //

            Cursor cursor2 = db.rawQuery(
                    "SELECT SlabFrom, SlabTo, FreeQuantity FROM tblSchemeDetails WHERE SchemeID ='"
                            + strSchemeID + "'", null);

            //// System.out.println("SELECT SlabFrom, SlabTo, FreeQuantity FROM tblSchemeDetails WHERE SchemeID ='"+ strSchemeID + "'");

            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            if (Integer.parseInt(strCombTypeID) == 2) {
                                strProductSabFreeOrDiscount = "Combo :"
                                        + strSchemeName + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+"
                                        + cursor2.getString(LoncolumnIndex3);
                            } else {
                                strProductSabFreeOrDiscount = strSchemeName
                                        + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+"
                                        + cursor2.getString(LoncolumnIndex3);
                            }
                            //// System.out.println("strProductSabFreeOrDiscount4ab :"+ strProductSabFreeOrDiscount );


                        } else {
                            if (Integer.parseInt(strCombTypeID) == 2) {
                                strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                                        + ", "
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+"
                                        + cursor2.getString(LoncolumnIndex3);
                            } else {
                                strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                                        + ", "
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+"
                                        + cursor2.getString(LoncolumnIndex3);
                            }
                            //// System.out.println("strProductSabFreeOrDiscount5ab :"+ strProductSabFreeOrDiscount );


                        }

                        cursor2.moveToNext();
                        // cursor.close();
                    }
                    //// System.out.println("strProductSabFreeOrDiscount1ab :"+ strProductSabFreeOrDiscount );

                    if (strProductSabFreeOrDiscount == "") {
                        strProductSabFreeOrDiscount = "No Free Quantity Schemes Available_"
                                + strSchemType;
                    } else {
                        strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                                + ")_" + strSchemType;
                    }
                    //// System.out.println("strProductSabFreeOrDiscount2ab :"+ strProductSabFreeOrDiscount);

                }

            } finally {
                cursor2.close();
            }
        }
        if (Integer.parseInt(strSchemType) == 3) {
            ////// System.out.println("STR SCH TYPE: "+ Integer.parseInt(strSchemType)); //
            int flgDiscountType = 0;
            flgDiscountType = fnGetDisType(strSchemeID, strSchemType);
            Cursor cursor2 = db.rawQuery(
                    "SELECT SlabFrom, SlabTo, Discount FROM tblSchemeDetails WHERE SchemeID ='"
                            + strSchemeID + "'", null);

            //// System.out.println("SELECT SlabFrom, SlabTo, Discount FROM tblSchemeDetails WHERE SchemeID ='"+ strSchemeID + "'");

            try {
                if (cursor2.moveToFirst()) {
                    ////// System.out.println("CURSOR2 COUNT SCH DIS: "+ cursor2.getCount());

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (flgDiscountType == 1) {
                            if (strProductSabFreeOrDiscount == "") {
                                strProductSabFreeOrDiscount = strSchemeName
                                        + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+ Rs/-"
                                        + cursor2.getString(LoncolumnIndex3) + ")";
                            } else {
                                strProductSabFreeOrDiscount = strSchemeName
                                        + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+ Rs/-"
                                        + cursor2.getString(LoncolumnIndex3) + ")";
                            }
                        } else if (flgDiscountType == 2) {
                            if (strProductSabFreeOrDiscount == "") {
                                strProductSabFreeOrDiscount = strSchemeName
                                        + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+ "
                                        + cursor2.getString(LoncolumnIndex3) + "%)";
                            } else {
                                strProductSabFreeOrDiscount = strSchemeName
                                        + "("
                                        + cursor2.getString(LoncolumnIndex)
                                        + "+ "
                                        + cursor2.getString(LoncolumnIndex3) + "%)";
                            }
                        }

                        ////// System.out.println("strProductSabFreeOrDiscount: "+ strProductSabFreeOrDiscount);

                        cursor2.moveToNext();
                        // cursor.close();
                    }
                    if (strProductSabFreeOrDiscount == "") {
                        strProductSabFreeOrDiscount = "No Discounts Available_"
                                + strSchemType;
                    } else {
                        strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                                + "_" + strSchemType;
                    }

                }

            } finally {
                cursor2.close();
            }
        }
        return strProductSabFreeOrDiscount;
    }

    public String fnGetSchemeIDOnProductIDIdBasisNew(String strProductId) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strSchemeIDFreeProductId = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT SchemeID FROM tblschemeProductMap where ProductID='"
                        + strProductId + "' and SchemeType<=3", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = cursor2
                            .getString(LoncolumnIndex);
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public String fnGetAllSchemeDetailsOnProductNewClick(String strProductId) {

        String strSchemeIDFreePRoductId = "";
        String strSchemeID = fnGetSchemeIDOnProductIDIdBasisNew(strProductId);
        String strFreeProductID = "";
        String strSchemeTypeCombTypeIDSchemeName = "";
        strSchemeTypeCombTypeIDSchemeName = fnGetSchemTypeOnSchemIDIdBasis(strSchemeID);

        StringTokenizer tokensSchemeTypeCombTypeID = new StringTokenizer(
                String.valueOf(strSchemeTypeCombTypeIDSchemeName), "_");
        String strSchemeType = "";
        String strCombTypeID = "";
        String strSchemeName = "";
        strSchemeType = tokensSchemeTypeCombTypeID.nextToken().trim();
        strCombTypeID = tokensSchemeTypeCombTypeID.nextToken().trim();
        strSchemeName = tokensSchemeTypeCombTypeID.nextToken().trim();

        String strForAllScehmesAgainstProduct = "";
        strForAllScehmesAgainstProduct = fnGetSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisNew(
                strSchemeType, strSchemeID, strFreeProductID, strCombTypeID,
                strSchemeName);


        return strForAllScehmesAgainstProduct;
    }

    public String fnFreeQuantity(String strProductId, int MaxValue) {
        String strSchemeIDFreePRoductId = "";

        strSchemeIDFreePRoductId = fnGetSchemeIDOnProductIDIdBasis(strProductId);
        //StringTokenizer tokensSchemeIDFreePRoductId = new StringTokenizer(
        //	String.valueOf(strSchemeIDFreePRoductId), "_");
        String strSchemeID = "";
        String strFreeProductID = "";
        strSchemeID = strSchemeIDFreePRoductId;// tokensSchemeIDFreePRoductId.nextToken().trim();
        //strFreeProductID = tokensSchemeIDFreePRoductId.nextToken().trim();

        String strSchemeTypeCombTypeIDSchemeName = "";
        strSchemeTypeCombTypeIDSchemeName = fnGetSchemTypeOnSchemIDIdBasis(strSchemeID);

        StringTokenizer tokensSchemeTypeCombTypeID = new StringTokenizer(
                String.valueOf(strSchemeTypeCombTypeIDSchemeName), "_");
        String strSchemeType = "";
        String strCombTypeID = "";
        String strSchemeName = "";
        strSchemeType = tokensSchemeTypeCombTypeID.nextToken().trim();
        strCombTypeID = tokensSchemeTypeCombTypeID.nextToken().trim();
        strSchemeName = tokensSchemeTypeCombTypeID.nextToken().trim();

        String strValueFreeQtyOrDiscount = "";
        strValueFreeQtyOrDiscount = fnValueFreeQtyOrDiscountForCaculation(strSchemeType, strSchemeID, MaxValue);
        return strValueFreeQtyOrDiscount;
    }

    public String fnGetSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisForCaculation(
            String strSchemType, String strSchemeID, int strOrderValue) {
        int LoncolumnIndex = 0;
        //////// System.out.println("strFPIDSlb strMaxSlb :" + strMaxSlb);
        String strProductSabFreeOrDiscount = "";

        if (Integer.parseInt(strSchemType) == 1
                || Integer.parseInt(strSchemType) == 2) {
            Cursor cursor2 = db.rawQuery(
                    "SELECT Max(SlabFrom) FROM tblSchemeDetails where SlabFrom<="
                            + strOrderValue + " and SchemeID = '" + strSchemeID
                            + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }

                        cursor2.moveToNext();
                        // cursor.close();
                    }

                    strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                            + "_" + strSchemType;

                }

            } finally {
                cursor2.close();
            }
        }
        if (Integer.parseInt(strSchemType) == 3) {
            Cursor cursor2 = db.rawQuery(
                    "SELECT Max(SlabFrom) FROM tblSchemeDetails where SlabFrom<="
                            + strOrderValue + " and SchemeID = '" + strSchemeID
                            + "'", null);
            try {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (strProductSabFreeOrDiscount == "") {
                            strProductSabFreeOrDiscount = cursor2
                                    .getString(LoncolumnIndex);
                        }

                        ////// System.out.println("Discount Abhinav = "+ strProductSabFreeOrDiscount);
                        cursor2.moveToNext();
                        // cursor.close();
                    }

                    strProductSabFreeOrDiscount = strProductSabFreeOrDiscount
                            + "_" + strSchemType;

                }

            } finally {
                cursor2.close();
            }
        }
        return strProductSabFreeOrDiscount;
    }

    public String fnCallSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisForCaculationOverAll(
            String strSchemeType, String strSchemeID, int strOrderValue) {
        String strForCalculation = "";
        strForCalculation = fnGetSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisForCaculation(
                strSchemeType, strSchemeID, strOrderValue);
        return strForCalculation;
    }

    public String fnGetSchemTypeOnSchemIDIdBasis(String strSchemID) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String strSchemeTypeCombTypeIDSchemeName = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT SchemeType, CombTypeID,SchemeName FROM tblSchemeList where SchemeID='"
                        + strSchemID + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strSchemeTypeCombTypeIDSchemeName = cursor2
                            .getString(LoncolumnIndex)
                            + "_"
                            + cursor2.getString(LoncolumnIndex1)
                            + "_"
                            + cursor2.getString(LoncolumnIndex2);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeTypeCombTypeIDSchemeName;
        } finally {
            cursor2.close();
        }
    }

	/*public static String[] fnGetOtherProductIdOfCombo(String strSchemID) {

		// id = getAllEntries();

		int ScodecolumnIndex = 0;


		Cursor cursor = db.rawQuery(
				"SELECT ProductId FROM tblSchemeProductMap where SchemeID='"
						+ strSchemID + "'", null);
		try {
			String ProductComboIds[] = new String[cursor.getCount()];
			;
			if (cursor.moveToFirst()) {

				for (int i = 0; i <= (cursor.getCount() - 1); i++) {
					ProductComboIds[i] = (String) cursor.getString(
							ScodecolumnIndex).toString();
					cursor.moveToNext();
					//// System.out.println("fnGetOtherProductIdOfCombo : Product  Id  that Returns"+ ProductComboIds[i].trim());
				}
			}
			return ProductComboIds;
		} finally {
			cursor.close();
		}
	}*/

    public String fnGetProductSchemeIDandComboTypeIdDetails(String strProductId) {
        String strSchemeIDFreePRoductId = "";

        strSchemeIDFreePRoductId = fnGetSchemeIDOnProductIDIdBasis(strProductId);
        String strSchemeID = "";
        strSchemeID = strSchemeIDFreePRoductId;

        String strSchemeTypeCombTypeIDSchemeName = "";
        strSchemeTypeCombTypeIDSchemeName = fnGetSchemTypeOnSchemIDIdBasis(strSchemeID);

        StringTokenizer tokensSchemeTypeCombTypeID = new StringTokenizer(
                String.valueOf(strSchemeTypeCombTypeIDSchemeName), "_");
        String strSchemeType = "";
        String strCombTypeID = "";
        String strSchemeName = "";
        strSchemeType = tokensSchemeTypeCombTypeID.nextToken().trim();
        strCombTypeID = tokensSchemeTypeCombTypeID.nextToken().trim();
        strSchemeName = tokensSchemeTypeCombTypeID.nextToken().trim();

        String strProductIdSchemeIDFreeProductIDSchemeTypeCombTypeID = strProductId
                + "_"
                + strSchemeID
                + "_"
                + strSchemeType + "_" + strCombTypeID;

        // String strForCalculation="";
        // strForCalculation=fnGetSchemeDetailsOfProductOnSchemeTypeSchemeIDBasisForCaculation(strSchemeType,strSchemeID,strOrderValue);
        return strProductIdSchemeIDFreeProductIDSchemeTypeCombTypeID;
    }

    public String[] fnGetFreeProductIDetails(String SchemeID) {

        Cursor cursor = db.rawQuery("SELECT DISTINCT FreeProductID FROM tblSchemeDetails where SchemeID='" + SchemeID + "'", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = cursor.getString(0);
                        ////// System.out.println("Abhi121 FreeProductID:" + CompleteResult[i].toString());
                        cursor.moveToNext();
                    }

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String fnGetFreeProIdDefault(String strSchemeID, int strOrderValue) {
        int LoncolumnIndex = 0;
        //////// System.out.println("strFPIDSlb strMaxSlb :" + strMaxSlb);
        String strProductSabFreeOrDiscount = "";

        Cursor cursor2 = db.rawQuery(
                "SELECT FreeProductID FROM tblSchemeDetails where SchemeID = '" + strSchemeID
                        + "' LIMIT 1", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (strProductSabFreeOrDiscount == "") {
                        strProductSabFreeOrDiscount = cursor2
                                .getString(LoncolumnIndex);
                    }

                    ////// System.out.println("Discount Abhinav = "+ strProductSabFreeOrDiscount);
                    cursor2.moveToNext();
                    // cursor.close();
                }

                strProductSabFreeOrDiscount = strProductSabFreeOrDiscount;

            }

        } finally {
            cursor2.close();
        }

        return strProductSabFreeOrDiscount;
    }

    public String fnGetSchemeIDOnProductIDIdBasis(String strProductId) {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strSchemeIDFreeProductId = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT SchemeID FROM tblschemeProductMap where ProductID='"
                        + strProductId + "' and SchemeType<=3", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = cursor2
                            .getString(LoncolumnIndex);
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public String fnCheckIfSchemeApplicableOnProduct(String strProductId) {
        int LoncolumnIndex = 0;
        String strSchemeID = "";
        Cursor cursor2 = db.rawQuery(
                "SELECT SchemeID FROM tblschemeProductMap where ProductID= '"
                        + strProductId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strSchemeID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeID;
        } finally {
            cursor2.close();
        }
    }

    public String[] fnGetOtherSchemeIdBasedOnFreeProductId(
            String strFreeProductID) {

        // id = getAllEntries();

        int ScodecolumnIndex = 0;


        Cursor cursor = db
                .rawQuery(
                        "SELECT DISTINCT  SchemeID AS SchemeID FROM tblSchemeDetails  where FreeProductID='"
                                + strFreeProductID + "'", null);
        try {
            String ProductComboSchemeIds[] = new String[cursor.getCount()];
            ;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ProductComboSchemeIds[i] = (String) cursor.getString(
                            ScodecolumnIndex).toString();
                    cursor.moveToNext();
                    //// System.out.println("fnGetOtherSchemeIdBasedOnFreeProductId : Scheme ID  that Returns"+ ProductComboSchemeIds[i].trim());
                }
            }
            return ProductComboSchemeIds;
        } finally {
            cursor.close();
        }
    }

    public long saveStoreTransac(String IMEIno, String TransDate,
                                 String StoreID, String ProdID, int Stock, int OrderQty,
                                 Double OrderVal, int FreeQty, Double DisVal,
                                 String AppliedSchemeID, String AppliedSlab, String AppliedAbsVal,
                                 int selProdIDForSampleQty, String ProductShortName, Double ProductRate, String CatID) {//String DisplayUnit

        String activeRid;
        activeRid = GetActiveRouteID();


        ContentValues initialValues = new ContentValues();

        initialValues.put("PDACode", IMEIno.trim());
        initialValues.put("TransDate", TransDate.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProdID", ProdID.trim());
        initialValues.put("Stock", Stock);
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("OrderVal", OrderVal);
        initialValues.put("FreeQty", FreeQty);
        initialValues.put("DisVal", DisVal);

        initialValues.put("Sstat", 0);
        initialValues.put("SchemeID", AppliedSchemeID);
        initialValues.put("AppliedSlab", AppliedSlab);
        initialValues.put("AppliedAbsVal", AppliedAbsVal);
        initialValues.put("SampleQuantity", selProdIDForSampleQty);

        initialValues.put("ProductShortName", ProductShortName);

        initialValues.put("ProductPrice", ProductRate);
        initialValues.put("RouteID", Integer.parseInt(activeRid));
        initialValues.put("CatID", CatID.trim());

        //initialValues.put(Key_DisplayUnit, DisplayUnit);

        ////// System.out.println("inserting saveStoreTransac records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN31, null, initialValues);
    }
    //tblTransac (IMEIno text not null, TransDate string not null, StoreID text not null, ProdID text not null,
    //Stock integer not null, OrderQty integer not null, OrderVal real not null, FreeQty integer not null,
    //DisVal real not null, SchemeID text null, AppliedSlab text null, AppliedAbsVal text null, Sstat integer not null,
    //SampleQuantity int null, ProductShortName text null, ProductPrice real null);";//, DisplayUnit text null

    public long saveStoreInvoice(String IMEIno, String StoreID, String InvoiceDate, Double TotalBeforeTaxDis, Double TaxAmt,
                                 Double TotalDis, Double InvoiceVal, int FreeTotal,
                                 Double InvAfterDis, Double AddDis, Double AmtPrevDue,
                                 Double AmtColl, Double AmtOut, int NoOfCouponValue, Double TotalCoupunAmount, int Outstat, String OrderIDPDA, String TmpInvoiceCodePDA, String strFinalAllotedInvoiceIds, String routeID, String routetype)// , Double CreditAmt, Double
    // InvoiceAfterCreditAmt, Double
    // valInvoiceOrginal)
    {

        String activeRid;
        activeRid = GetActiveRouteID();


        ContentValues initialValues = new ContentValues();

        initialValues.put("PDACode", IMEIno.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("InvoiceDate", InvoiceDate.trim());
        initialValues.put("TotalBeforeTaxDis", TotalBeforeTaxDis);
        initialValues.put("TaxAmt", TaxAmt);
        initialValues.put("TotalDis", TotalDis);
        initialValues.put("InvoiceVal", InvoiceVal);
        initialValues.put("FreeTotal", FreeTotal);
        initialValues.put("InvAfterDis", InvAfterDis);
        initialValues.put("AddDis", AddDis);
        initialValues.put("Sstat", Outstat);

        initialValues.put("AmtPrevDue", AmtPrevDue);
        initialValues.put("AmtColl", AmtColl);
        initialValues.put("AmtOut", AmtOut);

        initialValues.put("NoCoupon", NoOfCouponValue);
        initialValues.put("TotalCoupunAmount", TotalCoupunAmount);
        initialValues.put("RouteID", Integer.parseInt(activeRid));
        initialValues.put("OrderIDPDA", OrderIDPDA);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("FinalAllotedInvoiceIds", strFinalAllotedInvoiceIds);
        initialValues.put("RouteNodeID", routeID);
        initialValues.put("RouteNodetype", routetype);

        /*
         * initialValues.put(KEY_OrderCreditAmt, 0.00);
         * initialValues.put(KEY_OrderInvoiceAfterCreditAmt, 0.00);
         * initialValues.put(KEY_OrderInvoiceOriginal, 0.00);
         */

        ////// System.out.println("inserting saveStoreInvoice records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN32, null, initialValues);
    }

    // table tblTmpInvoiceHeader (IMEIno text not null, StoreID text not null, InvoiceDate string not null, TotalBeforeTaxDis real not null, TaxAmt real not null,
    //TotalDis real not null, InvoiceVal real not null, FreeTotal integer not null, Sstat integer not null, InvAfterDis real not null, AddDis real not null,
    //AmtPrevDue real null, AmtColl real null, AmtOut real null, NoCoupon int null, TotalCoupunAmount real null);";

    public void deleteOldStoreTransac(String sID2del) {
        // int entryCount;
        db.execSQL("DELETE FROM tblTransac WHERE StoreID ='" + sID2del + "'");


    }

    public void deleteOldStoreInvoice(String sID2del, String OrderIDPDA, String TmpInvoiceCodePDA) {
        // int entryCount;
        //open();
        db.execSQL("DELETE FROM tblTmpInvoiceHeader WHERE StoreID ='" + sID2del + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");//and OrderIDPDA='"+OrderIDPDA+"'
        //close();
        // Cursor cursorE2 =


    }

    public long fninsertSchemeCouponSlab(int SchemeID, int CardSlabID, int Slab, int Qtny, int ProductValueOrSlabBased) {

        ContentValues initialValues = new ContentValues();


        initialValues.put("SchID", SchemeID);
        initialValues.put("cardStrachID", CardSlabID);
        initialValues.put("Slab", Slab);
        initialValues.put("Qty", Qtny);
        initialValues.put("ProductValueOrSlabBased", ProductValueOrSlabBased);
        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN82, null, initialValues);
    }

    //tblStrachOnSchemeDetails (SchID int null, cardStrachID int null, Slab int Null, Qty int null, ProductValueOrSlabBased int null);";

    public long fninsertSchemeCoupon(int SchemeID, int IsCouponApplicable) {

        ContentValues initialValues = new ContentValues();


        initialValues.put("SchID", SchemeID);
        initialValues.put("IsCouponApplicable", IsCouponApplicable);
        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN81, null, initialValues);
    }

    // tblStrachApplicableOnScheme (SchID int null, flgIsStrachApplicable int null);";

    public long SavetblSyncSummuryForProductDetails(String SkuName, String OrderQty, String FreeQty, String SampleQty,
                                                    String TotalOrderKgs, String TotalFreeKgs, String TotalSampleKgs, String TotalSales, int Lines) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SkuName", SkuName.trim());
        initialValues.put("OrderQty", OrderQty.trim());
        initialValues.put("FreeQty", FreeQty.trim());
        initialValues.put("SampleQty", SampleQty.trim());
        initialValues.put("TotalOrderKgs", TotalOrderKgs.trim());
        initialValues.put("TotalFreeKgs", TotalFreeKgs.trim());
        initialValues.put("TotalSampleKgs", TotalSampleKgs.trim());
        initialValues.put("TotalSales", TotalSales.trim());
        initialValues.put("Lines", Lines);


        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN72, null, initialValues);
    }


    //tblSyncSummuryForProductDetails (SkuName text null,OrderQty text null, FreeQty text null, SampleQty text null, TotalOrderKgs text null,
    //TotalFreeKgs text null, TotalSampleKgs text null, TotalSales text null);";

    public long SavetblSyncSummuryDetails(String ActualCalls, String ProductiveCalls, String TotSalesValue, String TotKGSales,
                                          String TotFreeQtyKGSales, String TotSampleKGSales, String TotLTSales,
                                          String TotFreeQtyLTSales, String TotSampleLTSales, String TotDiscountKGSales, String TotDiscountLTales, int Lines) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("ActualCalls", ActualCalls.trim());
        initialValues.put("ProductiveCalls", ProductiveCalls.trim());
        initialValues.put("TotSalesValue", TotSalesValue.trim());
        initialValues.put("TotKGSales", TotKGSales.trim());
        initialValues.put("TotFreeQtyKGSales", TotFreeQtyKGSales.trim());
        initialValues.put("TotSampleKGSales", TotSampleKGSales.trim());
        initialValues.put("TotLTSales", TotLTSales.trim());
        initialValues.put("TotFreeQtyLTSales", TotFreeQtyLTSales.trim());
        initialValues.put("TotSampleLTSales", TotSampleLTSales.trim());
        initialValues.put("TotDiscountKGSales", TotDiscountKGSales.trim());
        initialValues.put("TotDiscountLTales", TotDiscountLTales.trim());
        initialValues.put("Lines", Lines);


        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN71, null, initialValues);
    }

    // tblSyncSummuryDetails (ActualCalls int null,ProductiveCalls int null, TotSalesValue text null, TotKGSales text null, TotFreeQtyKGSales text null,
    //TotSampleKGSales text null, TotLTSales text null, TotFreeQtyLTSales text null, TotSampleLTSales text null, TotDiscountKGSales text null, TotDiscountLTales text null);";

    public long SavePDAIsSchemeApplicable(int IsSchemeApplicable) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("IsSchemeApplicable", IsSchemeApplicable);


        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN56, null, initialValues);
    }

    //tblPDAIsSchemeApplicable (IsSchemeApplicable int null);";

    public long saveStoreTypeDetails(String SidType, String SidDesc) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("ID", SidType.trim());
        initialValues.put("Descr", SidDesc.trim());

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN63, null, initialValues);
    }

    //private static final String DATABASE_CREATE_TABLE_63 = "create table tblStorTypeMstr(ID string null, Descr string null);";

    public long saveSOAPdataPdaSchAppListForSecondPage(String SchemeID,
                                                       String StoreType, String SchemeDesc, int flgSpecialScheme) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SchemeID", SchemeID.trim());
        initialValues.put("StoreType", StoreType.trim());
        initialValues.put("SchemeDesc", SchemeDesc.trim());
        initialValues.put("flgSpecialScheme", flgSpecialScheme);

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN55, null, initialValues);
    }

    //tblspForPDASchemeApplicableList(SchemeID string null, StoreType string null, SchemeDesc string null);";

    public long saveSOAPdataPdaLastTranDateForSecondPage(String StoreID,
                                                         String LastTransDate, String RetailerName, String SKUName,
                                                         String Stock, String OrderQty, String FreeQty) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("LastTransDate", LastTransDate.trim());
        initialValues.put("RetailerName", RetailerName.trim());
        initialValues.put("SKUName", SKUName.trim());
        initialValues.put("Stock", Stock.trim());
        initialValues.put("OrderQty", OrderQty.trim());
        initialValues.put("FreeQty", FreeQty.trim());
        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN62, null, initialValues);
    }


    //tblPDALastTranDateForSecondPage(StoreID text null, LastTransDate string null, RetailerName string null, SKUName string null, Stock string null, OrderQty string null, FreeQty string null);";

    public long saveSOAPdataschemeProductMap(String InSchemeID,
                                             String InProductID, int strSchemeType) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SchemeID", InSchemeID.toString().trim());
        initialValues.put("ProductID", InProductID.toString().trim());
        initialValues.put("SchemeType", strSchemeType);


        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN54, null, initialValues);
    }


    //tblschemeProductMap (SchemeID text not null, ProductID text not null, SchemeType int null);";

    public long saveSOAPdataSchemeSchemeStoreTypeMap(String InSchemeID,
                                                     int InStoreTypeID) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SchemeID", InSchemeID.toString().trim());
        initialValues.put("StoreTypeID", InStoreTypeID);

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN53, null, initialValues);
    }


    //tblschemeStoreTypeMap (SchemeID text not null, StoreTypeID integer not null);";

    public long saveSOAPdataLastTransactionDetails(String ltdetSCode,
                                                   String ltdetProdCode, String ltdetLTdate, int ltdetQTY,
                                                   int pSampleQty, int CategoryID) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", ltdetSCode.trim());
        initialValues.put("ProductID", ltdetProdCode.trim());
        initialValues.put("LastTransDate", ltdetLTdate.trim());
        initialValues.put("Quantity", ltdetQTY);
        initialValues.put("SampleQuantity", pSampleQty);
        initialValues.put("CategoryID", CategoryID);

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN61, null, initialValues);
    }


    //tblLastTransactionDetails (StoreID text not null, ProductID text not null, LastTransDate string not null, Quantity integer not null, SampleQuantity int null);";

    public long saveSOAPdataSchemeDetails(String schdetDetCode,
                                          String schdetCode, int schdetSF, int schdetST, int schdetFQ,
                                          Double schdetDIS, String NewFreePrdID) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SchemeDetID", schdetDetCode.trim());
        initialValues.put("SchemeID", schdetCode.trim());
        initialValues.put("SlabFrom", schdetSF);
        initialValues.put("SlabTo", schdetST);
        initialValues.put("FreeQuantity", schdetFQ);
        initialValues.put("Discount", schdetDIS);
        initialValues.put("FreeProductID", NewFreePrdID.toString().trim());

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN52, null, initialValues);
    }


//tblSchemeDetails (SchemeDetID text not null, SchemeID text not null, SlabFrom integer not null, SlabTo integer not null, FreeQuantity integer not null,
    //Discount real not null, FreeProductID text null);";

    public long saveSOAPdataSchemeList(String schCode, String schName,
                                       String schType, String SchListStoreType, int inCombTypeID, int flgDiscountType) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("SchemeID", schCode.trim());
        initialValues.put("SchemeName", schName.trim());
        initialValues.put("SchemeType", schType.trim());
        initialValues.put("StoreType", SchListStoreType.trim());
        initialValues.put("CombTypeID", inCombTypeID);
        initialValues.put("flgDiscountType", flgDiscountType);

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN51, null, initialValues);
    }

    // tblSchemeList (SchemeID text not null, SchemeName string not null, SchemeType string not null, StoreType string null, CombTypeID integer null);";

    public long saveSOAPdataStoreProductMap(String StoreID, String ProductID,
                                            Double ProductMRP, Double ProductRLP, Double ProductTaxAmount, Double DistributorPrice, int CategoryID) {
        ContentValues initialValues = new ContentValues();


		/*StoreID text  null,ProductID text  null, ProductMRP real  null, ProductRLP real  null,
		ProductTaxAmount real  null, KGLiter text null);";
*/

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProductID", ProductID.trim());
        //initialValues.put(KEY_ProductShortName, ProductShortName.trim());
        initialValues.put("ProductMRP", ProductMRP);
        initialValues.put("ProductRLP", ProductRLP);
        initialValues.put("ProductTaxAmount", ProductTaxAmount);
        initialValues.put("DistributorPrice", DistributorPrice);
        initialValues.put("DistributorPrice", DistributorPrice);
        initialValues.put("CategoryID", CategoryID);


        ////// System.out.println("inserting records in ProductList..");

        return db.insert(DBHelper.DATABASE_TABLE_MAINStoreProductMap, null, initialValues);

    }

    //(StoreID text  null,ProductID text  null, ProductMRP real  null, ProductRLP real  null, ProductTaxAmount real  null, DistributorPrice real null);";

    public long SavePDATargetQtyForSecondPage(
            String PDATargetQtyForSecondPageStoreID,
            String PDATargetQtyForSecondPageProductID,
            String PDATargetQtyForSecondPageSKUShortName,
            String PDATargetQtyForSecondPageTargetQty) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID",
                PDATargetQtyForSecondPageStoreID.trim());
        initialValues.put("ProductID",
                PDATargetQtyForSecondPageProductID.trim());
        initialValues.put("SKUShortName",
                PDATargetQtyForSecondPageSKUShortName.trim());
        initialValues.put("TargetQty",
                PDATargetQtyForSecondPageTargetQty.trim());

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN18, null, initialValues);
    }

// tblPDATargetQtyForSecondPage (StoreID text null, ProductID text null, SKUShortName text not null, TargetQty text null);";

    public long SavePDALastInvoiceDet(String SID, String invID, String LTDate,
                                      String BalAmt, Double CreditPreviousDue) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", SID.trim());
        initialValues.put("InvoiceID", invID.trim());
        initialValues.put("LastTransDate", LTDate.trim());
        initialValues.put("BalanceAmount", BalAmt.trim());
        initialValues.put("CreditPreviousDue", CreditPreviousDue);

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN17, null, initialValues);
    }

// tblPDALastInvoiceDet (StoreID text null, InvoiceID text null, LastTransDate text not null,
    //BalanceAmount text null,CreditPreviousDue real null);";

    //tblPDALastInvoiceDet (StoreID text null, InvoiceID text null, LastTransDate text not null,
    //BalanceAmount text null,CreditPreviousDue real null);";

    // start Table 10
    public long saveVisibilityDetails(String storeID, String VisibilityID, String VisibilityStock, int Sstat) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("storeID", storeID.trim());
        initialValues.put("VisibilityID", VisibilityID.trim());
        initialValues.put("VisibilityStock", VisibilityStock.trim());
        initialValues.put("Sstat", Sstat);

        ////// System.out.println("inserting records in table 10..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN10, null, initialValues);
    }

    public void deleteVisibilityDetails(String StoreID) {
        // int entryCount;
        db.execSQL("DELETE FROM tblVisibilityDetails WHERE StoreID ='" + StoreID + "'");

    }

    public int FetchVisibilityDetailsAvailable(String StoreID) {
        int columnIndex = 0;
        int columnIndex1 = 1;
        int check = 0;

        Cursor cursor = db.rawQuery("SELECT VisibilityID,VisibilityStock FROM tblVisibilityDetails WHERE StoreID ='" + StoreID + "'", null);
        try {

            String OrderDetails[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                check = 1;
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    OrderDetails[i] = (String) cursor.getString(columnIndex).toString() + "_" + (String) cursor.getString(columnIndex1).toString();
                    cursor.moveToNext();

                }

            }
            return check;
        } finally {
            cursor.close();
        }

    }

    public String[] FetchVisibilityDetails(String StoreID) {
        int columnIndex = 0;
        int columnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT VisibilityID,VisibilityStock FROM tblVisibilityDetails WHERE StoreID ='" + StoreID + "'", null);
        try {

            String OrderDetails[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    OrderDetails[i] = (String) cursor.getString(columnIndex).toString() + "_" + (String) cursor.getString(columnIndex1).toString();
                    cursor.moveToNext();

                }

            }
            return OrderDetails;
        } finally {
            cursor.close();
        }

    }

    // start Table 9
    public long saveVisibility(String VisibilityID, String VisibilityDescr) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("VisibilityID", VisibilityID.trim());
        initialValues.put("VisibilityDescr", VisibilityDescr.trim());

        ////// System.out.println("inserting records in table 9..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN9, null, initialValues);
    }


    // end Table 10

    public String[] FetchVisibilityDescr() {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT VisibilityDescr FROM tblVisibilityMstr", null);
        try {
            String VisibilityDescr[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                ////// System.out.println("CompetitionName Sunil Available");
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    VisibilityDescr[i] = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }
            ////// System.out.println("CompetitionName Sunil: not");
            return VisibilityDescr;
        } finally {
            cursor.close();
        }
    }

    public String fnGetRouteIDAgainstStoreID(String StoreID) {
        int LoncolumnIndex = 0;
        String activeRouteID = "0";
        Cursor cursor2 = null;
        cursor2 = db.rawQuery("SELECT StoreRouteID  FROM tblStoreList WHERE StoreID  ='" + StoreID + "'", null);

        try {

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }
            }
            if (activeRouteID.equals("0")) {
                activeRouteID = fnGetRouteIDWhilePurshase();
            }
            if (!CommonInfo.ActiveRouteSM.equals("0")) {
                activeRouteID = CommonInfo.ActiveRouteSM;
            }

        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }
            return activeRouteID;
        }
    }

    public String FetchRouteType(String ID) {
        int ScodecolumnIndex = 0;
        String RouteType = "0";
		/* private static final String DATABASE_CREATE_TABLE_2 = "create table " +
		 		"tblRouteListMaster(ID string null,RouteType text null, Descr string null, Active integer null," +
		 		"flgTodayRoute integer null,RouteDate string null);";*/
        Cursor cursor = null;
        try {
            cursor = db.rawQuery("SELECT RouteType FROM tblRouteListMaster  WHERE ID='" + ID + "' Limit 1", null);


            if (cursor.moveToFirst()) {
                for (int i = 0; i < cursor.getCount(); i++) {
                    RouteType = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }

            return RouteType;
        } finally {
            cursor.close();


        }
    }

    public String[] FetchVisibilityID() {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT VisibilityID FROM tblVisibilityMstr", null);
        try {
            String VisibilityID[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                ////// System.out.println("CompetitionID Sunil Available");
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    VisibilityID[i] = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }
            ////// System.out.println("CompetitionID Sunil: not");
            return VisibilityID;
        } finally {
            cursor.close();
        }
    }

    public String FetchStoreName(String storeID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT StoreName FROM tblStoreList WHERE StoreID ='" + storeID + "'", null);
        try {

            String StoreName = "NA";

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();

                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }


    }

    public int fnGetDisType(String schID, String schType) {
        // int entryCount;
        Cursor cursorE2 = db.rawQuery(
                "SELECT flgDiscountType FROM tblSchemeList WHERE SchemeID ='" + schID + "' and SchemeType='" + schType + "'", null);
        int flgDiscountType = 0;
        try {
            if (cursorE2.moveToFirst()) {

                flgDiscountType = Integer.parseInt(cursorE2.getString(0).toString());
            }

        } finally {
            cursorE2.close();
        }
        return flgDiscountType;
    }
    //public static String[] FetchRate(String CatID)
	/*public static String[] FetchRate()
	{

		// id = getAllEntries();

		int ScodecolumnIndex = 0;
		//////// System.out.println("Fetching StoreID :" + ssStoreID);
		//Cursor cursor = db.rawQuery("SELECT ProductRLP FROM tblProductListMaster where CategoryID='"+CatID+"'", null);
		Cursor cursor = db.rawQuery("SELECT ProductRLP FROM tblProductListMaster where CategoryID='"+CatID+"'", null);
		try {
			////// System.out.println("Fetching cursor.getCount() :" + cursor.getCount());
			String StoreName[] = new String[cursor.getCount()];
			;
			if (cursor.moveToFirst()) {

				for (int i = 0; i <= (cursor.getCount() - 1); i++) {
					StoreName[i] = ""+(Double) cursor.getDouble(ScodecolumnIndex);
					//////// System.out.println("DB-ADAP: PROD RLP: "
					//		+ (String) cursor.getString(ScodecolumnIndex)
					//				.toString());
					////// System.out.println("Fetching Rate :" + StoreName[i]);
					cursor.moveToNext();
				}
			}
			return StoreName;
		} finally {
			cursor.close();
		}
	}*/


	/*public static Double[] FetchProductTax(String SID)
	{
		int ScodecolumnIndex = 0;

		Cursor cursor = db.rawQuery("SELECT ProductTaxAmount FROM tblProductListMaster where StoreID='"+SID+"'",null);
		try
		{
			Double TaxRate[] = new Double[cursor.getCount()];

			if (cursor.moveToFirst())
			{
				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					TaxRate[i] = (Double) cursor.getDouble(ScodecolumnIndex);
					//////// System.out.println("Tax Rate Sunil: "+ String.valueOf(cursor.getString(ScodecolumnIndex).toString()));
                    cursor.moveToNext();
				}
			}
			////// System.out.println("Tax Rate Sunil: not");
		return TaxRate;
		}
		finally
		{
			cursor.close();
		}
	}*/

    public int countIfStoreTransacExists(String sID2del) {
        // int entryCount;
        Cursor cursorE2 = db.rawQuery(
                "SELECT COUNT(*) FROM tblTransac WHERE StoreID ='" + sID2del
                        + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String[] FetchOrderTransactionDetails(String IMEIno, String StoreID) {
        int columnIndex = 0;
        int columnIndex1 = 1;
        int columnIndex2 = 2;


        Cursor cursor = db.rawQuery("SELECT ProdID,OrderQty, OrderVal FROM tblTransac WHERE StoreID ='" + StoreID + "' and PDACode ='" + IMEIno + "'", null);
        try {

            String OrderDetails[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ////// System.out.println("CURSOR_FETCH: " + i);

                    OrderDetails[i] = (String) cursor.getString(columnIndex).toString() + "_" + (String) cursor.getString(columnIndex1).toString() + "_" + (String) cursor.getString(columnIndex2).toString();
                    ////// System.out.println("Product Id: "+ String.valueOf(cursor.getString(columnIndex).toString())+"Total OrdQty: "+ String.valueOf(cursor.getString(columnIndex1).toString())+ " Total OrdVal: "+ String.valueOf(cursor.getString(columnIndex2).toString()));

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return OrderDetails;
        } finally {
            cursor.close();
        }

    }

	/*public static String FetchProductName(String ProductID)
	{

        int ScodecolumnIndex = 0;

		Cursor cursor = db.rawQuery("SELECT ProductShortName FROM tblProductListMaster WHERE ProductID ='"+ ProductID + "'", null);
		try
		{

			String StoreName="NA";

			if (cursor.moveToFirst())
			{

				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					StoreName = (String) cursor.getString(ScodecolumnIndex).toString();


					////// System.out.println("fetch Product Name "+StoreName);
					cursor.moveToNext();

				}

			}
			////// System.out.println("fetch Product Name Not "+StoreName);
			return StoreName;
		}
		finally
		{
			cursor.close();
		}



	}*/

    public String[] FetchOrderInvoiceDetails(String IMEIno, String StoreID) {
        int columnIndex = 0;
        int columnIndex1 = 1;
        int columnIndex2 = 2;
        int columnIndex3 = 3;
        int columnIndex4 = 4;
        //int columnIndex5 = 5;

        Cursor cursor = db.rawQuery("SELECT InvoiceVal,TaxAmt,GrossVal, AmtColl,AmtOut FROM tblTmpInvoiceHeader WHERE StoreID ='" + StoreID + "' and PDACode ='" + IMEIno + "'", null);
        try {

            String InvoiceDetails[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ////// System.out.println("CURSOR_FETCH: " + i);

                    InvoiceDetails[i] = (String) cursor.getString(columnIndex).toString() + "_" + (String) cursor.getString(columnIndex1).toString() + "_" + (String) cursor.getString(columnIndex2).toString() + "_" + (String) cursor.getString(columnIndex3).toString() + "_" + (String) cursor.getString(columnIndex4).toString();
                    ////// System.out.println("Invoice Value: "+ String.valueOf(cursor.getString(columnIndex).toString())+"TaxAmount: "+ String.valueOf(cursor.getString(columnIndex1).toString())+ " Gross Invoce Value: "+ String.valueOf(cursor.getString(columnIndex2).toString())+"Amount Collected: "+ String.valueOf(cursor.getString(columnIndex3).toString())+"Amount OutStanding:  "+ String.valueOf(cursor.getString(columnIndex4).toString()));

                    cursor.moveToNext();
                    // cursor.close();

                }

            }
            return InvoiceDetails;
        } finally {
            cursor.close();
        }

    }

    public void deleteOrderTransactionDetails(String storeID) {
        // int entryCount;
        db.execSQL("DELETE FROM tblTransac WHERE StoreID='" + storeID + "'");

    }

    public void deleteOrderInvoiceDetails(String storeID) {
        // int entryCount;
        db.execSQL("DELETE FROM tblTmpInvoiceHeader WHERE StoreID='" + storeID + "'");

    }

    public long saveOrderTransactionDetails(String IMEIno, String TransDate, String StoreID, String ProdID,
                                            int OrderQty, Double OrderVal, Double ProductMRP, Double TaxRate) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("PDACode", IMEIno.trim());
        initialValues.put("TransDate", TransDate.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProdID", ProdID.trim());
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("OrderVal", OrderVal);
        initialValues.put("Sstat", 0);
        initialValues.put("ProductMRP", ProductMRP);
        initialValues.put("TaxRate", TaxRate);

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN31, null, initialValues);
    }

    public long saveOrderInvoiceDetails(String IMEIno, String StoreID, String InvoiceDate, Double TaxAmt,
                                        Double InvoiceVal, int Sstat, Double AmtColl, Double AmtOut, Double GrossVal, String TmpInvoiceCodePDA) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("PDACode", IMEIno.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("InvoiceDate", InvoiceDate.trim());
        initialValues.put("TaxAmt", TaxAmt);
        initialValues.put("InvoiceVal", InvoiceVal);
        initialValues.put("GrossVal", GrossVal);
        initialValues.put("Sstat", Sstat);
        initialValues.put("AmtColl", AmtColl);
        initialValues.put("AmtOut", AmtOut);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);

        ////// System.out.println("inserting records in table 32..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN32, null, initialValues);
    }


    public String[] FetchCategoryDesc() {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT CategoryDescr FROM tblCategoryMaster", null);
        try {
            String TaxRate[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                ////// System.out.println("Category Sunil Available");
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    TaxRate[i] = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }
            ////// System.out.println("Category Sunil: not");
            return TaxRate;
        } finally {
            cursor.close();
        }
    }

	/*public static long saveCategoryProductINformation(String CompetitionID,String ProductID,String Stock,int Sstat,String storeID )
	{

		ContentValues initialValues = new ContentValues();
		initialValues.put("CategoryID", CompetitionID.trim());
		//initialValues.put("CategoryID", CategoryID.trim());
		initialValues.put("Sstat", Sstat);
		initialValues.put("ProductID", ProductID.trim());
		initialValues.put("Stock", Stock.trim());
		initialValues.put("storeID", storeID.trim());



		////// System.out.println("inserting records in table 38..");

		return db.insert(DATABASE_TABLE_MAIN5, null, initialValues);
	}*/

	/*public static String[] FetchCategoryProductID(String CategoryID)
	{
        int columnIndex = 0;
        //int columnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT ProductID FROM tblProductListMaster WHERE CategoryID ='"+ CategoryID  + "'", null);
		try
		{

			String OrderDetails[] = new String[cursor.getCount()];

			if (cursor.moveToFirst())
			{

				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					OrderDetails[i] = (String) cursor.getString(columnIndex).toString();
					cursor.moveToNext();
					// cursor.close();

				}

			}
			return OrderDetails;
		}
		finally
		{
			cursor.close();
		}

	}
	*/
	/*public static String[] FetchCatergoryProductDescription(String CompetitionID)
	{
        int columnIndex = 0;
        //int columnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT ProductShortName FROM tblProductListMaster WHERE CategoryID ='"+ CompetitionID  + "'", null);
		try
		{

			String OrderDetails[] = new String[cursor.getCount()];

			if (cursor.moveToFirst())
			{

				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					OrderDetails[i] = (String) cursor.getString(columnIndex).toString();
					cursor.moveToNext();
					// cursor.close();

				}

			}
			return OrderDetails;
		}
		finally
		{
			cursor.close();
		}

	}*/

	/*public static String[] FetchCategoeyProductINformation(String CategoryID, String storeID)
	{
        int columnIndex = 0;
        int columnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT ProductID,Stock FROM tblCategoryQuestionInformation WHERE CategoryID ='"+ CategoryID  + "' and StoreID='"+ storeID +"'", null);
		try
		{

			String OrderDetails[] = new String[cursor.getCount()];

			if (cursor.moveToFirst())
			{

				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					OrderDetails[i] = (String) cursor.getString(columnIndex).toString()+ "_"+ (String) cursor.getString(columnIndex1).toString();
					cursor.moveToNext();

				}

			}
			return OrderDetails;
		}
		finally
		{
			cursor.close();
		}

	}*/

    public String[] FetchCategoryID() {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT CategoryID FROM tblCategoryMaster", null);
        try {
            String TaxRate[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                ////// System.out.println("CategoryID Sunil Available");
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    TaxRate[i] = (String) cursor.getString(ScodecolumnIndex);
                    cursor.moveToNext();
                }
            }
            ////// System.out.println("CategoryID Sunil: not");
            return TaxRate;
        } finally {
            cursor.close();
        }
    }

    //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null,
    //CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null,
    //KGLiter string nulll);";

	/*public static String[] FetchCategoryIDfromProduct()
	{
		int ScodecolumnIndex = 0;

		Cursor cursor = db.rawQuery("SELECT CategoryID FROM tblProductListMaster",null);
		try
		{
			String TaxRate[] = new String[cursor.getCount()];

			if (cursor.moveToFirst())
			{
				////// System.out.println("CategoryID Sunil Available");
				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					TaxRate[i] = (String) cursor.getString(ScodecolumnIndex);
					cursor.moveToNext();
				}
			}
			////// System.out.println("CategoryID Sunil: not");
		return TaxRate;
		}
		finally
		{
			cursor.close();
		}
	}*/

    public boolean GetPrevDateChk() {

        Cursor cursorDateE = db.rawQuery("SELECT ForDate FROM tblStoreList", null);
        boolean ifApplicableToPassIntent = GetIfApplicableToForward();

        try {
            if (cursorDateE.getCount() > 0) {

                if (ifApplicableToPassIntent) {
                    return true;
                } else {
                    return false;
                }

            } else {
                return false;
            }

        } finally {
            cursorDateE.close();
        }

    }


    //public static String[] FetchPid(String CATID)
	/*public static String[] FetchPid()
	{
		int ScodecolumnIndex = 0;
		////// System.out.println("a");

		//Cursor cursor = db.rawQuery("SELECT ProductID FROM tblProductListMaster where CategoryID='"+CATID+"'",null);
		Cursor cursor = db.rawQuery("SELECT ProductID FROM tblProductListMaster",null);
		////// System.out.println("b");
		try
		{
			String StoreName[] = new String[cursor.getCount()];

			////// System.out.println("length of cursor count in DBAdapter1"+ cursor.getCount());
			////// System.out.println("c");
			if (cursor.moveToFirst())
			{
				////// System.out.println("d");
				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					////// System.out.println("e");
					StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString();

					////// System.out.println("Sunil ProductID FROM tblProductListMaster: "+ StoreName[i]);
					cursor.moveToNext();
				}
			}
		 ////// System.out.println("f");
		 return StoreName;
		}
		finally
		{
			cursor.close();
		}
	}
	*/

    //public static String[] FetchPName(String CATID)
	/*public static String[] FetchPName()
	{

		int ScodecolumnIndex = 0;

		//Cursor cursor = db.rawQuery("SELECT ProductShortName FROM tblProductListMaster where CategoryID='"+CATID+"'", null);
		Cursor cursor = db.rawQuery("SELECT ProductShortName FROM tblProductListMaster", null);
		try
		{
			String StoreName[] = new String[cursor.getCount()];
			if (cursor.moveToFirst())
			{

				for (int i = 0; i <= (cursor.getCount() - 1); i++)
				{
					StoreName[i] = (String) cursor.getString(ScodecolumnIndex)
							.toString();
					////// System.out.println("product short name :"+StoreName[i]);
					cursor.moveToNext();
				}
			}
		  return StoreName;
		}
		finally
		{
			cursor.close();
		}
	}
	*/

    /*public boolean GetIfApplicableToForward() {

	  Cursor cursorDateE = db.rawQuery("SELECT IsSchemeApplicable FROM tblPDAIsSchemeApplicable",null);


	  try {
	   if (cursorDateE.getCount() > 0) {
	    // String date2Send = cursorDateE.getString(0);

	    ////// System.out.println("GetPrevDateChk - Records Count: "+ cursorDateE.getCount());
	    // ////// System.out.println("GetPrevDateChk - forDate: " +date2Send);
	    ////// System.out.println("returning GetPrevDateChk - true");
	    return true;
	   } else {
	    return false;
	   }

	  } finally {
	   cursorDateE.close();
	  }

	 }*/
    public boolean GetIfApplicableToForward() {

        Cursor cursorDateE = db.rawQuery("SELECT IsSchemeApplicable FROM tblPDAIsSchemeApplicable", null);


        try {
            if (cursorDateE.getCount() > 0) {
                // String date2Send = cursorDateE.getString(0);

                ////// System.out.println("GetPrevDateChk - Records Count: "+ cursorDateE.getCount());
                // ////// System.out.println("GetPrevDateChk - forDate: " +date2Send);
                ////// System.out.println("returning GetPrevDateChk - true");
                return true;
            } else {
                //return false;
                return true;
            }

        } finally {
            cursorDateE.close();
        }

    }

    public int CheckProductListPresentOrNot() {
        Cursor cursorE2 = null;
        int chkI = 0;

        try {
            //open();
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblProductListMaster", null);

            if (cursorE2.moveToFirst()) {
                if (Integer.parseInt(cursorE2.getString(0)) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public boolean PrevLocChk(String passedStoreID, String StoreVisitCode) {
        boolean abc = false;

        Cursor cursorLocE = db.rawQuery("SELECT ActualLatitude FROM tblStoreVisitMstr WHERE StoreID ='" + passedStoreID + "' AND StoreVisitCode='" + StoreVisitCode + "'", null);

        ////// System.out.println("PrevLocChk - Checking for StoreID: "+ passedStoreID);
        try {
            if (cursorLocE.moveToFirst()) {
                ////// System.out.println("cursorLocE count: " + cursorLocE.getCount());

                if ((cursorLocE.getString(0) == null) || (cursorLocE.getString(0).equals("0.0")) || (cursorLocE.getString(0).equals("0"))) {
                    ////// System.out.println(" A 1 " + abc);
                    ////// System.out.println("PrevLocChk - Records Count: "+ cursorLocE.getCount());
                    ////// System.out.println("returning PrevLocChk - False");
                    abc = false;
                    ////// System.out.println(" A 2 " + abc);
                } else {
                    ////// System.out.println("returning PrevLocChk - True");
                    abc = true;
                    ////// System.out.println(" A 3 " + abc);
                }
            }

        } finally {
            if(cursorLocE!=null)
            cursorLocE.close();
        }
        return abc;
    }

    public void UpdateStoreStartVisit(String StoreID, String strVisitStartTS) {


    }

    public void UpdateStoreStoreClose(String StoreID, int StoreClose, String StoreVisitCode) {


        final ContentValues values = new ContentValues();
        values.put("StoreClose", StoreClose);

        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?", new String[]{StoreID, StoreVisitCode});
        //   int affected1 = db.update("tblStoreList", values, "StoreID=?",new String[] { StoreID });
        // int affected21 = db.update("tblOutletQuestAnsMstr", values,"OutletID=?", new String[] { StoreID });

        //  int affected261 = db.update("tblNewAddedStoreLocationDetails", values,"StoreID=?", new String[] { StoreID });

    }

    public void UpdateStoreSstat(String StoreID, int Sstat, String StoreVisitCode) {


        final ContentValues values = new ContentValues();
        values.put("Sstat", Sstat);

        int affected = db.update("tblStoreVisitMstr", values, "StoreID=?", new String[]{StoreID});// AND StoreVisitCode=?,//, StoreVisitCode
        int affected22 = db.update("tblStoreOrderVisitDayActivity", values, "StoreID=? AND StoreVisitCode=?", new String[]{StoreID, StoreVisitCode});
        int affected1 = db.update("tblStoreList", values, "StoreID=?", new String[]{StoreID});
        int affected21 = db.update("tblOutletQuestAnsMstr", values, "OutletID=?", new String[]{StoreID});

        int affected261 = db.update("tblNewAddedStoreLocationDetails", values, "StoreID=?", new String[]{StoreID});

    }

    public void deleteStoreTblsRecordsInCaseCancelOrderInOrderBooking(String StoreID, int flag, String pdaOrderID, String TmpInvoiceCodePDA) {
        db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
        db.execSQL("DELETE FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
        db.execSQL("DELETE FROM tblStoreReturnDetail WHERE StoreID='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
        if (flag == 1) {
            db.execSQL("DELETE FROM tblStoreProductPhotoDetail WHERE StoreID='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
        }


    }

    public void UpdateStoreStoreReturnDetail(String StoreID, String Sstat, String pdaOrderID, String TmpInvoiceCodePDA) {
        final ContentValues values = new ContentValues();
        values.put("Sstat", Sstat);
        int affected = db.update("tblStoreReturnDetail", values, "StoreID=?  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and Sstat is not null", new String[]{StoreID});
    }

    public void UpdateStoreProductAppliedSchemesBenifitsRecords(String StoreID, String Sstat, String pdaOrderID, String TmpInvoiceCodePDA) {
        final ContentValues values = new ContentValues();
        values.put("Sstat", Sstat);
        int affected = db.update("tblStoreProductAppliedSchemesBenifitsRecords", values, "StoreID=? AND TmpInvoiceCodePDA=? and Sstat is not null",
                new String[]{StoreID, TmpInvoiceCodePDA});
    }

    public void UpdateStoreEndVisit(String StoreID, String strVisitEndTS) {
        int cnt=fnGetCounttblStoreOrderVisitDayActivity(StoreID);
        if(cnt==1 || cnt==0)
        {
            final ContentValues values = new ContentValues();
            values.put("VisitEndTS", strVisitEndTS);
            int affected = db.update("tblStoreVisitMstr", values,"StoreID=?",new String[] { StoreID });
        }
      /*  final ContentValues values = new ContentValues();
        values.put("VisitEndTS", strVisitEndTS);
        int affected = db.update("tblStoreList", values,"StoreID=? and VisitStartTS is not null",new String[] { StoreID });*/

    }
    public int fnGetCounttblStoreOrderVisitDayActivity(String StoreID) {
        //open();
        int cnt = 0;
        Cursor cursor = db.rawQuery("Select Count(*) from tblStoreOrderVisitDayActivity Where StoreID='" + StoreID + "'", null);

        if (cursor!=null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                cnt = cursor.getInt(0);
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        //close();
        return cnt;
    }

    public String[] FetchStoreStatus(String rID) {

        int ScodecolumnIndex = 0;

        //Cursor cursor = db.rawQuery("SELECT Sstat,ISNewStore FROM tblStoreList ORDER BY DistanceNear", null);
        Cursor cursor = db.rawQuery("SELECT Sstat, ISNewStore FROM tblStoreList  ORDER BY DistanceNear", null);// where StoreRouteID='"+ rID +"'

        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = cursor.getString(ScodecolumnIndex).toString() + "~" + cursor.getString(1).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    /*	public static void UpdateStoreCloseNextDay(String StoreID, int outStat) {

		final ContentValues values = new ContentValues();
		values.put("Sstat", outStat);

		int affected = db.update("tblStoreList", values,"StoreID=? and (StoreClose=1 or  StoreNextDay=1) and Sstat=0",
				new String[] { StoreID });
		Log.w(TAG, "affected records: " + affected);

		Log.w(TAG, "UpdateStoreEndVisit Updated..");
	}*/
    public int getStoreClosedStatus(String storeID) {
        Cursor cursor = db.rawQuery("Select StoreClose from tblStoreVisitMstr where StoreID = '" + storeID + "'", null);
        int status = 0;
        try {

            if (cursor.getCount() != 0) {
                while (cursor.moveToNext()) {
                    status = cursor.getInt(0);         //return cursor.getInt(0);
                }
                //return 0;
            }
        } finally {
            cursor.close();
            return status;
        }
    }

    public String[] FetchStoreList(String rID) {
        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;

        //Cursor cursor = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList   ORDER BY DistanceNear", null); //where StoreRouteID='"+ rID +"'
        /*  Cursor cursor = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList where StoreRouteID='"+ rID +"'  ORDER BY DistanceNear", null); //where StoreRouteID='"+ rID +"'*/
        Cursor cursor = db.rawQuery("SELECT StoreID, (StoreName || ' ('|| ifnull(OwnerName,'NA') || ':' || ifnull(StoreContactNo,'NA') || ') ')  AS StoreName,ifnull(StoreContactNo,'NA') FROM tblStoreList ORDER BY DistanceNear", null);// where StoreRouteID='"+ rID +"'  //where StoreRouteID='"+ rID +"'//|| '('||OwnerName ||' : '||StoreContactNo||')'

        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    int closedStatus = getStoreClosedStatus(cursor.getString(ScodecolumnIndex));
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString() + "_" + (String) cursor.getString(SnamecolumnIndex).toString() + "_" + closedStatus + "_" + cursor.getString(2);
                    cursor.moveToNext();
                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    //Cursor cursorLocE = db.rawQuery("SELECT ActualLatitude FROM tblStoreList WHERE StoreID ='"+ passedStoreID + "'", null);

    public String[] ProcessStoreReq() {
        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;

        //Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList WHERE (Sstat = 1  OR StoreNextDay = 1) and Sstat<>4  and Sstat<>5 and Sstat<>6",null);//OR StoreClose = 1
        Cursor cursor2 = db.rawQuery("SELECT DISTINCT tblStoreVisitMstr.StoreID, tblStoreList.StoreName FROM tblStoreVisitMstr inner join tblStoreList On tblStoreVisitMstr.StoreID=tblStoreList.StoreID WHERE (tblStoreVisitMstr.VisitTypeStatus ='2' OR tblStoreVisitMstr.VisitTypeStatus='4'  OR tblStoreVisitMstr.StoreNextDay = 1 ) and tblStoreList.Sstat<>4  and tblStoreList.Sstat<>5 and tblStoreList.Sstat<>6", null);//OR StoreClose = 1
        try {
            String strAreaIdsDetais[] = new String[cursor2.getCount()];
            ////// System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());
            if (cursor2.moveToFirst()) {
                for (int i = 0; i < cursor2.getCount(); i++) {
                    strAreaIdsDetais[i] = (String) cursor2.getString(LoncolumnIndex) + "%" + (String) cursor2.getString(LoncolumnIndex2);
                    ////// System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }
            }
            return strAreaIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    public boolean GetLeftStoresChk() {

        Cursor cursorDateE = db.rawQuery("SELECT DISTINCT tblStoreVisitMstr.StoreID, tblStoreList.StoreName FROM tblStoreVisitMstr inner join tblStoreList On tblStoreVisitMstr.StoreID=tblStoreList.StoreID WHERE (tblStoreList.Sstat = 3  OR tblStoreVisitMstr.StoreClose = 1 OR tblStoreVisitMstr.StoreNextDay = 1) AND tblStoreList.Sstat<>4 AND tblStoreList.Sstat<>5 AND tblStoreList.Sstat<>6", null);

        try {
            if (cursorDateE.getCount() > 0) {
                ////// System.out.println("GetLeftStoresChk - Records Count: "+ cursorDateE.getCount());
                ////// System.out.println("returning GetLeftStoresChk - true");
                return true;
            } else {
                return false;
            }

        } finally {
            cursorDateE.close();
        }

    }

    public long insertTblSelectedStoreIDinChangeRouteCase(String StorID) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StorID);

        return db.insert(DBHelper.DATABASE_TABLE_MAIN92, null, initialValues);
    }

    public String[] getStoreIDTblSelectedStoreIDinChangeRouteCase() {

        int SnamecolumnIndex1 = 0;

        //Cursor cursor = db.rawQuery("SELECT OutId FROM tblOutletPicMstr WHERE OutId IN (SELECT StoreId FROM tblStoreList WHERE Sstat IN (1, 3))", null);

        Cursor cursor = db.rawQuery("SELECT StoreID FROM tblSelectedStoreIDinChangeRouteCase", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();
                    ////// System.out.println("STORE ID 4 Pic: "+cursor.getString(SnamecolumnIndex1).toString());

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public void UpdateStoreFlagAtDayEndOrChangeRoute(String sID, int flag2set) {

        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            int affected24 = db.update("tblStoreOrderBillAddressDetails", values, "StoreID=?", new String[]{sID});
            int affected25 = db.update("tblStoreSalesOrderPaymentDetails", values, "StoreId=?", new String[]{sID});
            int affected26 = db.update("tblRateDistribution", values, "StoreId=?", new String[]{sID});
            // int affected27 = db.update("tableImage", values,"StoreID=?", new String[] { sID });

            //tblNewStoreSalesQuotePaymentDetails (StoreId text null,PymtStageId text null,Sstat text null);";
            int affected23 = db.update("tblNewStoreSalesQuotePaymentDetails", values, "StoreId=?", new String[]{sID});

            //tblOutletQuestAnsMstr
            ////// System.out.println("Updating Status for Store ID: " + sID);
            int affected = db.update("tblStoreList", values, "StoreID=?", new String[]{sID});
            //int affected2 = db.update("tblTransac", values, "StoreID=?",new String[] { sID });

            int affected4 = db.update("tblNewStoreListEntries", values, "StoreID=?", new String[]{sID});

            //int affected4 = db.update("tblDistributionStoreProductWiseDetails", values, "StoreID=?",new String[] { sID });
            //int affected5 = db.update("tblDistributionStoreProductMstr", values, "StoreID=?",new String[] { sID });

            int affected9 = db.update("tblNewStoreEntries", values, "StoreID=?", new String[]{sID});
            int affected10 = db.update("tblTemp", values, "StoreID=?", new String[]{sID});

            // int affected3 = db.update("tblTmpInvoiceHeader", values, "StoreID=? ",new String[] { sID });

            //int affected4 = db.update("tblDistributionStoreProductWiseDetails", values, "StoreID=?",new String[] { sID });
            //int affected5 = db.update("tblDistributionStoreProductMstr", values, "StoreID=?",new String[] { sID });
            int affected5 = db.update("tblPDAProductReturnMstr", values,
                    "StoreID=? ", new String[]{sID});

            //   int affected7 = db.update("tblTmpInvoiceDetails", values,"StoreID=?  ", new String[] { sID });
            int affected8 = db.update("tblStoreProductAppliedSchemesBenifitsRecords", values, "StoreID=? ", new String[]{sID});


            int affected11 = db.update("tblStoreReturnDetail", values, "StoreID=? ", new String[]{sID});


            //int affected12 = db.update("tblStoreReturnDetail", values,"StoreID=?", new String[] { sID });
            int affected13 = db.update("tblProductMappedWithSchemeSlabApplied", values, "StoreId=? ", new String[]{sID});
            //StoreId text null,ProductID text null,schSlabId text null,schmIdMapped text null,Sstat int null);";
            int affected14 = db.update("tblStoreProductPhotoDetail", values, "StoreID=? ", new String[]{sID});

            int affected21 = db.update("tblOutletQuestAnsMstr", values, "OutletID=?", new String[]{sID});

            int affected261 = db.update("tblNewAddedStoreLocationDetails", values, "StoreID=?", new String[]{sID});
            int affected17 = db.update("tblSalesQuotePersonMeetMstr", values, "StoreId=?", new String[]{sID});

            // int affected171 = db.update("tblAllCollectionData", values,"StoreID=?", new String[] { sID });

            // int affected19 = db.update("tblDsrRegDetails", values, "StoreID=?",new String[] { sID });

            db.execSQL("UPDATE tblDsrRegDetails SET Sstat=" + flag2set);

            LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr = fngetDistinctSalesQuotePersonMeetMstrForSstatUpdate(sID);


            Iterator it11new = hmapDistinctSalesQuotePersonMeetMstr.entrySet().iterator();

            while (it11new.hasNext()) {
                Entry pair = (Entry) it11new.next();
                if (hmapDistinctSalesQuotePersonMeetMstr.containsKey(pair.getKey().toString())) {
                    //crntPID	=pair.getKey().toString();
                    int affected18 = db.update("tblSalesQuoteProductsMstr", values, "SalesQuoteId=?", new String[]{pair.getKey().toString()});
                }

            }


            int chkValue = fnChkStoreIdExistsInReturnMstrDayEndChangeRoute(sID);

            if (chkValue == 1) {
                int productreturnmstrid = fnGetAutoIdStoreOnReturnPAge(sID);

                int chkValueReturnDetails = fnChkAutoIdMstrForReturnDetailsChangeRouteDayEnd(productreturnmstrid);
                if (chkValueReturnDetails == 1) {
                    int affected6 = db.update("tblPDAProductReturnDetails",
                            values, "ReturnIdMstr=? ", new String[]{""
                                    + productreturnmstrid});
                }
            }

            Log.w(TAG, "affected records: " + affected);

            Log.w(TAG, "Record(s) Updated..");

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }


    public void UpdatetblStoreClosedPhotoDetail(String sID, int flag2set) {

        try {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            int affected28 = db.update("tblStoreClosedPhotoDetail", values, "Sstat=?", new String[]{"3"});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void UpdateStoreImage(String sID, int flag2set) {

        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            int affected27 = db.update("tableImage", values, "Sstat=?", new String[]{"3"});
            int affected28 = db.update("tblStoreClosedPhotoDetail", values, "Sstat=?", new String[]{"3"});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public int fnChkAutoIdMstrForReturnDetailsChangeRouteDayEnd(int ReturnIdMstr) {

        int LoncolumnIndex = 0;
        int strReturnIdDetails = 0;

        Cursor cursor2 = db
                .rawQuery(
                        "SELECT AutoReturnDetailsId FROM  tblPDAProductReturnDetails where ReturnIdMstr='" + ReturnIdMstr + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdDetails = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdDetails;
        } finally {
            cursor2.close();
        }

    }

    public int fnChkStoreIdExistsInReturnMstrDayEndChangeRoute(String ReturnStoreId) {

        int LoncolumnIndex = 0;
        int strReturnIdMstr = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT AutoReturnIdMstr FROM  tblPDAProductReturnMstr where StoreID='"
                        + ReturnStoreId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnIdMstr = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnIdMstr;
        } finally {
            cursor2.close();
        }

    }

    public void UpdateStoreFlag(String sID, int flag2set) {

        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            if (flag2set == 3) {
                int affected4 = db.update("tblsameLocationForStoreRestartDone", values, "CrntStoreID=?", new String[]{sID});
            }

            int affected29 = db.update("tblStoreListForUpdateMstr", values, "StoreID=?", new String[]{sID});

            int affected3 = db.update("tblLatLongDetails", values, "StoreID=?", new String[]{sID});
            // int affected41 = db.update("tableImage", values,"StoreID=?", new String[] { sID });

            // int affected42 = db.update("tblAllCollectionData", values,"StoreID=?", new String[] { sID });

            int affected211 = db.update("tblActualVisitStock", values, "StoreID=?", new String[]{sID});


            int affected = db.update("tblStoreList", values, "StoreID=?", new String[]{sID});
            int affected62 = db.update("tblStoreCheckInPic", values, "StoreID=?", new String[]{sID});
            //  int affected1 = db.update("tblLatLongDetails", values, "StoreID=?",new String[] { sID });

            int affected26 = db.update("tblRateDistribution", values, "StoreId=?", new String[]{sID});


            int affected4 = db.update("tblNewStoreListEntries", values, "StoreID=?", new String[]{sID});
            int affected9 = db.update("tblNewStoreEntries", values, "StoreID=?", new String[]{sID});
            int affected10 = db.update("tblTemp", values, "StoreID=?", new String[]{sID});

            int affected15 = db.update("tblStoreMaterialDetail", values, "StoreID=?", new String[]{sID});
            int affected16 = db.update("tblStoreMaterialPhotoDetail", values, "StoreID=?", new String[]{sID});
            int affected17 = db.update("tblSalesQuotePersonMeetMstr", values, "StoreId=?", new String[]{sID});
            int affected21 = db.update("tblOutletQuestAnsMstr", values, "OutletID=?", new String[]{sID});

            int affected261 = db.update("tblNewAddedStoreLocationDetails", values, "StoreID=?", new String[]{sID});

            int affected23 = db.update("tblNewStoreSalesQuotePaymentDetails", values, "StoreId=?", new String[]{sID});

            int affected24 = db.update("tblStoreOrderBillAddressDetails", values, "StoreID=?", new String[]{sID});
            int affected25 = db.update("tblStoreSalesOrderPaymentDetails", values, "StoreId=?", new String[]{sID});


            LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr = fngetDistinctSalesQuotePersonMeetMstrForSstatUpdate(sID);
            Iterator it11new = hmapDistinctSalesQuotePersonMeetMstr.entrySet().iterator();
            while (it11new.hasNext()) {
                Entry pair = (Entry) it11new.next();
                if (hmapDistinctSalesQuotePersonMeetMstr.containsKey(pair.getKey().toString())) {
                    int affected18 = db.update("tblSalesQuoteProductsMstr", values, "SalesQuoteId=?", new String[]{pair.getKey().toString()});
                }

            }


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void UpdateStoreOtherMainTablesFlag(String sID, int flag2set, String pdaOrderID, String TmpInvoiceCodePDA) {

        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);


            //   int affected3 = db.update("tblTmpInvoiceHeader", values, "StoreID=? AND TmpInvoiceCodePDA=?",new String[] { sID,TmpInvoiceCodePDA });

            //int affected4 = db.update("tblDistributionStoreProductWiseDetails", values, "StoreID=?",new String[] { sID });
            //int affected5 = db.update("tblDistributionStoreProductMstr", values, "StoreID=?",new String[] { sID });
            int affected5 = db.update("tblPDAProductReturnMstr", values,
                    "StoreID=? AND TmpInvoiceCodePDA=?", new String[]{sID, TmpInvoiceCodePDA});

            //   int affected7 = db.update("tblTmpInvoiceDetails", values,"StoreID=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });
            int affected8 = db.update("tblStoreProductAppliedSchemesBenifitsRecords", values, "StoreID=? AND TmpInvoiceCodePDA=?", new String[]{sID, TmpInvoiceCodePDA});


            int affected11 = db.update("tblStoreReturnDetail", values, "StoreID=? AND TmpInvoiceCodePDA=?", new String[]{sID, TmpInvoiceCodePDA});

            //int affected12 = db.update("tblStoreReturnDetail", values,"StoreID=?", new String[] { sID });
            int affected13 = db.update("tblProductMappedWithSchemeSlabApplied", values, "StoreId=? AND TmpInvoiceCodePDA=?", new String[]{sID, TmpInvoiceCodePDA});
            //StoreId text null,ProductID text null,schSlabId text null,schmIdMapped text null,Sstat int null);";
            int affected14 = db.update("tblStoreProductPhotoDetail", values, "StoreID=? AND TmpInvoiceCodePDA=?", new String[]{sID, TmpInvoiceCodePDA});

            int affected290 = db.update("tblStoreSalesOrderPaymentDetails", values, "StoreId=? AND TmpInvoiceCodePDA=?", new String[]{sID, TmpInvoiceCodePDA});
            //int affected291 = db.update("tblAllCollectionData", values,"StoreID=? AND TmpInvoiceCodePDA=?", new String[] { sID,TmpInvoiceCodePDA });


            int chkValue = fnChkStoreIdExistsInReturnMstr(sID, pdaOrderID, TmpInvoiceCodePDA);

            if (chkValue == 1) {
                int productreturnmstrid = fnGetAutoIdStoreOnReturnPAge(sID);

                int chkValueReturnDetails = fnChkAutoIdMstrForReturnDetails(productreturnmstrid, pdaOrderID, TmpInvoiceCodePDA);
                if (chkValueReturnDetails == 1) {
                    int affected6 = db.update("tblPDAProductReturnDetails",
                            values, "ReturnIdMstr=? AND TmpInvoiceCodePDA=?", new String[]{""
                                    + productreturnmstrid, TmpInvoiceCodePDA});
                }
            }
            //

            //Log.w(TAG, "affected records: " + affected);

            Log.w(TAG, "Record(s) Updated..");

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void UpdateStoreVisitBatt(String StoreID, String vBatt) {

      /*  final ContentValues values = new ContentValues();
        values.put("BateryLeftStatus", vBatt);
        int affected = db.update("tblStoreVisitMstr", values, "StoreID=?",
                new String[] { StoreID });
        Log.w(TAG, "affected records: " + affected);*/

    }

    public void UpdateStoreVisitBattVisitWise(String StoreID, String vBatt, String StoreVisitCode) {
//open();
        final ContentValues values = new ContentValues();
        values.put("BateryLeftStatus", vBatt);
        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?",
                new String[]{StoreID, StoreVisitCode});
        //close();
        Log.w(TAG, "affected records: " + affected);

    }

    // ---insert XML data into the database---
    public void createRouteTBL() {
        try {

            db.execSQL(DBHelper.TABLE_tblRouteListMaster_Definition);
            //db.execSQL(DATABASE_CREATE_TABLE_2);
        } catch (Exception e) {
            Log.e(TAG, "Error: onUpgrade db");
        }

    }

   /*public void UpdateStoreActualLatLongi(String StoreID,
                                          String ActualLatitude, String ActualLongitude, String Accuracy,
                                          String LocProvider, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgRestart, int flgStoreOrder)
    {
        //open();
        final ContentValues values = new ContentValues();
        values.put("ActualLatitude", ActualLatitude);
        values.put("ActualLongitude", ActualLongitude);
        values.put("Accuracy", Accuracy);
        values.put("LocProvider", LocProvider);


        values.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
        values.put("flgGPSOnOff", flgGPSOnOff);
        values.put("flgNetworkOnOff", flgNetworkOnOff);
        values.put("flgFusedOnOff", flgFusedOnOff);
        values.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
        values.put("flgRestart", flgRestart);


        int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { StoreID });
        close();
        Log.w(TAG, "affected records: " + affected);


    }*/


    // ---insert sample data into the database---
    //

    public void fnSetAllRouteActiveStatus() {

        try {


            db.execSQL("UPDATE tblRouteListMaster SET flgTodayRoute= 0");
            /* */


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }


    // tblRouteListMaster(ID string null, Descr string null, Active int null);";

    public void updateActiveRoute(String sID, int flag2set) {

        try {


            final ContentValues values = new ContentValues();
            values.put("flgTodayRoute", flag2set);

            int affected = db.update("tblRouteListMaster", values, "ID=?",
                    new String[]{sID});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public String GetRouteNameBasedOnRouteID(String ID) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster WHERE ID='" + ID + "' Limit 1", null);
        try {
            //String strLocationIDDetais[] = new String[cursor2.getCount()];
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("active Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }


    public String GetRouteNameBasedOnRouteIDForStoreEdit(String ID) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster WHERE ID='" + ID + "' Limit 1", null);
        try {
            //String strLocationIDDetais[] = new String[cursor2.getCount()];
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("active Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public String GetRouteDateBasedOnRouteID(String ID) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT RouteDate FROM tblRouteListMaster WHERE ID='" + ID + "'", null);
        try {
            //String strLocationIDDetais[] = new String[cursor2.getCount()];
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("active Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public String GetActiveRouteIDForToday(String fDate) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE RouteDate='" + fDate + "' and Active = 1 Limit 1", null);
        try {
            //String strLocationIDDetais[] = new String[cursor2.getCount()];
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("active Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public String GetActiveRouteIDForTomorrow(String fDate) {

        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE RouteDate='" + fDate + "' Limit 1", null);
        try {
            //String strLocationIDDetais[] = new String[cursor2.getCount()];
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    ////// System.out.println("active Route Id : "+ cursor2.getString(LoncolumnIndex).toString().trim());
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    //StoreID ='"+ StoreID + "'"

    public String GetAllActiveRouteDescr() {
        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster WHERE flgTodayRoute = 1", null);
        try {
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (i == 0) {
                        activeRouteID = cursor2.getString(LoncolumnIndex);
                    } else {
                        activeRouteID = activeRouteID + "^" + cursor2.getString(LoncolumnIndex);
                    }
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public String GetAllActiveRouteID() {
        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute=1", null);
        try {
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    if (i == 0) {
                        activeRouteID = cursor2.getString(LoncolumnIndex);
                    } else {
                        activeRouteID = activeRouteID + "^" + cursor2.getString(LoncolumnIndex);
                    }
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public String GetActiveRouteID() {
        int LoncolumnIndex = 0;
        String activeRouteID = "0";
        Cursor cursor2 = null;
        cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);

        try {

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }
            }
            if (activeRouteID.equals("0")) {
                activeRouteID = fnGetRouteIDWhilePurshase();
            }
            if (!CommonInfo.ActiveRouteSM.equals("0")) {
                activeRouteID = CommonInfo.ActiveRouteSM;
            }

        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }
            return activeRouteID;
        }
    }

    public String GetNOActiveRouteIDSunil() {
        int LoncolumnIndex = 0;

        //open();
        Cursor cursor2 = null;
        try {
            //cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);
            cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 0 Limit 1", null);


            String activeRouteID = "0";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
            //close();
        }

    }

    public String GetNotActiveRouteID() {
        int LoncolumnIndex = 0;
        String activeRouteID = "0";
        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster Limit 1", null);
        try {

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }

        } finally {
            cursor2.close();
            return activeRouteID;
        }

    }

    public String GetActiveRouteIDSunil() {
        int LoncolumnIndex = 0;

        //open();
        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);

            String activeRouteID = "0";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            if (!CommonInfo.ActiveRouteSM.equals("0")) {
                activeRouteID = CommonInfo.ActiveRouteSM;
            }
            return activeRouteID;
        } finally {
            cursor2.close();
            //close();
        }

    }

    public String GetCurrentDayActiveRouteID() {
        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE Active=1 Limit 1", null);
        try {
            String activeRouteID = "NA";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public int GetActiveRouteIDForRadioButton() {
        int LoncolumnIndex = 0;

        Cursor cursor2 = db.rawQuery("SELECT Active FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);
        try {
            int activeRouteID = 0;
            if (cursor2.moveToFirst()) {


                activeRouteID = Integer.parseInt(cursor2.getString(LoncolumnIndex));


            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public long savetblPOSMaterialMstr(String POSMaterialID, String POSMaterialDescr) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("POSMaterialID", POSMaterialID.trim());
        initialValues.put("POSMaterialDescr", POSMaterialDescr.trim());


        return db.insert(DBHelper.DATABASE_TABLE_MAIN161, null, initialValues);

    }

    public long savetblStoreIDAndMaterialIDMap(String StoreID, String VisitID, String MaterialID, String CurrentStockQty) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("VisitID", VisitID.trim());
        initialValues.put("MaterialID", MaterialID.trim());
        initialValues.put("CurrentStockQty", CurrentStockQty.trim());


        return db.insert(DBHelper.DATABASE_TABLE_MAIN162, null, initialValues);
    }

    public long savetblSchemeStoreMapping(String StoreID, String SchemeID) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("SchemeID", SchemeID.trim());

        // System.out.println("Ajay Data Save in table 201");


        return db.insert(DBHelper.DATABASE_TABLE_MAIN201, null, initialValues);

    }

    public long savetblSchemeMstr(String SchemeID, String SchemeName, String SchemeApplicationID, String SchemeAppliedRule) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("SchemeID", SchemeID.trim());
        initialValues.put("SchemeName", SchemeName.trim());
        initialValues.put("SchemeApplicationID", SchemeApplicationID.trim());
        initialValues.put("SchemeAppliedRule", SchemeAppliedRule.trim());


        // System.out.println("Ajay Data Save in table 202");


        return db.insert(DBHelper.DATABASE_TABLE_MAIN202, null, initialValues);
    }

    public long savetblSchemeSlabDetail(String SchemeID, String SchemeSlabID, String SchemeSlabDesc, String BenifitDescr) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("SchemeID", SchemeID.trim());
        initialValues.put("SchemeSlabID", SchemeSlabID.trim());
        initialValues.put("SchemeSlabDesc", SchemeSlabDesc.trim());
        initialValues.put("BenifitDescr", BenifitDescr.trim());

        // System.out.println("Ajay Data Save in table 203");
        return db.insert(DATABASE_TABLE_MAIN203, null, initialValues);
    }

    public long savetblSchemeSlabBucketDetails(String RowID, String SchemeID, String SchemeSlabID,
                                               String BucketID, String SubBucketID, String SlabSubBucketType, String SlabSubBucketValue, String SubBucketValType) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("RowID", RowID.trim());
        initialValues.put("SchemeID", SchemeID.trim());
        initialValues.put("SchemeSlabID", SchemeSlabID.trim());
        initialValues.put("BucketID", BucketID.trim());

        initialValues.put("SubBucketID", SubBucketID.trim());
        initialValues.put("SlabSubBucketType", SlabSubBucketType.trim());
        initialValues.put("SlabSubBucketValue", SlabSubBucketValue.trim());
        initialValues.put("SubBucketValType", SubBucketValType.trim());

        // System.out.println("Ajay Data Save in table 204");
        return db.insert(DATABASE_TABLE_MAIN204, null, initialValues);
    }

    public void savetblSchemeSlabBucketProductMapping(List<TblSchemeSlabBucketProductMapping> tblSchemeSlabBucketProductMappingList) {

        for (TblSchemeSlabBucketProductMapping tblSchemeSlabBucketProductMapping : tblSchemeSlabBucketProductMappingList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("RowID", tblSchemeSlabBucketProductMapping.getRowID());
            initialValues.put("ProductID", "" + tblSchemeSlabBucketProductMapping.getProductID());
            initialValues.put("flgCombine", "" + tblSchemeSlabBucketProductMapping.getFlgCombine());
            initialValues.put("QtyPerLine", "" + tblSchemeSlabBucketProductMapping.getQtyPerLine());

            Log.d("SchemeSlabBucketDetails", "" + db.insert(DBHelper.DATABASE_TABLE_MAIN205, null, initialValues));
        }

    }


    //tblSchemeSlabBucketProductMapping (RowID text null,ProductID text null);";

    public long savetblSchemeSlabBenefitsBucketDetails(String RowID, String SchemeID, String SchemeSlabID,
                                                       String BucketID, String SubBucketID, String BenSubBucketType, String BenDiscApplied, String CouponCode
            , String BenSubBucketValue, String per, String UOM, int ProRata) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("RowID", RowID.trim());
        initialValues.put("SchemeID", SchemeID.trim());
        initialValues.put("SchemeSlabID", SchemeSlabID.trim());
        initialValues.put("BucketID", BucketID.trim());
        initialValues.put("SubBucketID", SubBucketID.trim());
        initialValues.put("BenSubBucketType", BenSubBucketType.trim());
        initialValues.put("BenDiscApplied", BenDiscApplied.trim());
        initialValues.put("CouponCode", CouponCode.trim());
        initialValues.put("BenSubBucketValue", BenSubBucketValue.trim());
        initialValues.put("Per", Double.parseDouble(per));
        if (Double.parseDouble(per) == 1000.00) {
            // System.out.println("NDTV"+Double.parseDouble(per));
        }
        initialValues.put("UOM", Double.parseDouble(UOM));
        initialValues.put("ProRata", ProRata);


        // System.out.println("Ajay Data Save in table 206");
        return db.insert(DATABASE_TABLE_MAIN206, null, initialValues);
    }

	/* dbengine.savetblSchemeSlabBenefitsBucketDetails(RowID,SchemeID,SchemeSlabID,BucketID,
     		SubBucketID,BenSubBucketType,BenDiscApplied,CouponCode,BenSubBucketValue);
     */

    public long savetblSchemeSlabBenefitsProductMappingDetail(String RowID, String ProductID) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("RowID", RowID.trim());
        initialValues.put("ProductID", ProductID.trim());

        // System.out.println("Ajay Data Save in table 207");
        return db.insert(DATABASE_TABLE_MAIN207, null, initialValues);
    }

    public long savetblSchemeSlabBenefitsValueDetail(String RowID, String BenValue, String Remarks, String Type) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("RowID", RowID.trim());
        initialValues.put("BenValue", BenValue.trim());
        initialValues.put("Remarks", Remarks.trim());
        initialValues.put("Type", Type.trim());

        // System.out.println("Ajay Data Save in table 208");
        return db.insert(DATABASE_TABLE_MAIN208, null, initialValues);
    }

    //tblSchemeSlabBenefitsValueDetail (RowID text null,BenValue text null,Remarks text null,Type text null);";

    public long savetblProductRelatedScheme(String ProductID, String PrdString) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("ProductID", ProductID.trim());
        initialValues.put("PrdString", PrdString.trim());

        // System.out.println("Ajay Data Save in table 209");
        return db.insert(DATABASE_TABLE_MAIN209, null, initialValues);
    }

    //tblProductRelatedScheme (ProductID text null,PrdString text null);";

    public void saveRoutesInfo(List<TblRouteListMaster> tblRouteListMaster, String fDate) {
//    public long saveRoutesInfo(String ID, String RouteType, String Descr, int ActiveFlg, int flgTodayRoute, String RouteDate) {
        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_tblRouteListMaster_Define +
                    " (ID, RouteType, Descr, Active, flgTodayRoute, RouteDate,flgApproved,DBNodeID) VALUES (?, ?, ?, ?, ?, ?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblRouteListMaster tbl : tblRouteListMaster) {
                stmt.bindLong(1, tbl.getID());
                stmt.bindLong(2, tbl.getRouteType());
                stmt.bindString(3, tbl.getDescr().replaceAll("-"," "));
                stmt.bindLong(4, tbl.getActive());
                stmt.bindLong(5, tbl.getActive());
                stmt.bindString(6, fDate);
                if(tbl.getActive()==1)
                    stmt.bindLong(7, 1);
                    else
                stmt.bindLong(7, tbl.getFlgApproved());

                stmt.bindLong(8, tbl.getDBNodeID());

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
//        ContentValues initialValues = new ContentValues();
//        initialValues.put("ID", ID.trim());
//        initialValues.put("RouteType", RouteType.trim());
//        initialValues.put("Descr", Descr.trim());
//        initialValues.put("Active", ActiveFlg);
//        initialValues.put("flgTodayRoute", flgTodayRoute);
//        initialValues.put("RouteDate", RouteDate);
//
//
//        return db.insert(DBHelper.TABLE_tblRouteListMaster_Define, null, initialValues);
    }

    public int fncheckStoreIsNewOrOld(String StoreID) {
        //open();
        Cursor cursor = db.rawQuery("SELECT ISNewStore FROM tblStoreList WHERE StoreID='" + StoreID + "'", null);
        try {
            int ISNewStore = 0;
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    ISNewStore = Integer.parseInt(cursor.getString(0).toString());

                }
            }
            return ISNewStore;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }

    }

    //(StoreID text not null, StoreType string not null, StoreName string not null, StoreLatitude real not null,
    //StoreLongitude real not null, LastVisitDate string not null, LastTransactionDate string not null, Sstat integer not null,
    //ForDate string not null, ActualLatitude text null, ActualLongitude text null, VisitStartTS text null, VisitEndTS text null,
    //AutoIdStore int null, LocProvider text null, Accuracy text null, BateryLeftStatus text null,StoreClose integer null,
    //StoreNextDay integer null,chainID integer null);";


	/*private static final String DATABASE_CREATE_TABLE_13 = "create table tblStoreList " +
	(StoreID text not null, StoreType string not null, StoreName string not null, StoreLatitude real not null,
   StoreLongitude real not null, LastVisitDate string not null, LastTransactionDate string not null,
   Sstat integer not null, ForDate string not null, ActualLatitude text null, ActualLongitude text null,
   VisitStartTS text null, VisitEndTS text null, ISNewStore int null, AutoIdStore int null, LocProvider text null,
   Accuracy text null, BateryLeftStatus text null,StoreRouteID text null);";
*/

    public int fncheckStoreIsNewStoreDataCompleteSaved(String StoreID) {
        //open();
        Cursor cursor = db.rawQuery("SELECT IsNewStoreDataCompleteSaved FROM tblStoreList WHERE StoreID='" + StoreID + "'", null);
        try {
            int IsNewStoreDataCompleteSaved = 0;
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    IsNewStoreDataCompleteSaved = Integer.parseInt(cursor.getString(0).toString());

                }
            }
            return IsNewStoreDataCompleteSaved;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }

    }


    public int getFwdPgIdonNextBtnClick(String StoreID, String PgId, String ChainId) {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT fwdSeq FROM tblStorePgSeqFlow WHERE storeID=" + StoreID + " and pgId=" + PgId + " and chainID=" + ChainId, null);
        try {
            int strFwdPgIdonNextBtnClick = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strFwdPgIdonNextBtnClick = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        ////// System.out.println("Store Page PgId = "+ PgId +" and strFwdPgIdonNextBtnClick :"+strFwdPgIdonNextBtnClick);
                        cursor.moveToNext();
                    }

                }
            }
            return strFwdPgIdonNextBtnClick;
        } finally {
            cursor.close();
        }
    }

    public int getFwdPgIdonBackBtnClick(String StoreID, String PgId, String ChainId) {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT bckSeq FROM tblStorePgSeqFlow WHERE storeID=" + StoreID + " and pgId=" + PgId + " and chainID=" + ChainId, null);
        try {
            int strFwdPgIdonBackBtnClick = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strFwdPgIdonBackBtnClick = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        ////// System.out.println("Store Page PgId = "+ PgId +" and strFwdPgIdonBackBtnClick :"+strFwdPgIdonBackBtnClick);
                        cursor.moveToNext();
                    }

                }
            }
            return strFwdPgIdonBackBtnClick;
        } finally {
            cursor.close();
        }
    }

    public String getCustomPGid(int pgID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT pgName FROM tblStorePgSeqFlow WHERE pgId = " + pgID, null);
        try {
            String strProdStockQty = "";
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = cursor.getString(ScodecolumnIndex).toString();    //Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public String[] checkStoreCloseOrNextMethod(String StoreID) {

        int columnIndex1 = 0;
        int columnIndex2 = 1;
        Cursor cursor2 = db.rawQuery("SELECT StoreClose FROM tblStoreVisitMstr WHERE StoreID ='" + StoreID + "'", null);
        //Cursor cursorLocE = db.rawQuery("SELECT ActualLatitude FROM tblStoreList WHERE StoreID ='"+ passedStoreID + "'", null);

        try {
            String checkStoreCloseOrNextDetials[] = new String[cursor2.getCount()];

            ////// System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    checkStoreCloseOrNextDetials[i] = (String) cursor2.getString(columnIndex1);//+ "_"+ (String) cursor2.getString(columnIndex2);

                    //////// System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }

            }
            return checkStoreCloseOrNextDetials;
        } finally {
            cursor2.close();
        }

    }

    public int getChainIDBasedOnStoreID(String StoreID) {
        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT chainID FROM tblStorePgSeqFlow WHERE storeID=" + StoreID, null);
        try {
            int strChainID = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strChainID = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        ////// System.out.println("Store StoreID = '"+ StoreID +"' and strChainID :"+strChainID);
                        cursor.moveToNext();
                    }

                }
            }
            return strChainID;
        } finally {
            cursor.close();
        }
    }

    public String[] FetchStoreStoreNextDayStatus() {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT StoreNextDay FROM tblStoreList ORDER BY DistanceNear", null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public void updateCloseflg(String sID, int StoreClose) {
        try {
            ContentValues values = new ContentValues();
            values.put("StoreClose", StoreClose);
            int affected = db.update("tblStoreVisitMstr", values, "StoreID= ?", new String[]{sID});
            Log.w(TAG, "affected records: " + affected);
            Log.w(TAG, "Record(s) Updated..");

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void updateNextDayflg(String sID, int StoreNextDay) {
        try {
            ContentValues values = new ContentValues();
            values.put("StoreNextDay", StoreNextDay);
            ////// System.out.println("nextday: "+StoreNextDay);
            int affected = db.update("tblStoreVisitMstr", values, "StoreID= ?", new String[]{sID});

            Log.w(TAG, "affected records: " + affected);

            Log.w(TAG, "Record(s) Updated..");

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public String[] FetchStoreStoreCloseStatus(String rID) {
        int ScodecolumnIndex = 0;

        //Cursor cursor = db.rawQuery("SELECT StoreClose FROM tblStoreList ORDER BY DistanceNear", null);
        Cursor cursor = db.rawQuery("SELECT StoreClose FROM tblStoreList where StoreRouteID='" + rID + "'   ORDER BY DistanceNear", null);

        try {
            String StoreName[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public int getRouteId() {
        int LoncolumnIndex = 0;

        int strRouteIdMstr = 0;
        Cursor cursor2 = db.rawQuery("SELECT ID FROM  tblRouteListMaster where flgTodayRoute=1", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strRouteIdMstr = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strRouteIdMstr;
        } finally {
            cursor2.close();
        }
    }

	/*public static void deleteCategroyProductINformation(String CategoryId, String storeID) {
		// int entryCount;
		db.execSQL("DELETE FROM tblCategoryQuestionInformation WHERE CategoryID ='" + CategoryId + "' and StoreID='"+ storeID +"'");

	}*/

    public String[] fnarrUniqueProductsSaleSummry() {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;

        //ProductID text not null, ProductShortName

        //Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductShortName, KGLiter, DisplayUnit FROM tblProductListMaster", null);
        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductShortName, KGLiter, DisplayUnit FROM tblProductListMaster", null);
        try {
            String UniqueProductShortName[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        UniqueProductShortName[i] = cursor2.getString(LoncolumnIndex).toString() + "^" + cursor2.getString(LoncolumnIndex1).toString() + "^" + cursor2.getString(LoncolumnIndex2).toString();
                        //// System.out.println("Anuj ProductShortName sunil: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"KGLiter sunil: "+(String) cursor2.getString(LoncolumnIndex1));

                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueProductShortName;
        } finally {
            cursor2.close();
        }
    }

    public String fnCalculateLinesSkuWise(String PSName) {
        String LineValue = "0";
        int LoncolumnIndex = 0;


        //ProductID text not null, ProductShortName

        Cursor cursor2 = db.rawQuery("SELECT Count(DISTINCT StoreID) FROM tblTmpInvoiceDetails WHERE OrderQty>0 and ProductShortName ='" + PSName + "'", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {

                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (!cursor2.isNull(LoncolumnIndex)) {
                            LineValue = cursor2.getString(LoncolumnIndex).toString();
                            cursor2.moveToNext();
                        }

                    }

                }
            }

        } finally {
            cursor2.close();
        }

        return LineValue;
    }

    public String[] fnCalculateProductsSaleSummry() {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String[] UniqueProductsSaleSummry;
        UniqueProductsSaleSummry = fnarrUniqueProductsSaleSummry();
        String val = "";
        String SummryPName = "";
        String SDisplayName = "";
        String SDisplayUnit = "";


        String SumOQty[] = new String[UniqueProductsSaleSummry.length];
        String SumFQty[] = new String[UniqueProductsSaleSummry.length];
        String SumSQty[] = new String[UniqueProductsSaleSummry.length];
        //String DisplaySQty[]=new String[UniqueProductsSaleSummry.length];

        String SumOQtyKG[] = new String[UniqueProductsSaleSummry.length];
        String SumFQtyKG[] = new String[UniqueProductsSaleSummry.length];
        String SumSQtyKG[] = new String[UniqueProductsSaleSummry.length];
        //String DisplaySKG[]=new String[UniqueProductsSaleSummry.length];

        String SummryProductName[] = new String[UniqueProductsSaleSummry.length];
        String SummryDisplayUnit[] = new String[UniqueProductsSaleSummry.length];

        String FinalReturnValue[] = new String[UniqueProductsSaleSummry.length];

        String LineSkuWise[] = new String[UniqueProductsSaleSummry.length];


        for (int kk = 0; kk < UniqueProductsSaleSummry.length; kk++) {
            val = "";
            SummryPName = "";
            SDisplayUnit = "";
            String getVal = "";
            getVal = UniqueProductsSaleSummry[kk].toString().trim();

            StringTokenizer tokens = new StringTokenizer(String.valueOf(getVal), "^");
            SummryPName = tokens.nextToken().trim();
            val = tokens.nextToken().trim();
            SDisplayUnit = tokens.nextToken().trim();
            //SDisplayName=tokens.nextToken().trim();
            //////////// System.out.println("SummryPName"+SummryPName);
            //////////// System.out.println("SDisplayUnit"+SDisplayUnit);

            SummryProductName[kk] = SummryPName;
            SummryDisplayUnit[kk] = SDisplayUnit;
            ////////////// System.out.println("SummryProductName[kk]"+SummryProductName[kk]);
            //////////// System.out.println("SummryProductName val"+val);


            LineSkuWise[kk] = fnCalculateLinesSkuWise(SummryPName);

            //if(val.contains("0g"))
            if (SDisplayUnit.contains("Kg")) {

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity) FROM  tblTmpInvoiceDetails where ProductShortName ='" + SummryPName + "'", null);
                try {
                    //val=val.replace("g", "");
                    if (cursor2.getCount() > 0) {


                        if (cursor2.moveToFirst()) {

                            for (int i = 0; i < cursor2.getCount(); i++) {

                                if (!cursor2.isNull(LoncolumnIndex)) {
                                    SumOQty[kk] = "" + Integer.parseInt(cursor2.getString(LoncolumnIndex));
                                    //////////// System.out.println("SummryPName SumOQty[kk]"+SumOQty[kk]);
                                    String OrderKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //////////// System.out.println("SummryPName OrderKG"+OrderKG);
                                    SumOQtyKG[kk] = ConvertGramToKilo(OrderKG);
                                    //	cursor2.moveToNext();
                                } else {
                                    SumOQty[kk] = "" + "0";
                                    SumOQtyKG[kk] = "" + "0.0";
                                }

                                if (!cursor2.isNull(LoncolumnIndex1)) {
                                    SumFQty[kk] = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)));
                                    String FreeKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));

                                    SumFQtyKG[kk] = ConvertGramToKilo(FreeKG);

                                    //	cursor2.moveToNext();
                                } else {
                                    SumFQty[kk] = "" + "0";
                                    SumFQtyKG[kk] = "0.0";
                                }
                                if (!cursor2.isNull(LoncolumnIndex2)) {
                                    SumSQty[kk] = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)));
                                    String SampleKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    SumSQtyKG[kk] = ConvertGramToKilo(SampleKG);

                                } else {
                                    SumSQty[kk] = "0";
                                    SumSQtyKG[kk] = "0.0";
                                }
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
            //if(val.contains("0ml"))
            if (SDisplayUnit.contains("Lt")) {

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity) FROM  tblTmpInvoiceDetails where ProductShortName ='" + SummryPName + "'", null);
                try {
                    //val=val.replace("ml", "");
                    if (cursor2.getCount() > 0) {


                        if (cursor2.moveToFirst()) {

                            for (int i = 0; i < cursor2.getCount(); i++) {

                                if (!cursor2.isNull(LoncolumnIndex)) {
                                    SumOQty[kk] = "" + Integer.parseInt(cursor2.getString(LoncolumnIndex));
                                    String OrderKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    SumOQtyKG[kk] = ConvertMLToLiters(OrderKG);

                                } else {
                                    SumOQty[kk] = "" + "0";
                                    SumOQtyKG[kk] = "" + "0.0";
                                }

                                if (!cursor2.isNull(LoncolumnIndex1)) {
                                    SumFQty[kk] = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)));
                                    String FreeKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    SumFQtyKG[kk] = ConvertMLToLiters(FreeKG);

                                } else {
                                    SumFQty[kk] = "" + "0";
                                    SumFQtyKG[kk] = "0.0";
                                }
                                if (!cursor2.isNull(LoncolumnIndex2)) {
                                    SumSQty[kk] = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)));
                                    String SampleKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    SumSQtyKG[kk] = ConvertMLToLiters(SampleKG);

                                } else {
                                    SumSQty[kk] = "0";
                                    SumSQtyKG[kk] = "0.0";
                                }
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
        }


        String strGettblSyncSummuryDetailsKGLitersDetails[];//="";
        strGettblSyncSummuryDetailsKGLitersDetails = fnGettblSyncProductWiseDetailsKGLitersDetails();

        //////////// System.out.println("strGettblSyncSummuryDetailsKGLitersDetails :"+ strGettblSyncSummuryDetailsKGLitersDetails.length);


        for (int kk = 0; kk < UniqueProductsSaleSummry.length; kk++) {

            //////////// System.out.println("Sunil Check Line UniqueProductsSaleSummry :"+UniqueProductsSaleSummry[kk]);

            if (strGettblSyncSummuryDetailsKGLitersDetails.length > 0) {
                for (int in = 0; in < strGettblSyncSummuryDetailsKGLitersDetails.length; in++) {
//////////// System.out.println("Sunil Check LinestrGettblSyncSummuryDetailsKGLitersDetails :"+strGettblSyncSummuryDetailsKGLitersDetails[in]);

                    String SumOQtyofTable = "";
                    String SumFQtyofTable = "";
                    String SumSQtyofTable = "";

                    String SumOQtyKGofTable = "";
                    String SumFQtyKGofTable = "";
                    String SumSQtyKGofTable = "";
                    String SummryPNameofTable = "";
                    String LineCountSKUWiseFromServer = "";

                    StringTokenizer tokensofTable = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsKGLitersDetails[in]), "^");
                    SummryPNameofTable = tokensofTable.nextToken().trim();
                    SumOQtyofTable = tokensofTable.nextToken().trim();
                    SumFQtyofTable = tokensofTable.nextToken().trim();
                    SumSQtyofTable = tokensofTable.nextToken().trim();
                    SumOQtyKGofTable = tokensofTable.nextToken().trim();
                    SumFQtyKGofTable = tokensofTable.nextToken().trim();
                    SumSQtyKGofTable = tokensofTable.nextToken().trim();
                    tokensofTable.nextToken().trim();

                    LineCountSKUWiseFromServer = tokensofTable.nextToken().trim();//For Line Count SKU Wise

                    // System.out.println("Sunil Check Line Server Parsing :"+Integer.parseInt(LineCountSKUWiseFromServer));


                    //SumOQtyKGofTable=Double.parseDouble(new DecimalFormat("##.##").format(SumOQtyKGofTable));
                    //SumFQtyKGofTable=Double.parseDouble(new DecimalFormat("##.##").format(SumFQtyKGofTable));
                    //	SumSQtyKGofTable=Double.parseDouble(new DecimalFormat("##.##").format(SumSQtyKGofTable));


                    //////////// System.out.println("SummryProductName[kk].toString().trim() :" +SummryProductName[kk].toString().trim());
                    //////////// System.out.println("SummryPNameofTable.trim() :"+ SummryPNameofTable.trim());
                    if (SummryProductName[kk].toString().trim().equals(SummryPNameofTable.trim())) {
                        //////////// System.out.println("Condition matched");
                        SumOQty[kk] = "" + (Integer.parseInt(SumOQty[kk]) + Integer.parseInt(SumOQtyofTable));
                        SumFQty[kk] = "" + (Integer.parseInt(SumFQty[kk]) + Integer.parseInt(SumFQtyofTable));
                        SumSQty[kk] = "" + (Integer.parseInt(SumSQty[kk]) + Integer.parseInt(SumSQtyofTable));
                        // System.out.println("Sunil Check Line PDA :"+Integer.parseInt(LineSkuWise[kk]));
                        // System.out.println("Sunil Check Line Server :"+Integer.parseInt(LineCountSKUWiseFromServer));

                        LineSkuWise[kk] = "" + (Integer.parseInt(LineSkuWise[kk]) + Integer.parseInt(LineCountSKUWiseFromServer));//For Line Count SKU Wise

                        if (SummryDisplayUnit[kk].toString().contains("Kg")) {
                            Double SumOQtyKGofTable11 = Double.parseDouble(SumOQtyKG[kk]) + Double.parseDouble(SumOQtyKGofTable);
                            String a1 = "" + Double.parseDouble(new DecimalFormat("##.##").format(SumOQtyKGofTable11));

                            Double SumFQtyKGofTable11 = Double.parseDouble(SumFQtyKG[kk]) + Double.parseDouble(SumFQtyKGofTable);
                            String a2 = "" + Double.parseDouble(new DecimalFormat("##.##").format(SumFQtyKGofTable11));

                            Double SumSQtyKGofTable11 = Double.parseDouble(SumSQtyKG[kk]) + Double.parseDouble(SumSQtyKGofTable);
                            String a3 = "" + Double.parseDouble(new DecimalFormat("##.##").format(SumSQtyKGofTable11));
                            SumOQtyKG[kk] = "" + a1 + " Kg";
                            SumFQtyKG[kk] = "" + a2 + " Kg";
                            SumSQtyKG[kk] = "" + a3 + " Kg";
                        }

                        if (SummryDisplayUnit[kk].toString().contains("Lt")) {

                            Double SumOQtyKGofTable11 = Double.parseDouble(SumOQtyKG[kk]) + Double.parseDouble(SumOQtyKGofTable);
                            String a1 = "" + Double.parseDouble(new DecimalFormat("##.##").format(SumOQtyKGofTable11));

                            Double SumFQtyKGofTable11 = Double.parseDouble(SumFQtyKG[kk]) + Double.parseDouble(SumFQtyKGofTable);
                            String a2 = "" + Double.parseDouble(new DecimalFormat("##.##").format(SumFQtyKGofTable11));

                            Double SumSQtyKGofTable11 = Double.parseDouble(SumSQtyKG[kk]) + Double.parseDouble(SumSQtyKGofTable);
                            String a3 = "" + Double.parseDouble(new DecimalFormat("##.##").format(SumSQtyKGofTable11));
                            SumOQtyKG[kk] = "" + a1 + " Lt";
                            SumFQtyKG[kk] = "" + a2 + " Lt";
                            SumSQtyKG[kk] = "" + a3 + " Lt";
                        }

                        FinalReturnValue[kk] = SummryProductName[kk] + "^" + SumOQty[kk] + "^" + SumFQty[kk] + "^" + SumSQty[kk] + "^" + SumOQtyKG[kk] + "^" + SumFQtyKG[kk] + "^" + SumSQtyKG[kk] + "^" + LineSkuWise[kk];
                        // System.out.println("Sunil Check Line return FinalReturnValue[kk] :" + FinalReturnValue[kk]);
                        break;

                    }
                }
            } else {
                FinalReturnValue[kk] = SummryProductName[kk] + "^" + SumOQty[kk] + "^" + SumFQty[kk] + "^" + SumSQty[kk] + "^" + SumOQtyKG[kk] + "^" + SumFQtyKG[kk] + "^" + SumSQtyKG[kk] + "^" + LineSkuWise[kk];
                //////////// System.out.println("FinalReturnValue[kk] :" + FinalReturnValue[kk]);
            }

        }


        return FinalReturnValue;

    }

    public String[] fnGettblSyncProductWiseDetailsKGLitersDetails() {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        int LoncolumnIndex3 = 3;
        int LoncolumnIndex4 = 4;
        int LoncolumnIndex5 = 5;
        int LoncolumnIndex6 = 6;
        int LoncolumnIndex7 = 7;
        int LoncolumnIndex8 = 8;


        Cursor cursor = db.rawQuery("SELECT * from tblSyncSummuryForProductDetails", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];// "0.0_0.0_0.0_0.0_0.0_0.0";

            ////// System.out.println("cursor.getCount() :"+cursor.getCount());
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {


                    for (int i = 0; i < cursor.getCount(); i++) {

                        if (!cursor.isNull(LoncolumnIndex)) {
                            CompleteResult[i] = cursor.getString(LoncolumnIndex).toString() + "^" + cursor.getString(LoncolumnIndex1).toString() + "^" + cursor.getString(LoncolumnIndex2).toString() + "^" + cursor.getString(LoncolumnIndex3).toString() + "^" + cursor.getString(LoncolumnIndex4).toString() + "^" + cursor.getString(LoncolumnIndex5).toString() + "^" + cursor.getString(LoncolumnIndex6).toString() + "^" + cursor.getString(LoncolumnIndex7).toString() + "^" + cursor.getString(LoncolumnIndex8).toString(); // the 8th one is for Line;
                            ////// System.out.println("ProductDetails sunil: "+(String) cursor.getString(LoncolumnIndex) + "  "+"Product sunil: "+(String) cursor.getString(LoncolumnIndex1));

                            cursor.moveToNext();
                        }

                    }


                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String ConvertGramToKilo(String strGrams) {
        //1 gram = 0.001 kilogram;
        String kilogram = "";

        Double gram = Double.parseDouble(strGrams);
        kilogram = "" + (gram * 0.001);
        return kilogram;
    }

    public String ConvertMLToLiters(String strML) {
        //1 gram = 0.001 kilogram;
        String Lt = "";

        Double ML = Double.parseDouble(strML);
        Lt = "" + (ML * 0.001);
        return Lt;
    }

    public String fnGetFullSummryDetailsForSale() {

        String FullSummryDetailsForSale;
        FullSummryDetailsForSale = "";

        int TotActualCall = 0;
        TotActualCall = fnGetActualCall();

        ////// System.out.println("TotActualCall: "	+ TotActualCall);

        int TotProductiveCall = 0;
        TotProductiveCall = fnGetProductiveCall();

        ////// System.out.println("TotProductiveCall: "	+ TotProductiveCall);

        String TotSalesValue = "0.00";
        TotSalesValue = fnGetTotalSales();//fnGetTotalDiscount


        String TotDiscountValue = "0.00";
        TotDiscountValue = fnGetTotalDiscount();


        ////// System.out.println("TotSalesValue: "	+ TotSalesValue);
        ////// System.out.println("fnGetTotalDiscount: "	+ TotDiscountValue);
        String strGettblSyncSummuryDetailsCallDetails = "";
        strGettblSyncSummuryDetailsCallDetails = fnGettblSyncSummuryDetailsCallDetails();
        ////// System.out.println("strGettblSyncSummuryDetailsCallDetails: "	+ strGettblSyncSummuryDetailsCallDetails);
        StringTokenizer tokensGettblSyncSummuryDetailsCallDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsCallDetails), "_");

        TotActualCall = TotActualCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
        TotProductiveCall = TotProductiveCall + Integer.parseInt(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim());
        TotSalesValue = "" + (Double.parseDouble(TotSalesValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
        TotDiscountValue = "" + (Double.parseDouble(TotDiscountValue) + Double.parseDouble(tokensGettblSyncSummuryDetailsCallDetails.nextToken().trim()));
        FullSummryDetailsForSale = TotActualCall + "_" + TotProductiveCall + "_" + TotSalesValue + "_" + TotDiscountValue;


        ////// System.out.println("FullSummryDetailsForSale: "	+ FullSummryDetailsForSale);

        return FullSummryDetailsForSale;
    }

    public int fnGetActualCall() {

        int LoncolumnIndex = 0;
        int TotActualCall = 0;
        Cursor cursor2 = db.rawQuery("SELECT Count (StoreID) FROM tblTmpInvoiceHeader", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        TotActualCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                        cursor2.moveToNext();
                    }

                }

            }
            return TotActualCall;
        } finally {
            cursor2.close();
        }
    }

    public int fnGetProductiveCall() {
        int LoncolumnIndex = 0;
        int TotProductiveCall = 0;

        Double TotInvoiceValCall = 0.00;
        Cursor cursor2 = db.rawQuery("SELECT Count (StoreID) FROM tblTmpInvoiceHeader where InvoiceVal >" + TotInvoiceValCall, null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        TotProductiveCall = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                        cursor2.moveToNext();
                    }

                }

            }
            return TotProductiveCall;
        } finally {
            cursor2.close();
        }
    }

    public String fnGetTotalSales() {
        int LoncolumnIndex = 0;
        String TotSalesValue = "0.0";


        Cursor cursor2 = db.rawQuery("SELECT SUM(InvoiceVal) FROM tblTmpInvoiceHeader", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        TotSalesValue = "" + Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                        ////// System.out.println("Abhinav Raj Summary New TotSalesValue from function: "+TotSalesValue);
                        cursor2.moveToNext();
                    }

                }

            }
            return TotSalesValue.replace(",", "");//(TotSalesValue, ",");
        } finally {
            cursor2.close();
        }
    }

    public String fnGetTotalDiscount() {
        int LoncolumnIndex = 0;
        String TotDiscountValue = "0.0";


        Cursor cursor2 = db.rawQuery("SELECT SUM(TotalDis) FROM tblTmpInvoiceHeader", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        TotDiscountValue = "" + Double.parseDouble(cursor2.getString(LoncolumnIndex).toString());
                        cursor2.moveToNext();
                    }

                }

            }
            return TotDiscountValue;
        } finally {
            cursor2.close();
        }
    }

    public String fnGettblSyncSummuryDetailsCallDetails() {

        Cursor cursor = db.rawQuery("SELECT ActualCalls, ProductiveCalls, TotSalesValue, TotDiscountKGSales from tblSyncSummuryDetails", null);

        try {
            String CompleteResult = "0_0_0.0_0.0";
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    CompleteResult = (String) cursor.getString(0).toString()
                            + "_"
                            + (String) cursor.getString(1).toString()
                            + "_"
                            + (String) cursor.getString(2).toString()
                            + "_"
                            + (String) cursor.getString(3).toString();

                    cursor.moveToNext();

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public String fnCalculateKGLiters() {
        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        int LoncolumnIndex2 = 2;
        String[] UniqueKgLiters;
        UniqueKgLiters = fnarrUniqueKgLiters();//fnarrUniqueKgLitersDisplayUnit();
        String val = "";
        String totalKGSales = "0.0";
        String totalSampleSalesKG = "0.0";
        String totalFreeQtySalesKG = "0.0";
        String totalLitersSales = "0.0";
        String totalSampleSalesLT = "0.0";
        String totalFreeQtySalesLT = "0.0";
        String totalDiscountLT = "0.0";
        String totalDiscountKG = "0.0";


        String totalOverallKGSales = "0.0";
        String totalOverallSampleSalesKG = "0.0";
        String totalOverallFreeQtySalesKG = "0.0";
        String totalOverallLitersSales = "0.0";
        String totalOverallSampleSalesLT = "0.0";
        String totalOverallFreeQtySalesLT = "0.0";
        String totalOverallDiscountLT = "0.0";
        String totalOverallDiscountKG = "0.0";

        String FinalReturnValue = "";
        String ppName = "";
        String pDisplayUnit = "";
        for (int kk = 0; kk < UniqueKgLiters.length; kk++) {
            StringTokenizer tokensUniqueKgLiters = new StringTokenizer(String.valueOf(UniqueKgLiters[kk]), "^");

            ppName = tokensUniqueKgLiters.nextToken().trim();

            val = "";
            val = tokensUniqueKgLiters.nextToken().trim();//UniqueKgLiters[kk].toString().trim();

            // change by sunil
            //val="0";
            //// System.out.println("Abhi UniqueKgLiters[kk] :"+UniqueKgLiters[kk]);

            pDisplayUnit = tokensUniqueKgLiters.nextToken().trim();
            //// System.out.println("Abhi pDisplayUnit:" +pDisplayUnit);
            //if(val.contains("0g"))
            if (pDisplayUnit.contains("Kg")) {
                //// System.out.println("Abhi getting Kg");
                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName='" + ppName + "'", null);
                try {
                    //val=val.replace("g", "");
                    if (cursor2.getCount() > 0) {


                        if (cursor2.moveToFirst()) {

                            for (int i = 0; i < cursor2.getCount(); i++) {
                                totalKGSales = "0.0";
                                totalFreeQtySalesKG = "0.0";
                                totalSampleSalesKG = "0.0";
                                if (!cursor2.isNull(LoncolumnIndex)) {
                                    totalKGSales = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalKGSales-:"+ totalKGSales);
                                }

                                if (!cursor2.isNull(LoncolumnIndex1)) {
                                    totalFreeQtySalesKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //	cursor2.moveToNext();
                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalFreeQtySalesKG-:"+ totalFreeQtySalesKG);
                                }
                                if (!cursor2.isNull(LoncolumnIndex2)) {
                                    totalSampleSalesKG = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));

                                    ////// System.out.println("AbhiSunil  Product Short Name:" +val +":-totalSampleSalesKG-:"+ totalSampleSalesKG);
                                    //
                                }


                                //Write Here

                                totalOverallKGSales = "" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(totalKGSales));
                                //////// System.out.println("AbhiSunil  totalOverallKGSales-:"+ totalOverallKGSales);
                                totalOverallFreeQtySalesKG = "" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(totalFreeQtySalesKG));
                                //////// System.out.println("AbhiSunil  totalOverallFreeQtySalesKG-:"+ totalOverallFreeQtySalesKG);
                                totalOverallSampleSalesKG = "" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(totalSampleSalesKG));
                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }

            }
            //if(val.contains("0ml"))
            if (pDisplayUnit.contains("Lt")) {
                //// System.out.println("Abhi getting Liter");

                Cursor cursor2 = db.rawQuery("SELECT Sum(OrderQty),Sum(FreeQty),Sum(SampleQuantity),Sum(DisVal) FROM  tblTmpInvoiceDetails where ProductShortName ='" + ppName + "'", null);
                try {
                    //// System.out.println("Abhi  cursor2.getCount() :"+cursor2.getCount());
                    //val=val.replace("ml", "");
                    if (cursor2.getCount() > 0) {


                        if (cursor2.moveToFirst()) {

                            for (int i = 0; i < cursor2.getCount(); i++) {
                                totalLitersSales = "0.0";
                                totalSampleSalesLT = "0.0";
                                totalFreeQtySalesLT = "0.0";

                                if (!cursor2.isNull(LoncolumnIndex)) {

                                    totalLitersSales = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex)) * Integer.parseInt(val));
                                    //	////// System.out.println("totalLitersSales :"+totalLitersSales);
                                    totalOverallLitersSales = "" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(totalLitersSales));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }

                                if (!cursor2.isNull(LoncolumnIndex1)) {
                                    totalFreeQtySalesLT = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex1)) * Integer.parseInt(val));
                                    //////// System.out.println("totalFreeQtySalesLT :"+totalFreeQtySalesLT);
                                    totalOverallFreeQtySalesLT = "" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(totalFreeQtySalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //cursor2.moveToNext();
                                }
                                if (!cursor2.isNull(LoncolumnIndex2)) {
                                    totalSampleSalesLT = "" + (Integer.parseInt(cursor2.getString(LoncolumnIndex2)) * Integer.parseInt(val));
                                    totalOverallSampleSalesLT = "" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(totalSampleSalesLT));

                                    //// System.out.println("Abhi  totalOverallLitersSales :"+totalOverallLitersSales +" index :"+LoncolumnIndex);
                                    //	////// System.out.println("totalSampleSalesLT :"+totalSampleSalesLT);
                                }


                                cursor2.moveToNext();
                            }

                        }
                    }

                } finally {
                    cursor2.close();
                }


            }
        }

        //// System.out.println("Abhi Sunil  totalOverallKGSales Before:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG Before:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG Before:" +totalOverallSampleSalesKG);

        totalOverallKGSales = ConvertGramToKilo(totalOverallKGSales);

        totalOverallFreeQtySalesKG = ConvertGramToKilo(totalOverallFreeQtySalesKG);

        totalOverallSampleSalesKG = ConvertGramToKilo(totalOverallSampleSalesKG);

        //// System.out.println("Abhi Sunil  totalOverallKGSales After:" +totalOverallKGSales);
        //// System.out.println("Abhi Sunil  totalOverallFreeQtySalesKG After:" +totalOverallFreeQtySalesKG);
        //// System.out.println("Abhi Sunil  totalOverallSampleSalesKG After:" +totalOverallSampleSalesKG);
        totalOverallLitersSales = ConvertMLToLiters(totalOverallLitersSales);

        totalOverallFreeQtySalesLT = ConvertMLToLiters(totalOverallFreeQtySalesLT);
        //// System.out.println("Abhi Sunil totalOverallFreeQtySalesLT : "+totalOverallFreeQtySalesLT);
        totalOverallSampleSalesLT = ConvertMLToLiters(totalOverallSampleSalesLT);

        String strGettblSyncSummuryDetailsKGLitersDetails = "";
        strGettblSyncSummuryDetailsKGLitersDetails = fnGettblSyncSummuryDetailsKGLitersDetails();

        StringTokenizer tokensGettblSyncSummuryDetailsKGLitersDetails = new StringTokenizer(String.valueOf(strGettblSyncSummuryDetailsKGLitersDetails), "_");

        totalOverallKGSales = "" + (Double.parseDouble(totalOverallKGSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesKG = "" + (Double.parseDouble(totalOverallFreeQtySalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesKG = "" + (Double.parseDouble(totalOverallSampleSalesKG) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallLitersSales = "" + (Double.parseDouble(totalOverallLitersSales) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallFreeQtySalesLT = "" + (Double.parseDouble(totalOverallFreeQtySalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));
        totalOverallSampleSalesLT = "" + (Double.parseDouble(totalOverallSampleSalesLT) + Double.parseDouble(tokensGettblSyncSummuryDetailsKGLitersDetails.nextToken().trim()));


        Double DtotalOverallKGSales = Double.parseDouble(totalOverallKGSales);
        DtotalOverallKGSales = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));

        Double DtotalOverallFreeQtySalesKG = Double.parseDouble(totalOverallFreeQtySalesKG);
        DtotalOverallFreeQtySalesKG = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));

        Double DtotalOverallSampleSalesKG = Double.parseDouble(totalOverallSampleSalesKG);
        DtotalOverallSampleSalesKG = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));

        Double DtotalOverallLitersSales = Double.parseDouble(totalOverallLitersSales);
        DtotalOverallLitersSales = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));

        Double DtotalOverallFreeQtySalesLT = Double.parseDouble(totalOverallFreeQtySalesLT);
        DtotalOverallFreeQtySalesLT = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));

        Double DtotalOverallSampleSalesLT = Double.parseDouble(totalOverallSampleSalesLT);
        DtotalOverallSampleSalesLT = Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));


        //DtotalOverallKGSales = Double.parseDouble(decimalFormat.format(DtotalOverallKGSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallKGSales));
        FinalReturnValue = FinalReturnValue + DtotalOverallKGSales + " Units";

        // DtotalOverallFreeQtySalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesKG));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallFreeQtySalesKG + " Units";

        // DtotalOverallSampleSalesKG =Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesKG));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesKG));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallSampleSalesKG + " Units";

        // DtotalOverallLitersSales = Double.parseDouble(decimalFormat.format(DtotalOverallLitersSales));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallLitersSales));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallLitersSales + " LT";

        // DtotalOverallFreeQtySalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallFreeQtySalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallFreeQtySalesLT));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallFreeQtySalesLT + " LT";

        //DtotalOverallSampleSalesLT = Double.parseDouble(decimalFormat.format(DtotalOverallSampleSalesLT));
        //Double.parseDouble(new DecimalFormat("##.##").format(DtotalOverallSampleSalesLT));
        FinalReturnValue = FinalReturnValue + "^" + DtotalOverallSampleSalesLT + " LT";


        //FinalReturnValue= "" + DtotalOverallKGSales + " KG" + "^" + DtotalOverallFreeQtySalesKG + " KG" + "^" + DtotalOverallSampleSalesKG + " KG" + "^" + DtotalOverallLitersSales + " LT" + "^" + DtotalOverallFreeQtySalesLT + " LT" + "^" + DtotalOverallSampleSalesLT + " LT";
        //// System.out.println("Abhi  FinalReturnValue :"+FinalReturnValue);
        return FinalReturnValue;

    }

    public String[] fnarrUniqueKgLiters() {
        int LoncolumnIndex = 0;


        Cursor cursor2 = db.rawQuery("SELECT DISTINCT ProductShortName,KGLiter,DisplayUnit FROM tblProductListMaster", null);
        try {
            String UniqueKgLiters[] = new String[cursor2.getCount()];
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    if (!cursor2.isNull(LoncolumnIndex)) {
                        UniqueKgLiters[i] = cursor2.getString(LoncolumnIndex).toString() + "^" + cursor2.getString(1).toString() + "^" + cursor2.getString(2).toString();
                        cursor2.moveToNext();
                    }

                }

            }
            return UniqueKgLiters;
        } finally {
            cursor2.close();
        }
    }

    public String fnGettblSyncSummuryDetailsKGLitersDetails() {


        Cursor cursor = db.rawQuery("SELECT TotKGSales,TotFreeQtyKGSales,TotSampleKGSales,TotLTSales,TotFreeQtyLTSales,TotSampleLTSales,TotDiscountKGSales,TotDiscountLTales from tblSyncSummuryDetails", null);

        try {
            String CompleteResult = "0.0_0.0_0.0_0.0_0.0_0.0_0.0_0.0";
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    CompleteResult = (String) cursor.getString(0).toString()
                            + "_"
                            + (String) cursor.getString(1).toString()
                            + "_"
                            + (String) cursor.getString(2).toString()
                            + "_"
                            + (String) cursor.getString(3).toString()
                            + "_"
                            + (String) cursor.getString(4).toString()
                            + "_"
                            + (String) cursor.getString(5).toString()
                            + "_"
                            + (String) cursor.getString(6).toString()
                            + "_"
                            + (String) cursor.getString(7).toString();

                    cursor.moveToNext();

                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
        }

    }

    public void deleteAllSubmitDataToServer(int Sstat) {
        //open();
        db.execSQL("DELETE FROM tblTransac WHERE Sstat =" + Sstat);
        db.execSQL("DELETE FROM tblTmpInvoiceHeader WHERE Sstat =" + Sstat);
        db.execSQL("DELETE FROM tblStoreList WHERE Sstat =" + Sstat);

        db.execSQL("DELETE FROM tblNewStoreListEntries WHERE Sstat =" + Sstat);
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE Sstat =" + Sstat);
        db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE Sstat =" + Sstat);


        db.execSQL("DELETE FROM tblNewStoreEntries WHERE Sstat =" + Sstat);
        db.execSQL("DELETE FROM tblOutletQuestAnsMstr WHERE Sstat =" + Sstat);


        db.execSQL("DELETE FROM tblStoreMaterialDetail WHERE Sstat =" + Sstat);

        db.execSQL("DELETE FROM tblStoreMaterialPhotoDetail WHERE Sstat =" + Sstat);
        db.execSQL("DELETE FROM tblStoreReturnDetail WHERE Sstat =" + Sstat);
        db.execSQL("DELETE FROM tblStoreProductPhotoDetail WHERE Sstat =" + Sstat);


        // close();
    }

    public void updateRecordsSyncStoreProductReturn() {
        try {
            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected = db.update("tblStoreReturnDetail", values, "Sstat=?",
                    new String[]{"3"});
            int affected1 = db.update("tblStoreProductPhotoDetail", values, "Sstat=?",
                    new String[]{"3"});

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    public void updateRecordsSyncd(int Sstat) {

        try {
            // ////// System.out.println("No. of non-synced records: " +
            // countNonSynced());

            // if (countNonSynced() > 0) {

            Log.w(TAG, "Updating Synced Records..");

            final ContentValues values = new ContentValues();
            values.put("Sstat", Sstat);

            if (Sstat == 4) {
                int affected71 = db.update("tblStoreCloseLocationDetails", values, "Sstat=?",
                        new String[]{"3"});
                int affected72 = db.update("tblStoreClosedPhotoDetail", values, "Sstat=?",
                        new String[]{"3"});
                int affected73 = db.update("tblStoreCloseReasonSaving", values, "Sstat=?",
                        new String[]{"3"});

            }


            int affected = db.update("tblTransac", values, "Sstat=?",
                    new String[]{"5"});
            //  int affected2 = db.update("tblTmpInvoiceHeader", values, "Sstat=?",
            //          new String[] { "5" });
            int affected3 = db.update("tblStoreList", values, "Sstat=?",
                    new String[]{"5"});
            int affected4 = db.update("tblNewStoreListEntries", values,
                    "Sstat=?", new String[]{"5"});


            int affected7 = db.update("tblStoreProductAppliedSchemesBenifitsRecords", values,
                    "Sstat=?", new String[]{"5"});
            //    int affected8 = db.update("tblTmpInvoiceDetails", values,
            //           "Sstat=?", new String[] { "5" });


            int affected9 = db.update("tblNewStoreEntries", values,
                    "Sstat=?", new String[]{"5"});


            int affected10 = db.update("tblTemp", values,
                    "Sstat=?", new String[]{"5"});

            int affected11 = db.update("tblProductMappedWithSchemeSlabApplied", values,
                    "Sstat=?", new String[]{"5"});

            int affected12 = db.update("tblOutletQuestAnsMstr", values, "Sstat=?", new String[]{"3"});
            int affected121 = db.update("tblNewAddedStoreLocationDetails", values, "Sstat=?", new String[]{"3"});
            int affected13 = db.update("tblStoreMaterialDetail", values, "Sstat=?", new String[]{"5"});

            int affected14 = db.update("tblStoreMaterialPhotoDetail", values, "Sstat=?", new String[]{"5"});


            int affected15 = db.update("tblNoVisitStoreDetails", values, "Sstat=?", new String[]{"5"});

            int affected16 = db.update("tblPDANotificationMaster", values,
                    "Sstat=?", new String[]{"5"});

            int affected17 = db.update("tblAllCollectionData", values,
                    "Sstat=?", new String[]{"5"});


            Log.w(TAG, "affected records: " + affected + " in 1st Table, "
                    + " in 2nd table, " + affected3
                    //+ " in 3rd table(tblStoreList)" + affected4
						/*+ " in 4th table(tblNewStoreListEntries)" + affected5
						+ " in 5th table(tblPDAProductReturnMstr)" + affected6*/
                    + " in 6th table(tblPDAProductReturnDetails)");

            Log.w(TAG, "Synced Records Updated..");
            // } else {
            // Log.w(TAG, "Non-Synced Records not Found..");
            // }

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void AddNewStore(String strNewAddedStoreIDFlg, String RetailerName,
                            String OwnerName, String Address, String StoreType, String fDate, String phoneSendValue, String ActualLatitude, String ActualLongitude, String Accuracy,
                            String LocProvider, String BateryLevel) {/*
			if (Integer.parseInt(strNewAddedStoreIDFlg) == 0)
			{
				int MaxAutoStore = 0;
				int cntTotStore=0;
				cntTotStore=fnGetCountForNewStore();
				String strGetMaxIDForNewStore="0";
				String activeRid;
				activeRid = GetActiveRouteID();
				if(cntTotStore>0)
				{
				MaxAutoStore = fnGetMaxAutoStoreIncrementForNewStore();
				MaxAutoStore = MaxAutoStore + 1;
				strGetMaxIDForNewStore = fnGetMaxIdWithIncrementForNewStore(MaxAutoStore);
				}
				else
				{
					MaxAutoStore=0;
					MaxAutoStore = MaxAutoStore + 1;

					strGetMaxIDForNewStore = "-000^" + (1) + "$"
							+ MaxAutoStore;

				}
				////// System.out.println("MaxAutoStore.. " + MaxAutoStore);


				////// System.out.println("MaxAutoStore. After Increment . "+ MaxAutoStore);


				////// System.out.println("New Added Store Name . "+ strGetMaxIDForNewStore);

				if (!strGetMaxIDForNewStore.equals("")
						|| !strGetMaxIDForNewStore.equals(null)) {

					////// System.out.println("fDate vlaue by sunil"+fDate);
					////// System.out.println("strGetMaxIDForNewStore.trim() vlaue by sunil"+strGetMaxIDForNewStore.trim());
					////// System.out.println("StoreType vlaue by sunil"+StoreType.trim());

					////// System.out.println("RetailerName vlaue by sunil"+RetailerName.trim());

					////// System.out.println("MaxAutoStore vlaue by sunil"+MaxAutoStore);


					saveSOAPdataStoreListNewStore(strGetMaxIDForNewStore.trim(), StoreType.trim(), RetailerName.trim(), Double.parseDouble(ActualLatitude), Double.parseDouble(ActualLongitude), "", "", fDate, MaxAutoStore,1,Accuracy,LocProvider,activeRid,BateryLevel); // in last parameter Fdate

					fnUpdateFlgForNewSoreInMainStoreTable(strGetMaxIDForNewStore);
					//fnInsertStoreIfNotExistIntblDaySummary(strGetMaxIDForNewStore);//On Store Selection VisitStart Activity
					////// System.out.println("strGetMaxIDForNewStore"+strGetMaxIDForNewStore.trim());
					////// System.out.println("RetailerName"+RetailerName.toString().trim());

					////// System.out.println("OwnerName"+OwnerName.toString().trim());

					////// System.out.println("Address"+Address.toString().trim());

					////// System.out.println("PinCode"+PinCode.toString().trim());

					////// System.out.println("StoreType"+StoreType.toString().trim());

					////// System.out.println("Location"+Location.toString().trim());

					////// System.out.println("Area"+Area.toString().trim());

					saveSOAPdataStoreListDetailsInNewTable(strGetMaxIDForNewStore.trim(), RetailerName.toString().trim(), OwnerName.toString().trim(), Address.toString().trim(),phoneSendValue,ActualLatitude,ActualLongitude,Accuracy,LocProvider,activeRid);

				}
			}
		*/
    }

    public int fnGetMaxAutoStoreIncrementForNewStore() {

        int LoncolumnIndex = 0;
        int strAutoIdStore = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT Max(AutoIdStore) FROM tblStoreList", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strAutoIdStore = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strAutoIdStore;
        } finally {
            cursor2.close();
        }

    }

    public int fnGetCountForNewStore() {

        int LoncolumnIndex = 0;
        int strStore = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT Count(*) FROM tblStoreList", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStore = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStore;
        } finally {
            cursor2.close();
        }

    }

    public String fnGetMaxIdWithIncrementForNewStore(int MaxAutoStore) {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strLastMaxStoreId = "0";
        String nn = "";
        // String strLastMaxAutoStoreId="0";

        Cursor cursor2 = db
                .rawQuery(
                        "SELECT StoreID FROM tblStoreList order by AutoIdStore Desc Limit 1",
                        null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strLastMaxStoreId = cursor2.getString(LoncolumnIndex);
                    // strLastMaxAutoStoreId=
                    // cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }
                strLastMaxStoreId = strLastMaxStoreId.replace("-", "");

                if (strLastMaxStoreId.contains("^")) {
                    StringTokenizer tokensSchstrLastMaxStoreIdNew = new StringTokenizer(
                            String.valueOf(strLastMaxStoreId), "^");
                    nn = tokensSchstrLastMaxStoreIdNew.nextToken().trim();
                    strLastMaxStoreId = tokensSchstrLastMaxStoreIdNew
                            .nextToken().trim();
                }
                if (strLastMaxStoreId.contains("$")) {
                    StringTokenizer tokensSchstrLastMaxStoreId = new StringTokenizer(
                            String.valueOf(strLastMaxStoreId), "$");

                    strLastMaxStoreId = tokensSchstrLastMaxStoreId.nextToken()
                            .trim();
                }

                strLastMaxStoreId = "-000^" + (strLastMaxStoreId) + "$"
                        + MaxAutoStore;
            }
            return strLastMaxStoreId;
        } finally {
            cursor2.close();
        }

    }

    public long saveSOAPdataStoreListNewStore(String sCode, String sType, String sName,
                                              Double sLat, Double sLon, String LVdate, String LTdate,
                                              String sForDate, int AutoIdStore, int newStat, String Accuracy, String LocProvider,
                                              String activeRid, String BateryLevel, int IsNewStoreDataCompleteSaved, String fetchAddress,
                                              String PaymentStage, int flgHasQuote, int flgAllowQuotation, int flgSubmitFromQuotation
            , String flgGSTCapture, String flgGSTCompliance, String GSTNumber, int flgGSTRecordFromServer, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgRestart, int flgStoreOrder,
                                              String StoreCity, String StorePinCode, String StoreState, String DBR, String OwnerName, String StoreContactNo, String StoreCatType, int flgRuleTaxVal, int flgTransType, String SalesPersonName, String SalesPersonContactNo, int IsComposite, int StoreStateID, int StoreCityID, String Imei,int IsDiscountApplicable,int RegionID,String IsDiscountAllowed,String selectedDistributorDisText,String selectedStoreTypeDesc) {


        int flgIfStoreHasRecords = 0;
        try {
            flgIfStoreHasRecords = CheckTotalStoreCount();
        } catch (Exception ex) {

        }

        ArrayList<Integer> arrDistinctSchemeID=fnSelectDistinctSchemeIDsForNewStore(RegionID);
        List<TblSchemeStoreMapping> tblSchemeStoreMappingList=new ArrayList<TblSchemeStoreMapping>();
        if(arrDistinctSchemeID!=null && arrDistinctSchemeID.size()>0)
        {
            for(Integer arrSchemeID:arrDistinctSchemeID)
            {
                TblSchemeStoreMapping tblSchemeStoreMapping=new TblSchemeStoreMapping();
                tblSchemeStoreMapping.setStoreID(sCode.trim());
                tblSchemeStoreMapping.setSchemeID(arrSchemeID);
                tblSchemeStoreMapping.setIsNewStore(1);
                tblSchemeStoreMappingList.add(tblSchemeStoreMapping);
            }
            if(tblSchemeStoreMappingList!=null && tblSchemeStoreMappingList.size()>0)
            {
                savetblSchemeStoreMapping(tblSchemeStoreMappingList);
            }
        }


        ContentValues initialValues = new ContentValues();
        ////// System.out.println("Saved code:" + sCode + "Saved name:" + "" + sName);
        long syncTIMESTAMP = System.currentTimeMillis();
        Date dateobj = new Date(syncTIMESTAMP);
        SimpleDateFormat df = new SimpleDateFormat("dd-MMM-yyyy HH:mm:ss", Locale.ENGLISH);
        String startTS = TimeUtils.getNetworkDateTime(mContext, TimeUtils.DATE_TIME_FORMAT);

        /* activeRid = GetActiveRouteID();*/
        String RouteNodeType = FetchRouteType(activeRid);

        initialValues.put("PDACode", Imei);
        initialValues.put("StoreID", sCode.trim());

        initialValues.put("OwnerName", OwnerName);
        initialValues.put("StoreContactNo", StoreContactNo);
        initialValues.put("StoreCatType", StoreCatType);

        initialValues.put("OutStanding", "0.00");
        initialValues.put("OverDue", "0.00");
        initialValues.put("flgRuleTaxVal", flgRuleTaxVal);

        initialValues.put("SalesPersonName", SalesPersonName);
        initialValues.put("SalesPersonContact", SalesPersonContactNo);


        initialValues.put("chainID", 1);


        initialValues.put("StoreType", sType);
        initialValues.put("StoreName", sName.trim());
        // initialValues.put("ActualLatitude", ""+sLat);
        // initialValues.put("ActualLongitude",""+ sLon);
        initialValues.put("StoreLatitude", sLat);
        initialValues.put("StoreLongitude", sLon);
        initialValues.put("LastVisitDate", "NA");
        initialValues.put("LastTransactionDate", "NA");
        initialValues.put("Sstat", newStat);
        initialValues.put("ISNewStore", 1);
        initialValues.put("StoreClose", 0);
        //initialValues.put("StoreNextDay", 0);
        // System.out.println("DateTimeNitish fnDBkenya saveSOAPdataStoreListNewStore = "+startTS);
        //  initialValues.put("VisitStartTS", startTS);
        // initialValues.put("VisitEndTS", startTS);
        //initialValues.put("LocProvider", LocProvider);
        //initialValues.put("Accuracy", Accuracy);
        //initialValues.put("BateryLeftStatus", BateryLevel);
        // initialValues.put(KEY_snxtday, 0);
        // initialValues.put(KEY_sDone, 0);
        // initialValues.put("ForDate", sForDate.trim());
        //initialValues.put("AutoIdStore", AutoIdStore);
        initialValues.put("StoreRouteID", activeRid);
        initialValues.put("RouteNodeType", RouteNodeType);
        initialValues.put("StoreCatNodeId", 0);
        initialValues.put("IsNewStoreDataCompleteSaved", IsNewStoreDataCompleteSaved);
        // initialValues.put("flgFromWhereSubmitStatus", 0);
        initialValues.put("StoreAddress", fetchAddress);
        initialValues.put("PaymentStage", PaymentStage);
        initialValues.put("flgHasQuote", flgHasQuote);
        initialValues.put("flgAllowQuotation", flgAllowQuotation);
        // initialValues.put("flgSubmitFromQuotation", flgSubmitFromQuotation);

        initialValues.put("flgGSTCapture", flgGSTCapture);
        initialValues.put("flgGSTCompliance", flgGSTCompliance);
        initialValues.put("GSTNumber", GSTNumber);
        initialValues.put("flgGSTRecordFromServer", flgGSTRecordFromServer);
        initialValues.put("DistanceNear", 1000);



      /*  initialValues.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
        initialValues.put("flgGPSOnOff", flgGPSOnOff);
        initialValues.put("flgNetworkOnOff", flgNetworkOnOff);
        initialValues.put("flgFusedOnOff", flgFusedOnOff);
        initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
        initialValues.put("flgRestart", flgRestart);*/

        initialValues.put("flgStoreOrder", (flgIfStoreHasRecords + 1));

        initialValues.put("StoreCity", StoreCity.trim());
        initialValues.put("StorePinCode", StorePinCode.trim());
        initialValues.put("StoreState", StoreState.trim());

        // initialValues.put("flgRetailerCreditBalnce", 1);
        initialValues.put("DBR", DBR);
        initialValues.put("IsComposite", IsComposite);
        initialValues.put("StoreStateID", StoreStateID);
        initialValues.put("StoreCityID", StoreCityID);
        initialValues.put("flgOrderType", 0);
        initialValues.put(DBHelper.IS_NETWORK_TIME_RECORDED, TimeUtils.isNetworkTimeTaken());
        initialValues.put(DBHelper.DEVICE_TIME, TimeUtils.getCurrentDeviceDateTime(TimeUtils.DATE_TIME_FORMAT));

        initialValues.put("flgStoreEdit", 0);
        initialValues.put("flgLocationEdit", 0);

        initialValues.put("EmailID", "");
        initialValues.put("Distributor", selectedDistributorDisText);
        initialValues.put("IsDiscountApplicable", IsDiscountApplicable);
        initialValues.put("RegionID", RegionID);
        initialValues.put("IsDiscountAllow", IsDiscountAllowed);
        initialValues.put("flgMapped", 1);
        initialValues.put("StoreTypeDesc", selectedStoreTypeDesc);
        initialValues.put("flgStarStore", 0);
        initialValues.put("flgUnProductiveStore", 0);


        checkNumberOfStore++;

        ////// System.out.println("inserting records..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN13, null, initialValues);
    }


//	saveSOAPdataStoreList

    public int CheckTotalStoreCount() {

        int chkI = 0;
        Cursor cursorE2 = null;
        ////open();
        try {
            cursorE2 = db.rawQuery("SELECT flgStoreOrder from tblStoreList order by flgStoreOrder limit 1", null);
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    if (cursorE2.getInt(0) > 0) {
                        chkI = cursorE2.getInt(0);
                    } else {
                        chkI = 0;
                    }
                }
            }

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public void fnUpdateFlgForNewSoreInMainStoreTable(
            String strGetMaxIDForNewStore) {
        final ContentValues values = new ContentValues();
        values.put("ISNewStore", "1");

        int affected = db.update("tblStoreList", values, "StoreID=?",
                new String[]{strGetMaxIDForNewStore});
        Log.w(TAG, "affected records: " + affected);

        Log.w(TAG, "fnUpdateFlgForNewSoreInMainStoreTable Updated..");

    }

    public long saveSOAPdataStoreListDetailsInNewTable(String StoreID, String StoreCity,
                                                       String StorePinCode, String StoreState, int Sstat) {

        ContentValues initialValues = new ContentValues();
        String activeRid = GetActiveRouteID();

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("StoreCity", StoreCity.trim());
        initialValues.put("StorePinCode", StorePinCode.trim());
        initialValues.put("StoreState", StoreState.trim());
        initialValues.put("ActiveRouteID", activeRid.trim());
        initialValues.put("Sstat", Sstat);

        return db.insert(DBHelper.DATABASE_TABLE_MAIN16, null, initialValues);
    }

    public String fnGetOptionDescrFromtblGetPDAQuestOptionMstr(String QuestID, String AnsValue) {

        Cursor cursor = null;
        String DDlStringCity = "";
        try {
            //open();
            cursor = db.rawQuery("SELECT OptionDescr FROM tblGetPDAQuestOptionMstr WHERE  QuestID ='" + QuestID.trim() + "' and OptID='" + AnsValue.trim() + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        DDlStringCity = cursor.getString(0).toString().trim();

                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            //cursor.close();
            //close();

        }
        return DDlStringCity;
    }

    public LinkedHashMap isMstrQuestToHide() {
        LinkedHashMap<String, String> hmapMstrQstOptId = new LinkedHashMap<String, String>();
        //open();

        String channelOptId = getChannelGroupIdOptId();
        String channelkey = getChannelGroupIdKey();
        if (!channelOptId.equals("0-0-0")) {
            hmapMstrQstOptId.put(channelkey, channelOptId);
        } else {
            hmapMstrQstOptId.put(channelkey, "0");
        }
        //close();
        return hmapMstrQstOptId;
    }

    public String GetPrevDate() {

        Cursor cursorDateE = db.rawQuery("SELECT DISTINCT ForDate FROM tblStoreList", null);
        String returnDate = "";
        String date2Send = "";

        try {
            if (cursorDateE.getCount() > 0) {
                ////// System.out.println("GetPrevDate - Records Count: "+ cursorDateE.getCount());

                if (cursorDateE.moveToFirst()) {
                    date2Send = cursorDateE.getString(0);
                    // chk here
                    ////// System.out.println("GetPrevDate - forDate: " + date2Send);

                } else {
                    ////// System.out.println("moveToFirst <- GetPrevDate - FALSE!");
                }
                // ////// System.out.println("returning GetPrevDate - true");
                returnDate = date2Send;
            }

        } finally {
            cursorDateE.close();
        }
        return returnDate;
    }

    public void AddNewStore(String strNewAddedStoreIDFlg, String RetailerName,
                            String OwnerName, String Address, String StoreType, String fDate, String phoneSendValue, String ActualLatitude, String ActualLongitude, String Accuracy,
                            String LocProvider) {/*
			if (Integer.parseInt(strNewAddedStoreIDFlg) == 0)
			{
				int MaxAutoStore = 0;
				int cntTotStore=0;
				cntTotStore=fnGetCountForNewStore();
				String strGetMaxIDForNewStore="0";
				String activeRid;
				activeRid = GetActiveRouteID();
				if(cntTotStore>0)
				{
				MaxAutoStore = fnGetMaxAutoStoreIncrementForNewStore();
				MaxAutoStore = MaxAutoStore + 1;
				strGetMaxIDForNewStore = fnGetMaxIdWithIncrementForNewStore(MaxAutoStore);
				}
				else
				{
					MaxAutoStore=0;
					MaxAutoStore = MaxAutoStore + 1;

					strGetMaxIDForNewStore = "-000^" + (1) + "$"
							+ MaxAutoStore;

				}
				////// System.out.println("MaxAutoStore.. " + MaxAutoStore);


				////// System.out.println("MaxAutoStore. After Increment . "+ MaxAutoStore);


				////// System.out.println("New Added Store Name . "+ strGetMaxIDForNewStore);

				if (!strGetMaxIDForNewStore.equals("")
						|| !strGetMaxIDForNewStore.equals(null)) {



					saveSOAPdataStoreListNewStore(strGetMaxIDForNewStore.trim(), StoreType.trim(), RetailerName.trim(), Double.parseDouble(ActualLatitude), Double.parseDouble(ActualLongitude), "", "", fDate, MaxAutoStore,1,Accuracy,LocProvider,activeRid,IsNewStoreDataCompleteSaved); // in last parameter Fdate

					fnUpdateFlgForNewSoreInMainStoreTable(strGetMaxIDForNewStore);
					////// System.out.println("strGetMaxIDForNewStore"+strGetMaxIDForNewStore.trim());
					////// System.out.println("RetailerName"+RetailerName.toString().trim());

					////// System.out.println("OwnerName"+OwnerName.toString().trim());

					////// System.out.println("Address"+Address.toString().trim());

					////// System.out.println("PinCode"+PinCode.toString().trim());

					////// System.out.println("StoreType"+StoreType.toString().trim());

					////// System.out.println("Location"+Location.toString().trim());

					////// System.out.println("Area"+Area.toString().trim());

					saveSOAPdataStoreListDetailsInNewTable(strGetMaxIDForNewStore.trim(), RetailerName.toString().trim(), OwnerName.toString().trim(), Address.toString().trim(),phoneSendValue,ActualLatitude,ActualLongitude,Accuracy,LocProvider,activeRid,IsNewStoreDataCompleteSaved);

				}
			}
		*/
    }

    public String[] FetcDistinctProductWhichHaveAnySchemesOrderEntry() {
        int ScodecolumnIndex = 0;
        int ScodecolumnIndex1 = 1;

        Cursor cursor = db.rawQuery("SELECT Distinct ProductId FROM tblschemeProductMap", null);
        try {
            String DistinctProductIdStock[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    DistinctProductIdStock[i] = (String) cursor.getString(ScodecolumnIndex).toString();
                    ////// System.out.println("product short name :"+StoreProductIdStock[i]);
                    cursor.moveToNext();
                }
            }
            return DistinctProductIdStock;
        } finally {
            cursor.close();
        }
    }
	/*	public static long saveSOAPdataStoreListNewStore(String sCode, String sType, String sName,
				Double sLat, Double sLon, String LVdate, String LTdate,
				String sForDate, int AutoIdStore, int newStat, String Accuracy, String LocProvider,String activeRid) {
			ContentValues initialValues = new ContentValues();

			////// System.out.println("Saved code:" + sCode + "Saved name:" + "" + sName);
			long syncTIMESTAMP = System.currentTimeMillis();
			Date dateobj = new Date(syncTIMESTAMP);
			SimpleDateFormat df = new SimpleDateFormat(
					"dd-MM-yyyy HH:mm:ss");
			String startTS = df.format(dateobj);


			initialValues.put("StoreID", sCode.trim());
			initialValues.put("StoreType", "0");
			initialValues.put("StoreName", sName.trim());
			initialValues.put("ActualLatitude", ""+sLat);
			initialValues.put("ActualLongitude",""+ sLon);
			initialValues.put("StoreLatitude", sLat);
			initialValues.put("StoreLongitude", sLon);
			initialValues.put("LastVisitDate", LVdate.trim());
			initialValues.put("LastTransactionDate", LTdate.trim());
			initialValues.put("Sstat", newStat);
			initialValues.put("ISNewStore", 1);
			initialValues.put("StoreClose", 0);
			initialValues.put("StoreNextDay", 0);
			initialValues.put("VisitStartTS", startTS);
			initialValues.put("VisitEndTS", startTS);
			initialValues.put("LocProvider", LocProvider);
			initialValues.put("Accuracy", Accuracy);
			initialValues.put("BateryLeftStatus", "0");

			// initialValues.put(KEY_snxtday, 0);
			// initialValues.put(KEY_sDone, 0);
			initialValues.put("ForDate", sForDate.trim());
			initialValues.put("AutoIdStore", AutoIdStore);
			initialValues.put("StoreRouteID", activeRid);
			checkNumberOfStore++;

			////// System.out.println("inserting records..");

			return db.insert(DATABASE_TABLE_MAIN2, null, initialValues);
		}*/

    public String[] fnSchemeIDFreePRodQtyDetails() {

        Cursor cursor = db.rawQuery("SELECT tblSchemeList.SchemeID,tblSchemeList.SchemeType, " +
                " tblSchemeList.CombTypeID,tblSchemeList.flgDiscountType,tblSchemeDetails.FreeProductID from tblSchemeList Inner JOIN tblSchemeDetails" +
                "  ON tblSchemeList.SchemeID=tblSchemeDetails.SchemeID", null);
        try {
            String[] SchemeIDFreePRodQtyDetails = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    SchemeIDFreePRodQtyDetails[i] = (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString() + "^" + (String) cursor.getString(3).toString() + "^" + (String) cursor.getString(4).toString();
                    // System.out.println("product short name Abhinav Raj :"+SchemeIDFreePRodQtyDetails[i]);
                    cursor.moveToNext();
                }
            }
            return SchemeIDFreePRodQtyDetails;
        } finally {
            cursor.close();
        }
    }

    public int fnCheckIfStoreExistInStoreSchemeFreeProQtyOtherDetails(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStoreSchemeFreeProQtyOtherDetails WHERE StoreID ='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public void fnChkandInsertIfNotPresentInStoreSchemeFreeProQtyOtherDetails(String StoreID) {
        int chkI = fnCheckIfStoreExistInStoreSchemeFreeProQtyOtherDetails(StoreID);
        int GetStoreType = fnGetStoreTypeOnStoreID(StoreID);
        if (chkI == 0) {
            String[] SchemeIDFreePRodQtyDetails = fnSchemeIDFreePRodQtyDetails();
            fnInsertStoreRecordsInStoreSchemeFreeProQtyOtherDetailsIfNotPresent(SchemeIDFreePRodQtyDetails, StoreID, "" + GetStoreType);

        }

    }

    public void fnInsertStoreRecordsInStoreSchemeFreeProQtyOtherDetailsIfNotPresent(String SchemeIDFreePRodQtyDetails[], String StoreID, String StoreType) {

        for (int cnt = 0; cnt < SchemeIDFreePRodQtyDetails.length; cnt++) {
            StringTokenizer token = new StringTokenizer(String.valueOf(SchemeIDFreePRodQtyDetails[cnt]), "^");
            //// System.out.println("product short name Abhinav Raj In Loop :"+SchemeIDFreePRodQtyDetails[cnt]);
            ContentValues initialValues = new ContentValues();
            initialValues.put("StoreID", StoreID.trim());
            initialValues.put("StoreType", StoreType.trim());
            initialValues.put("SchemeID", token.nextToken().trim());
            initialValues.put("SchemeType", token.nextToken().trim());
            initialValues.put("CombTypeID", token.nextToken().trim());
            initialValues.put("flgDiscountType", token.nextToken().trim());
            initialValues.put("FreeProductID", token.nextToken().trim());
            initialValues.put("FreeProductQty", "0");
            initialValues.put("Discount", "0.00");

            db.insert("tblStoreSchemeFreeProQtyOtherDetails", null, initialValues);
        }

    }

    public void deleteStoreRecordFromtblStoreSchemeFreeProQtyOtherDetailsOnceSubmitted(String storeID) {
        db.execSQL("DELETE FROM tblStoreSchemeFreeProQtyOtherDetails WHERE StoreID='" + storeID + "'");
    }

    public String fnGetFreeQtyFromStoreSchemeFreeProQtyOtherDetails(String storeID, String SchID, String SchemeType, String CombTypeID, String FreeProductID) {

        int LoncolumnIndex = 0;
        int LoncolumnIndex1 = 1;
        String strSchemeIDFreeProductId = "";
        String Statement = "";
        if (SchemeType.equals("1") || SchemeType.equals("2")) {
            Statement = "SELECT FreeProductQty FROM tblStoreSchemeFreeProQtyOtherDetails where SchemeID='"
                    + SchID + "' and StoreID='" + storeID + "' and SchemeType='" + SchemeType + "' and CombTypeID='" + CombTypeID + "' and FreeProductID='" + FreeProductID + "'";

        } else {
            Statement = "SELECT Discount FROM tblStoreSchemeFreeProQtyOtherDetails where SchemeID='"
                    + SchID + "' and StoreID='" + storeID + "' and SchemeType='" + SchemeType + "' and CombTypeID='" + CombTypeID + "' and FreeProductID='" + FreeProductID + "'";
        }
        Cursor cursor2 = db.rawQuery("SELECT FreeProductQty FROM tblStoreSchemeFreeProQtyOtherDetails where SchemeID='"
                + SchID + "' and StoreID='" + storeID + "' and SchemeType='" + SchemeType + "' and CombTypeID='" + CombTypeID + "' and FreeProductID='" + FreeProductID + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {

                    strSchemeIDFreeProductId = cursor2
                            .getString(LoncolumnIndex);
                    //+ "_"
                    //+ cursor2.getString(LoncolumnIndex1);
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strSchemeIDFreeProductId;
        } finally {
            cursor2.close();
        }
    }

    public void UpdateInvoiceButtonStoreFlag(String storeID, String SchID, String SchemeType, String CombTypeID, String FreeProductID, String FreeProductQty, String Discount) {
        if (SchemeType.equals("1") || SchemeType.equals("2")) {
            try {
                final ContentValues values = new ContentValues();
                values.put("Discount", FreeProductQty);
                int affected = db.update("tblStoreSchemeFreeProQtyOtherDetails", values, "StoreID=? AND SchemeID=? AND SchemeType=? AND CombTypeID=? AND FreeProductID=?", new String[]{storeID, SchID, SchemeType, CombTypeID, FreeProductID});
            } catch (Exception ex) {
                Log.e(TAG, ex.toString());
            }
        } else if (SchemeType.equals("3")) {
            try {
                final ContentValues values = new ContentValues();
                values.put("FreeProductQty", FreeProductQty);
                int affected = db.update("tblStoreSchemeFreeProQtyOtherDetails", values, "StoreID=? AND SchemeID=? AND SchemeType=? AND CombTypeID=? AND FreeProductID=?", new String[]{storeID, SchID, SchemeType, CombTypeID, FreeProductID});
            } catch (Exception ex) {
                Log.e(TAG, ex.toString());
            }
        }
    }

    public int fnGetStoreTypeOnStoreID(String StoreID) {

        int LoncolumnIndex = 0;
        int strStoreType = 0;

        Cursor cursor2 = db.rawQuery(
                "SELECT StoreType FROM tblStoreList Where StoreID='" + StoreID + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStoreType = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }
            return strStoreType;
        } finally {
            cursor2.close();
        }

    }

    public ArrayList<HashMap<String, String>> fetch_catgry_prdctsData(String storeID, int BusinessSegmentId,int RegionID) {

        //open();
        ArrayList<HashMap<String, String>> totalProductDetail = new ArrayList<HashMap<String, String>>();
        //hmapCtgryPrdctDetail= key=prdctId,val=CategoryID
        LinkedHashMap<String, String> hmapCtgryPrdctDetail = new LinkedHashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=Volume^Rate^TaxAmount
        HashMap<String, String> hmapPrdctVolRatTax = new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=OrderQty
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();


        //hmapCtgryPrdctDetail= key=prdctId,val=OrderQty
        HashMap<String, String> hmapPrdctOdrQtyForCalculation = new HashMap<String, String>();


        //hmapCtgryPrdctDetail= key=prdctId,val=ProductSample
        HashMap<String, String> hmapPrdctSmpl = new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=ProductFreeQty
        HashMap<String, String> hmapPrdctFreeQty = new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=ProductName
        HashMap<String, String> hmapPrdctIdPrdctName = new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=ProductDiscount
        HashMap<String, String> hmapPrdctIdPrdctDscnt = new HashMap<String, String>();

        //hmapProductRetailerMarginPercentage= key =ProductID         value=RetailerMarginPercentage
        HashMap<String, String> hmapProductRetailerMarginPercentage = new HashMap<String, String>();

        //hmapProductVatTaxPerventage= key =ProductID         value=VatTaxPercentage
        HashMap<String, String> hmapProductVatTaxPerventage = new HashMap<String, String>();

        //hmapProductVatTaxPerventage= key =ProductID         value=ProductMRP
        HashMap<String, String> hmapProductMRP = new HashMap<String, String>();

        //hmapProductVatTaxPerventage= key =ProductID         value=DiscountPercentageGivenOnProduct
        HashMap<String, String> hmapProductDiscountPercentageGive = new HashMap<String, String>();

        //hmapProductVolumePer= key =ProductID         value=Per
        HashMap<String, String> hmapProductVolumePer = new HashMap<String, String>();

        //hmapProductVolumePer= key =ProductID         value=TaxValue
        HashMap<String, String> hmapProductTaxValue = new HashMap<String, String>();

        //hmapProductVolumePer= key =ProductID         value=LODQty
        HashMap<String, String> hmapProductLODQty = new HashMap<String, String>();

        //hmapProductVolumePer= key =ProductID         value=LODQty
        HashMap<String, String> hmapProductIdOrdrVal = new HashMap<String, String>();

        //hmapProductStandardRate= key =ProductID         value=StandardRate
        HashMap<String, String> hmapProductStandardRate = new HashMap<String, String>();

        //hmapProductStandardRateBeforeTax= key =ProductID         value=StandardRateBeforeTax
        HashMap<String, String> hmapProductStandardRateBeforeTax = new HashMap<String, String>();

        //hmapProductStandardTax= key =ProductID         value=StandardTax
        HashMap<String, String> hmapProductStandardTax = new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=Stock
        HashMap<String, String> hmapProductStock = new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapProductflgPriceAva = new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapflgWholeSellApplicable = new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapPriceRangeWholeSellApplicable = new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapStandardRateWholeSale = new HashMap<String, String>();
//hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapStandardRateBeforeTaxWholeSell = new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=flgPriceAva
        HashMap<String, String> hmapStandardTaxWholeSale = new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=ProductSelectedUOMId
        HashMap<String, String> hmapProductSelectedUOMId = new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=LineValBfrTxAftrDscnt
        HashMap<String, String> hmapLineValBfrTxAftrDscnt = new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=LineValAftrTxAftrDscnt
        HashMap<String, String> hmapLineValAftrTxAftrDscnt = new HashMap<String, String>();

        //hmapProductStock= key =ProductID         value=LineValAftrTxAftrDscnt

        HashMap<String, String> hmapProductExtraOrder = new HashMap<String, String>();

        //hmapProductVolumePer= key =ProductID         value=NHILTax
        HashMap<String, String> hmapProductNHILTaxPercent = new HashMap<String, String>();

        //hmapProductVolumePer= key =ProductID         value=GetFundTax
        HashMap<String, String> hmapProductGetFundTaxPercent = new HashMap<String, String>();

        HashMap<String, String> hmapProductMeasureID = new HashMap<String, String>();
        HashMap<String, String> hmapProductMeasureIDBaseQty = new HashMap<String, String>();
        HashMap<String, String> hmapProductMeasureIDflgDefaultMeasure = new HashMap<String, String>();
        HashMap<String, String> hmapProductFinalConversionUnit = new HashMap<String, String>();
        HashMap<String, String> hmapProductImage = new HashMap<String, String>();

        HashMap<String, String> hmapProductflgPicsOrCases = new HashMap<String, String>();
        HashMap<String, String> hmapLineValAftrTxAftrDscntWithTCOrder = new HashMap<String, String>();
        int SectorID=fnGetSectorID();
      /*  Cursor cursor=null;
        if(CommonInfo.hmapAppMasterFlags.get("flgControlStock")==1) {
            cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,tblProductListMaster.CategoryID,tblProductListMaster.ProductShortName,tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,tblProductSegementMap.RetMarginPer,tblProductSegementMap.VatTax,tblProductSegementMap.ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,tblProductSegementMap.StandardTax,0 As Stock,tblProductSegementMap.flgPriceAva,tblProductSegementMap.flgWholeSellApplicable,tblProductSegementMap.PriceRangeWholeSellApplicable,tblProductSegementMap.StandardRateWholeSale,tblProductSegementMap.StandardRateBeforeTaxWholeSell,tblProductSegementMap.StandardTaxWholeSale,'0' AS UOMID,'0.00' AS LineValBfrTxAftrDscnt,'0.00' AS LineValAftrTxAftrDscnt,0 AS ProductExtraOrder  FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblVanProductStock on tblProductListMaster.ProductID=tblVanProductStock.PrdctId  order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        }
        else
        {
            cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,tblProductListMaster.CategoryID,tblProductListMaster.ProductShortName,tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,tblProductSegementMap.RetMarginPer,tblProductSegementMap.VatTax,tblProductSegementMap.ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,tblProductSegementMap.StandardTax,0 As Stock,tblProductSegementMap.flgPriceAva,tblProductSegementMap.flgWholeSellApplicable,tblProductSegementMap.PriceRangeWholeSellApplicable,tblProductSegementMap.StandardRateWholeSale,tblProductSegementMap.StandardRateBeforeTaxWholeSell,tblProductSegementMap.StandardTaxWholeSale,'0' AS UOMID,'0.00' AS LineValBfrTxAftrDscnt,'0.00' AS LineValAftrTxAftrDscnt,0 AS ProductExtraOrder  FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        }*/
        Cursor cursor=null;
        if(SectorID==1)
        cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,tblProductListMaster.CategoryID,tblProductListMaster.ProductShortName,tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,tblProductSegementMap.RetMarginPer,tblProductSegementMap.VatTax,tblProductSegementMap.ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,tblProductSegementMap.StandardTax,0 As Stock,tblProductSegementMap.flgPriceAva,tblProductSegementMap.flgWholeSellApplicable,tblProductSegementMap.PriceRangeWholeSellApplicable,tblProductSegementMap.StandardRateWholeSale,tblProductSegementMap.StandardRateBeforeTaxWholeSell,tblProductSegementMap.StandardTaxWholeSale,'0' AS UOMID,'0.00' AS LineValBfrTxAftrDscnt,'0.00' AS LineValAftrTxAftrDscnt,ifnull(tblProductSegementMap.NHILTax,0.0) AS NHILTax,ifnull(tblProductSegementMap.GetFundTax,0.0) AS GetFundTax,0 AS ProductExtraOrder,0 AS RptUnitID,0.0 AS FinalConversionUnit,ifnull(ImageURL,'NA'),0 AS OrderQtyDataToShow,0 AS flgPicsOrCases   FROM tblProductListMaster  inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblPrdMstrTransactionUOMConfig on (tblProductSegementMap.ProductID=tblPrdMstrTransactionUOMConfig.NodeID and tblProductSegementMap.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID) where( tblPrdMstrTransactionUOMConfig.flgDistInv=1 or  tblPrdMstrTransactionUOMConfig.flgDistInv=2) and tblProductSegementMap.RegionID="+RegionID+"  order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        else
            cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,tblProductListMaster.CategoryID,tblProductListMaster.ProductShortName,tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,tblProductSegementMap.RetMarginPer,tblProductSegementMap.VatTax,tblProductSegementMap.ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,tblProductSegementMap.StandardTax,0 As Stock,tblProductSegementMap.flgPriceAva,tblProductSegementMap.flgWholeSellApplicable,tblProductSegementMap.PriceRangeWholeSellApplicable,tblProductSegementMap.StandardRateWholeSale,tblProductSegementMap.StandardRateBeforeTaxWholeSell,tblProductSegementMap.StandardTaxWholeSale,'0' AS UOMID,'0.00' AS LineValBfrTxAftrDscnt,'0.00' AS LineValAftrTxAftrDscnt,ifnull(tblProductSegementMap.NHILTax,0.0) AS NHILTax,ifnull(tblProductSegementMap.GetFundTax,0.0) AS GetFundTax,0 AS ProductExtraOrder,0 AS RptUnitID,0.0 AS FinalConversionUnit,ifnull(ImageURL,'NA'),0 AS OrderQtyDataToShow,0 AS flgPicsOrCases   FROM tblProductListMaster  inner join tblProductSectorMapping on tblProductListMaster.ProductID= tblProductSectorMapping.PrdNodeID inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblPrdMstrTransactionUOMConfig on (tblProductSegementMap.ProductID=tblPrdMstrTransactionUOMConfig.NodeID and tblProductSegementMap.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID) where( tblPrdMstrTransactionUOMConfig.flgDistInv=1 or  tblPrdMstrTransactionUOMConfig.flgDistInv=2) and tblProductSectorMapping.SectorID="+SectorID+" and tblProductSegementMap.RegionID="+RegionID+"  order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        //tblProductListMaster.ProductID------------->0
        //tblProductListMaster.CategoryID------------>1
        //tblProductListMaster.ProductShortName------>2
        //tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax
        //'NA/0' As LODQty---------------------->4
        //0 AS SampleQty------------------------>5
        //0 AS ProductFreeQty------------------->6
        //0 AS ProductOrderQty------------------>7
        //0.00 As PrdctDiscount----------------->8
        //tblProductSegementMap.RetMarginPer---->9
        //tblProductSegementMap.VatTax---------->10
        //tblProductSegementMap.ProductMRP-------->11
        //0.00 AS DiscountPercentageGivenOnProduct----->12
        //0 AS Per------------------------------->13
        //0.00 AS TaxValue----------------------->14
        //0.00 AS OrderValue--------------------->15
        //tblProductSegementMap.StandardRate----->16
        //tblProductSegementMap.StandardRateBeforeTax----->17
        //tblProductSegementMap.StandardTax------->18
        //0 As Stock------------------------------>19
        //FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"  order by tblProductListMaster.CategoryID,tblProductListMaster.ProductID",null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapCtgryPrdctDetail.put(cursor.getString(0), cursor.getString(1));
                        hmapPrdctVolRatTax.put(cursor.getString(0), cursor.getString(3));
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(7));
                        hmapPrdctSmpl.put(cursor.getString(0), cursor.getString(5));
                        hmapPrdctFreeQty.put(cursor.getString(0), cursor.getString(6));
                        hmapPrdctIdPrdctName.put(cursor.getString(0), cursor.getString(2));
                        hmapPrdctIdPrdctDscnt.put(cursor.getString(0), cursor.getString(8));
                        hmapProductRetailerMarginPercentage.put(cursor.getString(0), cursor.getString(9));
                        hmapProductVatTaxPerventage.put(cursor.getString(0), cursor.getString(10));
                        hmapProductMRP.put(cursor.getString(0), cursor.getString(11));
                        hmapProductDiscountPercentageGive.put(cursor.getString(0), cursor.getString(12));
                        hmapProductVolumePer.put(cursor.getString(0), cursor.getString(13));
                        hmapProductTaxValue.put(cursor.getString(0), cursor.getString(14));
                        hmapProductLODQty.put(cursor.getString(0), cursor.getString(4));
                        hmapProductIdOrdrVal.put(cursor.getString(0), cursor.getString(15));

                        hmapProductStandardRate.put(cursor.getString(0), cursor.getString(16));

                        hmapProductStandardRateBeforeTax.put(cursor.getString(0), cursor.getString(17));

                        hmapProductStandardTax.put(cursor.getString(0), cursor.getString(18));
                        hmapProductStock.put(cursor.getString(0), cursor.getString(19));
                        hmapProductflgPriceAva.put(cursor.getString(0), cursor.getString(20));
                        hmapflgWholeSellApplicable.put(cursor.getString(0), cursor.getString(21));
                        hmapPriceRangeWholeSellApplicable.put(cursor.getString(0), cursor.getString(22));
                        hmapStandardRateWholeSale.put(cursor.getString(0), cursor.getString(23));
                        hmapStandardRateBeforeTaxWholeSell.put(cursor.getString(0), cursor.getString(24));
                        hmapStandardTaxWholeSale.put(cursor.getString(0), cursor.getString(25));

                        hmapProductSelectedUOMId.put(cursor.getString(0), cursor.getString(26));
                        hmapLineValBfrTxAftrDscnt.put(cursor.getString(0), cursor.getString(27));
                        hmapLineValAftrTxAftrDscnt.put(cursor.getString(0), cursor.getString(28));

                        hmapProductNHILTaxPercent.put(cursor.getString(0), cursor.getString(29));

                        hmapProductGetFundTaxPercent.put(cursor.getString(0), cursor.getString(30));
                        hmapProductExtraOrder.put(cursor.getString(0), cursor.getString(31));

                        hmapProductMeasureID.put(cursor.getString(0), cursor.getString(31));
                        hmapProductMeasureIDBaseQty.put(cursor.getString(31), cursor.getString(32));
                        // hmapProductMeasureIDflgDefaultMeasure.put(cursor.getString(31), cursor.getString(33));
                        //  hmapProductMeasureIDflgDefaultMeasure.put(cursor.getString(31), cursor.getString(33));
                        hmapProductFinalConversionUnit.put(cursor.getString(0), cursor.getString(33));
                        hmapProductImage.put(cursor.getString(0), cursor.getString(34));

                        hmapPrdctOdrQtyForCalculation.put(cursor.getString(0), cursor.getString(35));
                        hmapProductflgPicsOrCases.put(cursor.getString(0), cursor.getString(36));


                        cursor.moveToNext();
                        // cursor.close();
                    }
                    totalProductDetail.add(hmapCtgryPrdctDetail);
                    totalProductDetail.add(hmapPrdctVolRatTax);
                    totalProductDetail.add(hmapPrdctOdrQty);
                    totalProductDetail.add(hmapPrdctSmpl);
                    totalProductDetail.add(hmapPrdctFreeQty);
                    totalProductDetail.add(hmapPrdctIdPrdctName);
                    totalProductDetail.add(hmapPrdctIdPrdctDscnt);
                    totalProductDetail.add(hmapProductRetailerMarginPercentage);
                    totalProductDetail.add(hmapProductVatTaxPerventage);
                    totalProductDetail.add(hmapProductMRP);
                    totalProductDetail.add(hmapProductDiscountPercentageGive);
                    totalProductDetail.add(hmapProductVolumePer);
                    totalProductDetail.add(hmapProductTaxValue);
                    totalProductDetail.add(hmapProductLODQty);
                    totalProductDetail.add(hmapProductIdOrdrVal);
                    totalProductDetail.add(hmapProductStandardRate);
                    totalProductDetail.add(hmapProductStandardRateBeforeTax);
                    totalProductDetail.add(hmapProductStandardTax);
                    totalProductDetail.add(hmapProductStock);
                    totalProductDetail.add(hmapProductflgPriceAva);
                    totalProductDetail.add(hmapflgWholeSellApplicable);
                    totalProductDetail.add(hmapPriceRangeWholeSellApplicable);
                    totalProductDetail.add(hmapStandardRateWholeSale);
                    totalProductDetail.add(hmapStandardRateBeforeTaxWholeSell);
                    totalProductDetail.add(hmapStandardTaxWholeSale);

                    totalProductDetail.add(hmapProductSelectedUOMId);
                    totalProductDetail.add(hmapLineValBfrTxAftrDscnt);
                    totalProductDetail.add(hmapLineValAftrTxAftrDscnt);
                    totalProductDetail.add(hmapProductNHILTaxPercent);
                    totalProductDetail.add(hmapProductGetFundTaxPercent);
                    totalProductDetail.add(hmapProductExtraOrder);


                    totalProductDetail.add(hmapProductMeasureID);
                    totalProductDetail.add(hmapProductMeasureIDBaseQty);
                    totalProductDetail.add(hmapProductFinalConversionUnit);
                    totalProductDetail.add(hmapProductImage);
                    totalProductDetail.add(hmapPrdctOdrQtyForCalculation);
                    totalProductDetail.add(hmapProductflgPicsOrCases);

                    //

                }
            }


            return totalProductDetail;
        } finally {
            cursor.close();

            // close();
        }


    }
	/*	public static ArrayList<HashMap<String, String>> fetch_catgry_prdctsData(String storeID,int BusinessSegmentId) {

			//open();
			ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>();
			//hmapCtgryPrdctDetail= key=prdctId,val=CategoryID
			LinkedHashMap<String, String> hmapCtgryPrdctDetail=new LinkedHashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=Volume^Rate^TaxAmount
			HashMap<String, String> hmapPrdctVolRatTax=new HashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=OrderQty
			HashMap<String, String> hmapPrdctOdrQty=new HashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=ProductSample
			HashMap<String, String> hmapPrdctSmpl=new HashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=ProductFreeQty
			HashMap<String, String> hmapPrdctFreeQty=new HashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=ProductName
			HashMap<String, String> hmapPrdctIdPrdctName=new HashMap<String, String>();
			//hmapCtgryPrdctDetail= key=prdctId,val=ProductDiscount
			HashMap<String, String> hmapPrdctIdPrdctDscnt=new HashMap<String, String>();

			 //hmapProductRetailerMarginPercentage= key =ProductID         value=RetailerMarginPercentage
			   HashMap<String, String> hmapProductRetailerMarginPercentage=new HashMap<String, String>();

			 //hmapProductVatTaxPerventage= key =ProductID         value=VatTaxPercentage
			   HashMap<String, String> hmapProductVatTaxPerventage=new HashMap<String, String>();

			 //hmapProductVatTaxPerventage= key =ProductID         value=ProductMRP
			   HashMap<String, String> hmapProductMRP=new HashMap<String, String>();

			 //hmapProductVatTaxPerventage= key =ProductID         value=DiscountPercentageGivenOnProduct
			   HashMap<String, String> hmapProductDiscountPercentageGive=new HashMap<String, String>();

			 //hmapProductVolumePer= key =ProductID         value=Per
			   HashMap<String, String> hmapProductVolumePer=new HashMap<String, String>();

			 //hmapProductVolumePer= key =ProductID         value=TaxValue
			   HashMap<String, String> hmapProductTaxValue=new HashMap<String, String>();

			 //hmapProductVolumePer= key =ProductID         value=LODQty
			   HashMap<String, String> hmapProductLODQty=new HashMap<String, String>();

			 //hmapProductVolumePer= key =ProductID         value=LODQty
			   HashMap<String, String> hmapProductIdOrdrVal=new HashMap<String, String>();

			   //hmapProductStandardRate= key =ProductID         value=StandardRate
			   HashMap<String, String> hmapProductStandardRate=new HashMap<String, String>();

			   //hmapProductStandardRateBeforeTax= key =ProductID         value=StandardRateBeforeTax
			   HashMap<String, String> hmapProductStandardRateBeforeTax=new HashMap<String, String>();

			   //hmapProductStandardTax= key =ProductID         value=StandardTax
			   HashMap<String, String> hmapProductStandardTax=new HashMap<String, String>();

			   //hmapProductStock= key =ProductID         value=Stock
			   HashMap<String, String> hmapProductStock=new HashMap<String, String>();

			//hmapProductStock= key =ProductID         value=flgPriceAva
			HashMap<String, String> hmapProductflgPriceAva=new HashMap<String, String>();


			 //Cursor cursor = db.rawQuery("SELECT ProductID,CategoryID,ProductShortName,KGLiter ||'^'||ProductRLP||'^'||ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,RetMarginPer,VatTax,ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,StandardRate,StandardRateBeforeTax,StandardTax,0 As Stock  FROM tblProductListMaster order by CategoryID,ProductID",null);
			   Cursor cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,tblProductListMaster.CategoryID,tblProductListMaster.ProductShortName,tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax,'NA/0' As LODQty,0 AS SampleQty,0 AS ProductFreeQty,0 AS ProductOrderQty,0.00 As PrdctDiscount,tblProductSegementMap.RetMarginPer,tblProductSegementMap.VatTax,tblProductSegementMap.ProductMRP,0.00 AS DiscountPercentageGivenOnProduct,0 AS Per,0.00 AS TaxValue,0.00 AS OrderValue,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,tblProductSegementMap.StandardTax,0 As Stock,tblProductSegementMap.flgPriceAva  FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr",null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"

			   //tblProductListMaster.ProductID------------->0
			   //tblProductListMaster.CategoryID------------>1
			   //tblProductListMaster.ProductShortName------>2
			   //tblProductListMaster.KGLiter ||'^'||tblProductSegementMap.ProductRLP||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax
			   //'NA/0' As LODQty---------------------->4
			   //0 AS SampleQty------------------------>5
			   //0 AS ProductFreeQty------------------->6
			   //0 AS ProductOrderQty------------------>7
			   //0.00 As PrdctDiscount----------------->8
			   //tblProductSegementMap.RetMarginPer---->9
			   //tblProductSegementMap.VatTax---------->10
			   //tblProductSegementMap.ProductMRP-------->11
			   //0.00 AS DiscountPercentageGivenOnProduct----->12
			   //0 AS Per------------------------------->13
			   //0.00 AS TaxValue----------------------->14
			   //0.00 AS OrderValue--------------------->15
			   //tblProductSegementMap.StandardRate----->16
			   //tblProductSegementMap.StandardRateBeforeTax----->17
			   //tblProductSegementMap.StandardTax------->18
			   //0 As Stock------------------------------>19
			   //FROM tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"  order by tblProductListMaster.CategoryID,tblProductListMaster.ProductID",null);
			   try
			{
				if(cursor.getCount()>0)
				{
					if (cursor.moveToFirst()) {

						for (int i = 0; i < cursor.getCount(); i++)
						{
							hmapCtgryPrdctDetail.put(cursor.getString(0), cursor.getString(1));
							hmapPrdctVolRatTax.put(cursor.getString(0), cursor.getString(3));
							hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(7));
							hmapPrdctSmpl.put(cursor.getString(0), cursor.getString(5));
							hmapPrdctFreeQty.put(cursor.getString(0), cursor.getString(6));
							hmapPrdctIdPrdctName.put(cursor.getString(0), cursor.getString(2));
							hmapPrdctIdPrdctDscnt.put(cursor.getString(0), cursor.getString(8));
							hmapProductRetailerMarginPercentage.put(cursor.getString(0), cursor.getString(9));
							hmapProductVatTaxPerventage.put(cursor.getString(0), cursor.getString(10));
							hmapProductMRP.put(cursor.getString(0), cursor.getString(11));
							hmapProductDiscountPercentageGive.put(cursor.getString(0), cursor.getString(12));
							hmapProductVolumePer.put(cursor.getString(0), cursor.getString(13));
							hmapProductTaxValue.put(cursor.getString(0), cursor.getString(14));
							hmapProductLODQty.put(cursor.getString(0), cursor.getString(4));
							hmapProductIdOrdrVal.put(cursor.getString(0), cursor.getString(15));

							hmapProductStandardRate.put(cursor.getString(0), cursor.getString(16));

							hmapProductStandardRateBeforeTax.put(cursor.getString(0), cursor.getString(17));

							hmapProductStandardTax.put(cursor.getString(0), cursor.getString(18));
							hmapProductStock.put(cursor.getString(0), cursor.getString(19));
							hmapProductflgPriceAva.put(cursor.getString(0), cursor.getString(20));
							cursor.moveToNext();
							// cursor.close();
						}
						totalProductDetail.add(hmapCtgryPrdctDetail);
						totalProductDetail.add(hmapPrdctVolRatTax);
						totalProductDetail.add(hmapPrdctOdrQty);
						totalProductDetail.add(hmapPrdctSmpl);
						totalProductDetail.add(hmapPrdctFreeQty);
						totalProductDetail.add(hmapPrdctIdPrdctName);
						totalProductDetail.add(hmapPrdctIdPrdctDscnt);
						totalProductDetail.add(hmapProductRetailerMarginPercentage);
						totalProductDetail.add(hmapProductVatTaxPerventage);
						totalProductDetail.add(hmapProductMRP);
						totalProductDetail.add(hmapProductDiscountPercentageGive);
						totalProductDetail.add(hmapProductVolumePer);
						totalProductDetail.add(hmapProductTaxValue);
						totalProductDetail.add(hmapProductLODQty);
						totalProductDetail.add(hmapProductIdOrdrVal);
						totalProductDetail.add(hmapProductStandardRate);
						totalProductDetail.add(hmapProductStandardRateBeforeTax);
						totalProductDetail.add(hmapProductStandardTax);
						totalProductDetail.add(hmapProductStock);
						totalProductDetail.add(hmapProductflgPriceAva);
					}
				}


				return totalProductDetail;
			} finally {
				cursor.close();

				//close();
			}


		}
	*/

    public long savetblPriceApplyType(int DiscountLevelType, double cutoffvalue) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("DiscountLevelType", DiscountLevelType);
        initialValues.put("cutoffvalue", cutoffvalue);
        return db.insert(DBHelper.DATABASE_TABLE_tblPriceApplyType, null, initialValues);
    }


    public int fnGettblPriceApplyDiscountLevelType(String storeID) {
        //open();
        int PriceApplyDiscountLevelType = 0;
        Cursor cursor = db.rawQuery("Select DiscountLevelType from tblPriceApplyType", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                PriceApplyDiscountLevelType = Integer.parseInt(cursor.getString(0));
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        // close();
        return PriceApplyDiscountLevelType;
    }

    public LinkedHashMap<String, String> fetch_Category_List_Return(String StoreID) {
        //open();
        // System.out.println("Abhinav Raj is 1");
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr FROM tblCategoryMaster inner join tblProductListMaster ON tblCategoryMaster.CategoryID=tblProductListMaster.CategoryID inner join tblActualVisitStock on tblProductListMaster.ProductID=tblActualVisitStock.ProductID Where tblActualVisitStock.Stock>0 and tblActualVisitStock.storeID='" + StoreID + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (i == 0) {
                            hmapCatgry.put("All", "0");
                        }
                        hmapCatgry.put(cursor.getString(1).toString(), cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("No Category", "0");
            }
            // System.out.println("Abhinav Raj is 3");
            return hmapCatgry;
        } finally {
            cursor.close();
            //close();
        }
    }

    public LinkedHashMap<String, String> fetch_Category_List() {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
       // int SectorID=0;
        Cursor cursor=null;
        int SectorID=fnGetSectorID();
        if(SectorID==1)
            cursor= db.rawQuery("SELECT DISTINCT CategoryID,CategoryDescr FROM tblCategoryMaster Order by CatOrdr", null);
        else
            cursor= db.rawQuery("SELECT DISTINCT tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr  FROM tblCategoryMaster inner join tblProductListMaster on tblCategoryMaster.CategoryID=tblProductListMaster.CategoryID inner join tblProductSectorMapping on tblProductSectorMapping.PrdNodeID=tblProductListMaster.ProductID where tblProductSectorMapping.SectorID="+SectorID+"  Order by tblCategoryMaster.CatOrdr", null);



        //Cursor cursor = db.rawQuery("SELECT CategoryID,CategoryDescr FROM tblCategoryMaster Order by CatOrdr", null);
        try {
            if (cursor!=null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    //    if (i > 0) {
                            hmapCatgry.put(cursor.getString(1).toString(), cursor.getString(0).toString());
                            cursor.moveToNext();
                      //  }
                    }
                }

            } else {
                hmapCatgry.put("No Category", "0");
            }
            return hmapCatgry;
        } finally {
            cursor.close();
            //close();
        }
    }

    public LinkedHashMap<String, String> fetch_Category_ListOtherFromOrderEntry() {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();

        int SectorID=fnGetSectorID();
        Cursor cursor =null;
        if(SectorID==1)
            cursor= db.rawQuery("SELECT DISTINCT CategoryID,CategoryDescr  FROM tblCategoryMaster ", null);
        else
            cursor= db.rawQuery("SELECT DISTINCT tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr  FROM tblCategoryMaster inner join tblProductListMaster on tblCategoryMaster.CategoryID=tblProductListMaster.CategoryID inner join tblProductSectorMapping on tblProductSectorMapping.PrdNodeID=tblProductListMaster.ProductID where tblProductSectorMapping.SectorID="+SectorID+"", null);


       // Cursor cursor = db.rawQuery("SELECT CategoryID,CategoryDescr FROM tblCategoryMaster Order by CatOrdr", null);
        try {
            if (cursor!=null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        hmapCatgry.put(cursor.getString(1).toString(), cursor.getString(0).toString());
                        cursor.moveToNext();

                    }
                }

            } else {
                hmapCatgry.put("No Category", "0");
            }
            return hmapCatgry;
        } finally {
            if(cursor!=null)
            cursor.close();
            //close();
        }
    }

    public ArrayList<TblOnlyCategoryMasterForRetriving> fetch_Category_ListSubList(int CategoryID) {
        //open();
        ArrayList<TblOnlyCategoryMasterForRetriving> tblOnlyCategoryMasterForRetrivings = new ArrayList<TblOnlyCategoryMasterForRetriving>();
        if (CategoryID != 0) {
            Cursor cursornew = db.rawQuery("SELECT  Distinct ProductTypeNodeID,ProductType FROM tblCategoryMaster Where CategoryID=" + CategoryID + " Order by PrdTypeOrdr", null);
            try {
                if (cursornew.getCount() > 0) {
                    if (cursornew.moveToFirst()) {

                        for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                            TblOnlyCategoryMasterForRetriving tblOnlyCategoryMasterForRetriving = new TblOnlyCategoryMasterForRetriving();
                            tblOnlyCategoryMasterForRetriving.setCategoryNodeID(cursornew.getInt(0));
                            tblOnlyCategoryMasterForRetriving.setCategory(cursornew.getString(1));
                            tblOnlyCategoryMasterForRetriving.setParentID(CategoryID);
                            tblOnlyCategoryMasterForRetriving.setSelected(false);
                            tblOnlyCategoryMasterForRetrivings.add(tblOnlyCategoryMasterForRetriving);
                            //  hmapCatgry.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                            cursornew.moveToNext();
                        }
                    }

                }


            } finally {
                if (cursornew != null)
                    cursornew.close();
                //close();
            }
        }
        return tblOnlyCategoryMasterForRetrivings;
    }


    public ArrayList<TblProductTypeMasterForRetriving> fetch_Category_List_Distribution() {
        //open();
        ArrayList<TblProductTypeMasterForRetriving> tblProductTypeMasterForRetrivings = new ArrayList<TblProductTypeMasterForRetriving>();
        Cursor cursor = db.rawQuery("SELECT DISTINCT CategoryID,CategoryDescr  FROM tblCategoryMaster Order by PrdClassOrdr", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (i > 0) {
                        TblProductTypeMasterForRetriving tblProductTypeMasterForRetriving = new TblProductTypeMasterForRetriving();
                        tblProductTypeMasterForRetriving.setProductType(cursor.getString(1).toString());
                        tblProductTypeMasterForRetriving.setProductTypeNodeID(cursor.getInt(0));
                        tblProductTypeMasterForRetriving.setTblOnlyCategoryMasterForRetrivingList(fetch_Category_ListSubList(cursor.getInt(0)));

                        tblProductTypeMasterForRetrivings.add(tblProductTypeMasterForRetriving);
                    }
                    //  hmapCatgry.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                    cursor.moveToNext();
                }
            }

        }

        if (cursor != null)
            cursor.close();
        //close();
        return tblProductTypeMasterForRetrivings;

    }
    public ArrayList<TblProductTypeMasterForRetriving> fetch_Category_List_OrderEntry(String StoreID) {
        //open();
        ArrayList<TblProductTypeMasterForRetriving> tblProductTypeMasterForRetrivings = new ArrayList<TblProductTypeMasterForRetriving>();
        int SectorID=fnGetSectorID();
        Cursor cursor =null;
        if(SectorID==1)
        cursor= db.rawQuery("SELECT DISTINCT CategoryID,CategoryDescr  FROM tblCategoryMaster Order by PrdClassOrdr", null);
        else
            cursor= db.rawQuery("SELECT DISTINCT tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr  FROM tblCategoryMaster inner join tblProductListMaster on tblCategoryMaster.CategoryID=tblProductListMaster.CategoryID inner join tblProductSectorMapping on tblProductSectorMapping.PrdNodeID=tblProductListMaster.ProductID where tblProductSectorMapping.SectorID="+SectorID+" Order by PrdClassOrdr", null);

        if (cursor!=null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    //if (i > 0) {
                        TblProductTypeMasterForRetriving tblProductTypeMasterForRetriving = new TblProductTypeMasterForRetriving();
                        tblProductTypeMasterForRetriving.setProductType(cursor.getString(1).toString());
                        tblProductTypeMasterForRetriving.setProductTypeNodeID(cursor.getInt(0));
                        //tblProductTypeMasterForRetriving.setTblOnlyCategoryMasterForRetrivingList(fetch_Category_ListSubList(cursor.getInt(0)));
                        tblProductTypeMasterForRetriving.setTblOnlyCategoryMasterForRetrivingList(fetch_Category_ListSubListCarton(cursor.getInt(0),StoreID,"NA"));
                        tblProductTypeMasterForRetrivings.add(tblProductTypeMasterForRetriving);
                    //}
                    //  hmapCatgry.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                    cursor.moveToNext();
                }
            }

        }

        if (cursor != null)
            cursor.close();
        //close();
        return tblProductTypeMasterForRetrivings;

    }

    public LinkedHashMap<String, String> fetch_MaterialMstr_List(String storeID) {
        //open();
        LinkedHashMap<String, String> hmapMaterial = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT POSMaterialID,POSMaterialDescr FROM tblPOSMaterialMstr Order by POSMaterialID", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //hmapMaterial.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                        hmapMaterial.put(cursor.getString(0).toString(), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }

            } else {
                hmapMaterial.put("No Category", "0");
            }
            return hmapMaterial;
        } finally {
            cursor.close();
            //close();
        }
    }

    //tblSchemeSlabBucketProductMapping
    public HashMap<String, HashMap<String, HashMap<String, String>>> fnProductWiseAppliedScehmeSlabDetails(String StorID) {
        String StorIDnew = "1";//StorID;
        //open();
        String[] uniqueProdSchemeList = fnUniqueProdSchemeList();

        String productId;
        String schemeId = null;
        int countProductId = 0;
        int countSchemeId = 0;

						/*Cursor cursor2 = db.rawQuery("SELECT tblSchemeSlabBucketProductMapping.ProductID FROM tblSchemeSlabBucketProductMapping inner join tblSchemeSlabBucketDetails on tblSchemeSlabBucketProductMapping.RowID=tblSchemeSlabBucketDetails.RowID", null);
			if(cursor2.getCount()>0)
			{

			}*/
        // Key=productId,Value=hmapSchemeIdSlab
        HashMap<String, String> hmapSlabIdSlabDscrptnBnftDscrptn = null;
        HashMap<String, HashMap<String, String>> hmapSchemeIdSlab = null;
        HashMap<String, HashMap<String, HashMap<String, String>>> hmapPrdctIdScheme = new HashMap<String, HashMap<String, HashMap<String, String>>>();
        //			0						1						2							3							4
        Cursor cursor = db.rawQuery("SELECT tblSchemeSlabBucketProductMapping.ProductID,tblSchemeMstr.SchemeID,tblSchemeMstr.SchemeName,tblSchemeSlabDetail.SchemeSlabId,tblSchemeSlabDetail.SchemeSlabDesc,tblSchemeSlabDetail.BenifitDescr FROM tblSchemeSlabBucketProductMapping inner join tblSchemeSlabBucketDetails on tblSchemeSlabBucketProductMapping.RowID=tblSchemeSlabBucketDetails.RowID inner join tblSchemeSlabDetail on tblSchemeSlabBucketDetails.SchemeID=tblSchemeSlabDetail.SchemeID inner Join tblSchemeMstr on tblSchemeSlabDetail.SchemeID=tblSchemeMstr.SchemeID inner join tblSchemeStoreMapping on tblSchemeMstr.SchemeID=tblSchemeStoreMapping.SchemeID Where tblSchemeStoreMapping.StoreID='" + StorIDnew + "' Order by tblSchemeSlabBucketProductMapping.ProductID", null);
        if (cursor.moveToFirst()) ;
        {
            for (int index = 0; index < cursor.getCount(); index++) {

                int length = uniqueProdSchemeList.length;
                if (uniqueProdSchemeList[countProductId].toString().equals(cursor.getString(0))) {
                    if (index == 0) {
                        hmapSchemeIdSlab = new HashMap<String, HashMap<String, String>>();
                        hmapSlabIdSlabDscrptnBnftDscrptn = new HashMap<String, String>();
                        schemeId = cursor.getString(1).toString();
                    }
                    if (schemeId.equals(cursor.getString(1))) {
                        hmapSlabIdSlabDscrptnBnftDscrptn.put(cursor.getString(3), cursor.getString(4) + "^" + cursor.getString(5));
                        // System.out.println("Astix SlabId="+cursor.getString(3));
                    } else {


                        hmapSchemeIdSlab.put(schemeId, hmapSlabIdSlabDscrptnBnftDscrptn);
                        hmapSlabIdSlabDscrptnBnftDscrptn = new HashMap<String, String>();
                        // System.out.println("Astix SchemeId="+cursor.getString(1));
                        schemeId = cursor.getString(1).toString();
                        hmapSlabIdSlabDscrptnBnftDscrptn.put(cursor.getString(3), cursor.getString(4) + "^" + cursor.getString(5));
                        // System.out.println("Astix NewScheme SlabId="+cursor.getString(3));

                    }


                } else {
                    hmapPrdctIdScheme.put(uniqueProdSchemeList[countProductId], hmapSchemeIdSlab);
                    hmapSchemeIdSlab = new HashMap<String, HashMap<String, String>>();
                    // System.out.println("Betu HashMapProduct = "+hmapPrdctIdScheme);
                    // System.out.println("Astix ProductID="+uniqueProdSchemeList[countProductId]);


                    hmapSlabIdSlabDscrptnBnftDscrptn.put(cursor.getString(3), cursor.getString(4) + "^" + cursor.getString(5));
                    // System.out.println("Astix NewProduct SlabId="+cursor.getString(3));
                    schemeId = cursor.getString(1).toString();

                    countProductId++;

                }

                cursor.moveToNext();
            }

            //// System.out.println("Betu HashMapProduct = "+hmapPrdctIdScheme);
        }

        //close();
        return hmapPrdctIdScheme;
    }

    public String[] fnUniqueProdSchemeList() {

        Cursor cursor = db.rawQuery("SELECT Distinct ProductID from tblSchemeSlabBucketProductMapping Order by ProductID", null);
        try {
            String[] SchemeIDFreePRodQtyDetails = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    SchemeIDFreePRodQtyDetails[i] = (String) cursor.getString(0).toString();
                    //// System.out.println("Astix short name Abhinav Raj :"+SchemeIDFreePRodQtyDetails[i]);
                    cursor.moveToNext();
                }
            }
            return SchemeIDFreePRodQtyDetails;
        } finally {
            cursor.close();
        }
    }

    public HashMap<String, String> fnGetSchemeIdSchemeDescptn(String schemeId) {
        //open();

        Cursor cursor = db.rawQuery("Select SchemeID , SchemeName from tblSchemeMstr where SchemeID'" + schemeId + "'", null);
        try {
            HashMap<String, String> hmapSchemeIDSchemeDes = new HashMap<String, String>();
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    hmapSchemeIDSchemeDes.put((cursor.getString(0).toString()), (cursor.getString(1).toString()));

                    cursor.moveToNext();
                }
            }
            return hmapSchemeIDSchemeDes;
        } finally {
            cursor.close();
            //close();
        }
    }

    public String[] fectProductIDMappedInSchSlbSubBukRowId(int schSlbSubRowID) {
        ////open();
        Cursor cursor = db.rawQuery("SELECT ProductID FROM tblSchemeSlabBucketProductMapping WHERE RowID =" + schSlbSubRowID, null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0).toString();
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
            // close();
        }

    }

    public HashMap<String, String> fnProductRelatedSchemesList(String StoreID) {
        //open();
        Cursor cursor = db.rawQuery("SELECT Distinct tblProductRelatedScheme.ProductID,PrdString from tblProductRelatedScheme inner join tblSchemeSlabBucketProductMapping on tblProductRelatedScheme.ProductID=tblSchemeSlabBucketProductMapping.ProductID inner join tblSchemeSlabBucketDetails on tblSchemeSlabBucketDetails.RowID=tblSchemeSlabBucketProductMapping.RowID inner join   tblSchemeStoreMapping on tblSchemeSlabBucketDetails.SchemeID=tblSchemeStoreMapping.SchemeID where tblSchemeStoreMapping.StoreID='" + StoreID + "'", null);
        try {
            HashMap<String, String> SchemeIDFreePRodQtyDetails = new HashMap<String, String>();
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        SchemeIDFreePRodQtyDetails.put(cursor.getString(0).toString(), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return SchemeIDFreePRodQtyDetails;
        } finally {
            cursor.close();
            //close();
        }
    }

    public String[] fectProductIDBenifitsListOnPurchase(int schId, int schSlabId, int schSlbBuckId) {

        //Cursor cursor = db.rawQuery("SELECT RowID AS BenifitRowID,BenSubBucketType,BenDiscApplied,CouponCode,BenSubBucketValue,Per, UOM,ProRata FROM tblSchemeSlabBenefitsBucketDetails WHERE SchemeID ="+ schId +" and SchemeSlabID="+schSlabId +" and BucketID="+schSlbBuckId , null);
        Cursor cursor = db.rawQuery("SELECT RowID AS BenifitRowID,BenSubBucketType,BenDiscApplied,CouponCode,BenSubBucketValue,Per, UOM,ProRata,ifnull(IsDiscountOnTotalAmount,0) FROM tblSchemeSlabBenefitsBucketDetails WHERE SchemeID =" + schId + " and SchemeSlabID=" + schSlabId, null);
        try {
            String PerBen;
            String UOMBen;

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (cursor.getString(5) == null) {
                            PerBen = "0.0";
                            UOMBen = "0.0";
                        } else {
                            PerBen = cursor.getString(5);
                            UOMBen = cursor.getString(6);
                        }
                        {
                            CompleteResult[i] = cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2) + "^" + cursor.getString(3) + "^" + cursor.getString(4) + "^" + PerBen + "^" + UOMBen + "^" + cursor.getString(7) + "^" + cursor.getString(8);
                            cursor.moveToNext();
                        }
                    }
                }


            }
            return CompleteResult;
        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }

    }

    public HashMap<String, String> fectProductIDMappedInSchSlbSubBukBenifits(int BenifitRowID) {     //open();
        Cursor cursor = db.rawQuery("SELECT tblSchemeSlabBenefitsProductMappingDetail.ProductID,tblProductListMaster.ProductShortName FROM tblSchemeSlabBenefitsProductMappingDetail inner join tblProductListMaster on tblSchemeSlabBenefitsProductMappingDetail.ProductID=tblProductListMaster.ProductID  WHERE RowID =" + BenifitRowID, null);
        try {
            HashMap<String, String> CompleteResult = new HashMap<String, String>();
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult.put(cursor.getString(1).toString(), cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
            // close();
        }
    }

    public String[] fectStatusIfBeniftRowIdExistsInSchemeSlabBenefitsValueDetail(int BenifitRowID, int toMultiply, Double defaultValue, int BenSubBucketType) {

        //open();
        Cursor cursor2 = db.rawQuery("SELECT BenValue FROM tblSchemeSlabBenefitsValueDetail where RowID=" + BenifitRowID, null);
        if (BenSubBucketType == 2 || BenSubBucketType == 6 || BenSubBucketType == 8) {
            toMultiply = 1;
        }
        //////////// System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        String[] chkI;
        try {
            if (cursor2.getCount() > 0) {
                chkI = new String[cursor2.getCount() + 1];
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (i == 0) {
                            chkI[i] = String.valueOf(defaultValue * toMultiply);

                        }

                        chkI[i + 1] = String.valueOf((Integer.parseInt(cursor2.getString(0)) * toMultiply));

                        cursor2.moveToNext();
                    }

                }
            } else {
                chkI = new String[1];
                chkI[0] = String.valueOf(defaultValue * toMultiply);
            }

        } finally {
            cursor2.close();
            //close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;
    }

    public String[] fnGetEarlierFreeProductIDandQtyonSchemeSlabBuckIDTypeBasis(String StoreID, int productID, int schId, int schSlabId, int schSlbBuckId, int BenifitRowID) {
        Cursor cursor = db.rawQuery("SELECT FreeProductID,BenifitAssignedValue From tblFreeProductIDandQtyonSchemeSlabBuckIDTypeBasis where StoreID='" + StoreID + "' and ProductID=" + productID + " and schId=" + schId + " and schSlabId=" + schSlabId + " and schSlbBuckId=" + schSlbBuckId + " and BenifitRowID=" + BenifitRowID, null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0).toString();
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
        }
    }

    public String fectStatusIfBeniftRowIdExistsInSchemeSlabBenefitsPercentageDetail(int BenifitRowID) {

        Cursor cursor2 = db.rawQuery("SELECT RowID,BenValue,Type FROM tblSchemeSlabBenefitsValueDetail where RowID=" + BenifitRowID, null);

        //////////// System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        String chkI = "";
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (!cursor2.isNull(0)) {
                            chkI = cursor2.getString(0).toString() + "_" + cursor2.getString(1).toString() + "_" + cursor2.getString(2).toString();
                        }
                        cursor2.moveToNext();
                    }
                }
            }

        } finally {
            cursor2.close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;
    }

    public String fectStatusIfBeniftRowIdExistsInSchemeSlabBenefitsFlatAmtDetail(int BenifitRowID) {

        Cursor cursor2 = db.rawQuery("SELECT RowID,BenValue,Type FROM tblSchemeSlabBenefitsValueDetail where RowID=" + BenifitRowID, null);

        //////////// System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        String chkI = "";
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (!cursor2.isNull(0)) {
                            chkI = cursor2.getString(0).toString() + "_" + cursor2.getString(1).toString() + "_" + cursor2.getString(2).toString();
                        }
                        cursor2.moveToNext();
                    }

                }
            }

        } finally {
            cursor2.close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;
    }

    public HashMap<String, String> fnSchemeIDandDescr() {
        //open();
        Cursor cursor = db.rawQuery("SELECT SchemeID,SchemeName from tblSchemeMstr", null);
        try {
            HashMap<String, String> SchemeIDSchemeName = new HashMap<String, String>();
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        SchemeIDSchemeName.put(cursor.getString(0).toString(), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return SchemeIDSchemeName;
        } finally {
            cursor.close();
            //close();
        }
    }


    public String fngetOrderIDAganistStore(String StoreID, String TmpInvoiceCodePDA) {
        // System.out.println("Abhinav Nitish Ankit New While Fetching Records Store Id:"+StoreID);
        //open();
        // Cursor cursorE2 = db.rawQuery("SELECT Distinct OrderIDPDA FROM tblTmpInvoiceHeader WHERE StoreID ='" + StoreID + "' and (Sstat=1 or Sstat=2)", null);
        Cursor cursorE2 = db.rawQuery("SELECT Distinct TmpInvoiceCodePDA FROM tblTmpInvoiceHeader WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and (Sstat=1 or Sstat=2)", null);
        String chkI = "0";
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {


                    chkI = (String) cursorE2.getString(0).toString();

                }
            }
        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }


    public int fnCheckIfStoreExistInStoreProdcutInvoiceDetails(String StoreID, String TmpInvoiceCodePDA) {
        //open();
        // Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblTmpInvoiceHeader WHERE StoreID ='" + StoreID + "' and (Sstat=1 or Sstat=2)", null);
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblTmpInvoiceHeader WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    if (cursorE2.getInt(0) > 0) {
                        chkI = 1;
                    } else {
                        chkI = 0;
                    }
                }
            }
        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }

    public String[] fnGetOnProductQtyChangeApplyApplicableDiscounts(String StoreID, String ProductIdOnClicked) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT BenSubBucketType,BenifitAssignedValue,BenifitDiscountApplied FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='" + StoreID + "' and ProductID=" + Integer.parseInt(ProductIdOnClicked) + " and BenSubBucketType in(6,7)", null);
        String[] chkI = new String[cursorE2.getCount()];
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        chkI[i] = (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString();
                    }
                }
            }

        } finally {
            cursorE2.close();
            // close();
        }
        return chkI;
    }

    public int fnCheckIfPrdRelatedDataExisitIntblStoreProductAppliedSchemesBenifitsRecords(String StoreID, String ProductIdOnClicked) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='" + StoreID + "' and ProductID=" + Integer.parseInt(ProductIdOnClicked), null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }

    /*public static String[] fnGetDistinctSchIdsAgainstStoreProduct(String StoreID,String ProductIdOnClicked,int schId)
		   {
		    //open();
		    Cursor cursor = db.rawQuery("SELECT BenSubBucketType,FreeProductID,BenifitAssignedValue,BenifitDiscountApplied,IFNULL(BenifitCouponCode,0),schId,schSlbRowId,SchTypeId,ProductID FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' and  schId="+schId+" and BenSubBucketType in(1,5,2,6,3,7,10)", null);
		    String[] chkI = new String[cursor.getCount()];
		    try {
		     if(cursor.getCount()>0)
		     {

		      if (cursor.moveToFirst()) {

		        for (int i = 0; i <= (cursor.getCount() - 1); i++)
		        {
		         if(cursor.getString(0)!=null && cursor.getString(1)!=null && cursor.getString(2)!=null && cursor.getString(3)!=null)
		          {
		          chkI[i] = cursor.getString(0)+"^"+cursor.getString(1)+"^"+cursor.getString(2)+"^"+cursor.getString(3)+"^"+cursor.getString(4)+"^"+ cursor.getString(5)+"^"+ cursor.getString(6)+"^"+ cursor.getString(7)+"^"+ cursor.getString(8);
		         }
		         cursor.moveToNext();
		        }
		      }
		     }

		    } finally {
		     cursor.close();
		     close();
		    }
		    return chkI;*/
    public String fnGetDistinctSchIdsAgainstStoreProduct(String StoreID, String ProductIdOnClicked, int schId) {
        //open();
        Cursor cursor = db.rawQuery("SELECT schSlbRowId,SchTypeId FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='" + StoreID + "' and  schId=" + schId + " and BenSubBucketType in(1,5,2,6,3,7,10) and ProductID=" + Integer.parseInt(ProductIdOnClicked), null);
        String chkI = "";
        try {
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (cursor.getString(0) != null && cursor.getString(1) != null) {
                            chkI = cursor.getString(0) + "^" + cursor.getString(1);
                        }
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            cursor.close();
            //close();
        }
        return chkI;
    }

    public String fnGetDistinctSchIdsAgainstStoreForDelete(String StoreID,String ProductIdOnClicked,int schId,int flgInCarton)
    {

        Cursor cursor = db.rawQuery("SELECT schSlbRowId,SchTypeId FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' and  schId="+schId+" and BenSubBucketType in(1,5,2,6,3,7,10) and flgInCarton="+flgInCarton, null);
        String chkI = "";
        try {
            if(cursor.getCount()>0)
            {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {
                        if(cursor.getString(0)!=null && cursor.getString(1)!=null)
                        {
                            chkI = cursor.getString(0)+"^"+cursor.getString(1);
                        }
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            if(cursor!=null)
            {
                cursor.close();
            }


        }
        return chkI;
    }
    public void fnDeleteRecordsAllRecordsForClickedProdoductId(String StoreID, int ProductIdOnClicked, String pdaOrderID, String TmpInvoiceCodePDA,int flgInCarton) {
        //open();
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='" + StoreID + "'  and schId=" +ProductIdOnClicked + " AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton);
        //close();
    }

    public void fnDeleteProductDetailsFromReturnTables(String StoreID, String ProductIdOnClicked, String pdaOrderID, String TmpInvoiceCodePDA) {

        //open();
        try {
            db.execSQL("DELETE FROM tblStoreProductPhotoDetail WHERE StoreID ='" + StoreID + "'  and ProductID=" + Integer.parseInt(ProductIdOnClicked) + " and TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
            db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "'  and ProdID='" + ProductIdOnClicked + "' and TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
            db.execSQL("DELETE FROM tblStoreReturnDetail WHERE StoreID ='" + StoreID + "' and  ReturnProductID=" + Integer.parseInt(ProductIdOnClicked) + " and TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
        } catch (Exception e) {

        } finally {
            //  close();
        }

    }

    public long fnsaveStoreProdcutPurchaseDetails(String IMEIno, String StoreID, String CatID, String ProdID, String TransDate,
                                                  int Stock, int OrderQty,
                                                  Double OrderVal, int FreeQty, Double DisVal,
                                                  int selProdIDForSampleQty, String ProductShortName, Double ProductRate, int Outstat, Double TaxRate, Double TaxValue, int StoreCatNodeId, String OrderIDPDA, int flgIsQuoteRateApplied, String distibutorID, int flgWholeSellApplicable, String TmpInvoiceCodePDA, String strFinalAllotedInvoiceIds) {//String DisplayUnit

        String activeRid;
        activeRid = GetActiveRouteID();


        ContentValues initialValues = new ContentValues();

        initialValues.put("PDACode", IMEIno.trim());
        initialValues.put("TransDate", TransDate.trim());
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProdID", ProdID.trim());
        initialValues.put("Stock", Stock);
        initialValues.put("OrderQty", OrderQty);
        initialValues.put("OrderVal", OrderVal);
        initialValues.put("FreeQty", FreeQty);
        initialValues.put("DisVal", DisVal);

        initialValues.put("Sstat", Outstat);

        initialValues.put("SampleQuantity", selProdIDForSampleQty);

        initialValues.put("ProductShortName", ProductShortName);

        initialValues.put("ProductPrice", ProductRate);
        initialValues.put("RouteID", Integer.parseInt(activeRid));
        initialValues.put("CatID", CatID.trim());
        initialValues.put("TaxRate", TaxRate);
        initialValues.put("TaxValue", TaxValue);
        initialValues.put("StoreCatNodeId", StoreCatNodeId);
        initialValues.put("OrderIDPDA", OrderIDPDA);
        initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
        initialValues.put("distibutorID", distibutorID);
        initialValues.put("flgWholeSellApplicable", flgWholeSellApplicable);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("FinalAllotedInvoiceIds", strFinalAllotedInvoiceIds);
//TmpInvoiceCodePDA
        //initialValues.put(Key_DisplayUnit, DisplayUnit);

        ////// System.out.println("inserting saveStoreTransac records..");
    /*// System.out.println("Abhinav Nitish Ankit New Printing Insert Store Id :"+StoreID);
    // System.out.println("Abhinav Nitish Ankit New Printing Insert ProdID Id :"+ProdID);
    // System.out.println("Abhinav Nitish Ankit New Printing Insert OrderQty :"+OrderQty);*/
        return db.insert(DBHelper.DATABASE_TABLE_MAIN210, null, initialValues);
    }

		/*public long fnsaveStoreProdcutPurchaseDetails(String IMEIno,String StoreID,String CatID,String ProdID, String TransDate,
			      int Stock, int OrderQty,
			    Double OrderVal, int FreeQty, Double DisVal,
			    int selProdIDForSampleQty, String ProductShortName, Double ProductRate,int Outstat,Double TaxRate,Double TaxValue, int StoreCatNodeId,String OrderIDPDA,int flgIsQuoteRateApplied,String distibutorID) {//String DisplayUnit

			   String activeRid;
			   activeRid = GetActiveRouteID();


			   ContentValues initialValues = new ContentValues();

			   initialValues.put("IMEIno", IMEIno.trim());
			   initialValues.put("TransDate", TransDate.trim());
			   initialValues.put("StoreID", StoreID.trim());
			   initialValues.put("ProdID", ProdID.trim());
			   initialValues.put("Stock", Stock);
			   initialValues.put("OrderQty", OrderQty);
			   initialValues.put("OrderVal", OrderVal);
			   initialValues.put("FreeQty", FreeQty);
			   initialValues.put("DisVal", DisVal);

			   initialValues.put("Sstat", Outstat);

			   initialValues.put("SampleQuantity", selProdIDForSampleQty);

			   initialValues.put("ProductShortName", ProductShortName);

			   initialValues.put("ProductPrice", ProductRate);
			   initialValues.put("RouteID", Integer.parseInt(activeRid));
			   initialValues.put("CatID", CatID.trim());
			   initialValues.put("TaxRate", TaxRate);
			   initialValues.put("TaxValue", TaxValue);
			   initialValues.put("StoreCatNodeId", StoreCatNodeId);
			   initialValues.put("OrderIDPDA", OrderIDPDA);
			   initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
			 initialValues.put("distibutorID", distibutorID);

			   //initialValues.put(Key_DisplayUnit, DisplayUnit);

			   ////// System.out.println("inserting saveStoreTransac records..");
				// System.out.println("Abhinav Nitish Ankit New Printing Insert Store Id :"+StoreID);
				// System.out.println("Abhinav Nitish Ankit New Printing Insert ProdID Id :"+ProdID);
				// System.out.println("Abhinav Nitish Ankit New Printing Insert OrderQty :"+OrderQty);*//*
			   return db.insert(DATABASE_TABLE_MAIN210, null, initialValues);
			  }*/

    public void deleteStoreRecordFromtblStorePurchaseDetailsFromProductTrsaction(String storeID, String pdaOrderID, String TmpInvoiceCodePDA,int flgInCarton) {
        //open();
        db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE StoreID='" + storeID + "'  and TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"");
        db.execSQL("DELETE FROM tblTmpInvoiceDetailsLocalOrder WHERE StoreID='" + storeID + "'  and TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"");

        // close();
    }
    public void deleteStoreRecordFromtblStorePurchaseDetailsFromProductTrsactionBasedOnCarton(String storeID, String pdaOrderID, String TmpInvoiceCodePDA,int flgInCarton,String CartonID) {
        //open();
        db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE StoreID='" + storeID + "'  and TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+" and CartonID='"+CartonID+"'");
        // close();
    }

    public void deleteStoreRecordFromtblStorePurchaseDetailsFromProductTrsactionBeforPermanentTransfer(String storeID, String pdaOrderID, String TmpInvoiceCodePDA) {
        //open();
        //db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE StoreID='" + storeID + "'  and TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
        // close();
    }
    public void deleteStoreRecordFromtblStorePurchaseDetailsFromProductTrsactionSingleProduct(String storeID, String pdaOrderID, String getPIdToremove, String TmpInvoiceCodePDA) {
        //open();
        db.execSQL("DELETE FROM tblTmpInvoiceDetails WHERE StoreID='" + storeID + "'  and ProdID='" + getPIdToremove + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
        // close();
    }

    public long fnsavetblStoreProductAppliedSchemesBenifitsRecords(String StoreID, int ProdID, int schId, int schSlabId, int schSlbBuckId, double schSlabSubBucketValue, int schSubBucketValType,
                                                                   int schSlabSubBucketType, int BenifitRowID, int BenSubBucketType,
                                                                   int FreeProductID, double BenifitSubBucketValue, double BenifitMaxValue, double BenifitAssignedValue, double BenifitAssignedValueType, int BenifitDiscountApplied, String BenifitCouponCode, double per, double UOM, int WhatFinallyApplied, int schSlbRowId, int SchTypeId, String pdaOrderID, String TmpInvoiceCodePDA,int flgInCarton) {
        //StoreID text not null,ProductID int not null,schId int not null,schSlabId integer not null,schSlbBuckId integer not null,schSlabSubBucketValue real not null,
        //schSubBucketValType integer not null,schSlabSubBucketType int not null,BenifitRowID integer not null,BenSubBucketType int null,FreeProductID int null,
        //BenifitSubBucketValue real null,BenifitMaxValue real null,BenifitAssignedValue real null,BenifitAssignedValueType int null,BenifitDiscountApplied int null,
        //BenifitCouponCode text null
        String activeRid;
        // activeRid = GetActiveRouteID();


        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("ProductID", ProdID);
        initialValues.put("schId", schId);
        initialValues.put("schSlabId", schSlabId);
        initialValues.put("schSlbBuckId", schSlbBuckId);
        initialValues.put("schSlabSubBucketValue", schSlabSubBucketValue);
        initialValues.put("schSubBucketValType", schSubBucketValType);
        initialValues.put("schSlabSubBucketType", schSlabSubBucketType);
        initialValues.put("BenifitRowID", BenifitRowID);

        initialValues.put("BenSubBucketType", BenSubBucketType);

        initialValues.put("FreeProductID", FreeProductID);

        initialValues.put("BenifitSubBucketValue", BenifitSubBucketValue);

        initialValues.put("BenifitMaxValue", BenifitMaxValue);
        initialValues.put("BenifitAssignedValue", BenifitAssignedValue);
        initialValues.put("BenifitAssignedValueType", BenifitAssignedValueType);

        initialValues.put("BenifitDiscountApplied", BenifitDiscountApplied);
        initialValues.put("BenifitCouponCode", BenifitCouponCode);

        initialValues.put("PER", per);
        initialValues.put("UOM", UOM);
        initialValues.put("Sstat", 0);
        initialValues.put("schSlbRowId", schSlbRowId);
        initialValues.put("SchTypeId", SchTypeId);
        initialValues.put("WhatFinallyApplied", WhatFinallyApplied);
        initialValues.put("OrderIDPDA", pdaOrderID);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);

        initialValues.put("flgInCarton", flgInCarton);

        // System.out.println("Save Data Save in Table 211");
        //open();
        long xyx = db.insert(DBHelper.DATABASE_TABLE_Main211, null, initialValues);
        //close();
        return xyx;
    }

    public String fnctnGetMaxAssignedBen8DscntApld1(String storeId, String pdaOrderID, String TmpInvoiceCodePDA) {
        String discountValOnBen8apld1 = "";
        //open();
        try {
            Cursor cursor = db.rawQuery("Select Max(BenifitAssignedValue),BenifitRowID  from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + storeId + "' and  BenSubBucketType='" + 8 + "' and BenifitDiscountApplied ='" + 1 + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' Limit 1", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (cursor.getString(0) == null) {
                        discountValOnBen8apld1 = "";
                    } else {
                        discountValOnBen8apld1 = cursor.getString(0) + "^" + cursor.getString(1);
                    }

                }
            }

            //close();
        } catch (Exception e) {
            //close();
        }
        return discountValOnBen8apld1;
    }

    public String fnctnGetMaxAssignedBen8DscntApld2(String storeId, String pdaOrderID, String TmpInvoiceCodePDA) {
        String discountValOnBen8apld1 = "";
        try {
            //open();

            Cursor cursor = db.rawQuery("Select Max(BenifitAssignedValue),BenifitRowID  from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + storeId + "'  and BenSubBucketType='" + 8 + "' and BenifitDiscountApplied='" + 2 + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' Limit 1", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    //discountValOnBen8apld1=cursor.getString(0)+"^"+cursor.getString(1);
                    if (cursor.getString(0) == null) {
                        discountValOnBen8apld1 = "";
                    } else {
                        discountValOnBen8apld1 = cursor.getString(0) + "^" + cursor.getString(1);
                    }

                }
            }

            // close();
        } catch (Exception e) {
            // close();
        }
        return discountValOnBen8apld1;
    }

    public String fnctnGetMaxAssignedBen9DscntApld1(String storeId, String pdaOrderID, String TmpInvoiceCodePDA) {
        String discountValOnBen8apld1 = "";
        //open();
        try {
            Cursor cursor = db.rawQuery("Select Max(BenifitAssignedValue),BenifitRowID  from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + storeId + "'  and BenSubBucketType='" + 9 + "' and BenifitDiscountApplied ='" + 1 + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' Limit 1", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    //discountValOnBen8apld1=cursor.getString(0)+"^"+cursor.getString(1);
                    if (cursor.getString(0) == null) {
                        discountValOnBen8apld1 = "";
                    } else {
                        discountValOnBen8apld1 = cursor.getString(0) + "^" + cursor.getString(1);
                    }
                }
            }

            // close();
        } catch (Exception e) {
            // close();
        }
        return discountValOnBen8apld1;
    }

    public String fnctnGetMaxAssignedBen9DscntApld2(String storeId, String pdaOrderID, String TmpInvoiceCodePDA) {
        String discountValOnBen8apld1 = "";
        try {
            //open();

            Cursor cursor = db.rawQuery("Select Max(BenifitAssignedValue),BenifitRowID  from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + storeId + "'  and BenSubBucketType='" + 9 + "' and BenifitDiscountApplied ='" + 2 + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' Limit 1", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    // discountValOnBen8apld1=cursor.getString(0)+"^"+cursor.getString(1);
                    if (cursor.getString(0) == null) {
                        discountValOnBen8apld1 = "";
                    } else {
                        discountValOnBen8apld1 = cursor.getString(0) + "^" + cursor.getString(1);
                    }
                }
            }


            //close();
        } catch (Exception e) {
            //close();
        }
        return discountValOnBen8apld1;
    }

    public String fnctnGetHighestDiscount(String freeProductId, String storeId, String benSubBucketType) {
        String highestDiscount = "";
        try {
            //open();

            Cursor cursor = db.rawQuery("Select Distinct FreeProductID,Max(BenifitAssignedValue),BenSubBucketType from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + storeId + "' and FreeProductID='" + freeProductId + "' and BenSubBucketType ='" + benSubBucketType + "' Limit 1", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    highestDiscount = cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2);
                }
            }

            //close();
        } catch (Exception e) {
            // close();
        }
        return highestDiscount;
    }

    public HashMap<String, String> fnctnSchemeStoreID(String storeID) {
        //open();
        //hmapSchemeStoreID= key = SchemeId  value=StoreId
        HashMap<String, String> hmapSchemeStoreID = new HashMap<String, String>();
        //tblSchemeStoreMapping=StoreID text null,SchemeID text null
        Cursor cursor = db.rawQuery("Select StoreID,SchemeID from tblSchemeStoreMapping where  StoreID ='" + storeID + "'", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapSchemeStoreID.put(cursor.getString(1), cursor.getString(0));

                    cursor.moveToNext();
                }
            }
        }
        // close();
        return hmapSchemeStoreID;
    }

    public LinkedHashMap<Integer, ArrayList<Integer>> fngetSlabIDArrRowID(String storeID) {
        LinkedHashMap<Integer, ArrayList<Integer>> hmapSlabIDArrRowID = new LinkedHashMap<Integer, ArrayList<Integer>>();
        Cursor cursor = db.rawQuery("SELECT tblSchemeSlabDetail.SchemeSlabID,tblSchemeSlabBucketDetails.RowID from tblSchemeSlabDetail inner join tblSchemeSlabBucketDetails on tblSchemeSlabDetail.SchemeSlabID=tblSchemeSlabBucketDetails.SchemeSlabID inner join tblSchemeStoreMapping on tblSchemeStoreMapping.SchemeID=tblSchemeSlabBucketDetails.SchemeID Where tblSchemeStoreMapping.StoreID='" + storeID + "'", null);
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                ArrayList<Integer> listRowIDs = new ArrayList<Integer>();
                Integer slabId = 0, prvsslabId = 0;
                for (int i = 0; i < cursor.getCount(); i++) {
                    slabId = cursor.getInt(0);
                    if (i == 0) {
                        prvsslabId = slabId;
                        listRowIDs.add(cursor.getInt(1));
                    } else {
                        if (prvsslabId.equals(slabId)) {
                            listRowIDs.add(cursor.getInt(1));
                        } else {
                            hmapSlabIDArrRowID.put(prvsslabId, listRowIDs);
                            listRowIDs = new ArrayList<Integer>();
                            prvsslabId = slabId;
                            listRowIDs.add(cursor.getInt(1));
                        }
                    }
                    if (i == (cursor.getCount() - 1)) {
                        hmapSlabIDArrRowID.put(prvsslabId, listRowIDs);
                    }
                    cursor.moveToNext();
                }
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        return hmapSlabIDArrRowID;
    }

    public LinkedHashMap<Integer, ArrayList<Integer>> fngetRowIDProductIds(String storeID) {
        LinkedHashMap<Integer, ArrayList<Integer>> hmapRowIdProductIDs = new LinkedHashMap<Integer, ArrayList<Integer>>();
        Cursor cursor = db.rawQuery("SELECT tblSchemeSlabBucketProductMapping.RowID,tblSchemeSlabBucketProductMapping.ProductID from tblSchemeSlabBucketProductMapping inner join tblSchemeSlabBucketDetails ON tblSchemeSlabBucketProductMapping.RowID=tblSchemeSlabBucketDetails.RowID inner join tblSchemeMstr on tblSchemeSlabBucketDetails.SchemeID=tblSchemeMstr.SchemeID inner join tblSchemeStoreMapping on tblSchemeMstr.SchemeID=tblSchemeStoreMapping.SchemeID Where tblSchemeStoreMapping.StoreID='" + storeID + "'", null);
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                ArrayList<Integer> listProductIDs = new ArrayList<Integer>();
                Integer rowId = 0, prvsrowId = 0;
                for (int i = 0; i < cursor.getCount(); i++) {
                    rowId = cursor.getInt(0);
                    if (i == 0) {
                        prvsrowId = rowId;
                        listProductIDs.add(cursor.getInt(1));
                    } else {
                        if (prvsrowId.equals(rowId)) {
                            listProductIDs.add(cursor.getInt(1));
                        } else {
                            hmapRowIdProductIDs.put(prvsrowId, listProductIDs);
                            listProductIDs = new ArrayList<Integer>();
                            prvsrowId = rowId;
                            listProductIDs.add(cursor.getInt(1));
                        }
                    }
                    if (i == (cursor.getCount() - 1)) {
                        hmapRowIdProductIDs.put(prvsrowId, listProductIDs);
                    }
                    cursor.moveToNext();
                }
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        return hmapRowIdProductIDs;
    }

    public LinkedHashMap<Integer, String> fngetSchemeSlabIDBucketTypeBucketValueForSchemeType1And3(String storeID) {
        LinkedHashMap<Integer, String> hmapSchemeSlabIDBucketTypeBucketValue = new LinkedHashMap<Integer, String>();
        Cursor cursor = db.rawQuery("SELECT tblSchemeSlabBucketDetails.SchemeSlabID,tblSchemeSlabBucketDetails.SlabSubBucketType,tblSchemeSlabBucketDetails.SlabSubBucketValue,tblSchemeSlabBucketDetails.SubBucketValType from tblSchemeSlabBucketDetails inner join tblSchemeMstr on tblSchemeSlabBucketDetails.SchemeID=tblSchemeMstr.SchemeID inner join tblSchemeStoreMapping on tblSchemeMstr.SchemeID=tblSchemeStoreMapping.SchemeID Where tblSchemeStoreMapping.StoreID='" + storeID + "'", null);
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int i = 0; i < cursor.getCount(); i++) {
                    hmapSchemeSlabIDBucketTypeBucketValue.put(cursor.getInt(0), cursor.getString(1) + "^" + cursor.getString(2) + "^" + cursor.getString(3));
                    cursor.moveToNext();

                }
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        return hmapSchemeSlabIDBucketTypeBucketValue;
    }

    public static ArrayList<HashMap<String, String>> fnctnSchemeSlabIdSchmVal(String storeID) {
        //open();
        // tblSchemeSlabDetail (SchemeID text null,SchemeSlabID text null,SchemeSlabDesc text null,BenifitDescr text null);";

        ArrayList<HashMap<String, String>> arrayListSchemeSlabDteail = new ArrayList<HashMap<String, String>>();

        //hmapSchmeSlabIdSchemeId= key =SchemeSlabId         value=SchemeID
        HashMap<String, String> hmapSchmeSlabIdSchemeId = new HashMap<String, String>();
        //hmapSchmeSlabIdSchemeId= key =SchemeSlabId         value=SchemeSlabDes
        HashMap<String, String> hmapSchmeSlabIdSlabDes = new HashMap<String, String>();
        //hmapSchmeSlabIdSchemeId= key = SchemeSlabId        value=BenifitDescription
        HashMap<String, String> hmapSchmeSlabIdBenifitDes = new HashMap<String, String>();
        Cursor cursor = db.rawQuery("Select tblSchemeSlabDetail.SchemeID,tblSchemeSlabDetail.SchemeSlabID,tblSchemeSlabDetail.SchemeSlabDesc,tblSchemeSlabDetail.BenifitDescr from tblSchemeSlabDetail inner join tblSchemeStoreMapping ON tblSchemeSlabDetail.SchemeID=tblSchemeStoreMapping.SchemeID Where tblSchemeStoreMapping.StoreID='" + storeID + "'", null);
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int i = 0; i < cursor.getCount(); i++) {
                    hmapSchmeSlabIdSchemeId.put(cursor.getString(1), cursor.getString(0));
                    hmapSchmeSlabIdSlabDes.put(cursor.getString(1), cursor.getString(2));
                    hmapSchmeSlabIdBenifitDes.put(cursor.getString(1), cursor.getString(3));

                    cursor.moveToNext();
                }

                arrayListSchemeSlabDteail.add(hmapSchmeSlabIdSchemeId);
                arrayListSchemeSlabDteail.add(hmapSchmeSlabIdSlabDes);
                arrayListSchemeSlabDteail.add(hmapSchmeSlabIdBenifitDes);

            }
        }
        // close();
        if (cursor != null) {
            cursor.close();
        }
        return arrayListSchemeSlabDteail;
    }

    public String fnctnGetHighestDiscountPercentge(String freeProductId, String storeId, String TmpInvoiceCodePDA) {
        //open();
        String highestDiscount = "";
        Cursor cursor = db.rawQuery("Select  Max(BenifitAssignedValue),BenifitRowID from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + storeId + "' and FreeProductID='" + freeProductId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and BenSubBucketType in (2,6) Limit 1", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    //highestDiscount=cursor.getString(0)+"^"+cursor.getString(1);
                    if (cursor.getString(0) == null) {
                        highestDiscount = "";
                    } else {
                        highestDiscount = cursor.getString(0) + "^" + cursor.getString(1);
                    }
                }
            }
            // close();
        } catch (Exception ex) {
            //close();
            Log.e(TAG, ex.toString());
        }


        return highestDiscount;
    }

    public String[] fnGetAllSchSlabbasedOnSchemeID(String SchemeID) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT DISTINCT SchemeSlabID FROM tblSchemeSlabDetail WHERE SchemeID ='"
                + SchemeID + "'", null);
        String AllSchemeSlabID[] = new String[cursorE2.getCount()];

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllSchemeSlabID[i] = (String) cursorE2.getString(0).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public String fnctnGetHighestDiscountAmount(String freeProductId, String storeId, String TmpInvoiceCodePDA) {
        //open();
        String highestDiscount = "";
        Cursor cursor = db.rawQuery("Select  Max(BenifitAssignedValue),BenifitRowID from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + storeId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and ProductID='" + freeProductId + "' and BenSubBucketType in (3,7,10) Limit 1", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    //highestDiscount=cursor.getString(0)+"^"+cursor.getString(1);
                    if (cursor.getString(0).equals(null)) {
                        highestDiscount = "";
                    } else {
                        highestDiscount = cursor.getString(0) + "^" + cursor.getString(1);
                    }
                }
            }
            // close();
        } catch (Exception ex) {
            //close();
            Log.e(TAG, ex.toString());
        }


        return highestDiscount;
    }

    public void updatewhatAppliedFlag(int flag, String storeId, int benifitrRowId, String pdaOrderID, String TmpInvoiceCodePDA,int flgInCarton) {

        try {
            //open();


            final ContentValues values = new ContentValues();
            values.put("WhatFinallyApplied", flag);
            int affected = db.update(DBHelper.DATABASE_TABLE_Main211, values, "StoreID=? AND BenifitRowID=? AND  TmpInvoiceCodePDA=? and flgInCarton=?", new String[]{storeId, "" + benifitrRowId, TmpInvoiceCodePDA,""+flgInCarton});

            //close();


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public String fnctnGetfreePerUnitVol(String freeProductId, String storeId, String TmpInvoiceCodePDA) {
        //open();
        String perUnit = "";
        Cursor cursor = db.rawQuery("Select  Per,UOM from tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + storeId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and ProductID='" + freeProductId + "' and BenSubBucketType = '" + 10 + "' ", null);
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                //highestDiscount=cursor.getString(0)+"^"+cursor.getString(1);
                if (cursor.getString(0) == null) {
                    perUnit = "";
                } else {
                    perUnit = cursor.getString(0) + "^" + cursor.getString(1);
                }
            }
        }

        //close();
        return perUnit;
    }

    public String[] fnGetProductsAgainstBenifitTable(String StoreID, String ProdId) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT FreeProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + StoreID + "' and ProductID='" + ProdId + "'", null);
        String AllSchemeSlabID[] = new String[cursorE2.getCount()];

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllSchemeSlabID[i] = (String) cursorE2.getString(0).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
            // close();
        }

    }

    public int fnGetSlabIdBasedOnPrdIDSchmId(String StoreID, String ProdId, int SchID) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT schSlabId FROM  tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + StoreID + "' and ProductID='" + ProdId + "' and schId=" + SchID, null);
        int AllSchemeSlabID = 0;

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {


                    AllSchemeSlabID = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public int fnGetStoreCatNodeId(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT StoreType FROM  tblStoreList where StoreID='" + StoreID + "'", null);
        int StoreCatNodeId = 0;
        ////open();
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {


                    StoreCatNodeId = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return StoreCatNodeId;
        } finally {
            cursorE2.close();
            //  close();

        }

    }

    public int fnGetRowIDBasedOnSchIDAndSlabID(int SchID, int slabSchmId) {
        //tblSchemeSlabBenefitsBucketDetails
        // [11:23:51 PM] Abhinav Raj: RowID
        //[11:23:58 PM] Abhinav Raj: SchemeID text null,SchemeSlabID
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT BenifitRowID FROM  tblSchemeSlabBenefitsBucketDetails where  SchemeID='" + SchID + "' and SchemeSlabID=" + slabSchmId, null);
        int AllSchemeSlabID = 0;

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {


                    AllSchemeSlabID = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return AllSchemeSlabID;
        } finally {
            cursorE2.close();
            // close();
        }

    }

    public String[] fnGetProductsSchIdSlabRow(String StoreID, int RowID, String pdaOrderID, String TmpInvoiceCodePDA) {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schId
        // Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId=" + RowID + " AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'  and StoreID='" + StoreID + "'", null);
        String AllProductInSlab[] = new String[cursorE2.getCount()];

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllProductInSlab[i] = (String) cursorE2.getString(0).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public String[] fnGetProductsSchIds(String StoreID, int schID, String pdaOrderID, String TmpInvoiceCodePDA) {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schIdsd
        //  ssd
        // Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT ProductID,schSlbRowId,BenifitAssignedValue,FreeProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schId=" + schID + " AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'  and StoreID='" + StoreID + "' ", null);
        String AllProductInSlab[] = new String[cursorE2.getCount()];

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllProductInSlab[i] = (String) cursorE2.getString(0).toString() + "^" + (String) cursorE2.getString(1).toString() + "^" + (String) cursorE2.getString(2).toString() + "^" + (String) cursorE2.getString(3).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public void fnDeleteOldSchemeRowIdRecords(String StoreID, int RowID, String pdaOrderID, String TmpInvoiceCodePDA) {
        //open();
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords where  StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and schSlbRowId=" + RowID);
        // close();
    }

    public void fnDeleteOldStoreProductAppliedSchemesBenifitsRecordsWhileSubmit(String StoreID, String pdaOrderID) {
        //open();
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords where OrderIDPDA='" + pdaOrderID + "'  and StoreID='" + StoreID + "'");
        // close();
    }

    public String[] fnGetRowsIDsAgainstProdIs(String StoreID, int schId) {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schId
        // Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT BenifitRowID,BenSubBucketType,schSlbRowId,BenifitAssignedValue,FreeProductID,SchTypeId,ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where  StoreID='" + StoreID + "' and schId=" + schId, null);
        String AllProductInSlab[] = new String[cursorE2.getCount()];

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllProductInSlab[i] = (String) cursorE2.getString(0).toString() + "^" + (String) cursorE2.getString(1).toString() + "^" + (String) cursorE2.getString(2).toString() + "^" + (String) cursorE2.getString(3).toString() + "^" + (String) cursorE2.getString(4).toString() + "^" + (String) cursorE2.getString(5).toString() + "^" + (String) cursorE2.getString(6).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public String dbfunctiongetProdMapedWithBenifitRowID(int benifitRowID, int ClickedProID) {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schId
        //tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        // Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT tblStoreProductAppliedSchemesBenifitsRecords.ProductID,tblStoreProductAppliedSchemesBenifitsRecords.FreeProductID FROM  tblSchemeSlabBenefitsProductMappingDetail inner join tblStoreProductAppliedSchemesBenifitsRecords on tblSchemeSlabBenefitsProductMappingDetail.RowID=tblStoreProductAppliedSchemesBenifitsRecords.BenifitRowID  where  tblSchemeSlabBenefitsProductMappingDetail.RowID='" + benifitRowID + "'", null);
        String AllProductInSlab = "";
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllProductInSlab = (String) cursorE2.getString(0).toString() + "^" + (String) cursorE2.getString(1).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            //close();
        }

    }

    public String dbfunctiongetProdMapedWithBenifitRowID2(int benifitRowID, int ClickedProID) {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schId
        //tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        // Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT ProductID,FreeProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where BenifitRowID='" + benifitRowID + "'", null);
        String AllProductInSlab = "";
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllProductInSlab = (String) cursorE2.getString(0).toString() + "^" + (String) cursorE2.getString(1).toString();
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            // close();
        }

    }

    public String[] fnGetDistinctProductIdAgainstStoreProduct(String StoreID, String schmIdForProductsavdInRecord, String pdaOrderID, String TmpInvoiceCodePDA) {
        //open();
        Cursor cursor = db.rawQuery("SELECT BenSubBucketType,ProductID,BenifitAssignedValue,BenifitDiscountApplied,IFNULL(BenifitCouponCode,0),schId,schSlbRowId,SchTypeId FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'  and  schId=" + schmIdForProductsavdInRecord + " and BenSubBucketType in(10)", null);
        String[] chkI = new String[cursor.getCount()];
        try {
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (cursor.getString(0) != null && cursor.getString(1) != null && cursor.getString(2) != null && cursor.getString(3) != null) {
                            chkI[i] = cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2) + "^" + cursor.getString(3) + "^" + cursor.getString(4) + "^" + cursor.getString(5) + "^" + cursor.getString(6) + "^" + cursor.getString(7);
                        }
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            cursor.close();
            //close();
        }
        return chkI;
    }

    public String[] fnctnGetBensubBucket10Column(String schmId, String storeId, String pdaOrderID, String TmpInvoiceCodePDA,int flgInCarton) {
        //open();
        Cursor cursor = db.rawQuery("Select ProductID,FreeProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where StoreID='" + storeId + "' and schId='" + schmId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and BenSubBucketType in(1,10) and flgInCarton="+flgInCarton, null);
        try {
            String[] productIdBen10 = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int index = 0; index < cursor.getCount(); index++) {
                        productIdBen10[index] = cursor.getString(0) + "^" + cursor.getString(1);
                        //updateBensubBucket10Col(storeId,schmId, ((productIdBen10[index]).split(Pattern.quote("^")))[0],"10");
                        cursor.moveToNext();
                    }
                }


            }

            return productIdBen10;
        } finally {
            cursor.close();
            // close();
        }
    }

    public void updateBensubBucket10Col(String storeId, String schemeId, String productId, String benSubBucketType) {
        final ContentValues values = new ContentValues();
        values.put("BenifitAssignedValue", 0.0);


        int affected = db.update(DBHelper.DATABASE_TABLE_Main211, values, "StoreID=? AND schId=? AND ProductID=? AND BenSubBucketType=?", new String[]{storeId, schemeId, productId, benSubBucketType});
    }

    public void deleteUnRequiredRecordsFromTablesAfterCase() {
        //open();
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE Sstat =" + 4);

        // close();
    }

    public int fectRowIdBasedOnSchIDSlabID(int SchID, int SchemeSlabID) {
        //open();
        Cursor cursor = db.rawQuery("SELECT RowID FROM tblSchemeSlabBucketDetails WHERE SchemeID=" + SchID + " and SchemeSlabID =" + SchemeSlabID + " and SlabSubBucketType=5", null);
        try {
            int CompleteResult = 0;
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult = Integer.parseInt(cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
            //  close();
        }

    }

    public String[] fectProdIDBasedOnRowIDOfProductsPurchased(int sclSlabRowID) {
        //open();
        Cursor cursor = db.rawQuery("SELECT ProductID FROM tblSchemeSlabBucketProductMapping WHERE RowID=" + sclSlabRowID, null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0).toString();
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
            //close();
        }

    }

    public int fnGetStatValueagainstStore(String StoreID) {
        //open();
        Cursor cursor = db.rawQuery("SELECT Sstat FROM tblStoreList WHERE StoreID='" + StoreID + "'", null);
        try {
            int Sstat = 0;
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    Sstat = Integer.parseInt(cursor.getString(0).toString());

                }
            }
            return Sstat;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }

    }

    public void updateReturnData(HashMap<String, String> hmapReturnData, String OrderPDAID, HashMap<String, String> hmapRemark, String TmpInvoiceCodePDA) {
        //open();
        String routeID;
        String storeID;
        String returnProductID;
        String prodReturnQty;
        String prodReturnReason;
        String prodReturnReasonIndex;
        String returnDate;
        // String _outstat;
        int Sstat = 0;


        for (Entry<String, String> entry : hmapReturnData.entrySet()) {

            returnProductID = entry.getKey();
            routeID = (entry.getValue().split(Pattern.quote("~")))[0];
            storeID = (entry.getValue().split(Pattern.quote("~")))[1];
            if ((entry.getValue().split(Pattern.quote("~")))[2].equals("")) {
                prodReturnQty = "0";
            } else {
                prodReturnQty = (entry.getValue().split(Pattern.quote("~")))[2];
            }

            prodReturnReason = hmapRemark.get(returnProductID);
            prodReturnReasonIndex = (entry.getValue().split(Pattern.quote("~")))[4];
            returnDate = (entry.getValue().split(Pattern.quote("~")))[5];
            // _outstat=(entry.getValue().split(Pattern.quote("~")))[6];

            Cursor cursor = db.rawQuery("SELECT RouteID FROM tblStoreReturnDetail where StoreID='" + storeID + "' and ReturnProductID ='" + returnProductID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
            // System.out.println("NitishReturn "+cursor.getCount());
            ContentValues initialValues = new ContentValues();
            // StoreID ,ProductID ,ClickedDateTime ,PhotoName ,PhotoValidation ,PDAPhotoPath ,outstat
            initialValues.put("RouteID", routeID.trim());
            initialValues.put("ReturnProductID", returnProductID.trim());
            initialValues.put("StoreID", storeID.trim());

            initialValues.put("ProdReturnQty", prodReturnQty.trim());

            initialValues.put("ProdReturnReason", prodReturnReason.trim());
            initialValues.put("ProdReturnReasonIndex", prodReturnReasonIndex.trim());
            initialValues.put("ReturnDate", returnDate.trim());
            initialValues.put("Sstat", Sstat);
            initialValues.put("OrderIDPDA", OrderPDAID);
            initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
            if (cursor.getCount() > 0) {

                // System.out.println("Return update is called :"+ routeID+":"+storeID+":"+returnProductID+":"+prodReturnQty+":"+prodReturnReason+":"+ prodReturnReasonIndex+":"+returnDate);
                int affected = db.update(DBHelper.DATABASE_TABLE_Main213, initialValues, "StoreID=? AND ReturnProductID=? AND  TmpInvoiceCodePDA=?", new String[]{storeID, returnProductID, TmpInvoiceCodePDA});


            } else {
                // System.out.println("Return insert is called :"+ routeID+":"+storeID+":"+returnProductID+":"+prodReturnQty+":"+prodReturnReason+":"+ prodReturnReasonIndex+":"+returnDate);
                db.insert(DBHelper.DATABASE_TABLE_Main213, null, initialValues);
            }

        }
        // close();
    }

    public HashMap<String, String> getRtrnOrderQtyReason(String storeID, String OrderPDAID, String TmpInvoiceCodePDA) {
        HashMap<String, String> hmapPrdctIdPrdctRtrnQtyReason = new HashMap<String, String>();
        //ReturnProductID text null, ProdReturnQty text null, ProdReturnReason
        Cursor cursor = db.rawQuery("SELECT ReturnProductID,ProdReturnQty,ProdReturnReasonIndex FROM tblStoreReturnDetail where StoreID='" + storeID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        String rtrnQty = null;
        // System.out.println("Return Cursor storeId"+storeID);
        // System.out.println("Return Cursor"+cursor.getCount());
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {


                        hmapPrdctIdPrdctRtrnQtyReason.put(cursor.getString(0), cursor.getString(1) + "^" + cursor.getString(2));


                        cursor.moveToNext();
                        // cursor.close();
                    }

                }
            } else {
                hmapPrdctIdPrdctRtrnQtyReason.put("No Product", "Thankyou");
            }


            return hmapPrdctIdPrdctRtrnQtyReason;
        } finally {
            cursor.close();


        }
    }

    public HashMap<String, String> getProductStockList(String StoreID, String OrderPDAID, String TmpInvoiceCodePDA) {

        //hmapCtgryPrdctDetail= key=prdctId,val=Stock
        HashMap<String, String> hmapPrdctIdPrdctStock = new HashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT DISTINCT ProductID,ifnull(SUM(Stock),0) From tblActualVisitStock where StoreID='" + StoreID + "'", null);//  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (cursor.getString(0) != null) {
                        for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                            hmapPrdctIdPrdctStock.put(cursor.getString(0).toString(), cursor.getString(1).toString());
                            cursor.moveToNext();
                        }
                    }
                }
            }
            return hmapPrdctIdPrdctStock;

        } finally {
            cursor.close();

        }
    }

    public ArrayList<HashMap<String, String>> fetch_catgry_prdctReturnData(String storeId, String OrderPDAID, String TmpInvoiceCodePDA) {
        // System.out.println("Abhinav Raj is 2");
        //open();
        ArrayList<HashMap<String, String>> totalProductDetail = new ArrayList<HashMap<String, String>>(4);
        //hmapCtgryPrdctDetail= key=prdctId,val=CategoryID
        HashMap<String, String> hmapCtgryPrdctDetail = new HashMap<String, String>();

        //hmapCtgryPrdctDetail= key=prdctId,val=ProductName
        HashMap<String, String> hmapPrdctIdPrdctName = new HashMap<String, String>();
        //hmapCtgryPrdctDetail= key=prdctId,val=Stock
        HashMap<String, String> hmapPrdctIdPrdctStock = new HashMap<String, String>();

        //hmapCtgryPrdctDetail= key=prdctId,val=ProductRtrnQty,Reason
        HashMap<String, String> hmapPrdctIdPrdctRtrnQtyReason = new HashMap<String, String>();

        hmapPrdctIdPrdctRtrnQtyReason = getRtrnOrderQtyReason(storeId, OrderPDAID, TmpInvoiceCodePDA);
        hmapPrdctIdPrdctStock = getProductStockList(storeId, OrderPDAID, TmpInvoiceCodePDA);

        //Cursor cursor = db.rawQuery("SELECT ProductID,CategoryID,ProductShortName FROM tblProductListMaster",null);
        Cursor cursor = db.rawQuery("SELECT tblActualVisitStock.ProductID,tblProductListMaster.CategoryID,tblProductListMaster.ProductShortName,tblActualVisitStock.Stock FROM tblProductListMaster inner join tblActualVisitStock on tblProductListMaster.ProductID=tblActualVisitStock.ProductID Where tblActualVisitStock.Stock>0 and StoreID='" + storeId + "'order by CategoryID,tblActualVisitStock.ProductID", null);//  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapCtgryPrdctDetail.put(cursor.getString(0), cursor.getString(1));

                        hmapPrdctIdPrdctName.put(cursor.getString(0), cursor.getString(2));
                        hmapPrdctIdPrdctStock.put(cursor.getString(0), cursor.getString(3));
                        cursor.moveToNext();
                        // cursor.close();
                    }
                    totalProductDetail.add(0, hmapCtgryPrdctDetail);
                    totalProductDetail.add(1, hmapPrdctIdPrdctName);
                    totalProductDetail.add(2, hmapPrdctIdPrdctRtrnQtyReason);
                    totalProductDetail.add(3, hmapPrdctIdPrdctStock);

                }
            }


            return totalProductDetail;
        } finally {
            cursor.close();

            //close();
        }


    }

    public void UpdateCancelStoreFlag(HashMap<String, String> hmapConfirmCancel, int isCancelConfirm, String reason, String idSelectedRsn) {

        for (Entry<String, String> dataEntry : hmapConfirmCancel.entrySet()) {

            // // System.out.println("Update tblInvoiceButtonTransac Set flgCancel='"+isCancelConfirm+"' and Sstat="+dataEntry.getValue()+" WHERE OrderID='"+dataEntry.getKey()+"'");
            // db.execSQL("Update tblInvoiceButtonTransac Set flgCancel='"+isCancelConfirm+"' and Sstat="+dataEntry.getValue()+" WHERE OrderID='"+dataEntry.getKey()+"'");

            final ContentValues values = new ContentValues();
            if (Integer.parseInt(dataEntry.getValue()) == 10) {
                values.put("Sstat", 9);
            } else {
                values.put("Sstat", dataEntry.getValue());
            }
            values.put("flgCancel", isCancelConfirm);


            ////// System.out.println("Updating Status for Store ID: " + sID);
            //int affected = db.update("tblInvoiceButtonStoreMstr", values, "StoreID=? AND RouteId=? AND DistId=? AND InvoiceForDate=?",new String[] { sID,RouteId,DistId,Invdate });

            int affected = db.update("tblPendingInvoices", values, "OrderID=?", new String[]{dataEntry.getKey()});
            values.put("CancelRemarks", reason);
            values.put("CancelReasonId", idSelectedRsn);
            int affected2 = db.update("tblInvoiceButtonTransac", values, "OrderID=?", new String[]{dataEntry.getKey()});

            //int affected2 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });
            //int affected1 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });

        }


    }

    public void UpdateProductCancelStoreFlag(String orderId, int isCancelConfirm) {
        //open();

        {

            // // System.out.println("Update tblInvoiceButtonTransac Set flgCancel='"+isCancelConfirm+"' and Sstat="+dataEntry.getValue()+" WHERE OrderID='"+dataEntry.getKey()+"'");
            // db.execSQL("Update tblInvoiceButtonTransac Set flgCancel='"+isCancelConfirm+"' and Sstat="+dataEntry.getValue()+" WHERE OrderID='"+dataEntry.getKey()+"'");

            final ContentValues values = new ContentValues();
            values.put("Sstat", "9");
            values.put("flgCancel", isCancelConfirm);
            ////// System.out.println("Updating Status for Store ID: " + sID);
            //int affected = db.update("tblPendingInvoices", values, "StoreID=? AND RouteId=? AND DistId=? AND InvoiceForDate=?",new String[] { sID,RouteId,DistId,Invdate });

            int affected = db.update("tblPendingInvoices", values, "OrderID=?", new String[]{orderId});
            int affected2 = db.update("tblInvoiceButtonTransac", values, "OrderID=?", new String[]{orderId});


            //int affected2 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });
            //int affected1 = db.update("tblInvoiceButtonTransac", values, "StoreID=? AND OrderID=?",new String[] { sID,OrderID });


            //  9,1

            //close();

        }


    }

    public int fnCountToDisplayDailySummaryDetailsSKUWise(int DraftorNonSubmitted, int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        int CountToDisplayDailySummaryDetailsSKUWise = 0;
        //ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>(4);

        //Getting Category Details Starts Here
        Cursor cursor = null;
        //open();
        if (flgReportFromTmpOrPermanent == 0) {
            cursor = db.rawQuery("Select Count(tblCategoryMaster.CategoryID) from tblCategoryMaster inner join tblTmpInvoiceDetails on tblCategoryMaster.CategoryID=tblTmpInvoiceDetails.CatID Where (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        if (flgReportFromTmpOrPermanent == 1) {
            cursor = db.rawQuery("Select Count(tblCategoryMaster.CategoryID) from tblCategoryMaster inner join tblInvoiceDetails on tblCategoryMaster.CategoryID=tblInvoiceDetails.CatID Where (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    CountToDisplayDailySummaryDetailsSKUWise = Integer.parseInt(cursor.getString(0).toString());
                }
            }
            return CountToDisplayDailySummaryDetailsSKUWise;
        } finally {
            cursor.close();
            // close();
        }

    }


    // change by Abhnav Sir

    @SuppressWarnings("unchecked")
    public LinkedHashMap<String, String> fnGetDailySummaryDetailsSKUWiseCategoryLevel(int DraftorNonSubmitted, int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        ArrayList<Object> totalCategoryWiseResult = new ArrayList<Object>(11);

        //Getting Category Details Starts Here
        Cursor cursor = null;
        LinkedHashMap<String, String> hmapSKUWiseDailySummaryReport = new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapGrandTotalCategorySKUWiseDailySummaryReport = new LinkedHashMap<String, String>();
        HashMap<Integer, List<TblUOMMapping>> hmapProductTblUOMMapping = new HashMap<Integer, List<TblUOMMapping>>();
        hmapProductTblUOMMapping=fetch_ProductWiseGetAllMeasureUnitAgainstProductForLastVisitPage("0");

        HashMap<Integer, String> hmapProductOrdQty = new HashMap<Integer, String>();


        String CompleteResult[] = null;

        String strGrandTotalDiscValue = "";
        String strGrandTotalAmountBeforeTax = "";
        String strGrandTotalTaxValue = "";
        String strGrandTotalOrderValue = "";
        //tblTmpInvoiceDetails (IMEIno text not null,RouteID int null,StoreID text not null,CatID text  null,ProdID text not null,TransDate string not null,Stock integer not null,OrderQty integer not null,OrderVal real not null,FreeQty integer not null,DisVal real not null,Sstat integer not null,SampleQuantity int null,ProductShortName text null,ProductPrice real null, TaxRate real null,TaxValue real null,StoreCatNodeId int null,OrderIDPDA text null,flgIsQuoteRateApplied int null);";
        //open();
        //  Cursor cursor = db.rawQuery("Select tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,1 AS FlgRowType  from tblCategoryMaster inner join tblTmpInvoiceDetails on tblCategoryMaster.CategoryID=tblTmpInvoiceDetails.CatID Where (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+" Group By tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr" , null);
        //or tblTmpInvoiceDetails.Stock>0
        if (flgReportFromTmpOrPermanent == 1) {
            cursor = db.rawQuery("Select tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr,Count(Distinct tblInvoiceDetails.StoreID) As StoreCount,1 AS FlgRowType  from tblCategoryMaster inner join tblInvoiceDetails on tblCategoryMaster.CategoryID=tblInvoiceDetails.CatID Where (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr Order by tblCategoryMaster.CatOrdr", null);
        }
        if (flgReportFromTmpOrPermanent == 0) {
            cursor = db.rawQuery("Select tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,1 AS FlgRowType  from tblCategoryMaster inner join tblTmpInvoiceDetails on tblCategoryMaster.CategoryID=tblTmpInvoiceDetails.CatID Where (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr Order by tblCategoryMaster.CatOrdr", null);
        }
        try {
            if (cursor.getCount() > 0) {
                //CompleteResult = new String[cursor.getCount()];
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        ArrayList<Object> arrProductDailySummaryKUWiseReportWithCategory = fnGetDailySummaryDetailsSKUWiseProductLevel(Integer.parseInt(cursor.getString(0).toString()), DraftorNonSubmitted, flgReportFromTmpOrPermanent,hmapProductTblUOMMapping);

                        if (arrProductDailySummaryKUWiseReportWithCategory.size() > 0) {

                            // CompleteResult[i]=(String) cursor.getString(0).toString();


                            String strCatDisplayUnit = (String) arrProductDailySummaryKUWiseReportWithCategory.get(0);
                            String strCatOrderVolume = (String) arrProductDailySummaryKUWiseReportWithCategory.get(1);
                            String strCatFreeVolume = (String) arrProductDailySummaryKUWiseReportWithCategory.get(2);
                            String strCatDiscValue = (String) arrProductDailySummaryKUWiseReportWithCategory.get(3);
                            String strCatAmountBeforeTax = (String) arrProductDailySummaryKUWiseReportWithCategory.get(4);
                            String strCatTaxValue = (String) arrProductDailySummaryKUWiseReportWithCategory.get(5);
                            String strCatOrderValue = (String) arrProductDailySummaryKUWiseReportWithCategory.get(6);


                            int CategoryLevelpcsPart= (int) arrProductDailySummaryKUWiseReportWithCategory.get(8);
                            double CategoryLevelcasePart=(double)(arrProductDailySummaryKUWiseReportWithCategory.get(9));

                            int CategoryLevelpcsPartFreeQty=(int) arrProductDailySummaryKUWiseReportWithCategory.get(10);
                            double CategoryLevelcasePartFreeQty=(double) arrProductDailySummaryKUWiseReportWithCategory.get(11);


                            String casepcstext="0";
                            if(CategoryLevelcasePart>0)
                            {
                                casepcstext=CategoryLevelcasePart +" Cs";
                            }
                            if(CategoryLevelpcsPart>0)
                            {
                                if(casepcstext.equals("0"))
                                {
                                    casepcstext = CategoryLevelpcsPart + " Pc";
                                }
                                else {
                                    casepcstext = casepcstext +", "+ CategoryLevelpcsPart + " Pc";
                                }
                            }




                            String casepcstextFreeQty="0";
                            if(CategoryLevelcasePartFreeQty>0)
                            {
                                casepcstextFreeQty=CategoryLevelcasePartFreeQty +" Cs";
                            }
                            if(CategoryLevelpcsPartFreeQty>0)
                            {
                                if(casepcstextFreeQty.equals("0"))
                                {
                                    casepcstextFreeQty = CategoryLevelpcsPartFreeQty+ " Pc";
                                }
                                else {
                                    casepcstextFreeQty = casepcstextFreeQty +", "+ CategoryLevelpcsPartFreeQty + " Pc";
                                }
                            }

                            if (strGrandTotalDiscValue.equals("")) {
                                strGrandTotalDiscValue = "" + Double.parseDouble(strCatDiscValue);
                            } else {
                                strGrandTotalDiscValue = "" + (Double.parseDouble(strGrandTotalDiscValue) + Double.parseDouble(strCatDiscValue));
                            }
                            if (strGrandTotalAmountBeforeTax.equals("")) {
                                strGrandTotalAmountBeforeTax = "" + Double.parseDouble(strCatAmountBeforeTax);
                            } else {
                                strGrandTotalAmountBeforeTax = "" + (Double.parseDouble(strGrandTotalAmountBeforeTax) + Double.parseDouble(strCatAmountBeforeTax));
                            }
                            if (strGrandTotalTaxValue.equals("")) {
                                strGrandTotalTaxValue = "" + Double.parseDouble(strCatTaxValue);
                            } else {
                                strGrandTotalTaxValue = "" + (Double.parseDouble(strGrandTotalTaxValue) + Double.parseDouble(strCatTaxValue));
                            }
                            if (strGrandTotalOrderValue.equals("")) {
                                strGrandTotalOrderValue = "" + Double.parseDouble(strCatOrderValue);
                            } else {
                                strGrandTotalOrderValue = "" + (Double.parseDouble(strGrandTotalOrderValue) + Double.parseDouble(strCatOrderValue));
                            }
                            LinkedHashMap<String, String> hmapSkuLevelRows = new LinkedHashMap<String, String>();
                            hmapSkuLevelRows = (LinkedHashMap<String, String>) arrProductDailySummaryKUWiseReportWithCategory.get(7);
                            //hmapSKUWiseDailySummaryReport.put((String) cursor.getString(0).toString(), "CATEGORY :"+(String) cursor.getString(1).toString()+"^"+0+"^"+0+"^"+(String) cursor.getString(2).toString()+"^"+strCatOrderVolume+" "+strCatDisplayUnit+"^"+strCatFreeVolume+" "+strCatDisplayUnit+"^"+strCatDiscValue+"^"+strCatAmountBeforeTax+"^"+strCatTaxValue+"^"+strCatOrderValue+"^"+(String) cursor.getString(3).toString());
                           // hmapSKUWiseDailySummaryReport.put((String) cursor.getString(0).toString(), "CATEGORY :" + (String) cursor.getString(1).toString() + "^" + 0 + "^" + 0 + "^" + strCatOrderVolume + " " + strCatDisplayUnit + "^" + strCatFreeVolume + " " + strCatDisplayUnit + "^" + strCatDiscValue + "^" + strCatAmountBeforeTax + "^" + strCatTaxValue + "^" + strCatOrderValue + "^" + (String) cursor.getString(2).toString() + "^" + (String) cursor.getString(3).toString() +"^0");
                            hmapSKUWiseDailySummaryReport.put((String) cursor.getString(0).toString(), "CATEGORY :" + (String) cursor.getString(1).toString() + "^" + 0 + "^" + 0 + "^" + casepcstext + "^" + casepcstextFreeQty + "^" + strCatDiscValue + "^" + strCatAmountBeforeTax + "^" + strCatTaxValue + "^" + strCatOrderValue + "^" + (String) cursor.getString(2).toString() + "^" + (String) cursor.getString(3).toString() +"^0");
                            hmapSKUWiseDailySummaryReport.putAll(hmapSkuLevelRows);
                            if (i == cursor.getCount() - 1) {
                                int storeCntGrandTotal = fnGetCountDailySummaryDetailsSKUWiseGrandTotal(DraftorNonSubmitted, flgReportFromTmpOrPermanent);
                                hmapGrandTotalCategorySKUWiseDailySummaryReport.putAll(hmapSKUWiseDailySummaryReport);
                                //hmapGrandTotalCategorySKUWiseDailySummaryReport.put("0", "GRAND TOTAL :"+"^"+" "+"^"+" "+"^"+storeCntGrandTotal+"^"+" "+"^"+" "+"^"+strGrandTotalDiscValue+"^"+strGrandTotalAmountBeforeTax+"^"+strGrandTotalTaxValue+"^"+strGrandTotalOrderValue+"^0");
                                hmapGrandTotalCategorySKUWiseDailySummaryReport.put("0", "GRAND TOTAL :" + "^" + "0" + "^" + "0" + "^" + "0" + "^" + "0" + "^" + strGrandTotalDiscValue + "^" + strGrandTotalAmountBeforeTax + "^" + strGrandTotalTaxValue + "^" + strGrandTotalOrderValue + "^" + storeCntGrandTotal + "^0^0");

                            }


                            cursor.moveToNext();


                        }
                    }
                }

            }


            return hmapGrandTotalCategorySKUWiseDailySummaryReport;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }
        //Getting Category Details Ends Here

    }

    public void fnShowCasePcsConversion()
    {
        HashMap<Integer, List<TblUOMMapping>> hmapProductTblUOMMapping = new HashMap<Integer, List<TblUOMMapping>>();
        hmapProductTblUOMMapping=fetch_ProductWiseGetAllMeasureUnitAgainstProductForLastVisitPage("0");

    }

    public LinkedHashMap<String, String> fnGetTabelEntry()//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        LinkedHashMap<String, String> hmapPrdRowDetails = new LinkedHashMap<String, String>();
        //ArrayList<Object> totalProductCategoryWiseResult=new ArrayList<Object>(8);
        //open();
        Cursor cursorSKUPrd = db.rawQuery("Select * from tblTmpInvoiceDetails", null);
        try {
            if (cursorSKUPrd.getCount() > 0) {
                cursorSKUPrd.moveToFirst();
                //if (cursorSKUPrd.moveToFirst()) {
                for (int i = 0; i <= (cursorSKUPrd.getCount() - 1); i++) {
                    String rowVales = "";
                    for (int j = 0; j <= (cursorSKUPrd.getColumnCount() - 1); j++) {
                        if (rowVales.equals("")) {
                            rowVales = cursorSKUPrd.getString(j).toString();
                        } else {
                            rowVales += "^" + cursorSKUPrd.getString(j).toString();
                        }
                    }

                    hmapPrdRowDetails.put("" + i, rowVales);
                    cursorSKUPrd.moveToNext();
                }
                //}
            }

            return hmapPrdRowDetails;

        } finally {
            cursorSKUPrd.close();
            //LinkedHashMap<String,String> hmapProductList=fnGetTabelEntryProduct();
            // close();
            // close();
        }

    }

    public LinkedHashMap<String, String> fnGetTabelEntryProduct()//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        LinkedHashMap<String, String> hmapPrdRowDetails = new LinkedHashMap<String, String>();
        //ArrayList<Object> totalProductCategoryWiseResult=new ArrayList<Object>(8);
        ////open();
        Cursor cursorSKUPrd = db.rawQuery("Select * from tblProductListMaster", null);
        try {
            if (cursorSKUPrd.getCount() > 0) {
                cursorSKUPrd.moveToFirst();
                //if (cursorSKUPrd.moveToFirst()) {
                for (int i = 0; i <= (cursorSKUPrd.getCount() - 1); i++) {
                    String rowVales = "";
                    for (int j = 0; j <= (cursorSKUPrd.getColumnCount() - 1); j++) {
                        if (rowVales.equals("")) {
                            rowVales = cursorSKUPrd.getString(j).toString();
                        } else {
                            rowVales += "^" + cursorSKUPrd.getString(j).toString();
                        }
                    }

                    hmapPrdRowDetails.put("" + i, rowVales);
                    cursorSKUPrd.moveToNext();
                }
                //}
            }

            return hmapPrdRowDetails;

        } finally {
            cursorSKUPrd.close();
            //close();
            // close();
        }

    }

    public ArrayList<Object> fnGetDailySummaryDetailsSKUWiseProductLevel(int CategoryId, int DraftorNonSubmitted, int flgReportFromTmpOrPermanent,HashMap<Integer, List<TblUOMMapping>> hmapProductTblUOMMapping)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        ArrayList<Object> totalProductCategoryWiseResult = new ArrayList<Object>(8);
        int CategoryLevelpcsPart=0;
        double CategoryLevelcasePart=0;

        int CategoryLevelpcsPartFreeQty=0;
        double CategoryLevelcasePartFreeQty=0;

        // Cursor cursorSKUPrd = db.rawQuery("Select tblProductListMaster.StoreCatNodeId || tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,tblProductListMaster.ProductMRP As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,Sum(tblTmpInvoiceDetails.OrderQty) as OrderQty,Sum(Cast(tblTmpInvoiceDetails.FreeQty As Real)) AS FreeQty, Sum(Cast(tblTmpInvoiceDetails.OrderQty as Real)) As OrderVolume,Cast(Sum(tblTmpInvoiceDetails.FreeQty) AS Real) As FreeVolume,Sum(Cast(tblTmpInvoiceDetails.DisVal As Real)) As DisVal,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real))-Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As TaxValue,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real)) As OrderVal,tblProductListMaster.DisplayUnit AS PDisplayUnit,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID and tblProductListMaster.StoreCatNodeId=tblTmpInvoiceDetails.StoreCatNodeId Where tblProductListMaster.StoreCatNodeId=tblTmpInvoiceDetails.StoreCatNodeId and  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.CatID="+CategoryId+" and  tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+" Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductListMaster.ProductMRP,tblProductListMaster.StandardRate,tblProductListMaster.DisplayUnit,tblProductListMaster.StoreCatNodeId Order by tblProductListMaster.CatOrdr,tblProductListMaster.PrdOrdr", null);
        //Cursor cursorSKUPrd = db.rawQuery("Select tblTmpInvoiceDetails.CatID || tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,tblProductSegementMap.ProductMRP As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,Sum(tblTmpInvoiceDetails.OrderQty) as OrderQty,Sum(Cast(tblTmpInvoiceDetails.FreeQty As Real)) AS FreeQty, Sum(Cast(tblTmpInvoiceDetails.OrderQty as Real)) As OrderVolume,Cast(Sum(tblTmpInvoiceDetails.FreeQty) AS Real) As FreeVolume,Sum(Cast(tblTmpInvoiceDetails.DisVal As Real)) As DisVal,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real))-Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As TaxValue,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real)) As OrderVal,tblProductListMaster.DisplayUnit AS PDisplayUnit,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID and tblProductListMaster.StoreCatNodeId=tblTmpInvoiceDetails.StoreCatNodeId inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  Where tblProductListMaster.StoreCatNodeId=tblTmpInvoiceDetails.StoreCatNodeId and  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.CatID="+CategoryId+" and  tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+"  Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductSegementMap.ProductMRP,tblProductSegementMap.StandardRate,tblProductListMaster.DisplayUnit,tblProductListMaster.StoreCatNodeId Order by tblProductListMaster.CatOrdr,tblProductListMaster.PrdOrdr", null);
        // Cursor cursorSKUPrd = db.rawQuery("Select tblProductListMaster.CategoryID || tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,((Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real)))/Sum(tblTmpInvoiceDetails.OrderQty)) As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,Sum(tblTmpInvoiceDetails.OrderQty) as OrderQty,Sum(Cast(tblTmpInvoiceDetails.FreeQty As Real)) AS FreeQty, Sum(Cast(tblTmpInvoiceDetails.OrderQty as Real)) As OrderVolume,Cast(Sum(tblTmpInvoiceDetails.FreeQty) AS Real) As FreeVolume,Sum(Cast(tblTmpInvoiceDetails.DisVal As Real)) As DisVal,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real))-Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As TaxValue,Sum(Cast(tblTmpInvoiceDetails.OrderVal As Real)) As OrderVal,tblProductListMaster.DisplayUnit AS PDisplayUnit,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID   Where tblProductListMaster.CategoryID=tblTmpInvoiceDetails.CatID and  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.CatID="+CategoryId+" and  tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+"  Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductListMaster.DisplayUnit Order by tblProductListMaster.CatOrdr,tblProductListMaster.PrdOrdr", null);
        Cursor cursorSKUPrd = null;
        if (flgReportFromTmpOrPermanent == 0) {
            cursorSKUPrd = db.rawQuery("Select tblProductListMaster.CategoryID || tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,((Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblTmpInvoiceDetails.OrderQty)) As PMRP,((Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblTmpInvoiceDetails.OrderQty)) As PSRate,Sum(tblTmpInvoiceDetails.OrderQty) as OrderQty,Sum(Cast(tblTmpInvoiceDetails.FreeQty As Real)) AS FreeQty, Sum(Cast(tblTmpInvoiceDetails.OrderQty as Real)) As OrderVolume,Cast(Sum(tblTmpInvoiceDetails.FreeQty) AS Real) As FreeVolume,Sum(Cast(tblTmpInvoiceDetails.DisVal As Real)) As DisVal,Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real))-Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) AS TaxValue,Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)) As OrderVal,tblProductListMaster.DisplayUnit AS PDisplayUnit,Count(Distinct tblTmpInvoiceDetails.StoreID) As StoreCount,2 AS FlgRowType,tblTmpInvoiceDetails.ProdID AS ProdID  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID Where tblTmpInvoiceDetails.CatID=" + CategoryId + "  and  tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted + "  Group By tblProductListMaster.CategoryID, tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductListMaster.DisplayUnit having Sum(tblTmpInvoiceDetails.OrderQty) >0 or  Sum(Cast(tblTmpInvoiceDetails.FreeQty As Real))>0 Order by tblProductListMaster.CatOrdr,PrdOrdr", null);
        }
        if (flgReportFromTmpOrPermanent == 1) {
            cursorSKUPrd = db.rawQuery("Select tblProductListMaster.CategoryID || tblInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,((Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblInvoiceDetails.OrderQty)) As PMRP,((Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblInvoiceDetails.OrderQty)) As PSRate,Sum(tblInvoiceDetails.OrderQty) as OrderQty,Sum(Cast(tblInvoiceDetails.FreeQty As Real)) AS FreeQty, Sum(Cast(tblInvoiceDetails.OrderQty as Real)) As OrderVolume,Cast(Sum(tblInvoiceDetails.FreeQty) AS Real) As FreeVolume,Sum(Cast(tblInvoiceDetails.DisVal As Real)) As DisVal,Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real))-Sum(Cast(tblInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,Sum(Cast(tblInvoiceDetails.TaxValue As Real)) AS TaxValue,Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)) As OrderVal,tblProductListMaster.DisplayUnit AS PDisplayUnit,Count(Distinct tblInvoiceDetails.StoreID) As StoreCount,2 AS FlgRowType,tblInvoiceDetails.ProdID AS ProdID  from tblInvoiceDetails inner join tblProductListMaster on tblInvoiceDetails.ProdID=tblProductListMaster.ProductID Where tblInvoiceDetails.CatID=" + CategoryId + "  and  tblInvoiceDetails.Sstat=" + DraftorNonSubmitted + "  Group By tblProductListMaster.CategoryID, tblInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductListMaster.DisplayUnit having Sum(tblInvoiceDetails.OrderQty) >0 or  Sum(Cast(tblInvoiceDetails.FreeQty As Real))>0 Order by tblProductListMaster.CatOrdr,PrdOrdr", null);
        }
        try {
            //hmapCtgryDetails= key=CategoryId,val=CategoryDescr
            HashMap<Integer, String> hmapProductOrdQtyCategoryLevel = new HashMap<Integer, String>();
            HashMap<Integer, String> hmapProductFreeQtyCategoryLevel = new HashMap<Integer, String>();
            LinkedHashMap<String, String> hmapPrdRowDetails = new LinkedHashMap<String, String>();
            String strCatDisplayUnit = "Kg/Liters";
            String strCatOrderVolume = "";
            String strCatFreeVolume = "";
            String strCatDiscValue = "";
            String strCatAmountBeforeTax = "";
            String strCatTaxValue = "";
            String strCatOrderValue = "";
            if (cursorSKUPrd.getCount() > 0) {
                if (cursorSKUPrd.moveToFirst()) {
                    for (int i = 0; i <= (cursorSKUPrd.getCount() - 1); i++) {

                        if (i == 0) {
                            strCatDisplayUnit = (String) cursorSKUPrd.getString(12).toString();
                        }
                        if (strCatOrderVolume.equals("")) {
                            strCatOrderVolume = "" + Double.parseDouble(cursorSKUPrd.getString(6).toString());
                        } else {
                            strCatOrderVolume = "" + (Double.parseDouble(strCatOrderVolume) + Double.parseDouble(cursorSKUPrd.getString(6).toString()));
                        }
                        if (strCatFreeVolume.equals("")) {
                            strCatFreeVolume = "" + Double.parseDouble(cursorSKUPrd.getString(7).toString());

                            Double strCatFreeVolumeVolumeValue = Double.parseDouble(strCatFreeVolume);
                            strCatFreeVolume = "" + Double.parseDouble(new DecimalFormat("##.##").format(strCatFreeVolumeVolumeValue));
                        } else {
                            strCatFreeVolume = "" + (Double.parseDouble(strCatFreeVolume) + Double.parseDouble(cursorSKUPrd.getString(7).toString()));

                            Double strCatFreeVolumeVolumeValue = Double.parseDouble(strCatFreeVolume);
                            strCatFreeVolume = "" + Double.parseDouble(new DecimalFormat("##.##").format(strCatFreeVolumeVolumeValue));
                        }
                        if (strCatDiscValue.equals("")) {
                            strCatDiscValue = "" + Double.parseDouble(cursorSKUPrd.getString(8).toString());
                        } else {
                            strCatDiscValue = "" + (Double.parseDouble(strCatDiscValue) + Double.parseDouble(cursorSKUPrd.getString(8).toString()));


                        }
                        if (strCatAmountBeforeTax.equals("")) {
                            strCatAmountBeforeTax = "" + Double.parseDouble(cursorSKUPrd.getString(9).toString());
                        } else {
                            strCatAmountBeforeTax = "" + (Double.parseDouble(strCatAmountBeforeTax) + Double.parseDouble(cursorSKUPrd.getString(9).toString()));
                        }
                        if (strCatTaxValue.equals("")) {
                            strCatTaxValue = "" + Double.parseDouble(cursorSKUPrd.getString(10).toString());
                        } else {
                            strCatTaxValue = "" + (Double.parseDouble(strCatTaxValue) + Double.parseDouble(cursorSKUPrd.getString(10).toString()));
                        }
                        if (strCatOrderValue.equals("")) {
                            strCatOrderValue = "" + Double.parseDouble(cursorSKUPrd.getString(11).toString());
                        } else {
                            strCatOrderValue = "" + (Double.parseDouble(strCatOrderValue) + Double.parseDouble(cursorSKUPrd.getString(11).toString()));
                        }

                     /*   HashMap<Integer, String> hmapProductOrdQty = new HashMap<Integer, String>();
                        HashMap<Integer, String> hmapProductFreedQty = new HashMap<Integer, String>();
                        hmapProductOrdQty.put(Integer.parseInt( cursorSKUPrd.getString(15).toString()),(String) cursorSKUPrd.getString(4).toString());*/
                        String pcsPart="0";
                        String casePart="0";
                        String locCaseConversion=(String) cursorSKUPrd.getString(4).toString();
                        if(hmapProductTblUOMMapping!=null && hmapProductTblUOMMapping.size()>0 && hmapProductTblUOMMapping.containsKey(Integer.parseInt( cursorSKUPrd.getString(15).toString())))
                        {
                            Double otqy=Double.parseDouble(locCaseConversion);
                            List<TblUOMMapping> tblUOMMappings= hmapProductTblUOMMapping.get(Integer.parseInt(cursorSKUPrd.getString(15).toString()));
                            if(otqy>=tblUOMMappings.get(0).getRelConversionUnits()) {
                                otqy = otqy / tblUOMMappings.get(0).getRelConversionUnits();
                                otqy = Double.parseDouble(new DecimalFormat("##.##").format(otqy));
                                casePart = ("" + otqy);
                                CategoryLevelcasePart = CategoryLevelcasePart + otqy;
                                pcsPart =locCaseConversion;
                               // pcsPart = ("" + otqy);//.split(Pattern.quote("."))[1];
                                CategoryLevelpcsPart = CategoryLevelpcsPart + Integer.parseInt(locCaseConversion);

                              //otqy = Double.parseDouble(new DecimalFormat("##.##").format(otqy));
                                /*if (("" + otqy).contains(".")) {
                                    casePart = ("" + otqy).split(Pattern.quote("."))[0];
                                    CategoryLevelcasePart = CategoryLevelcasePart + Integer.parseInt(casePart);
                                    pcsPart = ("" + otqy).split(Pattern.quote("."))[1];
                                    CategoryLevelpcsPart = CategoryLevelpcsPart + Integer.parseInt(pcsPart);
                                }*/
                            }
                            else
                            {
                               // otqy = Double.parseDouble(new DecimalFormat("##.##").format(otqy));
                                //if (("" + otqy).contains(".")) {

                                   // pcsPart = ("" + otqy).split(Pattern.quote("."))[0];
                                pcsPart=locCaseConversion;
                                    CategoryLevelpcsPart = CategoryLevelpcsPart + Integer.parseInt(locCaseConversion);
                                //}
                            }


                        }
                        String casepcstext="0";
                        if((Double.parseDouble(casePart))>0)
                        {
                            casepcstext=(Double.parseDouble(casePart)) +" Cs";
                        }
                        if((Double.parseDouble(pcsPart))>0)
                        {
                            if(casepcstext.equals("0"))
                            {
                                casepcstext =  pcsPart + " Pc";
                            }
                            else {
                                casepcstext = casepcstext +", "+  pcsPart + " Pc";
                            }
                        }





                        String pcsPartFreeQty="0";
                        String casePartFreeQty="0";
                        String locCaseConversionFreeQty=(String) cursorSKUPrd.getString(5).toString();
                        if(hmapProductTblUOMMapping!=null && hmapProductTblUOMMapping.size()>0 && hmapProductTblUOMMapping.containsKey(Integer.parseInt( cursorSKUPrd.getString(15).toString())))
                        {
                            Double otqy=Double.parseDouble(locCaseConversionFreeQty);
                            List<TblUOMMapping> tblUOMMappings= hmapProductTblUOMMapping.get(Integer.parseInt(cursorSKUPrd.getString(15).toString()));
                            if(otqy>=tblUOMMappings.get(0).getRelConversionUnits()) {
                                otqy = otqy / tblUOMMappings.get(0).getRelConversionUnits();

                                otqy = Double.parseDouble(new DecimalFormat("##.##").format(otqy));

                                casePartFreeQty = ("" + otqy);//.split(Pattern.quote("."))[0];
                                CategoryLevelcasePartFreeQty = CategoryLevelcasePartFreeQty + otqy;//Integer.parseInt(casePartFreeQty);
                                pcsPartFreeQty = (""+locCaseConversionFreeQty);//("" + otqy);//.split(Pattern.quote("."))[1];
                                CategoryLevelpcsPartFreeQty = CategoryLevelpcsPartFreeQty +Integer.parseInt(locCaseConversionFreeQty);// Integer.parseInt(pcsPartFreeQty);
                                /*if (("" + otqy).contains(".")) {
                                    casePartFreeQty = ("" + otqy).split(Pattern.quote("."))[0];
                                    CategoryLevelcasePartFreeQty = CategoryLevelcasePartFreeQty + Integer.parseInt(casePartFreeQty);
                                    pcsPartFreeQty = ("" + otqy).split(Pattern.quote("."))[1];
                                    CategoryLevelpcsPartFreeQty = CategoryLevelpcsPartFreeQty + Integer.parseInt(pcsPartFreeQty);
                                }*/
                            }
                            else
                            {
                               // otqy = Double.parseDouble(new DecimalFormat("##.##").format(otqy));
                                //if (("" + otqy).contains(".")) {
                                   /* casePart = ("" + otqy).split(Pattern.quote("."))[0];
                                    CategoryLevelcasePart = CategoryLevelcasePart + Integer.parseInt(casePart);*/
                                    pcsPartFreeQty =locCaseConversionFreeQty;// ("" + otqy).split(Pattern.quote("."))[0];
                                    CategoryLevelpcsPartFreeQty = CategoryLevelpcsPartFreeQty +Integer.parseInt(locCaseConversionFreeQty);// + Integer.parseInt(pcsPartFreeQty);
                                //}
                            }


                        }
                        String casepcstextFreeQty="0";
                        if((Double.parseDouble(casePartFreeQty))>0)
                        {
                            casepcstextFreeQty=(Double.parseDouble(casePartFreeQty)) +" Cs";
                        }
                        if((int)(Double.parseDouble(pcsPartFreeQty))>0)
                        {
                            if(casepcstextFreeQty.equals("0"))
                            {
                                casepcstextFreeQty =pcsPartFreeQty + " Pc";
                            }
                            else {
                                casepcstextFreeQty = casepcstextFreeQty +", "+ pcsPartFreeQty + " Pc";
                            }
                        }








                        hmapPrdRowDetails.put(CategoryId + "_" + (String) cursorSKUPrd.getString(0).toString(), (String) cursorSKUPrd.getString(1).toString() + "^" + (String) cursorSKUPrd.getString(2).toString() + "^" + (String) cursorSKUPrd.getString(3).toString() + "^" + casepcstext + "^" + casepcstextFreeQty + "^" + (String) cursorSKUPrd.getString(8).toString() + "^" + (String) cursorSKUPrd.getString(9).toString() + "^" + (String) cursorSKUPrd.getString(10).toString() + "^" + (String) cursorSKUPrd.getString(11).toString() + "^" + (String) cursorSKUPrd.getString(13).toString() + "^" + (String) cursorSKUPrd.getString(14).toString() + "^" + (String) cursorSKUPrd.getString(15).toString());
                        cursorSKUPrd.moveToNext();
                    }
                }

                if (strCatDisplayUnit.equals("Kg")) {
                    strCatOrderVolume = ConvertGramToKilo(strCatOrderVolume);
                    Double strCatOrderVolumeValue = Double.parseDouble(strCatOrderVolume);
                    strCatOrderVolume = "" + Double.parseDouble(new DecimalFormat("##.##").format(strCatOrderVolumeValue));
                }
                if (strCatDisplayUnit.equals("Lt")) {
                    strCatOrderVolume = ConvertMLToLiters(strCatOrderVolume);
                    Double strCatOrderVolumeValue = Double.parseDouble(strCatOrderVolume);
                    strCatOrderVolume = "" + Double.parseDouble(new DecimalFormat("##.##").format(strCatOrderVolumeValue));
                }


                if (strCatDisplayUnit.equals("Kg")) {
                    strCatFreeVolume = ConvertGramToKilo(strCatFreeVolume);
                    Double strCatFreeVolumeValue = Double.parseDouble(strCatFreeVolume);
                    strCatFreeVolume = "" + Double.parseDouble(new DecimalFormat("##.##").format(strCatFreeVolumeValue));
                }
                if (strCatDisplayUnit.equals("Lt")) {
                    strCatFreeVolume = ConvertMLToLiters(strCatFreeVolume);
                    Double strCatFreeVolumeValue = Double.parseDouble(strCatFreeVolume);
                    strCatFreeVolume = "" + Double.parseDouble(new DecimalFormat("##.##").format(strCatFreeVolumeValue));
                }


                totalProductCategoryWiseResult.add(0, strCatDisplayUnit);
                totalProductCategoryWiseResult.add(1, strCatOrderVolume);
                totalProductCategoryWiseResult.add(2, strCatFreeVolume);
                totalProductCategoryWiseResult.add(3, strCatDiscValue);
                totalProductCategoryWiseResult.add(4, strCatAmountBeforeTax);
                totalProductCategoryWiseResult.add(5, strCatTaxValue);
                totalProductCategoryWiseResult.add(6, strCatOrderValue);
                totalProductCategoryWiseResult.add(7, hmapPrdRowDetails);
                totalProductCategoryWiseResult.add(8, CategoryLevelpcsPart);
                totalProductCategoryWiseResult.add(9, CategoryLevelcasePart);
                totalProductCategoryWiseResult.add(10, CategoryLevelpcsPartFreeQty);
                totalProductCategoryWiseResult.add(11, CategoryLevelcasePartFreeQty);
            }


            return totalProductCategoryWiseResult;

        } finally {
            cursorSKUPrd.close();
            // close();
        }

    }

    public int fnGetCountDailySummaryDetailsSKUWiseGrandTotal(int DraftorNonSubmitted, int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        ////open();
        Cursor cursorGTota = null;
        if (flgReportFromTmpOrPermanent == 1) {
            cursorGTota = db.rawQuery("Select Count(*) from tblInvoiceDetails where (OrderQty>0 or FreeQty>0) and Sstat=" + DraftorNonSubmitted + "", null);
        }
        if (flgReportFromTmpOrPermanent == 0) {
            cursorGTota = db.rawQuery("Select Count(*) from tblTmpInvoiceDetails where (OrderQty>0 or FreeQty>0) and Sstat=" + DraftorNonSubmitted + "", null);
        }
        try {
            int CountCompleteResultSkuWiseProductLevel = 0;
            if (cursorGTota.getCount() > 0) {
                if (cursorGTota.moveToFirst()) {
                    for (int i = 0; i <= (cursorGTota.getCount() - 1); i++) {
                        CountCompleteResultSkuWiseProductLevel = Integer.parseInt(cursorGTota.getString(0).toString());
                        cursorGTota.moveToNext();
                    }
                }
            }
            return CountCompleteResultSkuWiseProductLevel;

        } finally {
            cursorGTota.close();
            // close();
        }

    }

    public void insertProductMappedWithSchemApplied(String storeId, String productId, String _schSlabId, String _schmId, String pdaOrderID, String TmpInvoiceCodePDA,int flgInCarton) {
        //open();


        ContentValues initialValues = new ContentValues();
        initialValues.put("schmIdMapped", _schmId.trim());
        initialValues.put("schSlabId", _schSlabId.trim());


        initialValues.put("StoreId", storeId.trim());
        initialValues.put("ProductID", productId.trim());
        initialValues.put("Sstat", 0);
        initialValues.put("OrderIDPDA", pdaOrderID);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("flgInCarton", flgInCarton);

        // System.out.println("DATABASE_TABLE_Main215 : StoreId = "+storeId+" ProductID = "+productId+" schSlabId ="+_schSlabId+" schmIdMapped ="+_schmId);

        db.insert(DBHelper.DATABASE_TABLE_Main215, null, initialValues);


        //close();

    }


    //	 DATABASE_CREATE_TABLE_215 =tblProductMappedWithSchemeSlabApplied (StoreId,ProductID,schSlabId,schmIdMapped
    // changes by nitish

    public void insertSchemeAlrtVal(String storeId, String productId, String spinnerVal, String product, String SpinnerPosition, String _schSlabId, String _schmAlrtId, String pdaOrderID, String TmpInvoiceCodePDA) {
        //open();
        //StoreId text null,ProductID text null,SpinnerVal text null,SpinnerPosition text null,Product text null,schSlabId text null,schmAlrtId text null);";
        Cursor cur = db.rawQuery("Select Product,SpinnerVal from tblAlrtVal where StoreId ='" + storeId + "' and ProductID = '" + productId + "' and schSlabId = '" + _schSlabId + "' and schmAlrtId = '" + _schmAlrtId + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        ContentValues initialValues = new ContentValues();

        initialValues.put("Product", product.trim());
        initialValues.put("SpinnerVal", spinnerVal.trim());
        initialValues.put("SpinnerPosition", SpinnerPosition.trim());


        if (cur.getCount() > 0) {
            db.update(DBHelper.DATABASE_TABLE_Main214, initialValues, "StoreID=? AND ProductID=? AND  TmpInvoiceCodePDA=?", new String[]{storeId, productId, TmpInvoiceCodePDA});
        } else {

            //	 DATABASE_CREATE_TABLE_214,SpinnerPosition
            initialValues.put("schmAlrtId", _schmAlrtId.trim());
            initialValues.put("schSlabId", _schSlabId.trim());
            initialValues.put("StoreId", storeId.trim());
            initialValues.put("ProductID", productId.trim());
            initialValues.put("OrderIDPDA", pdaOrderID);
            initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
            //TmpInvoiceCodePDA

            db.insert(DBHelper.DATABASE_TABLE_Main214, null, initialValues);

        }

        // close();
        cur.close();
    }

    public String[] getValOfSchemeAlrt(String storeId, String productId, String _schmSlabID, String pdaOrderID, String TmpInvoiceCodePDA) {
        //open();
        String[] alrtValues = new String[2];
        //open();
        Cursor cur = db.rawQuery("Select Product,SpinnerPosition from tblAlrtVal where StoreId ='" + storeId + "' and ProductID = '" + productId + "' and schSlabId = '" + _schmSlabID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);

        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                alrtValues[0] = cur.getString(0);
                alrtValues[1] = cur.getString(1);
            }


        } else {
            alrtValues[0] = "No Data";
            alrtValues[1] = "";
        }
        //close();
        cur.close();
        return alrtValues;

    }

    public String getValOfSchemeAlrtSelected(String storeId, String _schmAlrtId, String _schSlabId, String pdaOrderID, String TmpInvoiceCodePDA) {
        //open();
        String alrtValues = null;
        //open();
        Cursor cur = db.rawQuery("Select SpinnerVal from tblAlrtVal where StoreId ='" + storeId + "' and schmAlrtId = '" + _schmAlrtId + "' and schSlabId = '" + _schSlabId + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);

        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                alrtValues = cur.getString(0);

            }


        } else {
            alrtValues = "0";

        }
        //close();
        cur.close();
        return alrtValues;

    }

    public LinkedHashMap<String, String> fnGetDailySummaryDetailsStoreWise(int DraftorNonSubmitted, int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        ArrayList<Object> totalCategoryWiseResult = new ArrayList<Object>(11);

        //Getting Category Details Starts Here


        //hmapStoreDetails= key=StoreId,val=StoreDetails
        LinkedHashMap<String, String> hmapStoreWiseDailySummaryDetails = new LinkedHashMap<String, String>();

        //hmapStoreDetails= key=StoreId,val=StoreDetails
        LinkedHashMap<String, String> hmapStoreWiseDailySummaryDetailsWithGrandTotal = new LinkedHashMap<String, String>();
        String StoreStockValue = "";
        String StoreDiscountValue = "";
        String StoreOrderValueBeforeTax = "";
        String StoreTaxValue = "";
        String StoreOrderValueAfterTax = "";

        //open();
        //or tblTmpInvoiceDetails.Stock>0
        Cursor cursor = null;
        if (flgReportFromTmpOrPermanent == 0) {
            cursor = db.rawQuery("Select tblTmpInvoiceDetails.StoreID,tblStoreList.StoreName,Count(Distinct tblTmpInvoiceDetails.ProdID) As LinesPerBill,(Cast(tblTmpInvoiceDetails.ProductPrice As Real)*0) As StockValue,Sum(Cast(tblTmpInvoiceDetails.DisVal As Real)) As DiscountValue,(Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real))-Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real))) As ValueBeforeTax,Sum(Cast(tblTmpInvoiceDetails.TaxValue As Real)) As TaxValue,Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)) As ValueAfterTax from tblTmpInvoiceDetails inner join tblStoreList on tblTmpInvoiceDetails.StoreID=tblStoreList.StoreID Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblTmpInvoiceDetails.StoreID,tblStoreList.StoreName", null);
        }
        if (flgReportFromTmpOrPermanent == 1) {
            cursor = db.rawQuery("Select tblInvoiceDetails.StoreID,tblStoreList.StoreName,Count(Distinct tblInvoiceDetails.ProdID) As LinesPerBill,(Cast(tblInvoiceDetails.ProductPrice As Real)*0) As StockValue,Sum(Cast(tblInvoiceDetails.DisVal As Real)) As DiscountValue,(Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real))-Sum(Cast(tblInvoiceDetails.TaxValue As Real))) As ValueBeforeTax,Sum(Cast(tblInvoiceDetails.TaxValue As Real)) As TaxValue,Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)) As ValueAfterTax from tblInvoiceDetails inner join tblStoreList on tblInvoiceDetails.StoreID=tblStoreList.StoreID Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblInvoiceDetails.StoreID,tblStoreList.StoreName", null);
        }
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapStoreWiseDailySummaryDetails.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString() + "^" + (String) cursor.getString(3).toString() + "^" + (String) cursor.getString(4).toString() + "^" + (String) cursor.getString(5).toString() + "^" + (String) cursor.getString(6).toString() + "^" + (String) cursor.getString(7).toString());

                        if (StoreStockValue.equals("")) {
                            StoreStockValue = (String) cursor.getString(3).toString();
                        } else {
                            StoreStockValue = "" + (Double.parseDouble(StoreStockValue) + Double.parseDouble(cursor.getString(3).toString()));
                        }
                        if (StoreDiscountValue.equals("")) {
                            StoreDiscountValue = (String) cursor.getString(4).toString();
                        } else {
                            StoreDiscountValue = "" + (Double.parseDouble(StoreDiscountValue) + Double.parseDouble(cursor.getString(4).toString()));
                        }
                        if (StoreOrderValueBeforeTax.equals("")) {
                            StoreOrderValueBeforeTax = (String) cursor.getString(5).toString();
                        } else {
                            StoreOrderValueBeforeTax = "" + (Double.parseDouble(StoreOrderValueBeforeTax) + Double.parseDouble(cursor.getString(5).toString()));
                        }
                        if (StoreTaxValue.equals("")) {
                            StoreTaxValue = (String) cursor.getString(6).toString();
                        } else {
                            StoreTaxValue = "" + (Double.parseDouble(StoreTaxValue) + Double.parseDouble(cursor.getString(6).toString()));
                        }
                        if (StoreOrderValueAfterTax.equals("")) {
                            StoreOrderValueAfterTax = (String) cursor.getString(7).toString();
                        } else {
                            StoreOrderValueAfterTax = "" + (Double.parseDouble(StoreOrderValueAfterTax) + Double.parseDouble(cursor.getString(7).toString()));
                        }
                        if (i == cursor.getCount() - 1) {
                            int cntLinesBillTotStoreWiseGrandTotal = fnCountToDisplayDailySummaryDetailsStoreWiseLines(DraftorNonSubmitted, flgReportFromTmpOrPermanent);
                            hmapStoreWiseDailySummaryDetailsWithGrandTotal.put("0", "TOTAL :" + "^" + cntLinesBillTotStoreWiseGrandTotal + "^" + StoreStockValue + "^" + StoreDiscountValue + "^" + StoreOrderValueBeforeTax + "^" + StoreTaxValue + "^" + StoreOrderValueAfterTax);
                            hmapStoreWiseDailySummaryDetailsWithGrandTotal.putAll(hmapStoreWiseDailySummaryDetails);
                        }
                        cursor.moveToNext();
                    }
                }
                //totalCategoryWiseResult.add(1, hmapStoreDetails);


            }
            return hmapStoreWiseDailySummaryDetailsWithGrandTotal;

        } finally {
            cursor.close();
            // close();
        }
        //Getting Category Details Ends Here

    }


    // StoreWise Summary Function given by Abhinav Sir

    public int fnCountToDisplayDailySummaryDetailsStoreWiseLines(int DraftorNonSubmitted, int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        int CountToDisplayDailySummaryDetailsSKUWise = 0;
        //ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>(4);

        //Getting Category Details Starts Here
        Cursor cursor = null;
        ////open();
        if (flgReportFromTmpOrPermanent == 0) {
            cursor = db.rawQuery("Select Count(tblTmpInvoiceDetails.ProdID) from tblTmpInvoiceDetails Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        if (flgReportFromTmpOrPermanent == 1) {
            cursor = db.rawQuery("Select Count(tblInvoiceDetails.ProdID) from tblInvoiceDetails Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    CountToDisplayDailySummaryDetailsSKUWise = Integer.parseInt(cursor.getString(0).toString());
                }
            }
            return CountToDisplayDailySummaryDetailsSKUWise;
        } finally {
            cursor.close();
            //close();
        }

    }

    public int fnCountToDisplayDailySummaryDetailsStoreSKUWise(int DraftorNonSubmitted, int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        int CountToDisplayDailySummaryDetailsSKUWise = 0;
        //ArrayList<HashMap<String, String>> totalProductDetail=new ArrayList<HashMap<String, String>>(4);

        //Getting Category Details Starts Here
        Cursor cursor = null;
        //open();
        if (flgReportFromTmpOrPermanent == 0) {
            cursor = db.rawQuery("Select Count(tblTmpInvoiceDetails.StoreID) from tblTmpInvoiceDetails Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        if (flgReportFromTmpOrPermanent == 1) {
            cursor = db.rawQuery("Select Count(tblInvoiceDetails.StoreID) from tblInvoiceDetails Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted, null);
        }
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    CountToDisplayDailySummaryDetailsSKUWise = Integer.parseInt(cursor.getString(0).toString());
                }
            }
            return CountToDisplayDailySummaryDetailsSKUWise;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }

    }

    @SuppressWarnings("unchecked")

    public LinkedHashMap<String, String> fnGetDailySummaryDetailsStoreSKUWiseLevel(int DraftorNonSubmitted, int flgReportFromTmpOrPermanent)//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {

        //Getting Category Details Starts Here

        LinkedHashMap<String, String> hmapSKUWiseDailySummaryReport = new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapGrandTotalCategorySKUWiseDailySummaryReport = new LinkedHashMap<String, String>();

        HashMap<Integer, List<TblUOMMapping>> hmapProductTblUOMMapping = new HashMap<Integer, List<TblUOMMapping>>();
        hmapProductTblUOMMapping=fetch_ProductWiseGetAllMeasureUnitAgainstProductForLastVisitPage("0");

        String CompleteResult[] = null;

        String strGrandTotalDiscValue = "";
        String strGrandTotalAmountBeforeTax = "";
        String strGrandTotalTaxValue = "";
        String strGrandTotalOrderValue = "";
        Cursor cursor = null;
        //open();
        // or tblTmpInvoiceDetails.Stock>0
        if (flgReportFromTmpOrPermanent == 0) {
            cursor = db.rawQuery("Select tblTmpInvoiceDetails.StoreID,tblStoreList.StoreName,1 AS FlgRowType from  tblTmpInvoiceDetails inner join tblStoreList on  tblTmpInvoiceDetails.StoreID=tblStoreList.StoreID Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblTmpInvoiceDetails.StoreID,tblStoreList.StoreName", null);
        }
        if (flgReportFromTmpOrPermanent == 1) {
//            cursor = db.rawQuery("Select tblInvoiceDetails.StoreID,tblStoreList.StoreName,1 AS FlgRowType from  tblInvoiceDetails inner join tblStoreList on  tblInvoiceDetails.StoreID=tblStoreList.StoreID inner join tblStoreVisitMstr on tblStoreList.StoreID=tblStoreVisitMstr.StoreID Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblStoreVisitMstr.Sstat=" + DraftorNonSubmitted + " Group By tblInvoiceDetails.StoreID,tblStoreList.StoreName", null);
            cursor = db.rawQuery("Select tblInvoiceDetails.StoreID,tblStoreList.StoreName,1 AS FlgRowType from  tblInvoiceDetails inner join tblStoreList on  tblInvoiceDetails.StoreID=tblStoreList.StoreID Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.Sstat=" + DraftorNonSubmitted + " Group By tblInvoiceDetails.StoreID,tblStoreList.StoreName", null);
        }
        try {
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        int StoreCatNodeId = fnGetStoreCatNodeId(cursor.getString(0).toString());
                        ArrayList<Object> arrProductDailySummaryKUWiseReportWithCategory = fnGetDailySummaryDetailsStoreSKUWiseProductLevel(cursor.getString(0).toString(), DraftorNonSubmitted, StoreCatNodeId, flgReportFromTmpOrPermanent,hmapProductTblUOMMapping);
                        if (arrProductDailySummaryKUWiseReportWithCategory.size() > 0) {
                            String strStoreSKUDiscValue = (String) arrProductDailySummaryKUWiseReportWithCategory.get(0);
                            String strStoreSKUAmountBeforeTax = (String) arrProductDailySummaryKUWiseReportWithCategory.get(1);
                            String strStoreSKUTaxValue = (String) arrProductDailySummaryKUWiseReportWithCategory.get(2);
                            String strStoreSKUOrderValue = (String) arrProductDailySummaryKUWiseReportWithCategory.get(3);

                            if (strGrandTotalDiscValue.equals("")) {
                                strGrandTotalDiscValue = "" + Double.parseDouble(strStoreSKUDiscValue);
                            } else {
                                strGrandTotalDiscValue = "" + (Double.parseDouble(strGrandTotalDiscValue) + Double.parseDouble(strStoreSKUDiscValue));
                            }
                            if (strGrandTotalAmountBeforeTax.equals("")) {
                                strGrandTotalAmountBeforeTax = "" + Double.parseDouble(strStoreSKUAmountBeforeTax);
                            } else {
                                strGrandTotalAmountBeforeTax = "" + (Double.parseDouble(strGrandTotalAmountBeforeTax) + Double.parseDouble(strStoreSKUAmountBeforeTax));
                            }
                            if (strGrandTotalTaxValue.equals("")) {
                                strGrandTotalTaxValue = "" + Double.parseDouble(strStoreSKUTaxValue);
                            } else {
                                strGrandTotalTaxValue = "" + (Double.parseDouble(strGrandTotalTaxValue) + Double.parseDouble(strStoreSKUTaxValue));
                            }
                            if (strGrandTotalOrderValue.equals("")) {
                                strGrandTotalOrderValue = "" + Double.parseDouble(strStoreSKUOrderValue);
                            } else {
                                strGrandTotalOrderValue = "" + (Double.parseDouble(strGrandTotalOrderValue) + Double.parseDouble(strStoreSKUOrderValue));
                            }
                            LinkedHashMap<String, String> hmapSkuLevelRows = new LinkedHashMap<String, String>();
                            hmapSkuLevelRows = (LinkedHashMap<String, String>) arrProductDailySummaryKUWiseReportWithCategory.get(4);
                            hmapSKUWiseDailySummaryReport.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString() + "^" + "0" + "^" + "0" + "^" + "0" + "^" + "0" + "^" + "0" + "^" + strStoreSKUDiscValue + "^" + strStoreSKUAmountBeforeTax + "^" + strStoreSKUTaxValue + "^" + strStoreSKUOrderValue + "^" + (String) cursor.getString(2).toString());
                            hmapSKUWiseDailySummaryReport.putAll(hmapSkuLevelRows);
                            if (i == cursor.getCount() - 1) {
                                hmapGrandTotalCategorySKUWiseDailySummaryReport.put("0", "GRAND TOTAL :" + "^" + "0" + "^" + "0" + "^" + "0" + "^" + "0" + "^" + "0" + "^" + strGrandTotalDiscValue + "^" + strGrandTotalAmountBeforeTax + "^" + strGrandTotalTaxValue + "^" + strGrandTotalOrderValue + "^0");
                                hmapGrandTotalCategorySKUWiseDailySummaryReport.putAll(hmapSKUWiseDailySummaryReport);


                            }

                        }

                        cursor.moveToNext();
                    }
                }

            }


            return hmapGrandTotalCategorySKUWiseDailySummaryReport;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }
        //Getting Category Details Ends Here
    }

    @SuppressWarnings("unchecked")

    public ArrayList<Object> fnGetDailySummaryDetailsStoreSKUWiseProductLevel(String StoreID, int DraftorNonSubmitted, int StoreCatNodeId, int flgReportFromTmpOrPermanent, HashMap<Integer, List<TblUOMMapping>> hmapProductTblUOMMapping )//DraftorNonSubmitted=3:-Submited But Not Synced,DraftorNonSubmitted=1:-Saved as Draft
    {
        ArrayList<Object> totalProductCategoryWiseResult = new ArrayList<Object>(4);


        int CategoryLevelpcsPart=0;
        double CategoryLevelcasePart=0;

        int CategoryLevelpcsPartFreeQty=0;
        double CategoryLevelcasePartFreeQty=0;

        Cursor cursorSKUPrd = null;
        //Cursor cursorSKUPrd = db.rawQuery("Select tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,tblProductListMaster.ProductMRP As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,tblTmpInvoiceDetails.Stock as Stock,tblTmpInvoiceDetails.OrderQty as OrderQty,tblTmpInvoiceDetails.FreeQty AS FreeQty,tblTmpInvoiceDetails.DisVal As DisVal,(Cast(tblTmpInvoiceDetails.OrderVal As Real)-Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,tblTmpInvoiceDetails.TaxValue As TaxValue,tblTmpInvoiceDetails.OrderVal As OrderVal,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.StoreID='"+StoreID+"' and  tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+" and tblTmpInvoiceDetails.StoreCatNodeId="+StoreCatNodeId+" and tblProductListMaster.StoreCatNodeId="+StoreCatNodeId+"  Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductListMaster.ProductMRP,tblProductListMaster.StandardRate Order by PrdOrdr", null);
        //Cursor cursorSKUPrd = db.rawQuery("Select tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,tblProductSegementMap.ProductMRP As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,tblTmpInvoiceDetails.Stock as Stock,tblTmpInvoiceDetails.OrderQty as OrderQty,tblTmpInvoiceDetails.FreeQty AS FreeQty,tblTmpInvoiceDetails.DisVal As DisVal,(Cast(tblTmpInvoiceDetails.OrderVal As Real)-Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,tblTmpInvoiceDetails.TaxValue As TaxValue,tblTmpInvoiceDetails.OrderVal As OrderVal,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.StoreID='"+StoreID+"' and  tblTmpInvoiceDetails.Sstat="+DraftorNonSubmitted+" and tblTmpInvoiceDetails.StoreCatNodeId="+StoreCatNodeId+" and tblProductListMaster.StoreCatNodeId="+StoreCatNodeId+" Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName,tblProductSegementMap.ProductMRP,tblProductSegementMap.StandardRate Order by PrdOrdr", null);

        if (flgReportFromTmpOrPermanent == 0) {
            cursorSKUPrd = db.rawQuery("Select tblTmpInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,((Sum(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblTmpInvoiceDetails.OrderQty)) As PMRP,tblTmpInvoiceDetails.ProductPrice As PSRate,0 as Stock,tblTmpInvoiceDetails.OrderQty as OrderQty,tblTmpInvoiceDetails.FreeQty AS FreeQty,tblTmpInvoiceDetails.DisVal As DisVal,(Cast(tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As Real)-Cast(tblTmpInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,tblTmpInvoiceDetails.TaxValue As TaxValue,tblTmpInvoiceDetails.LineValAftrTxAftrDscnt As OrderVal,2 AS FlgRowType  from tblTmpInvoiceDetails inner join tblProductListMaster on tblTmpInvoiceDetails.ProdID=tblProductListMaster.ProductID Where  (tblTmpInvoiceDetails.OrderQty>0 or tblTmpInvoiceDetails.FreeQty>0) and tblTmpInvoiceDetails.StoreID='" + StoreID + "' and  tblTmpInvoiceDetails.Sstat=" + DraftorNonSubmitted + "  Group By tblTmpInvoiceDetails.ProdID,tblProductListMaster.ProductShortName Order by tblProductListMaster.CategoryID, PrdOrdr", null);
        }
        if (flgReportFromTmpOrPermanent == 1) {
            cursorSKUPrd = db.rawQuery("Select tblInvoiceDetails.ProdID AS PID,tblProductListMaster.ProductShortName As ProdShortName,((Sum(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)))/Sum(tblInvoiceDetails.OrderQty)) As PMRP,tblInvoiceDetails.ProductPrice As PSRate,0 as Stock,tblInvoiceDetails.OrderQty as OrderQty,tblInvoiceDetails.FreeQty AS FreeQty,tblInvoiceDetails.DisVal As DisVal,(Cast(tblInvoiceDetails.LineValAftrTxAftrDscnt As Real)-Cast(tblInvoiceDetails.TaxValue As Real)) As AmtBeforeTax,tblInvoiceDetails.TaxValue As TaxValue,tblInvoiceDetails.LineValAftrTxAftrDscnt As OrderVal,2 AS FlgRowType  from tblInvoiceDetails inner join tblProductListMaster on tblInvoiceDetails.ProdID=tblProductListMaster.ProductID Where  (tblInvoiceDetails.OrderQty>0 or tblInvoiceDetails.FreeQty>0) and tblInvoiceDetails.StoreID='" + StoreID + "' and  tblInvoiceDetails.Sstat=" + DraftorNonSubmitted + "  Group By tblInvoiceDetails.ProdID,tblProductListMaster.ProductShortName Order by tblProductListMaster.CategoryID,PrdOrdr", null);
        }
        try {
            //hmapCtgryDetails= key=CategoryId,val=CategoryDescr
            LinkedHashMap<String, String> hmapPrdRowDetails = new LinkedHashMap<String, String>();
            String strCatDiscValue = "";
            String strCatAmountBeforeTax = "";
            String strCatTaxValue = "";
            String strCatOrderValue = "";
            if (cursorSKUPrd.getCount() > 0) {
                if (cursorSKUPrd.moveToFirst()) {
                    for (int i = 0; i <= (cursorSKUPrd.getCount() - 1); i++) {


                        if (strCatDiscValue.equals("")) {
                            strCatDiscValue = "" + Double.parseDouble(cursorSKUPrd.getString(7).toString());
                        } else {
                            strCatDiscValue = "" + (Double.parseDouble(strCatDiscValue) + Double.parseDouble(cursorSKUPrd.getString(7).toString()));
                        }
                        if (strCatAmountBeforeTax.equals("")) {
                            strCatAmountBeforeTax = "" + Double.parseDouble(cursorSKUPrd.getString(8).toString());
                        } else {
                            strCatAmountBeforeTax = "" + (Double.parseDouble(strCatAmountBeforeTax) + Double.parseDouble(cursorSKUPrd.getString(8).toString()));
                        }
                        if (strCatTaxValue.equals("")) {
                            strCatTaxValue = "" + Double.parseDouble(cursorSKUPrd.getString(9).toString());
                        } else {
                            strCatTaxValue = "" + (Double.parseDouble(strCatTaxValue) + Double.parseDouble(cursorSKUPrd.getString(9).toString()));
                        }
                        if (strCatOrderValue.equals("")) {
                            strCatOrderValue = "" + Double.parseDouble(cursorSKUPrd.getString(10).toString());
                        } else {
                            strCatOrderValue = "" + (Double.parseDouble(strCatOrderValue) + Double.parseDouble(cursorSKUPrd.getString(10).toString()));
                        }





                        String pcsPart="0";
                        String casePart="0";
                        String locCaseConversion=(String) cursorSKUPrd.getString(4).toString();
                        if(hmapProductTblUOMMapping!=null && hmapProductTblUOMMapping.size()>0 && hmapProductTblUOMMapping.containsKey(Integer.parseInt( cursorSKUPrd.getString(0).toString())))
                        {
                            Double otqy=Double.parseDouble(locCaseConversion);
                            List<TblUOMMapping> tblUOMMappings= hmapProductTblUOMMapping.get(Integer.parseInt(cursorSKUPrd.getString(0).toString()));
                            if(otqy>=tblUOMMappings.get(0).getRelConversionUnits()) {
                                otqy = otqy / tblUOMMappings.get(0).getRelConversionUnits();
                                otqy = Double.parseDouble(new DecimalFormat("##.##").format(otqy));
                                casePart = ("" + otqy);
                                CategoryLevelcasePart = CategoryLevelcasePart + otqy;
                                // pcsPart = ("" + otqy);//.split(Pattern.quote("."))[1];
                                pcsPart = locCaseConversion;
                                CategoryLevelpcsPart = CategoryLevelpcsPart + Integer.parseInt(locCaseConversion);
                                //otqy = Double.parseDouble(new DecimalFormat("##.##").format(otqy));
                                /*if (("" + otqy).contains(".")) {
                                    casePart = ("" + otqy).split(Pattern.quote("."))[0];
                                    CategoryLevelcasePart = CategoryLevelcasePart + Integer.parseInt(casePart);
                                    pcsPart = ("" + otqy).split(Pattern.quote("."))[1];
                                    CategoryLevelpcsPart = CategoryLevelpcsPart + Integer.parseInt(pcsPart);
                                }*/
                            }
                            else
                            {
                                // otqy = Double.parseDouble(new DecimalFormat("##.##").format(otqy));
                                //if (("" + otqy).contains(".")) {

                                 pcsPart = locCaseConversion;
                                CategoryLevelpcsPart = CategoryLevelpcsPart + Integer.parseInt(locCaseConversion);
                                //}
                            }


                        }
                        String casepcstext="0";
                        if((Double.parseDouble(casePart))>0)
                        {
                            casepcstext=(Double.parseDouble(casePart)) +" Cs";
                        }
                        if((Double.parseDouble(pcsPart))>0)
                        {
                            if(casepcstext.equals("0"))
                            {
                                casepcstext =  pcsPart+ " Pc";
                            }
                            else {
                                casepcstext = casepcstext +", "+  pcsPart + " Pc";
                            }
                        }





                        String pcsPartFreeQty="0";
                        String casePartFreeQty="0";
                        String locCaseConversionFreeQty=(String) cursorSKUPrd.getString(5).toString();
                        if(hmapProductTblUOMMapping!=null && hmapProductTblUOMMapping.size()>0 && hmapProductTblUOMMapping.containsKey(Integer.parseInt( cursorSKUPrd.getString(0).toString())))
                        {
                            Double otqy=Double.parseDouble(locCaseConversionFreeQty);
                            List<TblUOMMapping> tblUOMMappings= hmapProductTblUOMMapping.get(Integer.parseInt(cursorSKUPrd.getString(0).toString()));
                            if(otqy>=tblUOMMappings.get(0).getRelConversionUnits()) {
                                otqy = otqy / tblUOMMappings.get(0).getRelConversionUnits();

                                otqy = Double.parseDouble(new DecimalFormat("##.##").format(otqy));

                                casePartFreeQty = ("" + otqy);//.split(Pattern.quote("."))[0];
                                CategoryLevelcasePartFreeQty = CategoryLevelcasePartFreeQty + otqy;//Integer.parseInt(casePartFreeQty);
                                 pcsPartFreeQty = (""+locCaseConversionFreeQty);//("" + otqy);//.split(Pattern.quote("."))[1];
                                CategoryLevelpcsPartFreeQty = CategoryLevelpcsPartFreeQty +Integer.parseInt(locCaseConversionFreeQty);// Integer.parseInt(pcsPartFreeQty);
                                /*if (("" + otqy).contains(".")) {
                                    casePartFreeQty = ("" + otqy).split(Pattern.quote("."))[0];
                                    CategoryLevelcasePartFreeQty = CategoryLevelcasePartFreeQty + Integer.parseInt(casePartFreeQty);
                                    pcsPartFreeQty = ("" + otqy).split(Pattern.quote("."))[1];
                                    CategoryLevelpcsPartFreeQty = CategoryLevelpcsPartFreeQty + Integer.parseInt(pcsPartFreeQty);
                                }*/
                            }
                            else
                            {
                                // otqy = Double.parseDouble(new DecimalFormat("##.##").format(otqy));
                                //if (("" + otqy).contains(".")) {
                                   /* casePart = ("" + otqy).split(Pattern.quote("."))[0];
                                    CategoryLevelcasePart = CategoryLevelcasePart + Integer.parseInt(casePart);*/
                                pcsPartFreeQty =locCaseConversionFreeQty;// ("" + otqy).split(Pattern.quote("."))[0];
                                CategoryLevelpcsPartFreeQty = CategoryLevelpcsPartFreeQty +Integer.parseInt(locCaseConversionFreeQty);// + Integer.parseInt(pcsPartFreeQty);
                                //}
                            }


                        }
                        String casepcstextFreeQty="0";
                        if((Double.parseDouble(casePartFreeQty))>0)
                        {
                            casepcstextFreeQty=(Double.parseDouble(casePartFreeQty)) +" Cs";
                        }
                        if((int)(Double.parseDouble(pcsPartFreeQty))>0)
                        {
                            if(casepcstextFreeQty.equals("0"))
                            {
                                casepcstextFreeQty = pcsPartFreeQty + " Pc";
                            }
                            else {
                                casepcstextFreeQty = casepcstextFreeQty +", "+ pcsPartFreeQty + " Pc";
                            }
                        }

                        hmapPrdRowDetails.put(StoreID + "_" + (String) cursorSKUPrd.getString(0).toString(), (String) cursorSKUPrd.getString(1).toString() + "^" + (String) cursorSKUPrd.getString(2).toString() + "^" + (String) cursorSKUPrd.getString(3).toString() + "^" + casepcstext + "^" + casepcstextFreeQty + "^" + (String) cursorSKUPrd.getString(6).toString() + "^" + (String) cursorSKUPrd.getString(7).toString() + "^" + (String) cursorSKUPrd.getString(8).toString() + "^" + (String) cursorSKUPrd.getString(9).toString() + "^" + (String) cursorSKUPrd.getString(10).toString() + "^" + (String) cursorSKUPrd.getString(11).toString());
                        cursorSKUPrd.moveToNext();
                    }
                }


                totalProductCategoryWiseResult.add(0, strCatDiscValue);
                totalProductCategoryWiseResult.add(1, strCatAmountBeforeTax);
                totalProductCategoryWiseResult.add(2, strCatTaxValue);
                totalProductCategoryWiseResult.add(3, strCatOrderValue);
                totalProductCategoryWiseResult.add(4, hmapPrdRowDetails);
            }


            return totalProductCategoryWiseResult;

        } finally {
            cursorSKUPrd.close();
            // close();
        }

    }

    public String[] getOrderedproductsOfBenSubBckt10(String storeId) {
        String[] productOrderedVal;
        //open();
        Cursor cursor = db.rawQuery("Select ProductID  from tblStoreProductAppliedSchemesBenifitsRecords where StoreID = '" + storeId + "' and BenSubBucketType =" + 10, null);

        if (cursor.getCount() > 0) {
            productOrderedVal = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {
                for (int i = 0; i < cursor.getCount(); i++) {
                    productOrderedVal[i] = cursor.getString(0);
                    cursor.moveToNext();
                }
            }
        } else {
            productOrderedVal = new String[1];
            productOrderedVal[0] = "No Product";
        }
        // close();

        return productOrderedVal;
    }

    public int CheckUserDoneGetStoreOrNot() {
        Cursor cursorE2 = null;
        int chkI = 0;

        try {
            //open();
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStoreList", null);

            if (cursorE2.moveToFirst()) {
                if (Integer.parseInt(cursorE2.getString(0)) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public void droptblUserAuthenticationMstrTBL() {
        db.execSQL("DROP TABLE IF EXISTS tblUserAuthenticationMstr");


    }

    public void createtblUserAuthenticationMstrTBL() {
        try {
            db.execSQL(DBHelper.TABLE_tblUserAuthenticationMstr_Definition);

        } catch (Exception e) {

        }

    }

    public long savetblUserAuthenticationMstr(String flgUserAuthenticated, String PersonName,
                                              String FlgRegistered, String flgAppStatus,
                                              String DisplayMessage, String flgValidApplication,
                                              String MessageForInvalid, String flgPersonTodaysAtt,
                                              int PersonNodeID, int PersonNodeType,
                                              String ContactNo, String DOB, String SelfieName,
                                              String SelfieNameURL, String SalesAreaName, int CoverageNodeId, int CoverageNodeType,
                                              int FlgToShowAllRoutesData, int flgDrctslsIndrctSls, String AttenDatetime, int AllowedGeofence,int SectorID,String SectorName) {

        try {
            db.delete(DBHelper.TABLE_tblUserAuthenticationMstr_Define, null, null);
        } catch (Exception e) {

        }
        ContentValues initialValues = new ContentValues();

        initialValues.put("flgUserAuthenticated", flgUserAuthenticated.trim());
        initialValues.put("PersonName", PersonName.trim());
        initialValues.put("FlgRegistered", FlgRegistered.trim());

        initialValues.put("flgPersonTodaysAtt", flgPersonTodaysAtt.trim());
        initialValues.put("PersonNodeID", PersonNodeID);
        initialValues.put("PersonNodeType", PersonNodeType);
        initialValues.put("flgToShowAllRoutesData", FlgToShowAllRoutesData);
        initialValues.put("ContactNo", ContactNo.trim());
        initialValues.put("DOB", DOB.trim());
        initialValues.put("SelfieName", SelfieName.trim());
        initialValues.put("SelfieNameURL", SelfieNameURL);
        initialValues.put("SalesAreaName", SalesAreaName);
        initialValues.put("CoverageNodeId", CoverageNodeId);
        initialValues.put("CoverageNodeType", CoverageNodeType);
        initialValues.put("flgDrctslsIndrctSls", flgDrctslsIndrctSls);
        initialValues.put("AllowedGeofence", AllowedGeofence);
        initialValues.put("AttenDatetime", AttenDatetime);
        initialValues.put("SectorID", SectorID);
        initialValues.put("SectorName", SectorName);

        return db.insert(DBHelper.TABLE_tblUserAuthenticationMstr_Define, null, initialValues);
    }

   /*public long savetblUserAuthenticationMstr(String flgUserAuthenticated,String PersonName,
                                              String FlgRegistered,String PersonNodeID,String PersonNodeType,
                                              String flgPersonTodaysAtt)
    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("flgUserAuthenticated", flgUserAuthenticated.trim());
        initialValues.put("PersonName", PersonName.trim());
        initialValues.put("FlgRegistered", FlgRegistered.trim());
        initialValues.put("PersonNodeID", PersonNodeID.trim());
        initialValues.put("PersonNodeType", PersonNodeType.trim());
        initialValues.put("flgPersonTodaysAtt", flgPersonTodaysAtt.trim());



        // System.out.println("Data Insert in Table MAIN1User");

        return db.insert(TABLE_tblUserAuthenticationMstr_Define, null, initialValues);
    }*/

    public void savetblBloodGroup(List<TblBloodGroup> tblBloodGroup) {
        try {
            db.beginTransaction();
            String sql = "INSERT INTO " + DBHelper.TABLE_tblBloodGroup_Define +
                    " (BloddGroups) VALUES (?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblBloodGroup tbl : tblBloodGroup) {
                stmt.bindString(1, tbl.getBloddGroups());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }

//        ContentValues initialValues = new ContentValues();
//        initialValues.put("BloddGroups", BloddGroups.trim());
        // System.out.println("Data Insert in Table MAIN1User");
//        return db.insert(DBHelper.TABLE_tblBloodGroup_Define, null, initialValues);
    }


    public LinkedHashMap<String, String> fnGettblBloodGroup() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT BloddGroups from tblBloodGroup   ", null);// Where PNodeID='"+TSIID+"'
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(0).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            //close();
            return hmapQuestionMstr;
        }
    }

   /*public String fnGetPersonNameAndFlgRegistered()
    {
        String PersonNameAndFlgRegistered="0";
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT  PersonName,  FlgRegistered from tblUserAuthenticationMstr   ", null);// Where PNodeID='"+TSIID+"'
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst())
                {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        PersonNameAndFlgRegistered=(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString();

                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }

                }
            }

        }
        catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= "+e.toString());
        }
        finally
        {

            close();
            return PersonNameAndFlgRegistered;
        }
    }*/

    public String fnGetPersonNameAndFlgRegistered() {
        String PersonNameAndFlgRegistered = "0";
        // open();

        try {


            Cursor cursor = db.rawQuery("SELECT  PersonName,FlgRegistered,ContactNo,DOB,SelfieName,SelfieNameURL,SalesAreaName,PersonNodeID,PersonNodeType from tblUserAuthenticationMstr   ", null);// Where PNodeID='"+TSIID+"'
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        PersonNameAndFlgRegistered = (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString() + "^" + (String) cursor.getString(3).toString() + "^" + (String) cursor.getString(4).toString() + "^" + (String) cursor.getString(5).toString() + "^" + (String) cursor.getString(6).toString() + "^" + (String) cursor.getString(7).toString() + "^" + (String) cursor.getString(8).toString();

                        cursor.moveToNext();
                    }

                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            //close();
            return PersonNameAndFlgRegistered;
        }
    }

    public String fnGettblUserRegistarationStatus() {
        String PersonNameAndFlgRegistered = "0";
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT  Flag,  MsgToDisplay from tblUserRegistarationStatus   ", null);// Where PNodeID='"+TSIID+"'
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String msg = (String) cursor.getString(1).toString();
                        if (msg.trim().equals("")) {
                            msg = "0";
                        }
                        PersonNameAndFlgRegistered = (String) cursor.getString(0).toString() + "^" + msg;

                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }

                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();
            return PersonNameAndFlgRegistered;
        }
    }

    public void savetblEducationQuali(List<TblEducationQuali> tblEducationQuali) {
//    public long savetblEducationQuali(String Qualification) {
        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_tblEducationQuali + " (Qualification) VALUES (?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblEducationQuali tbl : tblEducationQuali) {
                stmt.bindString(1, tbl.getQualification());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
//        ContentValues initialValues = new ContentValues();
//        initialValues.put("Qualification", Qualification.trim());
//        // System.out.println("Data Insert in Table MAIN1User");
//        return db.insert(DBHelper.TABLE_tblEducationQuali, null, initialValues);
    }


    public int fngetcounttblDsrRegDetails() {
        int flgCheck = 0;
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT Count(*) from tblDsrRegDetails  ", null);
            //StoreID,StoreName,LatCode,LongCode,DateAdded
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (cursor.getInt(0) > 0) {
                        flgCheck = 1;
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();
            return flgCheck;
        }
    }

    public LinkedHashMap<String, String> fnGettblDsrRegDetails() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();

        try {                                   //0             1                         2                      3                         4           5             6              7                         8                9                           10                    11                12                   13                 14                 15                        16           17                      18
            Cursor cursor = db.rawQuery("SELECT IFNULL(PDACode,0),IFNULL(ClickedDateTime,0),IFNULL(FirstName,0),IFNULL(LastName,0),IFNULL(ContactNo,0),IFNULL(DOB,0),IFNULL(Sex,0),IFNULL(MaritalStatus,0),IFNULL(MarriedDate,0),IFNULL(Qualification,0),IFNULL(SelfieName,0),IFNULL(SelfiePath,0),IFNULL(EmailID,0),IFNULL(BloodGroup,0),IFNULL(SignName,0),IFNULL(SignPath,0),IFNULL(PhotoName,0),IFNULL(PersonNodeId,0),IFNULL(PersonNodeType,0) from tblDsrRegDetails   ", null);// Where PNodeID='"+TSIID+"'
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put("DSRDETAILS", (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString() + "^" + (String) cursor.getString(3).toString() + "^" + (String) cursor.getString(4).toString() + "^" + (String) cursor.getString(5).toString() + "^" + (String) cursor.getString(6).toString() + "^" + (String) cursor.getString(7).toString() + "^" + (String) cursor.getString(8).toString() + "^" + (String) cursor.getString(9).toString() + "^" + (String) cursor.getString(10).toString() + "^" + (String) cursor.getString(11).toString() + "^" + (String) cursor.getString(12).toString() + "^" + (String) cursor.getString(13).toString() + "^" + (String) cursor.getString(14).toString() + "^" + (String) cursor.getString(15).toString() + "^" + (String) cursor.getString(16).toString() + "^" + (String) cursor.getString(17).toString() + "^" + (String) cursor.getString(18).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();
            return hmapQuestionMstr;
        }
    }

    public LinkedHashMap<String, String> fnGettblEducationQuali() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT Qualification from tblEducationQuali   ", null);// Where PNodeID='"+TSIID+"'
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(0).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            //  close();
            return hmapQuestionMstr;
        }
    }

    public int FetchflgUserAuthenticated() {
        int SnamecolumnIndex1 = 0;
        int CatId = -1;

        Cursor cursor = db.rawQuery("SELECT flgUserAuthenticated from tblUserAuthenticationMstr", null);
        try {

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    String abc = (String) cursor.getString(SnamecolumnIndex1).toString();
                    CatId = Integer.parseInt(abc);
                    cursor.moveToNext();
                }

            }
            return CatId;
        } finally {
            cursor.close();
        }

    }

    public boolean isFreeProductIdExist(int freeProductId) {


        //open();
        Cursor cur = db.rawQuery("Select ProductID from tblStoreProductAppliedSchemesBenifitsRecords where freeProductId =" + freeProductId, null);
        try {


            if (cur.getCount() > 0) {
                return true;
            } else {
                return false;
            }
        } finally {
            cur.close();
            // close();

        }


    }

    public String getFreeProductIdAgainstFreeProductId(int freeProductId) {

        String productIdAgainstFreeProductId = null;
        //open();
        Cursor cur = db.rawQuery("Select ProductID from tblStoreProductAppliedSchemesBenifitsRecords where freeProductId =" + freeProductId, null);
        try {


            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    productIdAgainstFreeProductId = cur.getString(0);
                }

            } else {
                productIdAgainstFreeProductId = "";
            }
        } finally {
            cur.close();
            // close();

        }

        return productIdAgainstFreeProductId;

    }

    public String[] fectStatusIfBeniftRowIdExistsInSchemeSlabBenefitsValueDetailWithoutMultiply(int BenifitRowID, int toMultiply, Double defaultValue, int BenSubBucketType) {

        //open();
        Cursor cursor2 = db.rawQuery("SELECT BenValue FROM tblSchemeSlabBenefitsValueDetail where RowID=" + BenifitRowID, null);
        if (BenSubBucketType == 2 || BenSubBucketType == 6 || BenSubBucketType == 8) {
            toMultiply = 1;
        }
        //////////// System.out.println("SELECT Sum(flgIsStrachApplicable) FROM tblStrachApplicableOnScheme");
        String[] chkI;
        try {
            if (cursor2.getCount() > 0) {
                chkI = new String[cursor2.getCount() + 1];
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (i == 0) {
                            chkI[i] = String.valueOf(defaultValue);

                        }

                        chkI[i + 1] = String.valueOf((Integer.parseInt(cursor2.getString(0))));

                        cursor2.moveToNext();
                    }

                }
            } else {
                chkI = new String[1];
                chkI[0] = String.valueOf(defaultValue);
            }

        } finally {
            cursor2.close();
            // close();
        }
        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;
    }

    public void deleteAlrtProduct(String storeId, String _productID) {
        //open();
        Cursor cur = db.rawQuery("Select ProductID from tblAlrtVal where StoreId ='" + storeId + "' and ProductID = '" + _productID + "'", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.DATABASE_TABLE_Main214, "StoreID=? AND ProductID=? ", new String[]{storeId, _productID});
        }

        // close();
    }

    public int checkStoreListTableCount() {

        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblStoreList ", null);

        try {

            int check = 0;

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    check = cursor.getCount();
			                 /* for (int i = 0; i <= (cursor.getCount() - 1); i++)
								{
									check=1;
									cursor.moveToNext();
								}*/
                }

            }
            return check;

        } finally {
            cursor.close();
        }

    }


    public void deletetblStoreTypeMstr() {
        db.execSQL("DELETE FROM tblStoreTypeMstr");
    }

    public void deletetblTradeChannelMstr() {
        db.execSQL("DELETE FROM tblTradeChannelMstr");
    }

    public void deletetblDayStartAttendanceOptions() {
        db.execSQL("DELETE FROM tblDayStartAttendanceOptions");
    }

    public void deletetblStoreProductClassificationTypeListMstr() {
        db.execSQL("DELETE FROM tblStoreProductClassificationTypeListMstr");
    }

    public void updatetblAvailableVersionMstr(String ServerDate) {


        db.execSQL("Update tblAvailableVersion Set  ServerDate='" + ServerDate + "'");

    }

    public int checkRouteIDExistInStoreListTable() {
        int check = 0;
        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblInvoiceButtonTransac WHERE Sstat=9", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (cursor.getInt(0) > 0) {
                        check = 1;
                    }
                }
            }
            return check;
        } finally {
            cursor.close();
        }

    }


    public long savetblOutletChannelBusinessSegmentMaster(int OutChannelID, String ChannelName, int BusinessSegmentID, String BusinessSegment) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("OutChannelID", OutChannelID);
        initialValues.put("ChannelName", ChannelName);

        initialValues.put("BusinessSegmentID", BusinessSegmentID);
        initialValues.put("BusinessSegment", BusinessSegment);

        return db.insert(DBHelper.TABLE_OutletChannelBusinessSegmentMaster, null, initialValues);
    }


    public StringBuilder fnQuestionIdOnBasisOfDependentQuestionIDdpndntId(String dpndntQuesId, String optionId) {

        String value;
        //open();
        //tblGetPDAQuestionDependentMstr(QuestionID int null,OptionID int null,DependentQuestionID int null,GrpID int null,GrpDepQuestID int null);";
        Cursor cursor = db.rawQuery("SELECT GrpID from tblGetPDAQuestionDependentMstr where GrpDepQuestID = '" + dpndntQuesId + "' And OptionID = '" + optionId + "'", null);// Where PNodeID='"+TSIID+"'
        StringBuilder arrbhi = new StringBuilder();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        // hmapDpndntQuestionMstr.put((String) cursor.getString(3).toString()+"^"+(String) cursor.getString(1).toString(), (String) cursor.getString(2).toString());
                        if (i == 0) {
                            arrbhi.append(cursor.getString(0).toString());
                        } else {
                            arrbhi.append("^").append(cursor.getString(0).toString());
                        }

                        cursor.moveToNext();
                    }
                }
            }

            return arrbhi;
        } finally {
            cursor.close();
            // close();
        }
    }

    public String[] fnQuestionIdDpndnt() {

        String value;
        //open();

        Cursor cursor = db.rawQuery("SELECT QuestionID from tblGetPDAQuestionDependentMstr", null);// Where PNodeID='"+TSIID+"'
        String[] arrbhi = new String[cursor.getCount()];
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        // hmapDpndntQuestionMstr.put((String) cursor.getString(3).toString()+"^"+(String) cursor.getString(1).toString(), (String) cursor.getString(2).toString());
                        arrbhi[i] = (cursor.getString(0).toString());


                        cursor.moveToNext();
                    }
                }
            }

            return arrbhi;
        } finally {
            cursor.close();
            //close();
        }
    }

    public int fnGetAnsValFromOptionID(int optionID) {
        //open();
        int AnsVal = 0;
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestOptionMstr.OptionNo from tblGetPDAQuestOptionMstr Where tblGetPDAQuestOptionMstr.OptID='" + optionID + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    AnsVal = Integer.parseInt(cursor.getString(0).toString());
                }
            }
            return AnsVal;
        } finally {
            cursor.close();
            //close();
        }
    }

    public void saveOutletQuestAnsMstr(ArrayList<ArrayList<String>> outletQuestAnsVal) {

        //open();

        String OutletID, QuestID, AnswerType, AnswerValue;
        for (int i = 0; i < outletQuestAnsVal.size(); i++) {
            ArrayList<String> outletsDetailValue = outletQuestAnsVal.get(i);

            OutletID = outletsDetailValue.get(0);
            QuestID = outletsDetailValue.get(1);
            AnswerType = outletsDetailValue.get(2);
            AnswerValue = outletsDetailValue.get(3);

            Cursor cursor = db.rawQuery("SELECT OutletID FROM tblOutletQuestAnsMstr where OutletID='" + OutletID + "' and QuestID ='" + QuestID + "'", null);
            ContentValues initialValues = new ContentValues();
            System.out.println("SavingPartCompleted =" + OutletID + ":" + QuestID + ":" + AnswerType + ":" + AnswerValue);

            initialValues.put("AnswerType", Integer.parseInt(AnswerType));


            initialValues.put("AnswerValue", AnswerValue.trim());
            initialValues.put("Sstat", 1);


            if (cursor.getCount() > 0) {

                int affected = db.update("tblOutletQuestAnsMstr", initialValues, "OutletID=? AND QuestID=?",
                        new String[]{OutletID.toString().trim(), QuestID.toString().trim()});
            } else {

                initialValues.put("QuestID", Integer.parseInt(QuestID));
                initialValues.put("OutletID", OutletID.toString().trim());

                db.insert("DBHelper.TABLE_OutletQuestAnsMstr", null, initialValues);
            }


        }

        // close();

    }


		  	/*public static long savetblGetPDAQuestMstr(String QuestID,String QuestCode,String QuestDesc,String QuestType,String AnsControlType,String AnsControlInputTypeID,String AnsControlInputTypeMaxLength,String AnsMustRequiredFlg,String QuestBundleFlg,String ApplicationTypeID,String Sequence,String AnsControlInputTypeMinLength,int flgQuestIDForOutChannel)
		    {

		         ContentValues initialValues = new ContentValues();

		         initialValues.put("QuestCode", Integer.parseInt(QuestCode));
		         initialValues.put("QuestID", Integer.parseInt(QuestID));

		         initialValues.put("QuestDesc", QuestDesc.trim());
		         initialValues.put("QuestType", Integer.parseInt(QuestType));
		         initialValues.put("AnsControlType", Integer.parseInt(AnsControlType));
		         initialValues.put("AnsControlInputTypeID", Integer.parseInt(AnsControlInputTypeID));
		         initialValues.put("AnsControlInputTypeMaxLength", Integer.parseInt(AnsControlInputTypeMaxLength));
		         initialValues.put("AnsMustRequiredFlg", Integer.parseInt(AnsMustRequiredFlg));
		         initialValues.put("QuestBundleFlg", Integer.parseInt(QuestBundleFlg));
		         initialValues.put("ApplicationTypeID", Integer.parseInt(ApplicationTypeID));
		         initialValues.put("Sequence", Integer.parseInt(Sequence));//AnsControlInputTypeMinLength
		         initialValues.put("flgQuestIDForOutChannel", flgQuestIDForOutChannel);
		        // initialValues.put("AnsControlInputTypeMinLength", Integer.parseInt(AnsControlInputTypeMinLength));


		      return db.insert(TABLE_QuestionMstr, null, initialValues);
		    }*/

    public void saveViewOutletQuestAnsMstr(ArrayList<ArrayList<String>> outletQuestAnsVal) {

        //open();

        String OutletID, QuestID, AnswerType, AnswerValue;
        for (int i = 0; i < outletQuestAnsVal.size(); i++) {
            ArrayList<String> outletsDetailValue = outletQuestAnsVal.get(i);

            OutletID = outletsDetailValue.get(0);
            QuestID = outletsDetailValue.get(1);
            AnswerType = outletsDetailValue.get(2);
            AnswerValue = outletsDetailValue.get(3);
            Cursor cursor = db.rawQuery("SELECT OutletID FROM tblViewOutletQuestAnsMstr where OutletID='" + OutletID + "' and QuestID ='" + QuestID + "'", null);
            ContentValues initialValues = new ContentValues();
            System.out.println("SavingPartCompleted =" + OutletID + ":" + QuestID + ":" + AnswerType + ":" + AnswerValue);


            initialValues.put("AnswerType", Integer.parseInt(AnswerType));


            initialValues.put("AnswerValue", AnswerValue.trim());

            if (cursor.getCount() > 0) {

                int affected = db.update("tblViewOutletQuestAnsMstr", initialValues, "OutletID=? AND QuestID=?",
                        new String[]{OutletID.toString().trim(), QuestID.toString().trim()});
            } else {
                initialValues.put("QuestID", Integer.parseInt(QuestID));
                initialValues.put("OutletID", OutletID.toString().trim());

                db.insert(DBHelper.TABLE_ViewOutletQuestAnsMstr, null, initialValues);
            }


        }

        // close();

    }

    public void saveViewOutletNameAndId(String outletId, String outletName) {

        //open();


        Cursor cursor = db.rawQuery("SELECT OutletID FROM tblViewOutletNameAndId where OutletID='" + outletId + "'", null);
        ContentValues initialValues = new ContentValues();


        initialValues.put("OutletName", outletName.toString().trim());


        if (cursor.getCount() > 0) {
            int affected = db.update("tblViewOutletNameAndId", initialValues, "OutletID=?",
                    new String[]{outletId.toString().trim()});
        } else {
            initialValues.put("OutletID", outletId.toString().trim());
            db.insert(DBHelper.TABLE_ViewOutletNameAndId, null, initialValues);
        }


        //  close();

    }

    public LinkedHashMap<String, String> getAllNewAddedStoreName() {
        LinkedHashMap<String, String> lnkdHmapAllNewAddedStore = new LinkedHashMap<String, String>();

        //open();

        Cursor cur = db.rawQuery("Select * from tblViewOutletNameAndId", null);
        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                for (int i = 0; i < cur.getCount(); i++) {
                    lnkdHmapAllNewAddedStore.put(cur.getString(0), cur.getString(1));
                    cur.moveToNext();
                }
            }
        }
        // close();
        return lnkdHmapAllNewAddedStore;
    }

    public LinkedHashMap<String, String> getAllQuesSavedForOutlet(String outletId) {
        LinkedHashMap<String, String> lnkdHmapAllQuesSavedForOutlet = new LinkedHashMap<String, String>();

        //open();

        Cursor cur = db.rawQuery("Select * from tblViewOutletQuestAnsMstr where OutletID = '" + outletId + "'", null);
        if (cur.getCount() > 0) {
//OutletID ,QuestID ,AnswerType , AnswerValue );";
            if (cur.moveToFirst()) {
                for (int i = 0; i < cur.getCount(); i++) {
                    lnkdHmapAllQuesSavedForOutlet.put(cur.getString(1) + "^" + cur.getString(2), cur.getString(3));
                    cur.moveToNext();
                }
            }
        }
        //  close();
        return lnkdHmapAllQuesSavedForOutlet;
    }

    public long savedataStoreList(String StoreID, String VisitDateTime, String ActualLatitude, String ActualLongitude, String LocProvider, String Accuracy, String BateryLeftStatus, String StoreName, int ISNewStore,
                                  int Sstat) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("OutletID", StoreID.trim());
        initialValues.put("VisitDateTime", VisitDateTime.trim());

        initialValues.put("ActualLatitude", ActualLatitude);
        initialValues.put("ActualLongitude", ActualLongitude);
        initialValues.put("LocProvider", LocProvider);
        initialValues.put("Accuracy", Accuracy);
        initialValues.put("BateryLeftStatus", BateryLeftStatus);
        initialValues.put("StoreName", StoreName.trim());
        initialValues.put("ISNewStore", ISNewStore);
        initialValues.put("Sstat", Sstat);

        ////System.out.println("inserting records in StoreList table..");

        return db.insert(DBHelper.DATABASE_CREATE_TABLE_tblOutletMstr, null, initialValues);
    }


    //

    public String[] getStoreIDTblSelectedStoreIDinChangeRouteCaseStoreMapping() {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT DISTINCT(OutletID) FROM tblOutletPhotoDetail where Sstat=3", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    System.out.println("STORE ID 4 Pic: " + cursor.getString(SnamecolumnIndex1).toString());

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public int getExistingPicNosStoreMapping(String OutId) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(OutletID) FROM tblOutletPhotoDetail where OutletID='" + OutId + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public String[] getImgsPath(String StoreID) {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT PhotoName FROM tblStoreMaterialPhotoDetail WHERE StoreID ='" + StoreID + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public String[] getImgsPathAttendance() {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT SelfieName FROM tblAttandanceDetails", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public void updatexmlSyncdData() {
        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected = db.update("tblOutletMstr", values, "Sstat=?",
                    new String[]{"3"});
            int affected2 = db.update("tblOutletQuestAnsMstr", values, "Sstat=?",
                    new String[]{"3"});

        } catch (Exception ex) {

        }

    }


			/*public void updateRecordsSyncd()
				{
				 try
					{

	                    final ContentValues values = new ContentValues();
						values.put("Sstat", "4");
						int affected = db.update("tblOutletMstr", values, "Sstat=?",
								new String[] { "3" });
						int affected2 = db.update("tblOutletQuestAnsMstr", values, "Sstat=?",
								new String[] { "3" });
						int affected3 = db.update("tblOutletPhotoDetail", values, "Sstat=?",
								new String[] { "3" });

					}
					catch (Exception ex)
					{

					}

				}*/

    public void updatePhotoSyncdData() {
        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected3 = db.update("tblOutletPhotoDetail", values, "Sstat=?",
                    new String[]{"3"});

        } catch (Exception ex) {

        }

    }

    public void deletetblOutletPhotoDetailBasedOutletID(String OutletID) {
        //open();


        db.execSQL("DELETE FROM tblOutletPhotoDetail WHERE OutletID ='" + OutletID + "'");


        // close();
    }

    public long savetblOutletMstr(String OutletID, String VisitDateTime, String ActualLatitude,
                                  String ActualLongitude, String LocProvider, String Accuracy, String BateryLeftStatus, String StoreName,
                                  int ISNewStore, int Sstat) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("OutletID", OutletID);
        initialValues.put("VisitDateTime", VisitDateTime);

        initialValues.put("ActualLatitude", ActualLatitude);
        initialValues.put("ActualLongitude", ActualLongitude);
        initialValues.put("LocProvider", LocProvider);
        initialValues.put("Accuracy", Accuracy);
        initialValues.put("BateryLeftStatus", BateryLeftStatus);
        initialValues.put("StoreName", StoreName);
        initialValues.put("ISNewStore", ISNewStore);
        initialValues.put("Sstat", Sstat);


        return db.insert(DBHelper.TABLE_OutletMstr, null, initialValues);
    }



			/* private static final String DATABASE_CREATE_TABLE_tblOutletMstr = "create table tblOutletMstr" +
			 		" (OutletID text not null,VisitDateTime string not null,Sstat integer not null,ActualLatitude text null," +
			 		" ActualLongitude text null, ISNewStore int null, LocProvider text null, Accuracy text null," +
			 		" BateryLeftStatus text null,String StoreName);";
			 */

    public long insertPhotoDetail(String OutletID, String ClickedDateTime, String PhotoName,
                                  String PhotoComment, String PDAPhotoPath, int Sstat) {

        //open();
        ContentValues initialValues = new ContentValues();

        initialValues.put("OutletID", OutletID.trim());
        initialValues.put("ClickedDateTime", ClickedDateTime.trim());
        initialValues.put("PhotoName", PhotoName.trim());
        initialValues.put("PhotoComment", PhotoComment.trim());

        initialValues.put("PDAPhotoPath", PDAPhotoPath.trim());
        initialValues.put("Sstat", Sstat);

        long inserted = db.insert(DBHelper.TABLE_StoreProductPhotoDetail, null, initialValues);
        //   close();
        return inserted;
    }


				/*private static final String DATABASE_CREATE_TABLE_OutletPhotoDetail = "create table tblOutletPhotoDetail" +
						"(OutletID text null,ClickedDateTime text null,PhotoName text null,PhotoComment text null," +
						"PDAPhotoPath text null,Sstat integer null);";*/

    public String[] deletFromSDcCardPhotoValidationBasedSstat(String Sstat) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  PhotoName from tblStoreProductPhotoDetail where Sstat='" + Sstat + "'", null);
        try {
            if (cursor.getCount() > 0) {
                imageNameToBeDeleted = new String[cursor.getCount()];
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        imageNameToBeDeleted[i] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            } else {
                imageNameToBeDeleted = new String[1];
                imageNameToBeDeleted[0] = "No Data";
            }
        } finally {
            cursor.close();
            //  close();
        }


        return imageNameToBeDeleted;
    }

    public String[] deletFromtableImageBasedSstat(String Sstat) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  imageName from tableImage where Sstat='" + Sstat + "'", null);
        try {
            if (cursor.getCount() > 0) {
                imageNameToBeDeleted = new String[cursor.getCount()];
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        imageNameToBeDeleted[i] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            } else {
                imageNameToBeDeleted = new String[1];
                imageNameToBeDeleted[0] = "No Data";
            }
        } finally {
            cursor.close();
            // close();
        }


        return imageNameToBeDeleted;
    }

    public String[] deletFromSDcCardPhotoValidationNewStore(String OutletID) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  PhotoName from tblOutletPhotoDetail where OutletID='" + OutletID + "'", null);
        try {
            if (cursor.getCount() > 0) {
                imageNameToBeDeleted = new String[cursor.getCount()];
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        imageNameToBeDeleted[i] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            } else {
                imageNameToBeDeleted = new String[1];
                imageNameToBeDeleted[0] = "No Data";
            }
        } finally {
            cursor.close();
            // close();
        }


        return imageNameToBeDeleted;
    }

    public long inserttblOutletMstr(String OutletID, String VisitStartTS, String ActualLatitude,
                                    String ActualLongitude, String Accuracy, String LocProvider, String BateryLeftStatus, String StoreName,
                                    String imei, int ISNewStore, int Sstat, int AppVersion) {

        //open();
        ContentValues initialValues = new ContentValues();

        initialValues.put("OutletID", OutletID.trim());
        initialValues.put("VisitStartTS", VisitStartTS.trim());

        initialValues.put("ActualLatitude", ActualLatitude.trim());
        initialValues.put("ActualLongitude", ActualLongitude.trim());


        initialValues.put("Accuracy", Accuracy.trim());
        initialValues.put("LocProvider", LocProvider.trim());
        initialValues.put("BateryLeftStatus", BateryLeftStatus.trim());
        initialValues.put("StoreName", StoreName.trim());
        initialValues.put("PDACode", imei.trim());

        initialValues.put("ISNewStore", 1);
        initialValues.put("Sstat", Sstat);
        initialValues.put("AppVersion", AppVersion);

        System.out.println("Data insert in OutletMstr");

        long inserted = db.insert(DBHelper.TABLE_OutletMstr, null, initialValues);
        // close();
        return inserted;
    }


				 /*private static final String DATABASE_CREATE_TABLE_tblOutletMstr = "create table tblOutletMstr " +
				 		"(OutletID text not null,VisitDateTime string not null,Sstat integer not null,ActualLatitude text null, " +
				 		"ActualLongitude text null, ISNewStore int null, LocProvider text null, Accuracy text null," +
				 		" BateryLeftStatus text null,String StoreName);";*/

    public void UpdateStoreEndVisitNewStore(String OutletID, String VisitEndTS) { //open();
        final ContentValues values = new ContentValues();

        values.put("VisitEndTS", VisitEndTS);

        int affected = db.update("tblOutletMstr", values, "OutletID=? and VisitStartTS is not null",
                new String[]{OutletID});
        // close();

    }

    public int counttblContainNotSyncData(int Sstat) {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblOutletMstr WHERE Sstat =" + Sstat, null);
        int chkI = 0;
        try {

            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }


    // static final String DATABASE_CREATE_TABLE_tblOutletMstr = "create table tblOutletMstr (OutletID text not null,VisitDateTime text not null,ActualLatitude text null, ActualLongitude text null, LocProvider text null, Accuracy text null, BateryLeftStatus text null,StoreName text null,token text null, ISNewStore int null,Sstat integer not null);";

    public int fetch_Store_invoiceCount() {

        //open();
        int invoiceCount = 0;


        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblInvoiceHeader", null); //order by AutoIdOutlet Desc

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    invoiceCount = cursor.getCount();


                }
            }

            return invoiceCount;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }

    public LinkedHashMap<String, String> fetch_StoreInvoiceWiseData_List() {
        int incoiceCount = fetch_Store_invoiceCount();

        //open();
        LinkedHashMap<String, String> hmapInvoiceCaptionPrefixAndSuffix = fetch_InvoiceCaptionPrefixAndSuffix();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();


        Cursor cursor = db.rawQuery("SELECT tblInvoiceHeader.StoreID, tblStoreList.StoreName,IFNULL(tblInvoiceHeader.InvoiceVal,0),tblInvoiceHeader.InvoiceNumber FROM tblInvoiceHeader inner join tblStoreList on tblInvoiceHeader.StoreID=tblStoreList.StoreID WHERE tblInvoiceHeader.StoreID=tblStoreList.StoreID AND  tblInvoiceHeader.Sstat=3 OR tblInvoiceHeader.Sstat=4 OR tblInvoiceHeader.Sstat=5 OR tblInvoiceHeader.Sstat=6", null); //order by AutoIdOutlet Desc

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapCatgry.put((i + 1) + ")  " + cursor.getString(1).toString() + " [ Invoice Number:->" + hmapInvoiceCaptionPrefixAndSuffix.get("INVPrefix") + "-" + cursor.getString(3).toString() + "/" + hmapInvoiceCaptionPrefixAndSuffix.get("INVSuffix") + " ]" + " [ Invoice Value:->" + cursor.getString(2).toString() + " ]", cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }
            } else {
                hmapCatgry.put("No Submitted Invoices", "0");
            }
            return hmapCatgry;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }
    }

    public long savetblMessageTextFileContainer(String FileName, int FileFlag) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("FileName", FileName);
        initialValues.put("FileFlag", FileFlag);

        System.out.println("inserting records in DATABASE_CREATE_TABLE_2..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN251, null, initialValues);
    }

    public long savetblNoVisitStoreDetails(String IMEI, String CurDate, String ReasonId, String ReasonDescr, int flgHasVisit, int Sstat) {
        //open();

        ContentValues initialValues = new ContentValues();

        initialValues.put("PDACode", IMEI);
        initialValues.put("CurDate", CurDate);
        initialValues.put("ReasonId", ReasonId);
        initialValues.put("ReasonDescr", ReasonDescr);
        initialValues.put("flgHasVisit", flgHasVisit);
        initialValues.put("Sstat", Sstat);


        long inserted = db.insert(DBHelper.TABLE_tblNoVisitStoreDetails_Define, null, initialValues);
        //close();
        return inserted;
    }




					/*private static final String DATABASE_CREATE_TABLE_253 = "create table tblNoVisitStoreDetails " +
							"(IMEI text null,CurDate text null,ReasonId text null,ReasonDescr text null,flgHasVisit " +
							"integer null,Sstat integer null);";*/

					/* private static final String DATABASE_CREATE_TABLE_253 = "create table tblNoVisitStoreDetails(IMEI text null,CurDate text null," +
					 		"ReasonId text null,ReasonDescr text null,flgHasVisit integer null,Sstat integer null);";*/

    public void deletetblNoVisitStoreDetails() {
        db.execSQL("DELETE FROM tblNoVisitStoreDetails");
    }

    public void updateCurDatetblNoVisitStoreDetails(String CurDate) {
        //open();
        try {

            final ContentValues values = new ContentValues();
            values.put("CurDate", CurDate);
            int affected3 = db.update("tblNoVisitStoreDetails", values, "CurDate=?", new String[]{"NA"});

        } catch (Exception ex) {

        } finally {
            // close();
        }

    }

    public void updateReason(String storeId, String productId, String reason) {
        //"create table tblStoreProductPhotoDetail (StoreID text null,ProductID text null,ClickedDateTime text null,PhotoName text null,ReasonForReturn text null,PhotoValidation text null,PDAPhotoPath text null,Sstat integer null,OrderIDPDA text null);";
        Cursor cur = db.rawQuery("Select ReasonForReturn from tblStoreProductPhotoDetail where StoreID='" + storeId + "' AND ProductID='" + productId + "'", null);
        if (cur.getCount() > 0) {
            ContentValues values = new ContentValues();
            values.put("ReasonForReturn", reason);
            db.update(DBHelper.DATABASE_TABLE_Main212, values, "StoreID=? AND ProductID=?", new String[]{storeId, productId});
        }

    }

    public void updateReasonIdAndDescrtblNoVisitStoreDetails(String ReasonId, String ReasonDescr) {
        //open();
        try {

            final ContentValues values = new ContentValues();
            values.put("ReasonId", ReasonId);
            values.put("ReasonDescr", ReasonDescr);
            int affected3 = db.update("tblNoVisitStoreDetails", values, "ReasonId=?",
                    new String[]{"0"});

        } catch (Exception ex) {

        } finally {
            // close();
        }

    }

    public void updateSstattblNoVisitStoreDetails(int Sstat) {
        //open();
        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", Sstat);
            int affected32 = db.update("tblNoVisitStoreDetails", values, "Sstat=?",
                    new String[]{"0"});

        } catch (Exception ex) {

        } finally {
            // close();
        }

    }

    public void updateSstattblNoVisitStoreDetailsAfterSync(int Sstat) {
        //open();
        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", Sstat);
            int affected32 = db.update("tblNoVisitStoreDetails", values, "Sstat=?",
                    new String[]{"3"});

        } catch (Exception ex) {

        } finally {
            // close();
        }

    }

    public int fetchflgHasVisitFromtblNoVisitStoreDetails(String Sstat) {

        int flag = 0;
        //open();

        Cursor cursor = db.rawQuery("SELECT  flgHasVisit from tblNoVisitStoreDetails where Sstat='" + Sstat + "' or Sstat='" + 3 + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        flag = Integer.parseInt(cursor.getString(0));
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            cursor.close();
            // close();
        }
        return flag;
    }

    public int countDataIntblNoVisitStoreDetails() throws IOException {
        int chkI = 0;
        //open();

        Cursor cursorE2 = db.rawQuery("SELECT Count(*) from tblNoVisitStoreDetails where Sstat=3", null);

        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }

    public String[] fnGetALLDataInfo() {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT * FROM  tblNoVisitStoreDetails", null);
        String AllProductInSlab[] = new String[cursorE2.getCount()];

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllProductInSlab[i] = (String) cursorE2.getString(0).toString() + "^" + (String) cursorE2.getString(1).toString() + "^" + (String) cursorE2.getString(2).toString() + "^" + (String) cursorE2.getString(3).toString() + "^" + (String) cursorE2.getString(4).toString() + "^" + (String) cursorE2.getString(5).toString();
                        cursorE2.moveToNext();

                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            // close();
        }

    }

    public int countDataIntblDayStartAttendanceOptions() throws IOException {
        int chkI = 0;
        //open();

        Cursor cursorE2 = db.rawQuery("SELECT Count(*) from tblDayStartAttendanceOptions", null);

        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
            //  close();
        }
        return chkI;
    }

  /* public long savetblDayStartAttendanceOptions(int AutoIdStore,String ReasonId,String ReasonDescr,int FlgToShowTextBox)
    {

        ContentValues initialValues = new ContentValues();
        initialValues.put("AutoIdStore", AutoIdStore);
        initialValues.put("ReasonId", ReasonId);
        initialValues.put("ReasonDescr", ReasonDescr.trim());
        initialValues.put("FlgToShowTextBox", FlgToShowTextBox);

        //// System.out.println("Arjun data insert properly tblTradeChannelMstr ");
        return db.insert(TABLE_tblDayStartAttendanceOptions_Define, null, initialValues);
    }*/

    public void savetblDayStartAttendanceOptions(List<TblDayStartAttendanceOption> tblDayStartAttendanceOption) {
/*
    public long savetblDayStartAttendanceOptions(int AutoIdStore, String ReasonId, String ReasonDescr,
                                                 int FlgToShowTextBox, int flgSOApplicable, int flgDSRApplicable,
                                                 int flgNoVisitOption, int SeqNo, int flgDelayedReason, int flgMarketVisit) {*/

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_tblDayStartAttendanceOptions_Define +
                    " (AutoIdStore, ReasonId, ReasonDescr, FlgToShowTextBox, flgSOApplicable, flgDSRApplicable, flgNoVisitOption, flgDelayedReason, SeqNo, flgMarketVisit) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            int i = 1;
            for (TblDayStartAttendanceOption dayStartAttendanceOption : tblDayStartAttendanceOption) {
                stmt.bindLong(1, i++);
                stmt.bindLong(2, dayStartAttendanceOption.getReasonId());
                stmt.bindString(3, dayStartAttendanceOption.getReasonDescr());
                stmt.bindLong(4, dayStartAttendanceOption.getFlgToShowTextBox());
                stmt.bindLong(5, dayStartAttendanceOption.getFlgSOApplicable());
                stmt.bindLong(6, dayStartAttendanceOption.getFlgDSRApplicable());
                stmt.bindLong(7, dayStartAttendanceOption.getFlgNoVisitOption());
                stmt.bindLong(8, dayStartAttendanceOption.getFlgDelayedReason());
                stmt.bindLong(9, dayStartAttendanceOption.getSeqNo());
                stmt.bindLong(10, dayStartAttendanceOption.getFlgMarketVisit());

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
//        ContentValues initialValues = new ContentValues();
//        initialValues.put("AutoIdStore", AutoIdStore);
//        initialValues.put("ReasonId", ReasonId);
//        initialValues.put("ReasonDescr", ReasonDescr.trim());
//        initialValues.put("FlgToShowTextBox", FlgToShowTextBox);
//
//        initialValues.put("flgSOApplicable", flgSOApplicable);
//        initialValues.put("flgDSRApplicable", flgDSRApplicable);
//        initialValues.put("flgNoVisitOption", flgNoVisitOption);
//        initialValues.put("flgDelayedReason", flgDelayedReason);
//        initialValues.put("SeqNo", SeqNo);
//        initialValues.put("flgMarketVisit", flgMarketVisit);
//
//        return db.insert(DBHelper.TABLE_tblDayStartAttendanceOptions_Define, null, initialValues);
    }





					/* private static final String DATABASE_CREATE_TABLE_252 = "create table tblDayStartAttendanceOptions " +
					 		"(ReasonId text null,ReasonDescr text null,FlgToShowTextBox integer null);";*/

    public LinkedHashMap<String, String> fetch_Reason_List() {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT ReasonId,ReasonDescr FROM tblDayStartAttendanceOptions", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    hmapCatgry.put("Select Reason", "0");
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapCatgry.put(cursor.getString(1).toString(), cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("No Reason", "0");
            }
            return hmapCatgry;
        } finally {
            cursor.close();
            //  close();
        }
    }

					/* initialValues.put("AutoIdStore", AutoIdStore);
						initialValues.put("ReasonId", ReasonId);
						initialValues.put("ReasonDescr", ReasonDescr.trim());
						initialValues.put("FlgToShowTextBox", FlgToShowTextBox);

						 private static final String DATABASE_CREATE_TABLE_252 = "create table tblDayStartAttendanceOptions (ReasonId text null,ReasonDescr text null,FlgToShowTextBox integer null);";
					*/

    public int fetchFlgToShowTextBox(String ReasonDescr) {

        int FlgToShowTextBox = 0;
        //open();

        Cursor cursor = db.rawQuery("SELECT  FlgToShowTextBox from tblDayStartAttendanceOptions where ReasonDescr='" + ReasonDescr + "'", null);
        try {
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        FlgToShowTextBox = Integer.parseInt(cursor.getString(0));
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            cursor.close();
            //   close();
        }

        return FlgToShowTextBox;
    }

    public String fetchReasonIdBasedOnReasonDescr(String ReasonDescr) {

        String ReasonId = "0";
        //open();

        Cursor cursor = db.rawQuery("SELECT  ReasonId from tblDayStartAttendanceOptions where ReasonDescr='" + ReasonDescr + "'", null);
        try {
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        ReasonId = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            cursor.close();
            //close();
        }

        return ReasonId;
    }

    public String fetchReasonDescr() {

        String ReasonId = "0";
        //open();

        Cursor cursor = db.rawQuery("SELECT  ReasonDescr from tblDayStartAttendanceOptions", null);
        try {
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        ReasonId = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            cursor.close();
            // close();
        }

        return ReasonId;
    }

    public String[] fetchDateFromtblStorePOSLastVisitDateDetail(String StoreID) {
        //open();
        Cursor cursor = db
                .rawQuery("SELECT LastVisitDate FROM tblStorePOSLastVisitDateDetail WHERE StoreID ='" + StoreID + "'", null);

        try {

            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult[i] = (String) cursor.getString(0)
                                .toString();

                        cursor.moveToNext();
                    }
                }

            }
            return CompleteResult;

        } finally {
            cursor.close();
            // close();
        }

    }

    public long savetblStorePOSLastVisitDateDetail(String StoreID, String LastVisitDate) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("LastVisitDate", LastVisitDate.trim());


        return db.insert(DBHelper.DATABASE_TABLE_Main165, null, initialValues);

    }

    //  private static final String DATABASE_CREATE_TABLE_165 = "create table
    //tblStorePOSLastVisitDateDetail (StoreID text null,LastVisitDate text null);";

    public long savetblStorePOSLastVisitALLMaterialDetails(String StoreID, String POSMaterialID, String POSMaterialDescr
            , String CurrentStockQty, String NewOrderQty, String ReturnQty, String DamageQty) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("POSMaterialID", POSMaterialID.trim());
        initialValues.put("POSMaterialDescr", POSMaterialDescr.trim());
        initialValues.put("CurrentStockQty", CurrentStockQty.trim());
        initialValues.put("NewOrderQty", NewOrderQty.trim());
        initialValues.put("ReturnQty", ReturnQty.trim());
        initialValues.put("DamageQty", DamageQty.trim());


        return db.insert(DBHelper.DATABASE_TABLE_Main166, null, initialValues);

    }


					/* private static final String DATABASE_CREATE_TABLE_166 = "create table " +
					 		"tblStorePOSLastVisitALLMaterialDetails (StoreID text null,POSMaterialID text null," +
					 		"POSMaterialDescr text null,CurrentStockQty text null,NewOrderQty text null," +
					 		"ReturnQty text null,DamageQty text null);";*/

    public void Delete_tblLastVisitDetailsForPOS() {
        db.execSQL("DELETE FROM tblStorePOSLastVisitDateDetail");

        db.execSQL("DELETE FROM tblStorePOSLastVisitALLMaterialDetails");


    }

    public int counttblStorePOSLastVisitDateDetail(String StoreID) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStorePOSLastVisitDateDetail WHERE StoreID ='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
            //close();
        }
        return chkI;
    }

    public int counttblStorePOSLastVisitALLMaterialDetails(String StoreID) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStorePOSLastVisitALLMaterialDetails WHERE StoreID ='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
            // close();
        }
        return chkI;
    }

    public ArrayList<LinkedHashMap<String, String>> fetch_tblStorePOSLastVisitALLMaterialDetails(String StoreID) {
        //open();
        ArrayList<LinkedHashMap<String, String>> totalProductDetail = new ArrayList<LinkedHashMap<String, String>>();

        LinkedHashMap<String, String> hmapStoreIDPOSMaterialID = new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapPOSMaterialIDPOSMaterialDescr = new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapPOSMaterialIDCurrentStockQty = new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapPOSMaterialIDNewOrderQty = new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapPOSMaterialIDReturnQty = new LinkedHashMap<String, String>();

        LinkedHashMap<String, String> hmapPOSMaterialIDDamageQty = new LinkedHashMap<String, String>();

        Cursor cursor = db.rawQuery("SELECT StoreID,POSMaterialID,POSMaterialDescr,CurrentStockQty,NewOrderQty,ReturnQty,DamageQty  FROM tblStorePOSLastVisitALLMaterialDetails WHERE StoreID ='" + StoreID + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapStoreIDPOSMaterialID.put(cursor.getString(1), cursor.getString(0));
                        hmapPOSMaterialIDPOSMaterialDescr.put(cursor.getString(1), cursor.getString(2));
                        hmapPOSMaterialIDCurrentStockQty.put(cursor.getString(1), cursor.getString(3));
                        hmapPOSMaterialIDNewOrderQty.put(cursor.getString(1), cursor.getString(4));
                        hmapPOSMaterialIDReturnQty.put(cursor.getString(1), cursor.getString(5));
                        hmapPOSMaterialIDDamageQty.put(cursor.getString(1), cursor.getString(6));

                        cursor.moveToNext();

                    }
                    totalProductDetail.add(hmapStoreIDPOSMaterialID);
                    totalProductDetail.add(hmapPOSMaterialIDPOSMaterialDescr);
                    totalProductDetail.add(hmapPOSMaterialIDCurrentStockQty);
                    totalProductDetail.add(hmapPOSMaterialIDNewOrderQty);
                    totalProductDetail.add(hmapPOSMaterialIDReturnQty);
                    totalProductDetail.add(hmapPOSMaterialIDDamageQty);

                }
            }


            return totalProductDetail;
        } finally {
            cursor.close();

            //close();
        }


    }



					/* private static final String DATABASE_CREATE_TABLE_166 = "create table " +
					 		"tblStorePOSLastVisitALLMaterialDetails (StoreID text null,POSMaterialID text null," +
					 		"POSMaterialDescr text null,CurrentStockQty text null,NewOrderQty text null," +
					 		"ReturnQty text null" +
					 		",DamageQty text null);";*/

    public int checkAnyDataSubmitORNot(int Sstat) {
        //open();
        Cursor cursor = db.rawQuery("SELECT Count(*) FROM tblStoreList WHERE Sstat =" + Sstat, null);

        try {

            int check = 0;

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (cursor.getInt(0) > 0) {
                        check = 1;
                    } else {
                        check = 0;
                    }


                }

            }
            return check;

        } finally {
            cursor.close();
            // close();
        }

    }


					/*	private static final String DATABASE_CREATE_TABLE_13 = "create table tblStoreList (StoreID text not " +
								"null, StoreType string not null, StoreName string not null, StoreLatitude real not null," +
								" StoreLongitude real not null, LastVisitDate string not null, LastTransactionDate string not " +
								"null, Sstat integer not null, ForDate string not null, ActualLatitude text null, " +
								"ActualLongitude text null, VisitStartTS text null, VisitEndTS text null,AutoIdStore int null," +
								" LocProvider text null, Accuracy text null, BateryLeftStatus text null,StoreClose integer null" +
								",StoreNextDay integer null,chainID integer null,ISNewStore int null,StoreRouteID int null);";
						*/

    public void deleteOldtblStoreMaterialDetail(String StoreID) {
        //open();
        try {
            db.execSQL("DELETE FROM tblStoreMaterialDetail WHERE StoreID ='" + StoreID + "'");
        } catch (Exception e) {

        } finally {
            //close();
        }

    }


						/* private static final String DATABASE_CREATE_TABLE_163 = "create table tblStoreMaterialDetail " +
						 		"(RouteID text null,StoreID text null,MaterialID text null,ExistStock integer null," +
						 		"ReturntoDistributor integer null,FreshOrder integer null,DiscardDamage integer null," +
						 		"Sstat integer null);"; */

    public String[] getAllStoreIDIntblStoreReturnPhotoDetail() {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblStoreProductPhotoDetail where Sstat=5", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        } finally {
            cursor.close();
        }

    }


    // New Sync way

    public int getExistingPicNosForReturn(String StoreID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblStoreProductPhotoDetail where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public String[] getImgsPathForReturn(String StoreID) {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT PhotoName FROM tblStoreProductPhotoDetail WHERE StoreID ='" + StoreID + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public void updateImageRecordsSyncdForReturn(String PhotoName) {

        try {
            //open();
            System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tblStoreProductPhotoDetail", values, "PhotoName=?", new String[]{PhotoName});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            // close();
        }


    }

    public void updateImageRecordsSyncd() {

        try {


            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
									/*int affected = db.update("tblUserLoginMstr", values, "Sstat=?",
											new String[] { "3" });*/
           /* int affected2 = db.update("tblStoreList", values, "Sstat=?",
                    new String[] { "3" });*/
            int affected3 = db.update("tblOutletPhotoDetail", values, "Sstat=?",
                    new String[]{"5"});
            int affected4 = db.update("tblStoreMaterialPhotoDetail", values, "Sstat=?",
                    new String[]{"5"});
            int affected5 = db.update("tableImage", values, "Sstat=?",
                    new String[]{"5"});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void deleteAllXmlDataTable(String Sstat) {

        //open();
        db.execSQL("DELETE FROM tblOutletQuestAnsMstr WHERE Sstat =" + Sstat);
        db.execSQL("DELETE FROM tblOutletQuestAnsTempMapping WHERE Sstat =" + Sstat);
        db.execSQL("DELETE FROM tblPDARetailerProductSaving WHERE Sstat =" + Sstat);
        db.execSQL("DELETE FROM tableImage WHERE Sstat =" + Sstat);

        // close();


    }

    public void delDayEnd() {
        db.execSQL("DELETE FROM tblDayStartEndDetails");
    }

    public void savetbl_XMLfiles(String XmlFileName, String Sstat, String filetype) {
        //open();
        ContentValues initialValues = new ContentValues();


        initialValues.put("XmlFileName", XmlFileName.trim());
        initialValues.put("Sstat", Sstat.trim());
        initialValues.put("filetype", filetype.trim());


        db.insert(DBHelper.TABLE_XMLFILES, null, initialValues);
        //close();
    }

    public void UpdateStoreMaterialphotoFlag(String sID, int flag2set) {
        try {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected1 = db.update("tblStoreMaterialPhotoDetail", values, "StoreID=?", new String[]{sID});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void UpdateStoreCheckinFlg(String sID, int flag2set) {
        try {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected1 = db.update("tblStoreCheckInPic", values, "StoreID=?", new String[]{sID});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public String[] getAllStoreIDIntblStoreMaterialPhotoDetail() {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblStoreMaterialPhotoDetail where Sstat=5", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        } finally {
            cursor.close();
        }

    }



    public String[] getAllAttendacePhotoDetail() {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(SelfieURL) FROM tblAttandanceDetails", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public void updateImageRecordsSyncdforPOSMaterial(String PhotoName) {

        try {
            //open();
            System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tblStoreMaterialPhotoDetail", values, "PhotoName=?", new String[]{PhotoName});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            // close();
        }


    }

    public String fnGetXMLFile(String Sstat) {
        String optionList = "";
        //open();
        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        Cursor cursor = db.rawQuery("SELECT XmlFileName from tbl_XMLfiles Where Sstat='" + Sstat + "'", null);// Where PNodeID='"+TSIID+"'
        // (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (optionList.equals("")) {
                            optionList = (String) cursor.getString(0).toString();
                        } else {
                            optionList = optionList + "^" + (String) cursor.getString(0).toString();
                        }
                        cursor.moveToNext();
                    }
                }
            }
            return optionList;
        } finally {
            // close();
            cursor.close();

        }
    }

    public void upDateTblXmlFile(String XmlFileName) {
        //open();
        db.execSQL("UPDATE tbl_XMLfiles SET Sstat='4' WHERE XmlFileName='" + XmlFileName + "'");
        //   close();

    }

    public void deleteXmlTable(String Sstat) {
        //open();
        db.execSQL("DELETE FROM tbl_XMLfiles WHERE Sstat =" + Sstat);
        // close();
    }

    public LinkedHashMap<String, String> getFileredProductListMap(String _searchString, int BusinessSegmentId, String ctgryId) {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        String searchString = "";
        LinkedHashMap<String, String> hmapFilterProductList = new LinkedHashMap<String, String>();
        try {
            if (_searchString.indexOf(":") != -1) {
                String[] arrsearchString = _searchString.split(Pattern.quote(","));
                for (int i = 0; i < arrsearchString.length; i++) {
                    if (i == 0) {
                        searchString = " LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    } else {
                        searchString += " AND LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    }
                }
            }

            if (_searchString.indexOf(",") != -1) {
                String[] arrsearchString = _searchString.split(Pattern.quote(","));
                for (int i = 0; i < arrsearchString.length; i++) {
                    if (i == 0) {
                        searchString = " LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    } else {
                        searchString += " AND LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    }
                }
            } else {
                if (ctgryId.equals("0") && TextUtils.isEmpty(_searchString)) {
                    _searchString = "All";
                    searchString = " LOWER(SearchField) LIKE '%" + _searchString.trim().toLowerCase() + "%'";
                } else {
                    searchString = " LOWER(SearchField) LIKE '%" + _searchString.trim().toLowerCase() + "%'";
                }

            }
            Cursor cur = null;
            if (CommonInfo.flgDrctslsIndrctSls == 1) {
                if (!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0")) {
                    // tblVanProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,OriginalStock text null,SKUName text null);";
                    cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblVanProductStock On tblProductListMaster.ProductID = tblVanProductStock.PrdctId where (" + searchString + ")  AND tblProductListMaster.CategoryID='" + ctgryId + "' order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                } else {

                    cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  where (" + searchString + ") order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                }
            } else {
                if (!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0")) {
                    // tblVanProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,OriginalStock text null,SKUName text null);";
                    cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  where (" + searchString + ")  AND tblProductListMaster.CategoryID='" + ctgryId + "' order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                } else {

                    cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  where (" + searchString + ") order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                }
            }


            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapFilterProductList.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            // close();
            return hmapFilterProductList;
        }
    }


    public LinkedHashMap<String, String> getFileredProductListMapPRoductFilter(String _searchString, int BusinessSegmentId, String ctgryId, int filterType, int ParentID) {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        String searchString = "";
        LinkedHashMap<String, String> hmapFilterProductList = new LinkedHashMap<String, String>();
        try {
            if (_searchString.indexOf(":") != -1) {
                String[] arrsearchString = _searchString.split(Pattern.quote(","));
                for (int i = 0; i < arrsearchString.length; i++) {
                    if (i == 0) {
                        searchString = " LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    } else {
                        searchString += " AND LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    }
                }
            }

            if (_searchString.indexOf(",") != -1) {
                String[] arrsearchString = _searchString.split(Pattern.quote(","));
                for (int i = 0; i < arrsearchString.length; i++) {
                    if (i == 0) {
                        searchString = " LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    } else {
                        searchString += " AND LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    }
                }
            } else {
                if (ctgryId.equals("0") && TextUtils.isEmpty(_searchString)) {
                    _searchString = "All";
                    searchString = " LOWER(SearchField) LIKE '%" + _searchString.trim().toLowerCase() + "%'";
                } else {
                    searchString = " LOWER(SearchField) LIKE '%" + _searchString.trim().toLowerCase() + "%'";
                }

            }
            Cursor cur = null;
            if (CommonInfo.flgDrctslsIndrctSls == 1) {
                if (!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0")) {
                    // tblVanProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,OriginalStock text null,SKUName text null);";
                    cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblVanProductStock On tblProductListMaster.ProductID = tblVanProductStock.PrdctId where (" + searchString + ")  AND tblProductListMaster.CategoryID='" + ctgryId + "' order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                } else {

                    cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  where (" + searchString + ") order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                }
            } else {
                if (!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0")) {
                    // tblVanProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,OriginalStock text null,SKUName text null);";
                    //cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  where (" + searchString + ")  AND tblProductListMaster.CategoryID='" + ctgryId + "' order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                    if (filterType == 1) {
                        cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  where (" + searchString + ")  AND tblProductListMaster.CategoryID='" + ctgryId + "' order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                    } else {
                        cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  where (" + searchString + ")  AND tblProductListMaster.ProductTypeNodeID='" + ctgryId + "' AND tblProductListMaster.CategoryID=" + ParentID + " order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"

                    }
                } else {

                    cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID  where (" + searchString + ") order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"

                }
            }


            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapFilterProductList.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            // close();
            return hmapFilterProductList;
        }
    }

    public LinkedHashMap<String, String> getFileredProductListMapPRoductFilterSchemeProducts(String _searchString, int BusinessSegmentId, String ctgryId, int filterType, int ParentID) {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        String searchString = "";
        LinkedHashMap<String, String> hmapFilterProductList = new LinkedHashMap<String, String>();
        try {
            if (_searchString.indexOf(":") != -1) {
                String[] arrsearchString = _searchString.split(Pattern.quote(","));
                for (int i = 0; i < arrsearchString.length; i++) {
                    if (i == 0) {
                        searchString = " LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    } else {
                        searchString += " AND LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    }
                }
            }

            if (_searchString.indexOf(",") != -1) {
                String[] arrsearchString = _searchString.split(Pattern.quote(","));
                for (int i = 0; i < arrsearchString.length; i++) {
                    if (i == 0) {
                        searchString = " LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    } else {
                        searchString += " AND LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    }
                }
            } else {
                if (ctgryId.equals("0") && TextUtils.isEmpty(_searchString)) {
                    _searchString = "All";
                    searchString = " LOWER(SearchField) LIKE '%" + _searchString.trim().toLowerCase() + "%'";
                } else {
                    searchString = " LOWER(SearchField) LIKE '%" + _searchString.trim().toLowerCase() + "%'";
                }

            }
            Cursor cur = null;
            int SectorID=fnGetSectorID();
            if(SectorID==1)
            {
                if (!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0")) {
                    cur = db.rawQuery("Select DISTINCT tblProductListMaster.ProductID,ProductShortName from tblProductListMaster  inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblProductRelatedScheme on tblProductListMaster.ProductID=tblProductRelatedScheme.ProductID  where (" + searchString + ")  AND tblProductListMaster.ProductTypeNodeID='" + ctgryId + "' AND tblProductListMaster.CategoryID=" + ParentID + "  order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                } else {
                    cur = db.rawQuery("Select DISTINCT tblProductListMaster.ProductID,ProductShortName from tblProductListMaster  inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblProductRelatedScheme on tblProductListMaster.ProductID=tblProductRelatedScheme.ProductID   where (" + searchString + ")  order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                }
            }
            else
            {
                if (!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0")) {
                    cur = db.rawQuery("Select DISTINCT tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSectorMapping on tblProductListMaster.ProductID= tblProductSectorMapping.PrdNodeID inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblProductRelatedScheme on tblProductListMaster.ProductID=tblProductRelatedScheme.ProductID  where (" + searchString + ")  AND tblProductListMaster.ProductTypeNodeID='" + ctgryId + "' AND tblProductListMaster.CategoryID=" + ParentID + " and tblProductSectorMapping.SectorID="+SectorID+" order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                } else {
                    cur = db.rawQuery("Select DISTINCT tblProductListMaster.ProductID,ProductShortName from tblProductListMaster inner join tblProductSectorMapping on tblProductListMaster.ProductID= tblProductSectorMapping.PrdNodeID inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID inner join tblProductRelatedScheme on tblProductListMaster.ProductID=tblProductRelatedScheme.ProductID   where (" + searchString + ") and tblProductSectorMapping.SectorID="+SectorID+" order by PrdOrdr Asc", null);//and tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
                }
            }



            if (cur!=null && cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapFilterProductList.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            // close();
            return hmapFilterProductList;
        }
    }

    public LinkedHashMap<String, String> getUOMMstr() {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        LinkedHashMap<String, String> hmapUOMMstr = new LinkedHashMap<String, String>();
        try {
            Cursor cur = db.rawQuery("Select UOMID,UOM from tblUOMMstr", null);
            hmapUOMMstr.put("0", "Select UOM");
            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapUOMMstr.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            // close();
            return hmapUOMMstr;
        }
    }

    public LinkedHashMap<String, String> getSalesQuotePrcsMstr() {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        LinkedHashMap<String, String> hmapSalesQuoteMstr = new LinkedHashMap<String, String>();
        try {
            Cursor cur = db.rawQuery("Select SalesQuotePrcsId,SalesQuotePrcs from tblSalesQuotePrcsMstr", null);
            //hmapUOMMstr.put("0", "Select SalesQuote");
            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapSalesQuoteMstr.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //  close();
            return hmapSalesQuoteMstr;
        }
    }

    public LinkedHashMap<String, String> fngetDistinctSalesQuotePersonMeetMstr(String StoreId) {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //open();
        LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr = new LinkedHashMap<String, String>();
        try {
            Cursor cur = db.rawQuery("Select SalesQuoteId,SalesQuoteCode,SalesQuotePrcsId,SalesQuotePrcs,SalesQuoteDate from tblSalesQuotePersonMeetMstr WHERE StoreId='" + StoreId + "'", null);
            //hmapUOMMstr.put("0", "Select SalesQuote");
            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapDistinctSalesQuotePersonMeetMstr.put(cur.getString(0), cur.getString(1) + "^" + cur.getString(2) + "^" + cur.getString(3) + "^" + cur.getString(4));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            // close();
            return hmapDistinctSalesQuotePersonMeetMstr;
        }
    }

    public LinkedHashMap<String, String> fngetDistinctSalesQuotePersonMeetMstrForSstatUpdate(String StoreId) {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        //	//open();
        LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr = new LinkedHashMap<String, String>();
        try {
            Cursor cur = db.rawQuery("Select SalesQuoteId,SalesQuoteCode,SalesQuotePrcsId,SalesQuotePrcs,SalesQuoteDate from tblSalesQuotePersonMeetMstr WHERE StoreId='" + StoreId + "'", null);
            //hmapUOMMstr.put("0", "Select SalesQuote");
            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapDistinctSalesQuotePersonMeetMstr.put(cur.getString(0), cur.getString(1) + "^" + cur.getString(2) + "^" + cur.getString(3) + "^" + cur.getString(4));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //close();
            return hmapDistinctSalesQuotePersonMeetMstr;
        }
    }

    public int fncheckIfSalesQuotePersonMeetMstrExistsinTable(String SalesQuoteId) {
        //open();
        int strReturnPDADateExistOrNot = 0;

        Cursor cursor2 = db.rawQuery("SELECT SalesQuoteId FROM  tblSalesQuotePersonMeetMstr where tblSalesQuotePersonMeetMstr.SalesQuoteId='" + SalesQuoteId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnPDADateExistOrNot = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnPDADateExistOrNot;
        } finally {
            cursor2.close();
            //  close();
        }
    }

    public String[] fngetQutePersonMeetTabOneData(String SalesQuoteId) {
        //open();
        String qry = "select SalesQuoteType,SalesQuoteValidFrom,SalesQuoteValidTo,SalesQuoteDate from tblSalesQuotePersonMeetMstr where SalesQuoteId='" + SalesQuoteId + "'";
        Cursor cur = db.rawQuery(qry, null);
        String BasicData[] = new String[4];
        try {
            if (cur.moveToFirst()) {
                //for(int i=0;i<cur.getCount();i++)
                for (int i = 0; i < cur.getCount(); i++) {
                    BasicData[0] = (String) cur.getString(0).toString();
                    BasicData[1] = (String) cur.getString(1).toString();
                    BasicData[2] = (String) cur.getString(2).toString();
                    BasicData[3] = (String) cur.getString(3).toString();
                    cur.moveToNext();

                }


            }
            return BasicData;
        } finally {
            //cur.close();
            // close();
        }
    }

    public LinkedHashMap<String, String> getFileredProductListQuotationMap(String _searchString, String SalesQuoteId, int BusinessSegmentId, String ManufacturerID) {
        int chkIfSalesQuotePersonMeetMstrExistsinTable = fncheckIfSalesQuotePersonMeetMstrExistsinTable(SalesQuoteId);
        String SalesQuoteValidFrom = "0";
        String SalesQuoteValidTo = "0";
        String SalesQuoteType = "0";
        if (chkIfSalesQuotePersonMeetMstrExistsinTable == 1) {
            //SalesQuoteType,SalesQuoteValidFrom,SalesQuoteValidTo,SalesQuoteDate
            String[] arrValues = new String[4];
            arrValues = fngetQutePersonMeetTabOneData(SalesQuoteId);
            SalesQuoteType = arrValues[0];
            SalesQuoteValidFrom = arrValues[1];
            SalesQuoteValidTo = arrValues[2];
            SalesQuoteType = arrValues[3];
        }
        //open();
        //int intcheckIfgetFileredProductListQuotationMapExistsinTable=fncheckIfgetFileredProductListQuotationMapExistsinTable(SalesQuoteId);
        String searchString = "";
        LinkedHashMap<String, String> hmapFilterProductQuotationList = new LinkedHashMap<String, String>();
        try {
            if (_searchString.indexOf(",") != -1) {
                String[] arrsearchString = _searchString.split(Pattern.quote(","));
                for (int i = 0; i < arrsearchString.length; i++) {
                    if (i == 0) {
                        searchString = " LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    } else {
                        searchString += " AND LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    }
                }
            } else {
                searchString = " LOWER(SearchField) LIKE '%" + _searchString.trim().toLowerCase() + "%'";
            }
            Cursor cur = null;

            //cur=db.rawQuery("Select ProductID,ProductShortName,StandardRate,StandardRateBeforeTax,0 AS RateOffer,0 AS InclusiveTax,'"+SalesQuoteValidFrom+"' AS ValidFrom,'"+SalesQuoteValidTo+"' As ValidTo,0 AS MinDlvryQty,0 AS UOMID,0 AS Remarks,'0.00' AS LastTranscRate,tblProductListMaster.VatTax from tblProductListMaster where ("+searchString+") order by PrdOrdr Asc", null);
            if (ManufacturerID.equals("0") || ManufacturerID.equals("")) {
                cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,0 AS RateOffer,0 AS InclusiveTax,'" + SalesQuoteValidFrom + "' AS ValidFrom,'" + SalesQuoteValidTo + "' As ValidTo,0 AS MinDlvryQty,0 AS UOMID,0 AS Remarks,'0.00' AS LastTranscRate,tblProductSegementMap.VatTax from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID where (" + searchString + ") and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId + " order by PrdOrdr Asc", null);
            } else {

                cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName,tblProductSegementMap.StandardRate,tblProductSegementMap.StandardRateBeforeTax,0 AS RateOffer,0 AS InclusiveTax,'" + SalesQuoteValidFrom + "' AS ValidFrom,'" + SalesQuoteValidTo + "' As ValidTo,0 AS MinDlvryQty,0 AS UOMID,0 AS Remarks,'0.00' AS LastTranscRate,tblProductSegementMap.VatTax from tblProductListMaster inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID where (" + searchString + ") and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId + " and tblProductListMaster.ManufacturerID=" + Integer.parseInt(ManufacturerID) + " order by PrdOrdr Asc", null);
            }
            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapFilterProductQuotationList.put(cur.getString(0), cur.getString(1) + "^" + cur.getString(2) + "^" + cur.getString(3) + "^" + cur.getString(4) + "^" + cur.getString(5) + "^" + cur.getString(6) + "^" + cur.getString(7) + "^" + cur.getString(8) + "^" + cur.getString(9) + "^" + cur.getString(10) + "^" + cur.getString(11) + "^" + cur.getString(12));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("SSS" + e);
            // TODO: handle exception
        } finally {
            // close();
            int intcheckIfgetFileredProductListQuotationMapExistsinTable = fncheckIfgetFileredProductListQuotationMapExistsinTable(SalesQuoteId);
            if (intcheckIfgetFileredProductListQuotationMapExistsinTable == 1) {
                getFileredProductListPreFiledListQuotationMap(hmapFilterProductQuotationList, SalesQuoteId, BusinessSegmentId);
            }
            return hmapFilterProductQuotationList;
        }
    }

    public void getFileredProductListPreFiledListQuotationMap(LinkedHashMap<String, String> hmapFilterProductQuotationList, String SalesQuoteId, int BusinessSegmentId) {
        //open();
        try {
            Cursor cur = null;
            //cur=db.rawQuery("Select ProductID,ProductShortName,tblSalesQuoteProductsMstr.StandardRate ,tblSalesQuoteProductsMstr.StandardRateBeforeTax,tblSalesQuoteProductsMstr.RateOffer,tblSalesQuoteProductsMstr.InclusiveTax,tblSalesQuoteProductsMstr.ValidFrom AS ValidFrom,tblSalesQuoteProductsMstr.ValidTo As ValidTo,tblSalesQuoteProductsMstr.MinDlvryQty,tblSalesQuoteProductsMstr.UOMID,tblSalesQuoteProductsMstr.Remarks,tblSalesQuoteProductsMstr.LastTranscRate,tblProductListMaster.VatTax from tblProductListMaster inner join tblSalesQuoteProductsMstr on tblProductListMaster.ProductID=tblSalesQuoteProductsMstr.PrdId where tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"' order by tblProductListMaster.PrdOrdr Asc", null);
            cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName,tblSalesQuoteProductsMstr.StandardRate,tblSalesQuoteProductsMstr.StandardRateBeforeTax,tblSalesQuoteProductsMstr.RateOffer,tblSalesQuoteProductsMstr.InclusiveTax,tblSalesQuoteProductsMstr.ValidFrom AS ValidFrom,tblSalesQuoteProductsMstr.ValidTo As ValidTo,tblSalesQuoteProductsMstr.MinDlvryQty,tblSalesQuoteProductsMstr.UOMID,tblSalesQuoteProductsMstr.Remarks,tblSalesQuoteProductsMstr.LastTranscRate,tblProductSegementMap.VatTax from tblProductListMaster inner join tblSalesQuoteProductsMstr on tblProductListMaster.ProductID=tblSalesQuoteProductsMstr.PrdId inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID where tblSalesQuoteProductsMstr.SalesQuoteId='" + SalesQuoteId + "' and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId + " order by tblProductListMaster.PrdOrdr Asc", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapFilterProductQuotationList.put(cur.getString(0), cur.getString(1) + "^" + cur.getString(2) + "^" + cur.getString(3) + "^" + cur.getString(4) + "^" + cur.getString(5) + "^" + cur.getString(6) + "^" + cur.getString(7) + "^" + cur.getString(8) + "^" + cur.getString(9) + "^" + cur.getString(10) + "^" + cur.getString(11) + "^" + cur.getString(12));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("SSS" + e);
            // TODO: handle exception
        } finally {

            //close();

        }
    }

    public int fncheckIfgetFileredProductListQuotationMapExistsinTable(String SalesQuoteId) {
        //open();
        int strReturnPDADateExistOrNot = 0;
        //tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"'
        Cursor cursor2 = db.rawQuery("SELECT * FROM  tblSalesQuoteProductsMstr where tblSalesQuoteProductsMstr.SalesQuoteId='" + SalesQuoteId + "'", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strReturnPDADateExistOrNot = 1;
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strReturnPDADateExistOrNot;
        } finally {
            //cursor2.close();
            // close();
        }
    }

    public LinkedHashMap<String, String> getDefaultProductListQuotationMap(String SalesQuoteId, int BusinessSegmentId) {
        String searchString = "";
        LinkedHashMap<String, String> hmapDefaultProductQuotationList = new LinkedHashMap<String, String>();
        try {
            //open();
            //Cursor cur=db.rawQuery("Select ProductID,ProductShortName,IFNULL(tblSalesQuoteProductsMstr.StandardRate,0),IFNULL(tblSalesQuoteProductsMstr.StandardRateBeforeTax,0),IFNULL(tblSalesQuoteProductsMstr.RateOffer,0),IFNULL(tblSalesQuoteProductsMstr.InclusiveTax,0),IFNULL(tblSalesQuoteProductsMstr.ValidFrom,0),IFNULL(tblSalesQuoteProductsMstr.ValidTo,0),IFNULL(tblSalesQuoteProductsMstr.MinDlvryQty,0),IFNULL(tblSalesQuoteProductsMstr.UOMID,0),IFNULL(tblSalesQuoteProductsMstr.Remarks,''),IFNULL(tblSalesQuoteProductsMstr.LastTranscRate,'0.00'),VatTax from tblProductListMaster Inner Join tblSalesQuoteProductsMstr On tblProductListMaster.ProductID=tblSalesQuoteProductsMstr.PrdId Where tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"' order by PrdOrdr Asc", null);
            Cursor cur = db.rawQuery("Select tblProductListMaster.ProductID,ProductShortName,IFNULL(tblSalesQuoteProductsMstr.StandardRate,0),IFNULL(tblSalesQuoteProductsMstr.StandardRateBeforeTax,0),IFNULL(tblSalesQuoteProductsMstr.RateOffer,0),IFNULL(tblSalesQuoteProductsMstr.InclusiveTax,0),IFNULL(tblSalesQuoteProductsMstr.ValidFrom,0),IFNULL(tblSalesQuoteProductsMstr.ValidTo,0),IFNULL(tblSalesQuoteProductsMstr.MinDlvryQty,0),IFNULL(tblSalesQuoteProductsMstr.UOMID,0),IFNULL(tblSalesQuoteProductsMstr.Remarks,''),IFNULL(tblSalesQuoteProductsMstr.LastTranscRate,'0.00'),tblProductSegementMap.VatTax from tblProductListMaster Inner Join tblSalesQuoteProductsMstr On tblProductListMaster.ProductID=tblSalesQuoteProductsMstr.PrdId inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID Where tblSalesQuoteProductsMstr.SalesQuoteId='" + SalesQuoteId + "' and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId + " order by PrdOrdr Asc", null);
            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();

                if (cur.moveToFirst()) {

                    for (int i = 0; i < cur.getCount(); i++) {

                        hmapDefaultProductQuotationList.put(cur.getString(0), cur.getString(1) + "^" + cur.getString(2) + "^" + cur.getString(3) + "^" + cur.getString(4) + "^" + cur.getString(5) + "^" + cur.getString(6) + "^" + cur.getString(7) + "^" + cur.getString(8) + "^" + cur.getString(9) + "^" + cur.getString(10) + "^" + cur.getString(11) + "^" + cur.getString(12));

                        cur.moveToNext();

                    }

                }


            }


        } catch (Exception e) {

            // TODO: handle exception

        } finally {

            // close();

            return hmapDefaultProductQuotationList;

        }

    }

    public String fnGettPrcIDBasedOnQuotationId(String SalesQuoteId) {
        //open();
        Cursor cursor = db.rawQuery("SELECT SalesQuotePrcsId from tblSalesQuotePersonMeetMstr where SalesQuoteId='" + SalesQuoteId + "'", null);
        String flag = "0";
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    flag = cursor.getString(0).toString();
                }

            }
            return flag;
        } finally {
            cursor.close();
            //close();
        }
    }

    public LinkedHashMap<String, String> getQuotationPersionMeetDetails(String SalesQuoteId) {

        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";


        String searchString = "";

        LinkedHashMap<String, String> hmapQuotationPersionMeetDetails = new LinkedHashMap<String, String>();

        try {
            //open();


            // Cursor cur=db.rawQuery("Select StoreName As Customer,ContactPerson,ContactPersonPhone,ContactPersonEmail,SalesQuoteType,IFNULL(SalesQuoteValidFrom,0),IFNULL(SalesQuoteValidTo,0),IFNULL(ExpectedBusinessValue,0),IFNULL(PaymentTerms,0),IFNULL(PaymentTermsType,0),SalesQuoteDate from tblProductListMaster Inner Join tblSalesQuoteProductsMstr On tblProductListMaster.ProductID=tblSalesQuoteProductsMstr.PrdId Where tblSalesQuoteProductsMstr.SalesQuoteId='"+SalesQuoteId+"' order by PrdOrdr Asc", null);

            Cursor cur = db.rawQuery("Select StoreName As Customer,ContactPerson,ContactPersonPhone,ContactPersonEmail,SalesQuoteType,IFNULL(SalesQuoteValidFrom,0),IFNULL(SalesQuoteValidTo,0),IFNULL(ExpectedBusinessValue,0),IFNULL(CreditLimit,0),IFNULL(CreditDays,0),SalesQuoteDate,SalesQuotePrcsId ,SalesQuotePrcs,PaymentModeId,IFNULL(PymtStageId,0),IFNULL(ManufacturerID,0),IFNULL(ManufacturerName,0) from tblSalesQuotePersonMeetMstr Where tblSalesQuotePersonMeetMstr.SalesQuoteId='" + SalesQuoteId + "'", null);

            if (cur.getCount() > 0) {

                StringBuilder sBuilder = new StringBuilder();

                if (cur.moveToFirst()) {

                    for (int i = 0; i < cur.getCount(); i++) {

                        hmapQuotationPersionMeetDetails.put(SalesQuoteId, cur.getString(0) + "^" + cur.getString(1) + "^" + cur.getString(2) + "^" + cur.getString(3) + "^" + cur.getString(4) + "^" + cur.getString(5) + "^" + cur.getString(6) + "^" + cur.getString(7) + "^" + cur.getString(8) + "^" + cur.getString(9) + "^" + cur.getString(10) + "^" + cur.getString(11) + "^" + cur.getString(12) + "^" + cur.getString(13) + "^" + cur.getString(14) + "^" + cur.getString(15) + "^" + cur.getString(16));

                        cur.moveToNext();

                    }

                }


            }


        } catch (Exception e) {

            // TODO: handle exception

        } finally {

            // close();

            return hmapQuotationPersionMeetDetails;

        }

    }

    public void UpdateQuotePrcsAgainstQuotationId(String SalesQuoteId, String SalesQuotePrcsId, String SalesQuotePrcs) {

        try {
            final ContentValues values = new ContentValues();
            values.put("SalesQuotePrcsId", SalesQuotePrcsId);
            values.put("SalesQuotePrcs", SalesQuotePrcs);
            int affected = db.update("tblSalesQuotePersonMeetMstr", values, "SalesQuoteId=? ", new String[]{SalesQuoteId});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {

        }
    }


    public LinkedHashMap<String, String> fnGetDistinctSenction() {
        String searchString = "";
        LinkedHashMap<String, String> hmapDistinctDiffrentSection = new LinkedHashMap<String, String>();
        try {
            //open();
            Cursor cur = db.rawQuery("Select Distinct SectionNo from tblGetPDAQuestGrpMapping", null);
            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapDistinctDiffrentSection.put(cur.getString(0), "Section_" + cur.getString(0).toString().trim());
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception

        } finally {
            //  close();
            return hmapDistinctDiffrentSection;
        }
    }

    public LinkedHashMap<String, String> fnGetDistinctGroupsinSection(int SectionNo) {
        String searchString = "";
        LinkedHashMap<String, String> hmapDistinctGroupsinSection = new LinkedHashMap<String, String>();
        try {
            //open();
            Cursor cur = db.rawQuery("Select GrpID,GrpNodeID,GrpDesc from tblGetPDAQuestGrpMapping Where SectionNo='" + SectionNo + "'", null);
            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapDistinctGroupsinSection.put(cur.getString(2), cur.getString(0).toString().trim() + "_" + cur.getString(1).toString().trim());
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception

        } finally {
            // close();
            return hmapDistinctGroupsinSection;
        }
    }


    public LinkedHashMap<String, ArrayList<String>> fnGetGroupIDMapWithQuestionID() {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr = new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listKeyQuesVal = new ArrayList<String>();
        //open();
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.GrpID from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping where tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.GrpID ASC  ", null);// Where PNodeID='"+TSIID+"'

        try {
            if (cursor.getCount() > 0) {
                String sectionNo = "0", preVisousSectionNum = "0";
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        sectionNo = cursor.getString(3);
                        if (i == 0) {
                            preVisousSectionNum = sectionNo;
                            listKeyQuesVal.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));
                        } else if (preVisousSectionNum.equals(sectionNo)) {
                            listKeyQuesVal.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));
                        } else {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                            listKeyQuesVal = new ArrayList<String>();
                            preVisousSectionNum = sectionNo;
                            listKeyQuesVal.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));

                        }
                        if (i == (cursor.getCount() - 1)) {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                        }

                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            //close();
        }
    }

    public LinkedHashMap<String, String> fnGetGroupIDWithGroupDescr() {
        {
            //open();
            LinkedHashMap<String, String> hmapGroupIDWithGroupDescr = new LinkedHashMap<String, String>();
            //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";

            Cursor cur = db.rawQuery("Select Distinct GrpID,GrpDesc from tblGetPDAQuestGrpMapping", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapGroupIDWithGroupDescr.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }

                }
            }
            //close();
            return hmapGroupIDWithGroupDescr;
        }
    }

    public int getsectionCount() {
        int sectionCount = 0;


        try {

//tblQuestIDForOutChannel(GrpQstId int null,QuestID int null,OptID text null,SectionCount int null);";
            Cursor cur = db.rawQuery("Select SectionCount from tblQuestIDForOutChannel", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {

                    sectionCount = cur.getInt(0);
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {

            return sectionCount;
        }
    }

    public LinkedHashMap<String, ArrayList<String>> fnGetSectionIDMapWithGroupID() {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr = new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listKeyQuesVal = new ArrayList<String>();

        //open();
        int sectionCount = getsectionCount();
        //    int sectionCount=0;
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor;
        if (sectionCount != 0) {
            cursor = db.rawQuery("SELECT Distinct GrpID,SectionNo from tblGetPDAQuestGrpMapping where SectionNo<=" + sectionCount + " order by SectionNo", null);// Where PNodeID='"+TSIID+"'
        } else {
            cursor = db.rawQuery("SELECT Distinct GrpID,SectionNo from tblGetPDAQuestGrpMapping order by SectionNo", null);// Where PNodeID='"+TSIID+"'
        }


        try {
            if (cursor.getCount() > 0) {
                String sectionNo = "0", preVisousSectionNum = "0";
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        sectionNo = cursor.getString(1);
                        if (i == 0) {
                            preVisousSectionNum = sectionNo;
                            listKeyQuesVal.add(cursor.getString(0));
                        } else if (preVisousSectionNum.equals(sectionNo)) {
                            listKeyQuesVal.add(cursor.getString(0));
                        } else {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                            listKeyQuesVal = new ArrayList<String>();
                            preVisousSectionNum = sectionNo;
                            listKeyQuesVal.add(cursor.getString(0));

                        }
                        if (i == cursor.getCount() - 1) {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                        }


                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            //close();
        }
    }

    public LinkedHashMap<String, String> fnGetOptionId_OptionValue() {
        LinkedHashMap<String, String> hmapOptionId_OptionValue = new LinkedHashMap<String, String>();
        //open();

        Cursor cursor = db.rawQuery("SELECT QuestID,OptID,OptionNo from tblGetPDAQuestOptionMstr Order By Sequence ASC ", null);// Where PNodeID='"+TSIID+"'

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapOptionId_OptionValue.put((String) cursor.getString(0).toString() + "_" + (String) cursor.getString(1).toString(), (String) cursor.getString(2).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapOptionId_OptionValue;
        } finally {
            cursor.close();
            //close();
        }
    }

    public int getSectionCount() {
        int sectionNo = 0;

        try {


            Cursor cursor = db.rawQuery("Select SectionCount from tblQuestIDForOutChannel", null);

            if (cursor.getCount() > 0)  //Return the number of rows in the cursor
            {
                if (cursor.moveToFirst())  // move the cursor to the first row .
                {                          // This method will return false  if cursor is empty
                    sectionNo = cursor.getInt(0);
                    cursor.moveToNext();    // move the cursor to the next row
                }
            }
        } catch (Exception e) {

        } finally {
            return sectionNo;
        }


    }

    public LinkedHashMap<String, String> fnGetQuestionMstr(SharedPreferences sPref) {

        if (sPref.getString("Language", "").equals("en")) {

        } else if (sPref.getString("Language", "").equals("hi")) {

        } else {

        }
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
        int sectionCount = getsectionCount();


        Cursor cursor;


/*

		if(sPref.getString("Language", "").equals("en"))
		{
			if(sectionCount!=0)
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  where tblGetPDAQuestGrpMapping.SectionNo<="+sectionCount+" Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
			else
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
		}
		else if(sPref.getString("Language", "").equals("hi"))
		{
			if(sectionCount!=0)
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDescHindi,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  where tblGetPDAQuestGrpMapping.SectionNo<="+sectionCount+" Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
			else
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDescHindi,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
		}
		else
		{
			if(sectionCount!=0)
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  where tblGetPDAQuestGrpMapping.SectionNo<="+sectionCount+" Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
			else
			{
				cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
			}
		}
*/

        if (sectionCount != 0) {
            cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  where tblGetPDAQuestGrpMapping.SectionNo<=" + sectionCount + " Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        } else {
            cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.QuestCode,tblGetPDAQuestMstr.QuestDesc,tblGetPDAQuestMstr.QuestType,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestMstr.AnsControlInputTypeID,tblGetPDAQuestMstr.AnsControlInputTypeMaxLength,tblGetPDAQuestMstr.AnsMustRequiredFlg,tblGetPDAQuestMstr.QuestBundleFlg,tblGetPDAQuestMstr.ApplicationTypeID,tblGetPDAQuestMstr.Sequence,tblGetPDAQuestMstr.AnsControlInputTypeMinLength,tblGetPDAQuestMstr.AnswerHint,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping On tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        }


        try {
            //	String aa="उत्पाद का $ नाम है";
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        System.out.println("Varun Quest Id = " + (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(4).toString() + "^" + (String) cursor.getString(13).toString() + "~" + (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString() + "^" + (String) cursor.getString(3).toString() + "^" + (String) cursor.getString(4).toString() + "^" + (String) cursor.getString(5).toString() + "^" + (String) cursor.getString(6).toString() + "^" + (String) cursor.getString(7).toString() + "^" + (String) cursor.getString(8).toString() + "^" + (String) cursor.getString(13).toString() + "^" + (String) cursor.getString(14).toString());
                        //	hmapQuestionMstr.put((String) cursor.getString(0).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(13).toString(), (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()+"^"+(String) cursor.getString(11).toString()+"^"+(String) cursor.getString(12).toString()+"^"+(String) cursor.getString(13).toString());
                        hmapQuestionMstr.put((String) cursor.getString(0).toString() + "^" + (String) cursor.getString(4).toString() + "^" + (String) cursor.getString(13).toString(), (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString() + "^" + (String) cursor.getString(3).toString() + "^" + (String) cursor.getString(4).toString() + "^" + (String) cursor.getString(5).toString() + "^" + (String) cursor.getString(6).toString() + "^" + (String) cursor.getString(7).toString() + "^" + (String) cursor.getString(8).toString() + "^" + (String) cursor.getString(9).toString() + "^" + (String) cursor.getString(10).toString() + "^" + (String) cursor.getString(11).toString() + "^" + (String) cursor.getString(12).toString() + "^" + (String) cursor.getString(13).toString());
                        //use=aa in place of (String) cursor.getString(2).toString()
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            // close();
        }
    }

    public void fnDeletesaveOutletQuestAnsMstrSctionWise(String OutletID, int sectionID) {
        db.execSQL("DELETE FROM tblOutletQuestAnsMstr WHERE OutletID ='" + OutletID + "'");// and sectionID="+sectionID
    }


    //Add New Store Section wise Code Ends Here

    public LinkedHashMap<String, String> getReasonReturn() {
        ////tblGetReturnsReasonForPDAMstr(StockStatusId text not null,StockStatus text not null);";
        LinkedHashMap<String, String> hmapRtrnRsn = new LinkedHashMap<String, String>();
        //open();
        try {


            Cursor cur = db.rawQuery("Select * from tblGetReturnsReasonForPDAMstr", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapRtrnRsn.put(cur.getString(1), cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println(" Print e =" + e.toString());
        } finally {
            //  close();
            return hmapRtrnRsn;
        }
    }

    public LinkedHashMap<String, String> getSavedRemark(String StoreID, String OrderPDAID, String TmpInvoiceCodePDA) {
//			              /  //tblStoreReturnDetail (RouteID text null,StoreID text null,ReturnProductID text null, ProdReturnQty text null, ProdReturnReason text null, ProdReturnReasonIndex text null,ReturnDate text null,Sstat integer null,OrderIDPDA text null);";
        LinkedHashMap<String, String> hmapRtrnRsn = new LinkedHashMap<String, String>();
        //open();
        try {


            Cursor cur = db.rawQuery("Select * from tblStoreReturnDetail where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapRtrnRsn.put(cur.getString(2), cur.getString(4));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println(" Print e =" + e.toString());
        } finally {
            // close();
            return hmapRtrnRsn;
        }
    }

    public void updateflgFromWhereSubmitStatusAgainstStore(String sID, int flag2set, String StoreVisitCode) {
        try {

            final ContentValues values = new ContentValues();
            values.put("flgFromWhereSubmitStatus", flag2set);
            int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND flgFromWhereSubmitStatus=? AND StoreVisitCode=?", new String[]{sID, "" + 0, StoreVisitCode});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    public int checkCountIntblNewStoreSalesQuotePaymentDetails(String StoreId) {
        //open();
        Cursor cursor = null;
        int check = 0;
        try {

            //tblNewStoreSalesQuotePaymentDetails (StoreId text null,PymtStageId text null,Sstat text null);";
            cursor = db.rawQuery("SELECT Count(*) FROM tblNewStoreSalesQuotePaymentDetails WHERE  StoreId ='" + StoreId + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        check = 1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();
            // close();
        }
        return check;
    }

    //Code For Order Payment and Bill Starts Here

    public ArrayList<LinkedHashMap<String, String>> fngetStoreBillToAddressAndDiliverToAddress(String StoreID) {

        ArrayList<LinkedHashMap<String, String>> totalProductDetail = new ArrayList<LinkedHashMap<String, String>>(3);
        LinkedHashMap<String, String> hmapStoreBillTogAddresse = new LinkedHashMap<String, String>();
        LinkedHashMap<String, String> hmapStoreShippToAddress = new LinkedHashMap<String, String>();
        LinkedHashMap<String, String> hmapStoreAddress = new LinkedHashMap<String, String>();
        //open();
        Cursor cur = db.rawQuery("Select OutAddTypeID,Address,AddressDet,OutAddID from tblStoreAddressMapDetailsMstr where StoreID='" + StoreID + "'", null);
        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                for (int i = 0; i < cur.getCount(); i++) {
                    if (Integer.parseInt(cur.getString(0)) == 1) {
                        hmapStoreBillTogAddresse.put(cur.getString(1), cur.getString(3));
                    }
                    if (Integer.parseInt(cur.getString(0)) == 2) {
                        hmapStoreShippToAddress.put(cur.getString(1), cur.getString(3));
                    }
                    hmapStoreAddress.put(cur.getString(3), cur.getString(2));

                    cur.moveToNext();
                }
            }
        }
        // close();

        totalProductDetail.add(0, hmapStoreBillTogAddresse);
        totalProductDetail.add(1, hmapStoreShippToAddress);
        totalProductDetail.add(2, hmapStoreAddress);

        return totalProductDetail;
    }

    public long fnsaveStoreSalesOrderPaymentDetails(String StoreId, String OrderID, String PaymentStageId, String Sstat, String TmpInvoiceCodePDA) {

        ContentValues initialValues = new ContentValues();


        initialValues.put("StoreId", StoreId.toString().trim());
        initialValues.put("OrderID", OrderID.toString().trim());
        initialValues.put("PymtStageId", PaymentStageId.toString().trim());
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("Sstat", Sstat);

        return db.insert(DBHelper.DATABASE_TABLE_StoreSalesOrderPaymentDetails, null, initialValues);
    }

    public void fndeleteStoreSalesOrderPaymentDetails(String StoreID, String OrderID, String TmpInvoiceCodePDA) {

        db.execSQL("DELETE FROM tblStoreSalesOrderPaymentDetails WHERE StoreId ='" + StoreID + "' and OrderID='" + OrderID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
    }

    public void fndeleteStoreAddressMapDetailsMstr() {

        db.execSQL("DELETE FROM tblStoreAddressMapDetailsMstr");
    }

    public int checkCountIntblStoreSalesOrderPaymentDetails(String StoreId, String OrderID, String TmpInvoiceCodePDA) {
        //open();
        Cursor cursor = null;
        int check = 0;
        try {


            cursor = db.rawQuery("SELECT * FROM tblStoreSalesOrderPaymentDetails WHERE  StoreId ='" + StoreId + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        check = 1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();
            //   close();
        }
        return check;
    }
//tblStoreAddressMapDetailsMstr

    public String fngettblStoreSalesOrderPaymentDetails(String StoreID, String OrderID, String TmpInvoiceCodePDA) {


        String searchString = "";


        try {
            //open();

            Cursor cur = db.rawQuery("Select IFNULL(PymtStageId,0) from tblStoreSalesOrderPaymentDetails Where StoreId ='" + StoreID + "' and OrderID='" + OrderID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);

            if (cur.getCount() > 0) {

                StringBuilder sBuilder = new StringBuilder();

                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        searchString = cur.getString(0);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //   close();
            return searchString;
        }
    }

    public int checkPaymentStageintStoreMstrTabel(String StoreId) {
        //open();
        Cursor cursor = null;
        int check = 0;
        try {

            cursor = db.rawQuery("SELECT * FROM tblStoreList WHERE  StoreID ='" + StoreId + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        check = 1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();
            // close();
        }
        return check;
    }

    public int checkStoreOrderBillAddressDetails(String StoreId, String OrderID) {
        //open();
        Cursor cursor = null;
        int check = 0;
        try {

            cursor = db.rawQuery("SELECT * FROM tblStoreOrderBillAddressDetails WHERE  StoreID ='" + StoreId + "' and OrderID='" + OrderID + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        check = 1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();
            //close();
        }
        return check;
    }

    public void fndeleteStoreOrderBillAddressDetails(String StoreID, String OrderID) {
        //open();
        db.execSQL("DELETE FROM tblStoreOrderBillAddressDetails WHERE StoreId ='" + StoreID + "' and OrderID='" + OrderID + "'");
        // close();
    }

    public long fnsaveStoreOrderBillAddressDetails(String StoreId, String OrderID, String BillToAddress, String ShipToAddress, String Sstat) {

        ContentValues initialValues = new ContentValues();


        initialValues.put("StoreID", StoreId.toString().trim());
        initialValues.put("OrderID", OrderID.toString().trim());
        initialValues.put("BillToAddress", BillToAddress.toString().trim());
        initialValues.put("ShipToAddress", ShipToAddress.toString().trim());
	    /* initialValues.put("OrderID", OrderID.toString().trim());
	      initialValues.put("OutAddTypeID",OutAddTypeID );
	      initialValues.put("OutAddID", OutAddID);
	      initialValues.put("DeliveryPreferTime", DeliveryPreferTime);
	      initialValues.put("DeliveryNotPreferTime", DeliveryNotPreferTime);*/
        initialValues.put("Sstat", Sstat);

        return db.insert("tblStoreOrderBillAddressDetails", null, initialValues);
    }

    public int checkIfCurrentStoreIsNewInOrderBill(String StoreID) {

        int ScodecolumnIndex = 0;
        int ISNewStore = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT ISNewStore FROM tblStoreList where StoreID='" + StoreID + "'", null);
        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ISNewStore = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                    cursor.moveToNext();
                }
            }
            return ISNewStore;
        } finally {
            cursor.close();
            //   close();
        }
    }

    public String fetchBillAddress(String OutletID) {
        //open();
        Cursor cursor = null;
        String CompleteBillAddress = "";
        try {

            cursor = db.rawQuery("SELECT QuestID,AnswerType,AnswerValue,QuestionGroupID FROM tblOutletQuestAnsMstr WHERE  OutletID ='" + OutletID + "' and QuestionGroupID in (1,3,4) ", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String DDlStringCity = "";
                        if (Integer.parseInt(cursor.getString(1).toString()) == 8) {
                            DDlStringCity = fnGetCityName(cursor.getString(0).toString().trim(), cursor.getString(2).toString().trim());
                        }
                        if (Integer.parseInt(cursor.getString(3)) == 1 || Integer.parseInt(cursor.getString(3)) == 4) {
                            if (CompleteBillAddress.equals("")) {
                                CompleteBillAddress = cursor.getString(2).toString().trim();
                            } else {
                                CompleteBillAddress = CompleteBillAddress + ", " + cursor.getString(2).toString().trim();
                            }
                        } else if (Integer.parseInt(cursor.getString(3)) == 3) {
                            if (CompleteBillAddress.equals("")) {
                                CompleteBillAddress = DDlStringCity;
                            } else {
                                CompleteBillAddress = CompleteBillAddress + ", " + DDlStringCity;
                            }
                        }

                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();
            // close();
        }
        return CompleteBillAddress;
    }

    public String fnGetCityName(String QuestID, String AnsValue) {

        Cursor cursor = null;
        String DDlStringCity = "";
        try {

            cursor = db.rawQuery("SELECT OptionDescr FROM tblGetPDAQuestOptionMstr WHERE  QuestID ='" + QuestID + "' and OptID='" + AnsValue + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        DDlStringCity = cursor.getString(0).toString().trim();

                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();

        }
        return DDlStringCity;
    }

    public String fetchDeliverAddress(String OutletID) {
        //open();
        Cursor cursor = null;
        String CompleteDileveryAddress = "";
        try {

            cursor = db.rawQuery("SELECT QuestID,AnswerType,AnswerValue,QuestionGroupID FROM tblOutletQuestAnsMstr WHERE  OutletID ='" + OutletID + "' and QuestionGroupID in (5,7,8) ", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String DDlStringCity = "";
                        if (Integer.parseInt(cursor.getString(1).toString()) == 8) {
                            DDlStringCity = fnGetCityName(cursor.getString(0).toString().trim(), cursor.getString(2).toString().trim());
                        }
                        if (Integer.parseInt(cursor.getString(3)) == 5 || Integer.parseInt(cursor.getString(3)) == 8) {
                            if (CompleteDileveryAddress.equals("")) {
                                CompleteDileveryAddress = cursor.getString(2).toString().trim();
                            } else {
                                CompleteDileveryAddress = CompleteDileveryAddress + ", " + cursor.getString(2).toString().trim();
                            }
                        } else if (Integer.parseInt(cursor.getString(3)) == 7) {
                            if (CompleteDileveryAddress.equals("")) {
                                CompleteDileveryAddress = DDlStringCity;
                            } else {
                                CompleteDileveryAddress = CompleteDileveryAddress + ", " + DDlStringCity;
                            }
                        }

                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();
            // close();
        }
        return CompleteDileveryAddress;
    }

    public String fnGetPreFilledStoreOrderBillAddressDetails(String StoreId, String OrderID) {
        ////tblGetReturnsReasonForPDAMstr(StockStatusId text not null,StockStatus text not null);";
        String strPreFilledStoreOrderBillAddressDetails = "";
        //open();
        try {
            Cursor cur = db.rawQuery("Select BillToAddress,ShipToAddress from tblStoreOrderBillAddressDetails Where StoreID='" + StoreId + "' and OrderID='" + OrderID + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        strPreFilledStoreOrderBillAddressDetails = cur.getString(0) + "$" + cur.getString(1);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println(" Print e =" + e.toString());
        } finally {
            //  close();
            return strPreFilledStoreOrderBillAddressDetails;
        }
    }

    public void fndeleteStoreSalesOrderPaymentDetailsOnStoreIDBasis(String StoreID) {
        //open();
        db.execSQL("DELETE FROM tblStoreSalesOrderPaymentDetails WHERE StoreId ='" + StoreID + "'");
        //close();
    }

    public void fndeleteStoreOrderBillAddressDetailsOnStoreIDBasis(String StoreID) {
        //open();
        db.execSQL("DELETE FROM tblStoreOrderBillAddressDetails WHERE StoreId ='" + StoreID + "'");
        // close();
    }

    public String fnGetDefaultStoreOrderPAymentDetails(String StoreId) {
        //open();
        Cursor cursor = null;
        String PaymentStageFROM = "";
        try {

            cursor = db.rawQuery("SELECT PaymentStage FROM tblStoreList WHERE  StoreID ='" + StoreId + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        PaymentStageFROM = cursor.getString(0).toString();
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();
            // close();
        }
        return PaymentStageFROM;
    }

    // "create table tblStoreSomeProdQuotePriceMstr (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
    public LinkedHashMap<String, Integer> getMinDlvryQntty(String storeId) {
        LinkedHashMap<String, Integer> hmapMinDlvrQty = new LinkedHashMap<String, Integer>();
        //open();
        try {


            Cursor cur = db.rawQuery("Select PrdId,MinDlvrQty from tblStoreSomeProdQuotePriceMstr where StoreID='" + storeId + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapMinDlvrQty.put(cur.getString(0), cur.getInt(1));
                        cur.moveToNext();
                    }
                }
            }

        } catch (Exception e) {

        } finally {
            //  close();
            return hmapMinDlvrQty;
        }
    }

    // "create table tblStoreSomeProdQuotePriceMstr (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
    public LinkedHashMap<String, String> getMinDlvryQnttyQPBT(String storeId) {
        LinkedHashMap<String, String> hmapMinDlvrQtyQPBT = new LinkedHashMap<String, String>();
        //open();
        try {


            Cursor cur = db.rawQuery("Select PrdId,QPBT from tblStoreSomeProdQuotePriceMstr where StoreID='" + storeId + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapMinDlvrQtyQPBT.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }

        } catch (Exception e) {

        } finally {
            //  close();
            return hmapMinDlvrQtyQPBT;
        }
    }

    public LinkedHashMap<String, String> getMinDlvryQnttyQPAT(String storeId) {
        LinkedHashMap<String, String> hmapMinDlvrQtyQPAT = new LinkedHashMap<String, String>();
        //open();
        try {


            Cursor cur = db.rawQuery("Select PrdId,QPAT from tblStoreSomeProdQuotePriceMstr where StoreID='" + storeId + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapMinDlvrQtyQPAT.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }

        } catch (Exception e) {

        } finally {
            // close();
            return hmapMinDlvrQtyQPAT;
        }
    }

    // "create table tblStoreSomeProdQuotePriceMstr (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
    public LinkedHashMap<String, String> getMinDlvryQnttyQPTaxAmount(String storeId) {
        LinkedHashMap<String, String> hmapMinDlvrQtyQPTaxAmount = new LinkedHashMap<String, String>();
        //open();
        try {


            Cursor cur = db.rawQuery("Select PrdId,QPTaxAmount from tblStoreSomeProdQuotePriceMstr where StoreID='" + storeId + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapMinDlvrQtyQPTaxAmount.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }

        } catch (Exception e) {

        } finally {
            // close();
            return hmapMinDlvrQtyQPTaxAmount;
        }
    }

    public int fnchkIfStoreFasQuote(String StoreId) {
        //open();
        Cursor cursor = null;
        int check = 0;
        try {

            cursor = db.rawQuery("SELECT flgHasQuote FROM tblStoreList WHERE  StoreID ='" + StoreId + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (Integer.parseInt(cursor.getString(0).toString()) == 1) {
                        check = 1;
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();
            //  close();
        }
        return check;
    }

    public void fnDeletefromtblSchemeStoreMappingAgainstStore(String StoreID) {
        //open();
        db.execSQL("DELETE  FROM tblSchemeStoreMapping WHERE  StoreID='" + StoreID + "'");
        //  close();
    }

    public int fnchkIfStoreAllowQuotation(String StoreId) {
        //open();
        Cursor cursor = null;
        int check = 0;
        try {

            cursor = db.rawQuery("SELECT flgAllowQuotation FROM tblStoreList WHERE  StoreID ='" + StoreId + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (Integer.parseInt(cursor.getString(0).toString()) == 1) {
                        check = 1;
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();
            //  close();
        }
        return check;
    }

    public void UpdateStoreFlagQoutation(String sID, int flag2set) {

        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected = db.update("tblStoreList", values, "StoreID=?", new String[]{sID});
            int affected26 = db.update("tblRateDistribution", values, "StoreId=?", new String[]{sID});

            int affected4 = db.update("tblNewStoreListEntries", values, "StoreID=?", new String[]{sID});
            int affected9 = db.update("tblNewStoreEntries", values, "StoreID=?", new String[]{sID});
            int affected10 = db.update("tblTemp", values, "StoreID=?", new String[]{sID});

            int affected17 = db.update("tblSalesQuotePersonMeetMstr", values, "StoreId=?", new String[]{sID});
            int affected21 = db.update("tblOutletQuestAnsMstr", values, "OutletID=?", new String[]{sID});
            int affected261 = db.update("tblNewAddedStoreLocationDetails", values, "StoreID=?", new String[]{sID});
            int affected23 = db.update("tblNewStoreSalesQuotePaymentDetails", values, "StoreId=?", new String[]{sID});

            LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr = fngetDistinctSalesQuotePersonMeetMstrForSstatUpdate(sID);


            Iterator it11new = hmapDistinctSalesQuotePersonMeetMstr.entrySet().iterator();

            while (it11new.hasNext()) {
                Entry pair = (Entry) it11new.next();
                if (hmapDistinctSalesQuotePersonMeetMstr.containsKey(pair.getKey().toString())) {
                    //crntPID	=pair.getKey().toString();
                    int affected18 = db.update("tblSalesQuoteProductsMstr", values, "SalesQuoteId=?", new String[]{pair.getKey().toString()});
                }

            }

            Log.w(TAG, "affected records: " + affected);

            Log.w(TAG, "Record(s) Updated..");

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void updateStoreQuoteSubmitFlgInStoreMstr(String StoreID, int flgSubmitFromQuotation, String StoreVisitCode) {
        //open();

        final ContentValues values = new ContentValues();
        values.put("flgSubmitFromQuotation", flgSubmitFromQuotation);
        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?",
                new String[]{StoreID, StoreVisitCode});

        // close();
    }

    public int fnchkIfStoreHasInvoiceEntry(String StoreId) {

        Cursor cursor = null;
        int check = 0;
        try {

            cursor = db.rawQuery("SELECT * FROM tblTmpInvoiceHeader WHERE  StoreID ='" + StoreId + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (Integer.parseInt(cursor.getString(0).toString()) == 1) {
                        check = 1;
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();

        }
        return check;
    }

    public void updateStoreQuoteSubmitFlgInStoreMstrInChangeRouteCase(String StoreID, int flgSubmitFromQuotation) {
        final ContentValues values = new ContentValues();
        values.put("flgSubmitFromQuotation", flgSubmitFromQuotation);
        int affected = db.update("tblStoreList", values, "StoreID=?", new String[]{StoreID});
    }

    public String[] FetchStoreStatusflgSubmitFromQuotation() {
        int ScodecolumnIndex = 0;
        Cursor cursor = db.rawQuery("SELECT flgSubmitFromQuotation FROM tblStoreList ORDER BY DistanceNear", null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = cursor.getString(ScodecolumnIndex).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }

    public LinkedHashMap<String, String> fnGetListQuoteISOfUnmappedWithProducts(String StoreID) {
        //open();
        Cursor cursor = db.rawQuery("Select Distinct tblSalesQuotePersonMeetMstr.SalesQuoteId from tblSalesQuotePersonMeetMstr Where tblSalesQuotePersonMeetMstr.SalesQuoteId not in(Select tblSalesQuoteProductsMstr.SalesQuoteId from tblSalesQuoteProductsMstr) and StoreId='" + StoreID + "'", null);
        LinkedHashMap<String, String> hmapList = new LinkedHashMap<String, String>();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    hmapList.put(cursor.getString(0).toString(), StoreID);
                }

            }
            return hmapList;
        } finally {
            //cursor.close();
            //  close();
        }
    }

    public void fndeleteQuoteISOfUnmappedWithProducts(String SalesQuoteId) {
        //open();
        db.execSQL("DELETE FROM tblSalesQuoteProductsMstr WHERE SalesQuoteId='" + SalesQuoteId + "'");
        db.execSQL("DELETE FROM tblSalesQuotePersonMeetMstr WHERE SalesQuoteId='" + SalesQuoteId + "'");
        db.execSQL("DELETE FROM tblRateDistribution WHERE SalesQuoteId='" + SalesQuoteId + "'");
        // close();
    }

    public int fnGetBusinessSegmentIDAgainstStoreType(int OutChannelID) {

        int ScodecolumnIndex = 0;
        int BusinessSegmentID = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT BusinessSegmentID FROM tblOutletChannelBusinessSegmentMaster where OutChannelID=" + OutChannelID, null);
        try {


            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    BusinessSegmentID = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                    cursor.moveToNext();
                }
            }
            return BusinessSegmentID;
        } finally {
            cursor.close();
            // close();
        }
    }

    public int fnGetAnsValID(int optionId) {
//tblGetPDAQuestOptionMstr(OptID int null,QuestID int null,OptionNo int null,OptionDescr text null,Sequence int null );";
        int ScodecolumnIndex = 0;
        int ansValId = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT OptionNo FROM tblGetPDAQuestOptionMstr where OptID=" + optionId, null);
        try {


            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ansValId = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                    cursor.moveToNext();
                }
            }
            return ansValId;
        } finally {
            cursor.close();
            // close();
        }
    }

    public String fnGetQuestIDForOutChannelFromQuestionMstr() {//tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null,GrpCopyID int null,QuestCopyID int null);";

        int ScodecolumnIndex = 0;
        int ansCntrlTypeIndex = 1;
        int grpQuestIdIndex = 2;
        String QuestID = "0";
        //open();
      /*  Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestGrpMapping.GrpQuestID FROM tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping ON tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID where tblGetPDAQuestMstr.flgQuestIDForOutChannel=1", null);
        try {


            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    QuestID = cursor.getString(ScodecolumnIndex) + "^" + cursor.getString(ansCntrlTypeIndex) + "^" + cursor.getString(grpQuestIdIndex);
                    cursor.moveToNext();
                }
            }
            return QuestID;
        } finally {
            cursor.close();
            // close();
        }*/
        return QuestID;
    }

    public long saveTblSalesQuoteSponsorMstr(String SalesQuoteSponsorID, String SponsorDescr, String Ordr) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuoteSponsorID", SalesQuoteSponsorID.toString().trim());
        initialValues.put("SponsorDescr", SponsorDescr.toString().trim());
        initialValues.put("Ordr", Ordr.toString().trim());

        return db.insert(DBHelper.TABLE_tblSalesQuoteSponsorMstr, null, initialValues);
    }

    public long saveTblManufacturerMstrMain(String ManufacturerID, String ManufacturerName, String NodeType) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("ManufacturerID", ManufacturerID.toString().trim());
        initialValues.put("ManufacturerName", ManufacturerName.toString().trim());
        initialValues.put("NodeType", NodeType.toString().trim());

        return db.insert(DBHelper.TABLE_tblManufacturerMstrMain, null, initialValues);
    }

    public long saveTblRateDistribution(String SalesQuoteId, String StoreId, String SalesQuoteSponsorID, String ManufacturerID, String Percentage, String SponsorDescr, String ManufacturerName, String Sstat) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SalesQuoteId", SalesQuoteId.toString().trim());
        initialValues.put("StoreId", StoreId.toString().trim());
        initialValues.put("SalesQuoteSponsorID", SalesQuoteSponsorID.toString().trim());
        initialValues.put("ManufacturerID", ManufacturerID.toString().trim());
        initialValues.put("Percentage", Percentage.toString().trim());
        initialValues.put("SponsorDescr", SponsorDescr.toString().trim());
        initialValues.put("ManufacturerName", ManufacturerName.toString().trim());
        initialValues.put("Sstat", Sstat.toString().trim());

        return db.insert(DBHelper.TABLE_tblRateDistribution, null, initialValues);
    }

    public LinkedHashMap<String, String> fnGettblManufacturerMstrMain() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
// Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'

// (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            Cursor cursor = db.rawQuery("SELECT ManufacturerID,ManufacturerName,NodeType from tblManufacturerMstrMain   ", null);// Where PNodeID='"+TSIID+"'
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(1).toString(), (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(2).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();
            return hmapQuestionMstr;
        }
    }

    public LinkedHashMap<String, ArrayList<String>> fnGettblRateDistribution(String SalesQuoteId, String StoreId) {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr = new LinkedHashMap<String, ArrayList<String>>();

        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT SalesQuoteSponsorID,ManufacturerID,Percentage,SponsorDescr,ManufacturerName from tblRateDistribution   where SalesQuoteId='" + SalesQuoteId + "' and StoreId='" + StoreId + "'", null);// Where PNodeID='"+TSIID+"'
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        ArrayList<String> abc = new ArrayList<String>();
                        abc.add((String) cursor.getString(0).toString());
                        abc.add((String) cursor.getString(1).toString());
                        abc.add((String) cursor.getString(2).toString());
                        abc.add((String) cursor.getString(3).toString());
                        abc.add((String) cursor.getString(4).toString());
                        hmapQuestionMstr.put(abc.get(0), abc);
                        cursor.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();
            return hmapQuestionMstr;
        }
    }

    public LinkedHashMap<String, String> fnGettblSalesQuoteSponsorMstr() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
// Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'

// (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            Cursor cursor = db.rawQuery("SELECT SalesQuoteSponsorID,SponsorDescr,Ordr from tblSalesQuoteSponsorMstr   ", null);// Where PNodeID='"+TSIID+"'
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(1).toString(), (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(2).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            //close();
            return hmapQuestionMstr;
        }
    }

    public LinkedHashMap<String, String> fnProductManufractureIDList() {
        LinkedHashMap<String, String> hmapProductManufractureIDList = new LinkedHashMap<String, String>();
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT ProductID,ManufacturerID from tblProductListMaster", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapProductManufractureIDList.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnProductManufractureIDList= " + e.toString());
        } finally {

            // close();
            return hmapProductManufractureIDList;
        }
    }

    public ArrayList<String> fectProductIDMappedInSchSlbSubBukRowIdTemp(int schSlbSubRowID) {
        //open();
        Cursor cursor = db.rawQuery("SELECT ProductID FROM tblSchemeSlabBucketProductMapping WHERE RowID =" + schSlbSubRowID, null);
        try {
            ArrayList<String> CompleteResult = new ArrayList<String>();
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        CompleteResult.add(cursor.getString(0));
                        cursor.moveToNext();
                    }
                }
            }
            return CompleteResult;

        } finally {
            cursor.close();
            // close();
        }

    }

    public String fnGetBenifitAssignedValue(String StoreID, int ProductIdOnClicked, int schId, String TmpInvoiceCodePDA,int flgInCarton) {
        //tblStoreProductAppliedSchemesBenifitsRecords (StoreID text not null,ProductID int not null,schId int not null,schSlabId integer not null,schSlbBuckId integer not null,schSlabSubBucketValue real not null,schSubBucketValType integer not null,schSlabSubBucketType int not null,BenifitRowID integer not null,BenSubBucketType int null,FreeProductID int null,BenifitSubBucketValue real null,BenifitMaxValue real null,BenifitAssignedValue real null,BenifitAssignedValueType int null,BenifitDiscountApplied int null,BenifitCouponCode text null,Sstat integer not null,Per real null,UOM real null,WhatFinallyApplied int null,schSlbRowId int null,SchTypeId int null,DiscountPercentage real null,OrderIDPDA text null);";
        //open();
        Cursor cursor = db.rawQuery("SELECT FreeProductID,BenifitAssignedValue,BenSubBucketType FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='" + StoreID + "' and  schId=" + schId + " and BenSubBucketType in(1,5,2,6,3,7) AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and ProductID=" + ProductIdOnClicked, null);
        String chkI = "";
        try {
            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (cursor.getString(0) != null && cursor.getString(1) != null && cursor.getString(2) != null) {
                            chkI = cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2);
                        }
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            cursor.close();
            //close();
        }
        return chkI;
    }
    public void fnDeleteRecordsAllRecordsForClickedProdoductIdSchm_1_3(String StoreID,int ProductIdOnClicked,String pdaOrderID,int schmId,int flgInCarton)
    {

        //tblStoreProductAddOnSchemeApplied
        db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' and OrderIDPDA='"+pdaOrderID+"' and ProductID="+ ProductIdOnClicked+" and schId="+ schmId+ " and flgInCarton="+flgInCarton);
        // db.execSQL("DELETE FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' and OrderIDPDA='"+pdaOrderID+"' and schId="+ ProductIdOnClicked);

    }
    public ArrayList<String> fnGetProductsSchIdSlabRowList(String StoreID, int RowID, String pdaOrderID, String TmpInvoiceCodePDA,int flgInCarton) {//tblSchemeSlabBenefitsProductMappingDetail (RowID text null,ProductID text null)
        //open();//schId
// Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId="+RowID, null);
        Cursor cursorE2 = db.rawQuery("SELECT ProductID FROM  tblStoreProductAppliedSchemesBenifitsRecords where schSlbRowId=" + RowID + " AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'  and StoreID='" + StoreID + "' and flgInCarton="+flgInCarton, null);
        ArrayList<String> AllProductInSlab = new ArrayList<String>();

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    for (int i = 0; i <= (cursorE2.getCount() - 1); i++) {
                        AllProductInSlab.add(cursorE2.getString(0));
                        cursorE2.moveToNext();
                        //cursor.moveToNext();
                    }
                }
            }
            return AllProductInSlab;
        } finally {
            cursorE2.close();
            // close();
        }

    }

    public void updateManufacturerIDAndName(String SalesQuoteId, String ManufacturerID, String ManufacturerName) {

        try {
            //open();

            final ContentValues values = new ContentValues();
            values.put("ManufacturerID", ManufacturerID);
            values.put("ManufacturerName", ManufacturerName);

            int affected = db.update("tblSalesQuotePersonMeetMstr", values, "SalesQuoteId=?", new String[]{SalesQuoteId});

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            // close();
        }

    }

    public String getManufacturerIDAndManufacturerNameDetails(String SalesQuoteId) {
        String searchString = "0^0";
        // LinkedHashMap<String, String> hmapQuotationPersionMeetDetails=new LinkedHashMap<String, String>();

        try {
            //open();
            Cursor cur = db.rawQuery("Select ManufacturerID,ManufacturerName from tblSalesQuotePersonMeetMstr Where tblSalesQuotePersonMeetMstr.SalesQuoteId='" + SalesQuoteId + "'", null);

            if (cur.getCount() > 0) {

                StringBuilder sBuilder = new StringBuilder();

                if (cur.moveToFirst()) {

                    for (int i = 0; i < cur.getCount(); i++) {

                        searchString = cur.getString(0) + "^" + cur.getString(1);

                        cur.moveToNext();

                    }

                }


            }


        } catch (Exception e) {

            // TODO: handle exception

        } finally {

            // close();

            return searchString;

        }

    }

    public int checkMessageIDExistOrNotForNotification(int MsgServerID) {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDANotificationMaster WHERE MsgServerID =" + MsgServerID, null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }


    public ArrayList<String> getGstDataByStore(String StoreID) {
        ArrayList<String> PrevAccuracy = new ArrayList<String>();
        //open();
        try {
            Cursor cursor2 = db.rawQuery("Select flgGSTCapture,flgGSTCompliance,ifnull(GSTNumber,'NA') from tblStoreList where StoreID ='" + StoreID + "'", null);
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        PrevAccuracy.add(cursor2.getString(0).toString().trim());
                        PrevAccuracy.add(cursor2.getString(1).toString().trim());
                        PrevAccuracy.add(cursor2.getString(2).toString().trim());
                        // PrevAccuracy =cursor2.getString(0).toString().trim()+"^"+cursor2.getString(1).toString().trim()+"^"+cursor2.getString(2).toString().trim();
                        cursor2.moveToNext();
                    }

                }
            }
        } catch (Exception e) {
        } finally {
            //  close();
        }
        return PrevAccuracy;
    }

    public int fnGetflgServerRecordFromOutletMstr(String StoreID) {
        int flgServerRecord = 0;

        try {
            //open();
            //Cursor cursor = db.rawQuery("SELECT flgGSTRecordFromServer FROM tblStoreList where StoreID='" + StoreID + "' and Sstat=3", null);
            Cursor cursor = db.rawQuery("SELECT flgGSTRecordFromServer FROM tblStoreList where StoreID='" + StoreID + "'", null);

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(0)) {
                        flgServerRecord = Integer.parseInt(cursor.getString(0).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return flgServerRecord;
        } finally {
            // close();
        }
    }

    public void UpdateStoreInfoGST(String StoreID, String flgGSTCapture, String flgGSTCompliance, String GSTNumber) {
        try {
            //open();
            final ContentValues values = new ContentValues();
            values.put("flgGSTCapture", flgGSTCapture);
            values.put("flgGSTCompliance", flgGSTCompliance);
            values.put("GSTNumber", GSTNumber);


            int affected = db.update("tblStoreList", values, "StoreID=?", new String[]{StoreID});
        } catch (Exception e) {

        } finally {
            // close();
        }

    }

    public String fnGetGstOptionIDComplianceWhileAddingNewStore(String flgGSTCompliance) {
        String flgGSTComplianceResult = "0";

        try {
            //open();
            Cursor cursor = db.rawQuery("SELECT OptionNo FROM tblGetPDAQuestOptionMstr where OptID='" + flgGSTCompliance + "'", null);

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(0)) {
                        flgGSTComplianceResult = cursor.getString(0).toString();
                        cursor.moveToNext();
                    }

                }
            }
            return flgGSTComplianceResult;
        } finally {
            // close();
        }
    }

    public int countNumberOFNotificationtblPDANotificationMaster() throws IOException {
        int chkI = 0;
        Cursor cursorE2 = db.rawQuery("SELECT Count(*) FROM tblPDANotificationMaster where Noti_NewOld=1 and Noti_ReadStatus=1", null);

        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public LinkedHashMap<String, String> fngetAllOptionForQuestionID(int QuestID) {
        //open();
        LinkedHashMap<String, String> hashMapOption = new LinkedHashMap<String, String>();

        try {
            Cursor cursor = db.rawQuery("Select OptID,OptionDescr,Sequence from tblGetPDAQuestOptionMstr where QuestID=" + QuestID + "and Sequence Order by acs", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount() - 1; i++) {
                        hashMapOption.put(cursor.getString(0), cursor.getString(1));
                    }
                }
            }
        } catch (Exception e) {

        } finally {
            // close();
            return hashMapOption;
        }


    }
    //private static final String DATABASE_CREATE_TABLE_OPTIONMstr = "create table tblGetPDAQuestOptionMstr" +
    //"(OptID int null,QuestID int null,OptionNo int null,OptionDescr text null,Sequence int null );";

    public String[] getAllOptValueDpndntQuest() {
        String[] allQuestValesDpndnt = null;
        //open();
        try {

            //tblGetPDAQuestionDependentMstr(QuestionID int null,OptionID int null,DependentQuestionID int null,GrpID int null,GrpDepQuestID int null)
            Cursor cur = db.rawQuery("Select Distinct GrpID from tblGetPDAQuestionDependentMstr", null);
            if (cur.getCount() > 0) {
                allQuestValesDpndnt = new String[cur.getCount()];
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        allQuestValesDpndnt[i] = String.valueOf(cur.getInt(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            // close();
            return allQuestValesDpndnt;
        }

    }


    // New Added Store Fun Start

    public String[] fnGetDependentParentQuesIdr() {


        //open();
//tblGetPDAQuestionDependentMstr(QuestionID int null,OptionID int null,DependentQuestionID int null,GrpID int null,GrpDepQuestID int null);";
        Cursor cursor = db.rawQuery("SELECT DISTINCT GrpDepQuestID from tblGetPDAQuestionDependentMstr", null);// Where PNodeID='"+TSIID+"'
        String[] arrbhi = new String[cursor.getCount()];
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        // hmapDpndntQuestionMstr.put((String) cursor.getString(3).toString()+"^"+(String) cursor.getString(1).toString(), (String) cursor.getString(2).toString());
                        arrbhi[i] = (String) cursor.getString(0).toString();
                        cursor.moveToNext();
                    }
                }
            }

            return arrbhi;
        } finally {
            cursor.close();
            //close();
        }
    }

    public LinkedHashMap<String, String> fnGetQuestionID_AnsCntrlType() {
        LinkedHashMap<String, String> hmapQuestionId_AnsCntrlTyper = new LinkedHashMap<String, String>();
        //open();
        int lastIndex = 0;
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor = db.rawQuery("SELECT QuestID,AnsControlType from tblGetPDAQuestMstr", null);

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionId_AnsCntrlTyper.put(cursor.getString(0).trim(), (String) cursor.getString(1).toString().trim());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return hmapQuestionId_AnsCntrlTyper;
        } finally {
            cursor.close();
            // close();
        }
    }

    public LinkedHashMap<String, ArrayList<String>> getAllQuestIdDpndnt() {// //tblGetPDAQuestionDependentMstr(QuestionID int null,OptionID int null,DependentQuestionID int null,GrpID int null,GrpDepQuestID int null);";
        LinkedHashMap<String, ArrayList<String>> hmapQuestDependVisible = new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listQestDpndnt = new ArrayList<String>();

        try {


            //open();

            Cursor cur = db.rawQuery("Select GrpID,GrpDepQuestID from tblGetPDAQuestionDependentMstr Order By GrpDepQuestID", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    String questId, dpndntQuestId, prvsdpndntQuestId = null;
                    for (int i = 0; i < cur.getCount(); i++) {
                        questId = String.valueOf(cur.getInt(0));
                        dpndntQuestId = String.valueOf(cur.getInt(1));
                        if (i == 0) {
                            listQestDpndnt.add(questId);
                            prvsdpndntQuestId = dpndntQuestId;
                        } else {
                            if (prvsdpndntQuestId == dpndntQuestId) {
                                listQestDpndnt.add(questId);
                            } else {
                                hmapQuestDependVisible.put(prvsdpndntQuestId, listQestDpndnt);
                                listQestDpndnt = new ArrayList<String>();

                                listQestDpndnt.add(questId);
                                prvsdpndntQuestId = dpndntQuestId;
                            }


                        }
                        if (i == cur.getCount() - 1) {
                            hmapQuestDependVisible.put(prvsdpndntQuestId, listQestDpndnt);
                        }
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("ErrorDatabase getAllQuestIdWhoseValuesDpndnt =" + e.toString());
        } finally {
            // close();
            return hmapQuestDependVisible;
        }
    }

    public LinkedHashMap<String, String> getAllQstGrpIdAgainstGrp() {
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //open();
        LinkedHashMap<String, String> hmapData = new LinkedHashMap<String, String>();
        Cursor cur = db.rawQuery("Select GrpID,GrpQuestID from tblGetPDAQuestGrpMapping", null);
        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                for (int i = 0; i < cur.getCount(); i++) {
                    hmapData.put(cur.getString(1), cur.getString(0));
                    cur.moveToNext();
                }
            }
        }
        // close();
        return hmapData;
    }

    public LinkedHashMap<String, String> getQuestGrpIdLnkWdQstId() {
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //open();
        LinkedHashMap<String, String> hmapData = new LinkedHashMap<String, String>();
        Cursor cur = db.rawQuery("Select QuestID,GrpQuestID from tblGetPDAQuestGrpMapping", null);
        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                for (int i = 0; i < cur.getCount(); i++) {
                    hmapData.put(cur.getString(1), cur.getString(0));
                    cur.moveToNext();
                }
            }
        }
        // close();
        return hmapData;
    }

    public String getChannelGroupIdOptId() {
        String grpQstIdOptIdForChannel = "0-0-0";

return grpQstIdOptIdForChannel;
     /*   try {

//tblQuestIDForOutChannel(GrpQstId int null,QuestID int null,OptID text null,SectionCount int null);";
            Cursor cur = db.rawQuery("Select OptID from tblQuestIDForOutChannel", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {

                    grpQstIdOptIdForChannel = cur.getString(0);
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {

            return grpQstIdOptIdForChannel;
        }*/
    }

    public LinkedHashMap<String, String> getQuestAnswer(String tempId) {
        //open();
        LinkedHashMap<String, String> hmapRtrvQuestAns = new LinkedHashMap<String, String>();
        try {
            String channelOptId = getChannelGroupIdOptId();
            String channelkey = getChannelGroupIdKey();
            if (!channelOptId.equals("0-0-0") && !TextUtils.isEmpty(channelkey)) {
                hmapRtrvQuestAns.put(channelkey, channelOptId);
            }

            //  hmapRtrvQuestAns.put("1^6^1","0-80");
            //tblOutletQuestAnsMstr (OutletID text not null,QuestID text not null,AnswerType text null, AnswerValue text null,QuestionGroupID integer null,sectionID integer null,Sstat integer not null);";
            Cursor cursor = db.rawQuery("Select * from tblOutletQuestAnsMstr where OutletID='" + tempId + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {

                        hmapRtrvQuestAns.put(cursor.getString(1) + "^" + cursor.getString(2) + "^" + cursor.getString(4), cursor.getString(3));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //close();
            return hmapRtrvQuestAns;
        }
    }

    public LinkedHashMap<String, String> getPDAUserPreviousQuestionAnswerMasterServer(String tempId) {
        //open();
        LinkedHashMap<String, String> hmapPreviousVisitServerQuestionSavedAns = new LinkedHashMap<String, String>();
        try {
//tblPreAddedStoresDataDetails (StoreIDDB text null,GrpQuestID text null,QstId text null,AnsControlTypeID text null,AnsTextVal text null,flgPrvVal text null);";
            //tblPDAUserPreviousQuestionAnswerMaster(NodeID text null, NodeType text null,QstID text null,AnsControlTypeID text null,Answers text null,temID text null,flgPrvValue text null);";
            Cursor cursor = db.rawQuery("Select * from tblPreAddedStoresDataDetails where StoreIDDB='" + tempId + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapPreviousVisitServerQuestionSavedAns.put(cursor.getString(2) + "^" + cursor.getString(3) + "^" + cursor.getString(1), cursor.getString(4));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //close();
            return hmapPreviousVisitServerQuestionSavedAns;
        }
    }
/*	public static LinkedHashMap<String, String> fnGetQuestionIdFlgPrvValue(String TempID)
	{
	LinkedHashMap<String, String> hmapQuestionflgPrvValue=new LinkedHashMap<String, String>();
	//open();

	int lastIndex=0;
	Cursor cursor;
	cursor = db.rawQuery("SELECT QstId,AnsControlTypeID,flgPrvVal,GrpQuestID from tblPreAddedStoresDataDetails Where tblPreAddedStoresDataDetails.StoreIDDB='"+ TempID +"'", null);


	try {
		if(cursor.getCount()>0)
		{
			if (cursor.moveToFirst())
			{
				for (int i = 0; i <= (cursor.getCount() - 1); i++) {
					hmapQuestionflgPrvValue.put((String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(3).toString(), (String) cursor.getString(2).toString());

					cursor.moveToNext();
				}

			}
		}
		return hmapQuestionflgPrvValue;
	}
	finally
	{
		cursor.close();
		//close();
	}
}*/

    public LinkedHashMap<String, String> getGroupIdCopyAsAbove() {
        LinkedHashMap<String, String> hmapGroupIdCopyAsAbove = new LinkedHashMap<String, String>();
        //open();
        Cursor cur = db.rawQuery("Select DISTINCT GrpID,GrpCopyID from tblGetPDAQuestGrpMapping where GrpCopyID<>0", null);
        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                for (int i = 0; i < cur.getCount(); i++) {
                    hmapGroupIdCopyAsAbove.put(cur.getString(0), cur.getString(1));
                    cur.moveToNext();
                }
            }
        }
        // close();
        return hmapGroupIdCopyAsAbove;
    }

    public String getChannelGroupId() {
        String grpQstIdForChannel = "0";
        return grpQstIdForChannel;

        //open();
   /*     try {

//tblQuestIDForOutChannel(GrpQstId int null,QuestID int null,OptID text null,SectionCount int null);";
            Cursor cur = db.rawQuery("Select GrpQstId,QuestID from tblQuestIDForOutChannel", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    grpQstIdForChannel = cur.getString(0);
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            // close();
            return grpQstIdForChannel;
        }*/
    }

    public LinkedHashMap<String, String> getNameQstGrpId_QstId() {
        LinkedHashMap<String, String> grpQstId_qstIdForName = new LinkedHashMap<>();

        //open();
        try {


            Cursor cur = db.rawQuery("Select ID,GrpQstId,QuestID from tblQuestIDForName", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        grpQstId_qstIdForName.put(cur.getString(0), cur.getString(1) + "^" + cur.getString(2));
                        cur.moveToNext();
                    }

                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //  close();
            return grpQstId_qstIdForName;
        }
    }

    public LinkedHashMap<String, String> getDepOptMstr() {


        LinkedHashMap<String, String> hmapgetOptDepMstr = new LinkedHashMap<String, String>();

        //open();
        try {


            Cursor cur = db.rawQuery("Select GrpQuestID,GrpDepQuestID from tblPDAQuestOptionDependentMstr", null);
            if (cur.getCount() > 0) {
                String grpDepQstId, grpQstd;
                if (cur.moveToFirst())
                    for (int i = 0; i < cur.getCount(); i++) {
                        grpQstd = cur.getString(0);
                        grpDepQstId = cur.getString(1);
                        hmapgetOptDepMstr.put(grpQstd, grpDepQstId);
                        cur.moveToNext();


                    }

            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //close();
            return hmapgetOptDepMstr;
        }
    }

    public ArrayList<String> getImagePath(String StoreID) {
        //open();
        ArrayList<String> listImagePath = new ArrayList<String>();
        try {

            //tableImage(tempId text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,ImageClicktime text null,Sstat integer null);";
            //imagButtonTag+"~"+tempId+"~"+uriSavedImage.toString()+"~"+clkdTime+"~"+"2";
            Cursor cursor = db.rawQuery("Select QstIdAnsCntrlTyp,StoreID,imagePath,ImageClicktime,Sstat from tableImage where StoreID='" + StoreID + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        listImagePath.add(cursor.getString(0) + "~" + cursor.getString(1) + "~" + cursor.getString(2) + "~" + cursor.getString(3) + "~" + cursor.getString(4));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //close();
            return listImagePath;
        }
    }

    public String getChannelGroupIdKey() {
        String keyForChannel = "";


        try {
//tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,
//tblQuestIDForOutChannel(GrpQstId int null,QuestID int null,OptID text null,SectionCount int null);";
            Cursor cur = db.rawQuery("Select tblQuestIDForOutChannel.GrpQstId,tblQuestIDForOutChannel.QuestID,tblGetPDAQuestMstr.AnsControlType from tblQuestIDForOutChannel inner join tblGetPDAQuestMstr On tblQuestIDForOutChannel.QuestID=tblGetPDAQuestMstr.QuestID", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    keyForChannel = cur.getString(1) + "^" + cur.getString(2) + "^" + cur.getString(0);
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {

            return keyForChannel;
        }
    }

    public void fnsaveOutletQuestAnsMstrSectionWise(LinkedHashMap<String, String> hmapQuesAnsVal, int CurrentsectionID, String CurrentOutletID) {

        //open();
        fnDeletesaveOutletQuestAnsMstrSctionWise(CurrentOutletID, CurrentsectionID);
        String channelOptId = getChannelGroupIdOptId();
        String channelkey = getChannelGroupIdKey();
        if (!channelOptId.equals("0-0-0")) {
            hmapQuesAnsVal.put(channelkey, channelOptId);
        }
        // hmapQuesAnsVal.put("1^6^1","0-1-80");
        String OutletID = "0", QuestID = "0", AnswerType, AnswerValue = "";
        int sectionID = 0;
        int QuestionGroupID = 0;

        for (Entry<String, String> entry : hmapQuesAnsVal.entrySet()) {
            String questId = entry.getKey().split(Pattern.quote("^"))[0].toString();
            AnswerType = entry.getKey().split(Pattern.quote("^"))[1].toString();
            QuestionGroupID = Integer.valueOf(entry.getKey().split(Pattern.quote("^"))[2].toString());
            AnswerValue = entry.getValue();

            ContentValues content = new ContentValues();

            content.put("AnswerType", Integer.parseInt(AnswerType));
            content.put("AnswerValue", AnswerValue.trim());

            content.put("Sstat", 3);

            content.put("sectionID", CurrentsectionID);
            content.put("QuestionGroupID", QuestionGroupID);

            Cursor cursor = db.rawQuery("SELECT OutletID FROM tblOutletQuestAnsMstr where OutletID='" + CurrentOutletID.toString().trim() + "' and QuestID ='" + questId + "'", null);

            //db.insert(TABLE_OutletQuestAnsMstr, null, content);
            if (cursor.getCount() > 0) {

                int affected = db.update("tblOutletQuestAnsMstr", content, "OutletID=? AND QuestID=?",
                        new String[]{CurrentOutletID.toString().trim(), questId.toString().trim()});
            } else {

                content.put("QuestID", questId);
                content.put("OutletID", CurrentOutletID.toString().trim());


                db.insert(DBHelper.TABLE_OutletQuestAnsMstr, null, content);
            }

        }


        // close();

    }

    public String fngettblNewStoreSalesQuotePaymentDetails(String StoreID) {


        String searchString = "";


        try {
            //open();

            Cursor cur = db.rawQuery("Select IFNULL(PymtStageId,0) from tblNewStoreSalesQuotePaymentDetails Where StoreId ='" + StoreID + "'", null);

            if (cur.getCount() > 0) {

                StringBuilder sBuilder = new StringBuilder();

                if (cur.moveToFirst()) {

                    for (int i = 0; i < cur.getCount(); i++) {

                        searchString = cur.getString(0);

                        cur.moveToNext();

                    }

                }


            }


        } catch (Exception e) {

            // TODO: handle exception

        } finally {

            // close();

            return searchString;

        }

    }

    public LinkedHashMap<String, String> fnGettblSalesQuotePaymentModeMstrAllValues() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
        Cursor cursor = db.rawQuery("SELECT PymtModeId,PymtMode from tblSalesQuotePaymentModeMstr", null);// Where PNodeID='"+TSIID+"'
        //(String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            //  close();
        }
    }

    public LinkedHashMap<String, String> fnGettblSalesQuotePaymentModeMstr(String PaymentStageID) {


        String strPaymentModeID = "";
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
        strPaymentModeID = fngetPaymentModeIDsBasedOnStageID(PaymentStageID);

        String searchString = "0";

        if (strPaymentModeID.indexOf(",") != -1) {
            String[] arrsearchString = strPaymentModeID.split(Pattern.quote(","));
            for (int i = 0; i < arrsearchString.length; i++) {
                if (i == 0) {
                    searchString = "'" + arrsearchString[i].trim().toLowerCase() + "'";
                } else {
                    searchString += ",'" + arrsearchString[i].trim().toLowerCase() + "'";
                }
            }
        } else {
            searchString = "'" + strPaymentModeID.trim().toLowerCase() + "'";
        }

        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        Cursor cursor = null;
//tblSalesQuotePaymentModeMstr (PymtModeId text null,PymtMode text null);";
        //   cursor= db.rawQuery("SELECT PymtModeId,PymtMode from tblSalesQuotePaymentModeMstr Where  PymtModeId in ("+searchString+")  ", null);// Where PNodeID='"+TSIID+"'

        if (PaymentStageID.equals("1")) {
            cursor = db.rawQuery("SELECT PymtModeId,PymtMode from tblSalesQuotePaymentModeMstr limit 3  ", null);// Where PNodeID='"+TSIID+"'
        }
        if (PaymentStageID.equals("2")) {
            cursor = db.rawQuery("SELECT PymtModeId,PymtMode from tblSalesQuotePaymentModeMstr limit 4  ", null);// Where PNodeID='"+TSIID+"'
        }
        if (PaymentStageID.equals("3")) {
            cursor = db.rawQuery("SELECT PymtModeId,PymtMode from tblSalesQuotePaymentModeMstr limit 5  ", null);// Where PNodeID='"+TSIID+"'
        }
        if (PaymentStageID.equals("1") || PaymentStageID.equals("2") || PaymentStageID.equals("3")) {
            try {
                if (cursor.getCount() > 0) {
                    if (cursor.moveToFirst()) {
                        for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                            hmapQuestionMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString());
                            //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                            cursor.moveToNext();
                        }
                    }
                }

            } finally {
                cursor.close();
                // close();
            }
        }
        return hmapQuestionMstr;

    }

    public ArrayList<String> fnGetOptionMstr(int questionId) {
        //  LinkedHashMap<String, String> hmapOptionMstr=new LinkedHashMap<String, String>();
        ArrayList<String> listOptionMstr = new ArrayList<String>();
        // ArrayList<String> al1 = new ArrayList<String>();
        String idd = "0";

        //open();
        Cursor cursor = db.rawQuery("SELECT  tblGetPDAQuestMstr.AnsControlType ,tblGetPDAQuestOptionMstr.OptID,tblGetPDAQuestOptionMstr.QuestID,tblGetPDAQuestOptionMstr.OptionDescr,tblGetPDAQuestOptionMstr.Sequence from tblGetPDAQuestOptionMstr inner join tblGetPDAQuestMstr on tblGetPDAQuestOptionMstr.QuestID =tblGetPDAQuestMstr.QuestID  Where tblGetPDAQuestOptionMstr.QuestID='" + questionId + "' Order By tblGetPDAQuestOptionMstr.Sequence ASC ", null);// Where PNodeID='"+TSIID+"'
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        listOptionMstr.add(i, (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(3).toString());
                        cursor.moveToNext();
                    }
                    //  hmapOptionMstr.put(idd, al1);
                }
            }
            return listOptionMstr;
        } finally {
            cursor.close();
            //  close();
        }
    }

    public String[] getQuestIdGroupIdCopyAsAbove(int GrpCopyID, int groupId) {
        String[] questGroupIdCopyAsAbove = null;
        //open();
        Cursor cur = db.rawQuery("Select QuestCopyID from tblGetPDAQuestGrpMapping where GrpID=" + groupId + " AND GrpCopyID=" + GrpCopyID, null);
        if (cur.getCount() > 0) {
            questGroupIdCopyAsAbove = new String[cur.getCount()];
            if (cur.moveToFirst()) {
                for (int i = 0; i < cur.getCount(); i++) {
                    questGroupIdCopyAsAbove[i] = cur.getString(0);
                    cur.moveToNext();
                }
            }
        }
        //close();
        return questGroupIdCopyAsAbove;
    }

    public String[] fnGetGroupIdQuestionMstr(String questGroupID, int section) {
        String[] questonWdSameGroupId = new String[2];
        //open();
        int lastIndex = 0;
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.AnsControlType, tblGetPDAQuestGrpMapping.GrpQuestID from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping on tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID where tblGetPDAQuestMstr.QuestBundleGroupId = '" + questGroupID + "' AND tblGetPDAQuestGrpMapping.SectionNo=" + section, null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        questonWdSameGroupId[i] = (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString();

                        cursor.moveToNext();
                    }

                }
            }
            return questonWdSameGroupId;
        } finally {
            cursor.close();
            //  close();
        }
    }

    public ArrayList<String> getDepOtnVal(String depAnsValid, int grpId, int grpQstDepId) {
        ////  private static final String DATABASE_CREATE_TABLE_QUESTION_OPTION_VAL_DEPENDENTMstr = "create table tblPDAQuestOptionValuesDependentMstr(DepQstId int null,DepAnswValId int null,QstId int null,AnswValId text null,OptDescr text null,Sequence int null,GrpQuestID int null,GrpDepQuestID int null);";
        //open();

        ArrayList<String> listOptId_OptName = new ArrayList<String>();
        try {


            Cursor cur = db.rawQuery("Select AnswValId,OptDescr from tblPDAQuestOptionValuesDependentMstr where GrpQuestID=" + grpId + " AND GrpDepQuestID=" + grpQstDepId + " AND DepAnswValId='" + depAnsValid + "'", null);

            if (cur.getCount() > 0) {
                String optId_optDescr;
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        optId_optDescr = cur.getString(0) + "^" + cur.getString(1);
                        listOptId_OptName.add(optId_optDescr);
                        cur.moveToNext();
                    }

                }


            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //close();
            return listOptId_OptName;
        }

    }

    public void deleteImageData(String imageValidName, String storeId) {
        //tableImage(tempId text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,Sstat integer null);";
        //open();
        Cursor cur = db.rawQuery("Select imageName from tableImage where StoreID='" + storeId + "' AND imageName='" + imageValidName + "'", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.TABLE_IMAGE, "StoreID=? AND imageName=?", new String[]{storeId, imageValidName});
        }
        // close();
    }

    public void insertImageInfo(String tempId, LinkedHashMap<String, String> hmapAllValues) {
        //tableImage(tempId text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,Sstat integer null);";
        //open();
        Cursor cur = db.rawQuery("Select imageName from tableImage where StoreID='" + tempId + "'", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.TABLE_IMAGE, "StoreID=?", new String[]{tempId});
        }
        String StoreID = null, qstIdAndCntrlTyp = null, _imageName = null, imagePath = null, clkdTime;
        int sStat = 3;
        for (Entry<String, String> hmaEntry : hmapAllValues.entrySet()) {
            StoreID = hmaEntry.getValue().split(Pattern.quote("~"))[1].toString();
            qstIdAndCntrlTyp = hmaEntry.getValue().split(Pattern.quote("~"))[0].toString();
            _imageName = hmaEntry.getKey();
            imagePath = hmaEntry.getValue().split(Pattern.quote("~"))[2].toString();
            clkdTime = hmaEntry.getValue().split(Pattern.quote("~"))[3].toString();
            // sStat=Integer.valueOf(hmaEntry.getValue().split(Pattern.quote("~"))[4].toString());


            // tableImage(tempId
            ContentValues content = new ContentValues();
            content.put("StoreID", StoreID);
            content.put("QstIdAnsCntrlTyp", qstIdAndCntrlTyp);

            content.put("imageName", _imageName);
            content.put("imagePath", imagePath);
            content.put("ImageClicktime", clkdTime);
            content.put("Sstat", sStat);

            db.insert(DBHelper.TABLE_IMAGE, null, content);


        }

        // close();
    }

    public void fnInsertOrUpdate_tblStoreDeatils(String StoreID, String StoreName, String ActualLatitude, String ActualLongitude, String VisitStartTS, String VisitEndTS, String LocProvider, String Accuracy, String BateryLeftStatus, int IsStoreDataCompleteSaved, String PaymentStage, int flgLocationTrackEnabled, String StoreAddress, String StoreCity, String StorePinCode, String StoreState, int Sstat) {



		/*//open();
		try {
			Cursor cursor = db.rawQuery("SELECT StoreID FROM "+ DATABASE_TABLE_MAINtblStoreDeatils +" where StoreID='"+StoreID +"'" , null);


			ContentValues initialValues = new ContentValues();


			initialValues.put("StoreName", StoreName.trim());
			initialValues.put("VisitEndTS", VisitEndTS);

			initialValues.put("IsStoreDataCompleteSaved", IsStoreDataCompleteSaved);
			initialValues.put("PaymentStage", PaymentStage);
			initialValues.put("flgLocationTrackEnabled", flgLocationTrackEnabled);
			initialValues.put("StoreAddress", StoreAddress);
			initialValues.put("StoreCity", StoreCity);
			initialValues.put("StorePinCode", StorePinCode);
			initialValues.put("StoreState", StoreState);
			initialValues.put("Sstat", Sstat);


			if(cursor.getCount()>0)
			{

				int affected = db.update(DATABASE_TABLE_MAINtblStoreDeatils, initialValues, "StoreID=?",new String[] {StoreID});
			}
			else
			{
				initialValues.put("StoreID", StoreID.trim());
				initialValues.put("ActualLatitude", ActualLatitude);
				initialValues.put("ActualLongitude", ActualLongitude);
				initialValues.put("VisitStartTS", VisitStartTS);
				initialValues.put("LocProvider", LocProvider);
				initialValues.put("Accuracy", Accuracy);
				initialValues.put("BateryLeftStatus", BateryLeftStatus);
				db.insert(DATABASE_TABLE_MAINtblStoreDeatils, null, initialValues);
			}


		} finally {
			close();
		}*/

    }

    public void UpdateStoreReturnphotoFlag(String sID, int flag2set) {
        try {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected16 = db.update("tblStoreProductPhotoDetail", values, "StoreID=?", new String[]{sID});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    public void UpdateNewAddedStorephotoFlag(String sID, int flag2set) {
        try {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected16 = db.update("tableImage", values, "StoreID=?", new String[]{sID});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    public void UpdateStoreClosephotoWithOutFlag(String sID, int flag2set) {
        try {
            // final ContentValues values = new ContentValues();
            //values.put("Sstat", flag2set);
            // int affected16 = db.update("tblStoreClosedPhotoDetail", values,"", new String[] {  });
            db.execSQL("UPDATE tblStoreClosedPhotoDetail SET Sstat=5 where Sstat=" + 3);
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    /*public static void UpdateStoreReturnphotoFlag(String StoreID, String StoreName,int flgReMap)
	{
		try
		{
			//
			final ContentValues values = new ContentValues();
			values.put("StoreName", StoreName);
			values.put("flgReMap", flgReMap);



			int affected16 = db.update("tblPreAddedStores", values,"StoreID=?", new String[] { StoreID });
		}
		catch (Exception ex) {

		}
	}*/
    public String getTodatAndTotalStores() {
        String StoresData = "0";
        //open();
        try {
            Cursor cur = db.rawQuery("Select TotStoreAdded , TodayStoreAdded from tblStoreCountDetails", null);

            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        StoresData = cur.getString(0) + "^" + cur.getString(1);
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            // close();
            return StoresData;
        }
    }

    public void fnDeletesaveNewOutletFromOutletMstr(String OutletID) {
        //open();
        db.execSQL("DELETE FROM tblPreAddedStores WHERE StoreID ='" + OutletID + "'");// and sectionID="+sectionID
        // close();
    }

    public void deletetblStoreCountDetails() {
        db.execSQL("DELETE FROM tblStoreCountDetails");

    }

    public int checkCountIntblNewStoreMainTable(String StoreId) {
        //open();
        Cursor cursor = null;
        int check = 0;
        try {

            cursor = db.rawQuery("SELECT Count(*) FROM tblOutletQuestAnsMstr WHERE  OutletID ='" + StoreId + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        check = 1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {
            System.out.println("shivam query = " + e.toString());
        } finally {
            cursor.close();
            // close();
        }
        return check;
    }

	/*public static long saveTblStoreCountDetails(String TotStoreAdded,String TodayStoreAdded)
	{

		ContentValues initialValues = new ContentValues();

		initialValues.put("TotStoreAdded", Integer.parseInt(TotStoreAdded.toString().trim()));
		initialValues.put("TodayStoreAdded", Integer.parseInt(TodayStoreAdded.toString().trim()));

		return db.insert(DATABASE_TABLE_tblStoreCountDetails, null, initialValues);
	}*/


    public void fndeleteNewStoreSalesQuotePaymentDetails(String StoreID) {

        db.execSQL("DELETE FROM tblNewStoreSalesQuotePaymentDetails WHERE StoreId ='" + StoreID + "'");
    }

    public long fnsaveNewStoreSalesQuotePaymentDetails(String StoreId, String PaymentStageId) {

        ContentValues initialValues = new ContentValues();


        initialValues.put("StoreId", StoreId.toString().trim());

        initialValues.put("PymtStageId", PaymentStageId.toString().trim());
        initialValues.put("Sstat", "1");

        return db.insert(DBHelper.DATABASE_TABLE_NewStoreSalesQuotePaymentDetails, null, initialValues);
    }

    public String getLocationDetails() {
        //String StoresData="0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0^0";
        String StoresData = "0";
        //open();
        try {                           //  0           1        2         3       4     5       6     7                 8          9   1 0              11     12    13           14          15         16          17                        18        19    20                21                                   22                                   23
            Cursor cur = db.rawQuery("Select Lattitude,Longitude,Accuracy,Address,City,Pincode,State,fnAccurateProvider,GpsLat,GpsLong,GpsAccuracy,NetwLat,NetwLong,NetwAccuracy,FusedLat,FusedLong,FusedAccuracy,AllProvidersLocation,GpsAddress,NetwAddress,FusedAddress,FusedLocationLatitudeWithFirstAttempt,FusedLocationLongitudeWithFirstAttempt,FusedLocationAccuracyWithFirstAttempt from tblLocationDetails", null);

            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        StoresData = cur.getString(0) + "^" + cur.getString(1) + "^" + cur.getString(2) + "^" + cur.getString(3) + "^" + cur.getString(4) + "^" + cur.getString(5) + "^" + cur.getString(6) + "^" + cur.getString(7) + "^" + cur.getString(8) + "^" + cur.getString(9) + "^" + cur.getString(10) + "^" + cur.getString(11) + "^" + cur.getString(12) + "^" + cur.getString(13) + "^" + cur.getString(14) + "^" + cur.getString(15) + "^" + cur.getString(16) + "^" + cur.getString(17) + "^" + cur.getString(18) + "^" + cur.getString(19) + "^" + cur.getString(20) + "^" + cur.getString(21) + "^" + cur.getString(22) + "^" + cur.getString(23);
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //  close();
            return StoresData;
        }
    }
    public void Delete_tblLatLongDetails() {
        try {

            db.execSQL("DELETE FROM tblLatLongDetails");
        } catch (Exception e) {

        } finally {

        }
    }
    public long saveLatLngToTxtFile(String StoreID, String StoreVisitCode, String fnLati, String fnLongi,
                                    String fnAccuracy, String fnAccurateProvider,
                                    String GpsLat, String GpsLong, String GpsAccuracy,
                                    String NetwLat, String NetwLong, String NetwAccuracy, String FusedLat,
                                    String FusedLong, String FusedAccuracy,
                                    int Sstat, String flgLocNotFound, String fnAddress, String AllProvidersLocation, String GpsAddress, String NetwAddress
            , String FusedAddress, String FusedLocationLatitudeWithFirstAttempt, String FusedLocationLongitudeWithFirstAttempt, String FusedLocationAccuracyWithFirstAttempt) {
        //open();
        try {
            Delete_tblLatLongDetails();
            ContentValues initialValues = new ContentValues();

            Cursor cursor = db.rawQuery("Select StoreID from tblLatLongDetails where StoreID='" + StoreID + "'", null);

            if (cursor.getCount() > 0) {

            } else {
                initialValues.put("StoreID", StoreID);
                initialValues.put("StoreVisitCode", StoreVisitCode);
                initialValues.put("fnLati", fnLati);
                initialValues.put("fnLongi", fnLongi.trim());
                initialValues.put("fnAccuracy", fnAccuracy.trim());
                initialValues.put("flgLocNotFound", flgLocNotFound);//
                initialValues.put("fnAccurateProvider", fnAccurateProvider.trim());
                initialValues.put("fnAddress", fnAddress);
                initialValues.put("AllProvidersLocation", AllProvidersLocation);


                initialValues.put("GpsLat", GpsLat.trim());
                initialValues.put("GpsLong", GpsLong.trim());
                initialValues.put("GpsAccuracy", GpsAccuracy.trim());
                initialValues.put("GpsAddress", GpsAddress);

                initialValues.put("NetwLat", NetwLat.trim());
                initialValues.put("NetwLong", NetwLong.trim());
                initialValues.put("NetwAccuracy", NetwAccuracy.trim());
                initialValues.put("NetwAddress", NetwAddress);

                initialValues.put("FusedLat", FusedLat.trim());
                initialValues.put("FusedLong", FusedLong.trim());
                initialValues.put("FusedAccuracy", FusedAccuracy.trim());
                initialValues.put("FusedAddress", FusedAddress);


                initialValues.put("FusedLocationLatitudeWithFirstAttempt", FusedLocationLatitudeWithFirstAttempt);
                initialValues.put("FusedLocationLongitudeWithFirstAttempt", FusedLocationLongitudeWithFirstAttempt);
                initialValues.put("FusedLocationAccuracyWithFirstAttempt", FusedLocationAccuracyWithFirstAttempt);
                initialValues.put("Sstat", Sstat);
                return db.insert(DBHelper.DATABASE_TABLE_Main271, null, initialValues);
            }


        } catch (Exception e) {

        } finally {
            // close();
        }
        return 0;
    }

    public LinkedHashMap<String, String> fetch_DSRCoverage_List() {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();

        Cursor cursor = db.rawQuery("SELECT CoverageAreaNodeID,CoverageArea FROM tblDSRCoverageMaster", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    hmapCatgry.put("Select DSM", "0");
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapCatgry.put(cursor.getString(1).toString(), cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("No DSR", "0");
            }
            return hmapCatgry;
        } finally {
            cursor.close();
            //close();
        }
    }


    public String[] getSuplierDataMstr() {
        String strStoreTypeNamesDetais[] = null;
        try {
            Cursor cursor2 = db.rawQuery("SELECT NodeID,NodeType,Descr,flgMapped FROM tblSupplierMstrList", null);

            if (cursor2.getCount() > 0) {
                strStoreTypeNamesDetais = new String[cursor2.getCount() + 1];
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (i == 0) {
                            strStoreTypeNamesDetais[i] = "0^0^Select Distributor^0";
                        }
                        strStoreTypeNamesDetais[i + 1] = cursor2.getString(0).toString() + "^" + cursor2.getString(1) + "^" + cursor2.getString(2) + "^" + cursor2.getString(3);
                        cursor2.moveToNext();
                    }
                }
            } else {
                strStoreTypeNamesDetais = new String[1];
                strStoreTypeNamesDetais[0] = "0^0^Select Distributor^0";
            }
            return strStoreTypeNamesDetais;
        } finally {

        }
    }

    public void Delete_tblSuplierMapping(int DistribtrId, int DistributorNodeType) {
        try {

            db.execSQL("DELETE FROM tblSuplierMapping where SuplierId=" + DistribtrId + " and SuplierNodeType=" + DistributorNodeType);
        } catch (Exception e) {

        } finally {

        }
    }

    public void deletePrvsSupplierMpng() {
        db.execSQL("DELETE FROM tblSuplierMapping");
    }

    public long savetblSuplierMappingData(String SuplierId, String SuplierNodeType,
                                          String flgGSTCapture, String flgGSTCompliance, String GSTNumber, String Address,
                                          String PinCode, String City, String State, String fnLati,
                                          String fnLongi, String fnAccuracy, String flgLocNotFound, String fnAccurateProvider,
                                          String AllProvidersLocation, String fnAddress, String GpsLat, String GpsLong,
                                          String GpsAccuracy, String GpsAddress, String NetwLat, String NetwLong,
                                          String NetwAccuracy, String NetwAddress, String FusedLat, String FusedLong,
                                          String FusedAccuracy, String FusedAddress, String FusedLocationLatitudeWithFirstAttempt,
                                          String FusedLocationLongitudeWithFirstAttempt, String FusedLocationAccuracyWithFirstAttempt,
                                          int Sstat, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgRestart) {

        deletePrvsSupplierMpng();
        ContentValues initialValues = new ContentValues();


        initialValues.put("SuplierId", SuplierId.trim());
        initialValues.put("SuplierNodeType", SuplierNodeType.trim());
        initialValues.put("flgGSTCapture", flgGSTCapture.trim());
        initialValues.put("flgGSTCompliance", flgGSTCompliance.trim());
        initialValues.put("GSTNumber", GSTNumber.trim());

        initialValues.put("Address", Address.trim());
        initialValues.put("PinCode", PinCode.trim());
        initialValues.put("City", City.trim());
        initialValues.put("State", State.trim());

        initialValues.put("fnLati", fnLati.trim());
        initialValues.put("fnLongi", fnLongi.trim());
        initialValues.put("fnAccuracy", fnAccuracy.trim());
        initialValues.put("flgLocNotFound", flgLocNotFound.trim());
        initialValues.put("fnAccurateProvider", fnAccurateProvider.trim());
        initialValues.put("AllProvidersLocation", AllProvidersLocation.trim());
        initialValues.put("fnAddress", fnAddress.trim());

        initialValues.put("GpsLat", GpsLat.trim());
        initialValues.put("GpsLong", GpsLong.trim());
        initialValues.put("GpsAccuracy", GpsAccuracy.trim());
        initialValues.put("GpsAddress", GpsAddress.trim());

        initialValues.put("NetwLat", NetwLat.trim());
        initialValues.put("NetwLong", NetwLong.trim());
        initialValues.put("NetwAccuracy", NetwAccuracy.trim());
        initialValues.put("NetwAddress", NetwAddress.trim());

        initialValues.put("FusedLat", FusedLat.trim());
        initialValues.put("FusedLong", FusedLong.trim());
        initialValues.put("FusedAccuracy", FusedAccuracy.trim());
        initialValues.put("FusedAddress", FusedAddress.trim());

        initialValues.put("FusedLocationLatitudeWithFirstAttempt", FusedLocationLatitudeWithFirstAttempt.trim());
        initialValues.put("FusedLocationLongitudeWithFirstAttempt", FusedLocationLongitudeWithFirstAttempt.trim());
        initialValues.put("FusedLocationAccuracyWithFirstAttempt", FusedLocationAccuracyWithFirstAttempt.trim());
        initialValues.put("Sstat", Sstat);

        initialValues.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
        initialValues.put("flgGPSOnOff", flgGPSOnOff);
        initialValues.put("flgNetworkOnOff", flgNetworkOnOff);
        initialValues.put("flgFusedOnOff", flgFusedOnOff);
        initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
        initialValues.put("flgRestart", flgRestart);


        return db.insert(DBHelper.TABLE_tblSuplierMapping, null, initialValues);
    }

    public int fnCheckIfStoreIDExistsIn_tblStoreDeatils(String StoreID) {
        //open();
        int flgCheckIfStoreExists = 0;
        //tblStoreDetails(StoreID
        Cursor cursor2 = db.rawQuery("SELECT Count(*) FROM tblStoreList where StoreID='" + StoreID + "'", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    if (cursor2.getInt(0) > 0) {

                        flgCheckIfStoreExists = 1;

                    }
                }
            }


        } catch (Exception e) {

        } finally {
            cursor2.close();
            //  close();
        }
        return flgCheckIfStoreExists;
    }

    public ArrayList<String> fnGetDetails_tblStoreDeatils(String StoreID) {
        ArrayList<String> arrBasisDetailsAgainstStore = new ArrayList<String>();

        //open();
        try {
            //Cursor cursor = db.rawQuery("SELECT StoreName,IFNULL(PaymentStage,'0') AS PaymentStage,IFNULL(StoreAddress,'NA') AS StoreAddress,IFNULL(StoreCity,'NA') AS StoreCity,IFNULL(StorePinCode,'NA') AS StorePinCode,IFNULL(StoreState,'NA') AS StoreState,ActualLatitude,ActualLongitude,Accuracy FROM tblStoreList where StoreID='" + StoreID+"'", null);
            // by sunil
            //SELECT t1.product_s_desc, t1.product_desc, t1.product_name, t2.product_price
            //FROM table1 t1
            //INNER JOIN table2 t2 ON t2.product_id = t1.product_id
            Cursor cursor = db.rawQuery("SELECT StoreName,StoreClose,StoreClose,StoreCity,StorePinCode,StoreState,ActualLatitude,ActualLongitude,Accuracy FROM tblStoreList where StoreID='" + StoreID + "'", null);


            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(0).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(1).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(2).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(3).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(4).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(5).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(6).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(7).toString());
                    arrBasisDetailsAgainstStore.add((String) cursor.getString(8).toString());
                    cursor.moveToNext();
                }
            }


        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //  close();
        }

        return arrBasisDetailsAgainstStore;
    }

    public LinkedHashMap<String, ArrayList<String>> fnGetQuestionMstrKey() {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr = new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listKeyQuesVal = new ArrayList<String>();
        //open();
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null,GrpCopyID int null,QuestCopyID int null,Sequence int null);";
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.GrpID,tblGetPDAQuestGrpMapping.Sequence from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping where tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.GrpID ASC,tblGetPDAQuestGrpMapping.Sequence", null);// Where PNodeID='"+TSIID+"'

        try {
            if (cursor.getCount() > 0) {

                String sectionNo = "0", preVisousSectionNum = "0";
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        sectionNo = cursor.getString(3);
                        System.out.println("Squence Added = " + cursor.getString(3) + " : " + cursor.getString(4));
                        if (i == 0) {
                            preVisousSectionNum = sectionNo;
                            listKeyQuesVal.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));
                        } else if (preVisousSectionNum.equals(sectionNo)) {
                            listKeyQuesVal.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));
                        } else {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                            listKeyQuesVal = new ArrayList<String>();
                            preVisousSectionNum = sectionNo;
                            listKeyQuesVal.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));
                        }
                        if (i == (cursor.getCount() - 1)) {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                        }

                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            // close();
        }
    }

    public LinkedHashMap<String, String> getGroupDescription() {
        //open();
        LinkedHashMap<String, String> hmapGroupDescrptn = new LinkedHashMap<String, String>();
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        Cursor cur = db.rawQuery("Select Distinct GrpID,GrpDesc from tblGetPDAQuestGrpMapping", null);
        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                for (int i = 0; i < cur.getCount(); i++) {
                    hmapGroupDescrptn.put(cur.getString(0), cur.getString(1));
                    cur.moveToNext();
                }

            }
        }
        // close();
        return hmapGroupDescrptn;
    }

    public LinkedHashMap<String, ArrayList<String>> fnGetGroupIdMpdWdSectionId() {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr = new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listKeyQuesVal = new ArrayList<String>();

        //open();
        int sectionCount = getsectionCount();
        //    int sectionCount=0;
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor;
        if (sectionCount != 0) {
            cursor = db.rawQuery("SELECT Distinct GrpID,SectionNo from tblGetPDAQuestGrpMapping where SectionNo<=" + sectionCount + " order by SectionNo", null);// Where PNodeID='"+TSIID+"'
        } else {
            cursor = db.rawQuery("SELECT Distinct GrpID,SectionNo from tblGetPDAQuestGrpMapping order by SectionNo", null);// Where PNodeID='"+TSIID+"'
        }


        try {
            if (cursor.getCount() > 0) {
                String sectionNo = "0", preVisousSectionNum = "0";
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        sectionNo = cursor.getString(1);
                        if (i == 0) {
                            preVisousSectionNum = sectionNo;
                            listKeyQuesVal.add(cursor.getString(0));
                        } else if (preVisousSectionNum.equals(sectionNo)) {
                            listKeyQuesVal.add(cursor.getString(0));
                        } else {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                            listKeyQuesVal = new ArrayList<String>();
                            preVisousSectionNum = sectionNo;
                            listKeyQuesVal.add(cursor.getString(0));

                        }
                        if (i == cursor.getCount() - 1) {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                        }


                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            //close();
        }
    }

    public LinkedHashMap<String, String> fnGetDependentQuestionMstr() {

        LinkedHashMap<String, String> hmapDpndntQuestionMstr = new LinkedHashMap<String, String>();
        //open();
        //tblGetPDAQuestionDependentMstr(QuestionID int null,OptionID int null,DependentQuestionID int null,GrpID int null,GrpDepQuestID int null);";
        Cursor cursor = db.rawQuery("SELECT DISTINCT GrpDepQuestID,OptionID from tblGetPDAQuestionDependentMstr", null);// Where PNodeID='"+TSIID+"'
        String[] arrbhi = new String[cursor.getCount()];
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        // hmapDpndntQuestionMstr.put((String) cursor.getString(3).toString()+"^"+(String) cursor.getString(1).toString(), (String) cursor.getString(2).toString());
                        arrbhi[i] = (String) cursor.getString(0).toString() + "^" + (String) cursor.getString(1).toString();

                        cursor.moveToNext();
                    }

                }
            }
            for (int cntLoop = 0; cntLoop < arrbhi.length; cntLoop++) {
                String dpndIdAndOptId = arrbhi[cntLoop].toString();
                String dpndntId = dpndIdAndOptId.split(Pattern.quote("^"))[0];
                String optId = dpndIdAndOptId.split(Pattern.quote("^"))[1];
                StringBuilder quesIdToBeVisOrinVis = fnQuestionIdOnBasisOfDependentQuestionIDdpndntId(dpndntId, optId);
                hmapDpndntQuestionMstr.put(arrbhi[cntLoop].toString(), quesIdToBeVisOrinVis.toString());
            }

            return hmapDpndntQuestionMstr;
        } finally {
            cursor.close();
            //close();
        }

    }

    public LinkedHashMap<String, ArrayList<String>> fnGetSection_Key() {
        LinkedHashMap<String, ArrayList<String>> hmapQuestionMstr = new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listKeyQuesVal = new ArrayList<String>();
        //open();
        //tblGetPDAQuestGrpMapping(GrpQuestID int null,QuestID int null,GrpID int null,GrpNodeID int null,GrpDesc text null,SectionNo int null);";
        //tblGetPDAQuestMstr(QuestID int null,QuestCode int null,QuestDesc text null,QuestType int null,AnsControlType int null,AnsControlInputTypeID int null,AnsControlInputTypeMinLength int null,AnsControlInputTypeMaxLength int null,AnsMustRequiredFlg int null,QuestBundleFlg int null,ApplicationTypeID int null,Sequence int null,AnswerHint text null);";
        Cursor cursor = db.rawQuery("SELECT tblGetPDAQuestMstr.QuestID,tblGetPDAQuestMstr.AnsControlType,tblGetPDAQuestGrpMapping.GrpQuestID,tblGetPDAQuestGrpMapping.SectionNo from tblGetPDAQuestMstr inner join tblGetPDAQuestGrpMapping where tblGetPDAQuestMstr.QuestID=tblGetPDAQuestGrpMapping.QuestID  Order By tblGetPDAQuestGrpMapping.SectionNo ASC  ", null);// Where PNodeID='"+TSIID+"'

        try {
            if (cursor.getCount() > 0) {
                String sectionNo = "0", preVisousSectionNum = "0";
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        sectionNo = cursor.getString(3);
                        if (i == 0) {
                            preVisousSectionNum = sectionNo;
                            listKeyQuesVal.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));
                        } else if (preVisousSectionNum.equals(sectionNo)) {
                            listKeyQuesVal.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));
                        } else {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                            listKeyQuesVal = new ArrayList<String>();
                            preVisousSectionNum = sectionNo;
                            listKeyQuesVal.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));

                        }
                        if (i == (cursor.getCount() - 1)) {
                            hmapQuestionMstr.put(preVisousSectionNum, listKeyQuesVal);
                        }

                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            // close();
        }
    }

    public void deleteLocationTable() {
        db.execSQL("DELETE FROM tblLocationDetails");

    }

    public long saveTblLocationDetails(String Lattitude, String Longitude, String Accuracy, String Address, String City, String Pincode, String State, String fnAccurateProvider, String GpsLat, String GpsLong, String GpsAccuracy, String NetwLat, String NetwLong, String NetwAccuracy, String FusedLat, String FusedLong, String FusedAccuracy, String AllProvidersLocation, String GpsAddress, String NetwAddress, String FusedAddress, String FusedLocationLatitudeWithFirstAttempt, String FusedLocationLongitudeWithFirstAttempt, String FusedLocationAccuracyWithFirstAttempt) {

        db.delete(DBHelper.DATABASE_TABLE_tblLocationDetails, null, null);
        ContentValues initialValues = new ContentValues();

        initialValues.put("Lattitude", Lattitude);
        initialValues.put("Longitude", Longitude);
        initialValues.put("Accuracy", Accuracy);
        initialValues.put("Address", Address);
        initialValues.put("City", City);
        initialValues.put("Pincode", Pincode);
        initialValues.put("State", State);

        initialValues.put("fnAccurateProvider", fnAccurateProvider);
        initialValues.put("GpsLat", GpsLat);
        initialValues.put("GpsLong", GpsLong);
        initialValues.put("GpsAccuracy", GpsAccuracy);
        initialValues.put("NetwLat", NetwLat);
        initialValues.put("NetwLong", NetwLong);
        initialValues.put("NetwAccuracy", NetwAccuracy);
        initialValues.put("FusedLat", FusedLat);
        initialValues.put("FusedLong", FusedLong);
        initialValues.put("FusedAccuracy", FusedAccuracy);

        initialValues.put("AllProvidersLocation", AllProvidersLocation);
        initialValues.put("GpsAddress", GpsAddress);
        initialValues.put("NetwAddress", NetwAddress);
        initialValues.put("FusedAddress", FusedAddress);
        initialValues.put("FusedLocationLatitudeWithFirstAttempt", FusedLocationLatitudeWithFirstAttempt);
        initialValues.put("FusedLocationLongitudeWithFirstAttempt", FusedLocationLongitudeWithFirstAttempt);
        initialValues.put("FusedLocationAccuracyWithFirstAttempt", FusedLocationAccuracyWithFirstAttempt);


        return db.insert(DBHelper.DATABASE_TABLE_tblLocationDetails, null, initialValues);
    }

    public int fncheckCountNearByStoreExistsOrNot(int DistanceRange) {
        int flgCheck = 0;
        //open();

        try {
            // Cursor cursor = db.rawQuery("SELECT Count(*) from tblPreAddedStores Where (LatCode<>'0' and LatCode<>'NA') and DistanceNear<"+ DistanceRange+ " ORDER BY DistanceNear", null);

            Cursor cursor = db.rawQuery("SELECT Count(*) from tblStoreList WHERE (StoreLatitude<>'0' AND StoreLatitude<>'NA')    ORDER BY DistanceNear ASC", null);//
            //StoreID,StoreName,LatCode,LongCode,DateAdded
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (cursor.getInt(0) > 0) {
                        flgCheck = 1;
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();
            if (flgCheck == 0) {
                flgCheck = fncheckCountNewAddedNearByStoreExistsOrNotSM(flgCheck);
            }
            return flgCheck;
        }
    }

    public int fncheckCountNewAddedNearByStoreExistsOrNotSM(int DistanceRange) {

        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear from tblPreAddedStores WHERE (LatCode<>'0' AND LatCode<>'NA') AND DistanceNear<" + DistanceRange + " ORDER BY DistanceNear  ASC Limit 30", null);//
            // Cursor cursor = db.rawQuery("SELECT Count(*) from tblStoreList WHERE (StoreLatitude='NA') and ISNewStore=1", null);//
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (cursor.getInt(0) > 0) {
                        DistanceRange = 1;
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();

        }
        return DistanceRange;
    }

    public LinkedHashMap<String, String> fnGetALLOutletMstrSM() {
        Cursor cursor = null;

        LinkedHashMap<String, String> hmapOutletMstr = new LinkedHashMap<String, String>();
        //open();

        cursor = db.rawQuery("SELECT StoreID,ifnull(LatCode,0),ifnull(LongCode,0) from tblPreAddedStores", null);


        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    String phoneNum;
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapOutletMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapOutletMstr;
        } finally {
            cursor.close();
            // close();
        }
    }

    public int fncheckCountNewAddedNearByStoreExistsOrNot(int flgCheck) {

        //open();

        try {
            //Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear from tblPreAddedStores WHERE (LatCode<>'0' AND LatCode<>'NA') AND DistanceNear<"+ DistanceRange +" ORDER BY DistanceNear  ASC Limit 30", null);//
            Cursor cursor = db.rawQuery("SELECT Count(*) from tblStoreList WHERE (StoreLatitude='NA') and ISNewStore=1", null);//
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (cursor.getInt(0) > 0) {
                        flgCheck = 1;
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();

        }
        return flgCheck;
    }

    public LinkedHashMap<String, String> fnGeStoreList(int DistanceRange) {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        String ForDate = fnGetDateTimeString();
        //open();

        try {
            Cursor cursor = db.rawQuery("SELECT StoreID,StoreLatitude,StoreLongitude,ifnull(DistanceNear,0),0 AsflgReMap,StoreName from tblStoreList WHERE (StoreLatitude<>'0' AND StoreLatitude<>'NA') ORDER BY DistanceNear", null);//
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String StoreLat = "0.00";
                        String StoreLon = "0.00";
                        if (!cursor.getString(1).toString().equals("NA")) {
                            StoreLat = (String) cursor.getString(1).toString();
                            StoreLon = (String) cursor.getString(2).toString();
                        }

                        hmapQuestionMstr.put((String) cursor.getString(0).toString(), StoreLat + "^" + StoreLon + "^" + ForDate + "^" + (String) cursor.getString(3).toString() + "^" + (String) cursor.getString(5).toString());

                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();
            fnGeNewlyAddedStoreList(hmapQuestionMstr);
            return hmapQuestionMstr;
        }
    }

    public LinkedHashMap<String, String> FetchStoreAddress(String rID) {
        LinkedHashMap<String, String> hmapStoreIDAddressr = new LinkedHashMap<String, String>();

        Cursor cursor = null;
        try {
            cursor = db.rawQuery("SELECT StoreID,ifnull(StoreAddress,'NA')  from tblStoreList  ORDER BY DistanceNear", null);// where StoreRouteID='"+ rID +"'
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapStoreIDAddressr.put(cursor.getString(0).toString(), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {
            if (cursor != null)
                cursor.close();

            return hmapStoreIDAddressr;
        }
    }

    public void fnGeNewlyAddedStoreList(LinkedHashMap<String, String> hmapQuestionMstr) {

        //open();
        Cursor cursor = null;
        try {
            //Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear from tblPreAddedStores WHERE (LatCode<>'0' AND LatCode<>'NA') AND DistanceNear<"+ DistanceRange +" ORDER BY DistanceNear  ASC Limit 30", null);//
            String fetchdate = fnGetDateTimeString();
            cursor = db.rawQuery("SELECT StoreID,StoreLatitude,StoreLongitude,DistanceNear,0 AsflgReMap,StoreName from tblStoreList WHERE (StoreLatitude='NA') and ISNewStore=1", null);//
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String StoreLat = "0.00";
                        String StoreLon = "0.00";
                        if (!cursor.getString(1).toString().equals("NA")) {
                            StoreLat = (String) cursor.getString(1).toString();
                            StoreLon = (String) cursor.getString(2).toString();
                        }

                        //hmapQuestionMstr.put((String) cursor.getString(0).toString(),StoreLat+"^"+StoreLon+"^"+(String) cursor.getString(3).toString());
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(), StoreLat + "^" + StoreLon + "^" + fetchdate + "^" + (String) cursor.getString(4).toString() + "^" + (String) cursor.getString(5).toString());
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {

            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {
            if (cursor != null)
                cursor.close();
            //close();

        }
    }

    public LinkedHashMap<String, String> fnGetALLOutletMstr() {
        Cursor cursor = null;

        LinkedHashMap<String, String> hmapOutletMstr = new LinkedHashMap<String, String>();
        //open();

        cursor = db.rawQuery("SELECT StoreID,ifnull(StoreLatitude,0),ifnull(StoreLongitude,0) from tblStoreList", null);


        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    String phoneNum;
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapOutletMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapOutletMstr;
        } finally {
            cursor.close();
            //close();
        }
    }

    public String fnGetALLOutletMstrOfParticularStore(String StoreID) {
        Cursor cursor = null;

        String latLong = "0^0";
        //open();

        cursor = db.rawQuery("SELECT StoreID,ifnull(StoreLatitude,0),ifnull(StoreLongitude,0) from tblStoreList where StoreID='" + StoreID+"'", null);

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        latLong = (String) cursor.getString(1).toString() + "^" + (String) cursor.getString(2).toString();
                        cursor.moveToNext();
                    }
                }
            }
            return latLong;
        } finally {
            cursor.close();
            //close();
        }
    }

    public int fnGetAllowedGeofence() {
        Cursor cursor = null;

        int allowedGeofence = 0;
        //open();

        cursor = db.rawQuery("SELECT ifnull(AllowedGeofence,100) from " + DBHelper.TABLE_tblUserAuthenticationMstr_Define, null);

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        allowedGeofence = cursor.getInt(0);
                        cursor.moveToNext();
                    }
                }
            }
            return allowedGeofence;
        } finally {
            cursor.close();
            //close();
        }
    }

    public void UpdateStoreDistanceNear(String OutletID, int DistanceNear) {
        try {

            final ContentValues values = new ContentValues();
            values.put("DistanceNear", DistanceNear);
            int affected = db.update("tblStoreList", values, "StoreID=?", new String[]{OutletID});
        } catch (Exception e) {

        } finally {

        }

    }

    public long savetblManagerMstr(String PersonID, String PersonType, String PersonName, String ManagerID, String ManagerType, String ManagerName) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("PersonID", PersonID.trim());
        initialValues.put("PersonType", PersonType.trim());
        initialValues.put("PersonName", PersonName.trim());
        initialValues.put("ManagerID", ManagerID.trim());
        initialValues.put("ManagerType", ManagerType.trim());
        initialValues.put("ManagerName", ManagerName.trim());

        return db.insert(DBHelper.DATABASE_TABLE_MAIN261, null, initialValues);
    }

    public LinkedHashMap<String, String> fetch_Manager_List() {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT ManagerID,ManagerName FROM tblManagerMstr ", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
											/*if(i==0)
											{
												hmapCatgry.put("Select Manager", "00");
											}*/
                        hmapCatgry.put(cursor.getString(1).toString(), cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("Self Working", "0");
            }
            return hmapCatgry;
        } finally {
            cursor.close();
            //close();
        }
    }

    public void deletetblSelectedManagerDetails() {
        //open();
        db.execSQL("DELETE FROM tblSelectedManagerDetails");

        // close();
    }

    public int counttblSelectedManagerDetails() {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblSelectedManagerDetails", null);
        int chkI = 0;
        try {
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String Fetch_tblSelectedManagerDetails() {
        //open();
        Cursor cursor = null;
        try {
            cursor = db.rawQuery("SELECT ManagerID,ManagerName  FROM tblSelectedManagerDetails", null);

            String RankOutletName = null;//[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                RankOutletName = (String) cursor.getString(0).toString() + "_"
                        + (String) cursor.getString(1).toString();
                cursor.moveToNext();


            }
            return RankOutletName;
        } finally {
            cursor.close();
            //close();
        }

    }

    public String fetchOtherNameBasicOfManagerID(int ManagerID) {
        int SnamecolumnIndex1 = 0;
        String LocIDDesc = "0";
        Cursor cursor = db.rawQuery("SELECT  OtherName from tblSelectedManagerDetails where ManagerID='" + ManagerID + "'", null);
        try {

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    LocIDDesc = (String) cursor.getString(SnamecolumnIndex1).toString().trim();

                    cursor.moveToNext();
                }

            }
            return LocIDDesc;
        } finally {
            cursor.close();
        }


    }

    public long savetblSelectedManagerDetails(String IMEI, String CurDate, String PersonID,
                                              String PersonType, String PersonName, String ManagerID, String ManagerType,
                                              String ManagerName, String OtherName) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("PDACode", IMEI.trim());
        initialValues.put("CurDate", CurDate.trim());
        initialValues.put("PersonID", PersonID.trim());
        initialValues.put("PersonType", PersonType.trim());
        initialValues.put("PersonName", PersonName.trim());
        initialValues.put("ManagerID", ManagerID.trim());
        initialValues.put("ManagerType", ManagerType.trim());
        initialValues.put("ManagerName", ManagerName.trim());
        initialValues.put("OtherName", OtherName.trim());
        initialValues.put("Sstat", 3);

        return db.insert(DBHelper.DATABASE_TABLE_MAIN262, null, initialValues);
    }

    public String fetchtblManagerMstr(String ManagerID) {
        //open();
        int SnamecolumnIndex1 = 0;
        String LocIDDesc = "0";
        Cursor cursor = null;
        try {
            cursor = db.rawQuery("SELECT  * from tblManagerMstr where ManagerID='" + ManagerID + "'", null);


            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    LocIDDesc = (String) cursor.getString(0).toString().trim() + "^" + (String) cursor.getString(1).toString().trim() + "^" + (String) cursor.getString(2).toString().trim() + "^" + (String) cursor.getString(3).toString().trim() + "^" + (String) cursor.getString(4).toString().trim() + "^" + (String) cursor.getString(5).toString().trim();

                    cursor.moveToNext();
                }

            }
            return LocIDDesc;
        } finally {
            cursor.close();
            // close();
        }


    }

    public void droptblManagerMstr() {
        db.execSQL("DROP TABLE IF EXISTS tblManagerMstr");
        db.execSQL("DROP TABLE IF EXISTS tblSelectedManagerDetails");

    }

    public void createtblManagerMstr() {
        try {
            db.execSQL(DBHelper.DATABASE_CREATE_TABLE_261);
            db.execSQL(DBHelper.DATABASE_CREATE_TABLE_262);
        } catch (Exception e) {

        }

    }

    public void Delete_tblRouteMasterMstr() {
        db.execSQL("DELETE FROM tblRouteListMaster");

    }

    public void Delete_tblManagerMstr() {
        //db.execSQL("DELETE FROM tblManagerMstr");
        //db.execSQL("DELETE FROM tblSelectedManagerDetails");
    }


    public String[] getSuplierData() {
        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT *  FROM tblSupplierMstrList", null);
            String strStoreTypeNamesDetais[] = null;// new String[cursor2.getCount()];
            if (cursor2.getCount() > 0) {
                strStoreTypeNamesDetais = new String[cursor2.getCount() + 1];
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (i == 0) {
                            strStoreTypeNamesDetais[i] = "0^0^Select Distributor";
                        }
                        strStoreTypeNamesDetais[i + 1] = cursor2.getString(0).toString() + "^" + cursor2.getString(1) + "^" + cursor2.getString(2);
                        cursor2.moveToNext();
                    }
                }
            } else {
                strStoreTypeNamesDetais = new String[1];
                strStoreTypeNamesDetais[0] = "0^0^Select Distributor";

            }
            return strStoreTypeNamesDetais;
        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }

        }
    }

    public String fetchSuplierIdByName(String Descr) {
        //open();
        Cursor cursor2 = null;
        String strStoreTypeNamesDetais = "0^0";
        try {
            //tblSupplierMstrList(NodeID int not null,NodeType int not null,Descr text not null,latCode real null,LongCode real null,flgMapped int not null,Address text null,State text null,City text null,PinCode text null,ContactNumber text null,TaxNumber text null,flgStockManage int not null,EmailID text null,flgDefault int not null);";
            cursor2 = db.rawQuery("SELECT NodeID,NodeType FROM tblSupplierMstrList where Descr='" + Descr + "'", null);
            /*[] = new String[cursor2.getCount()]*/

            if (cursor2.moveToFirst()) {
                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStoreTypeNamesDetais = cursor2.getInt(0) + "^" + cursor2.getInt(1);
                    cursor2.moveToNext();
                }
            }
            return strStoreTypeNamesDetais;
        } catch (Exception e) {
            System.out.println("EXCEPTION    " + e);
        } finally {

            cursor2.close();
            //close();
            return strStoreTypeNamesDetais;
        }
    }

    public int fetchSuplierNodeTypeByID(int NodeID) {
        //open();
        Cursor cursor2 = null;
        int strStoreTypeNamesDetais = 0;
        try {
            cursor2 = db.rawQuery("SELECT NodeType FROM tblSupplierMstrList where NodeID='" + NodeID + "'", null);
            /*[] = new String[cursor2.getCount()]*/

            if (cursor2.moveToFirst()) {
                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStoreTypeNamesDetais = cursor2.getInt(0);
                    cursor2.moveToNext();
                }
            }
            return strStoreTypeNamesDetais;
        } catch (Exception e) {
            System.out.println("EXCEPTION    " + e);
        } finally {

            cursor2.close();
            //close();
            return strStoreTypeNamesDetais;
        }
    }

    public String fetchProductNodeTypeByID(int ProductNodeID, int DistID, int DistNodeType) {
        //open();
        Cursor cursor2 = null;
        String strStoreTypeNamesDetais = "0^0";
        try {
            cursor2 = db.rawQuery("SELECT ProductNodeType,StockDate FROM tblDistributorDayReport where ProductNodeID='" + ProductNodeID + "' and DistributorNodeID=" + DistID + " and DistributorNodeType=" + DistNodeType, null);
            /*[] = new String[cursor2.getCount()]*/

            if (cursor2.moveToFirst()) {
                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStoreTypeNamesDetais = cursor2.getInt(0) + "^" + cursor2.getString(1).toString();
                    cursor2.moveToNext();
                }
            }
            return strStoreTypeNamesDetais;
        } catch (Exception e) {
            System.out.println("EXCEPTION    " + e);
        } finally {

            //cursor2.close();
            // close();
            return strStoreTypeNamesDetais;
        }
    }

    public int countDataIntblDistributorSavedData(int DistribtrId, int DistributorNodeType, int Sstat) {
        //open();

        Cursor cursorE2 = null;
        int chkI = 0;
        try {
            cursorE2 = db.rawQuery("SELECT * FROM tblDistributorSavedData WHERE DistribtrId=" + DistribtrId + " and DistributorNodeType=" + DistributorNodeType, null);

            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {


                }
                chkI = 1;

            }

        } finally {
            //cursorE2.close();
            // close();
        }
        return chkI;
    }

    public int counttblDistributorSavedData() throws IOException {
        int chkI = 0;
        try {
            //open();
            Cursor cursorE2 = db.rawQuery("SELECT * from tblSuplierMapping where Sstat=3", null);

            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    chkI = 1;

                }
            }

        } catch (Exception e) {

        } finally {
            //cursorE2.close();
            //close();
        }
        return chkI;
    }

    public void deleteDistributorStockTbles() {
        try {
            //open();

            db.execSQL("DELETE FROM tblDistributorDayReport");
            db.execSQL("DELETE FROM tblDistributorDayReportColumnsDesc");
            db.execSQL("DELETE FROM tblDistributorSavedData");
            db.execSQL("DELETE FROM tblDistributorOldStockData");
        } catch (Exception e) {

        } finally {
            //  close();
        }

    }

    public String GetActiveRouteIDForDistributor() {
        int LoncolumnIndex = 0;
        String activeRouteID = "0";
        Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);
        try {

            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();
                }

            }
            return activeRouteID;
        } finally {
            cursor2.close();
        }

    }

    public void deleteDistributorStockTblesOnDistributorIDBasic(int DistributorNodeID, int DistributorNodeType) {
        try {
            //open();

            db.execSQL("DELETE FROM tblDistributorDayReport where DistributorNodeID=" + DistributorNodeID + " and DistributorNodeType=" + DistributorNodeType);
            db.execSQL("DELETE FROM tblDistributorDayReportColumnsDesc where DistributorNodeID=" + DistributorNodeID + " and DistributorNodeType=" + DistributorNodeType);
            db.execSQL("DELETE FROM tblDistributorSavedData where DistribtrId=" + DistributorNodeID + " and DistributorNodeType=" + DistributorNodeType);
            db.execSQL("DELETE FROM tblDistributorOldStockData where DistribtrId=" + DistributorNodeID + " and DistributorNodeType=" + DistributorNodeType);
        } catch (Exception e) {
System.out.println(e.getMessage().toString());
        } finally {
            //close();
        }

    }

    public LinkedHashMap<String, String>    fetchtblDistribtrReport(int DistributorNodeID, int DistributorNodeType) {
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        LinkedHashMap<String, String> HmapDistrbutrReport;
        try {
            cursor = db.rawQuery("SELECT *  FROM tblDistributorDayReport where DistributorNodeID=" + DistributorNodeID + " and DistributorNodeType=" + DistributorNodeType, null);
            HmapDistrbutrReport = new LinkedHashMap<String, String>();

            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;

                    HmapDistrbutrReport.put(cursor.getString(0).toString().trim() + "^" + (String) cursor.getString(3).toString().trim(), cursor.getString(1).toString().trim() + "^" + (String) cursor.getString(2).toString().trim());
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return HmapDistrbutrReport;
        } finally {
            cursor.close();
        }

    }

    public ArrayList<String> fetchtblDistribtrReportColumnDesc(int DistributorNodeID, int DistributorNodeType) {
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        ArrayList<String> alist;
        try {
            cursor = db.rawQuery("SELECT *  FROM tblDistributorDayReportColumnsDesc where DistributorNodeID=" + DistributorNodeID + " and DistributorNodeType=" + DistributorNodeType, null);
            alist = new ArrayList<String>();

            if (cursor.moveToFirst()) {
                for (int i = 0; i < cursor.getCount(); i++) {
                    if (i > 4) {
                        alist.add(cursor.getString(0) + "^" + cursor.getString(1).toString().trim());
                        System.out.println(cursor.getString(0).toString().trim() + "^" + cursor.getString(1).toString().trim());
                        //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                        // cursor.close();
                    }
                    cursor.moveToNext();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return alist;
        } finally {
            cursor.close();
        }
    }

    public void Delete_tblDistributorSavedData(int DistribtrId, int DistributorNodeType) {
        try {
            //open();
            db.execSQL("DELETE FROM tblDistributorSavedData where DistribtrId=" + DistribtrId + " and DistributorNodeType=" + DistributorNodeType);
            db.execSQL("DELETE FROM tblDistributorOldStockData where DistribtrId=" + DistribtrId + " and DistributorNodeType=" + DistributorNodeType);
        } catch (Exception e) {

        } finally {
            // close();
        }
    }

    public long savetblDistributorSavedData(String ProductName, String ShortName, String ProductID, String Date, String EnteredValue, int DistribtrId, int DistributorNodeType, int ProductNodeType, String StockDate, int Sstat, int EntryType, int StockPcsCaseType,int UOMID) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("ProductName", ProductName.trim());
        initialValues.put("ShortName", ShortName.trim());
        initialValues.put("ProductID", ProductID.trim());
        initialValues.put("Date", Date.trim());
        initialValues.put("EnteredValue", EnteredValue.trim());
        initialValues.put("DistribtrId", DistribtrId);
        initialValues.put("DistributorNodeType", DistributorNodeType);
        initialValues.put("ProductNodeType", ProductNodeType);
        initialValues.put("EntryType", EntryType);
        initialValues.put("StockDate", StockDate);
        initialValues.put("StockPcsCaseType", StockPcsCaseType);
        initialValues.put("UOMTypeID", UOMID);


        initialValues.put("Sstat", Sstat);

        return db.insert(DBHelper.TABLE_tblDistributorSavedData, null, initialValues);
    }

    public LinkedHashMap<String, String> fetchtblDistribtrMnthDates(int DistributorNodeID, int DistributorNodeType) {
        //open();
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        LinkedHashMap<String, String> HmapForDates;
        try {
            cursor = db.rawQuery("SELECT DistDayReportColumnDisplayName  FROM tblDistributorDayReportColumnsDesc where DistributorNodeID=" + DistributorNodeID + " and DistributorNodeType=" + DistributorNodeType, null);
            HmapForDates = new LinkedHashMap<String, String>();

            if (cursor.moveToFirst()) {
                for (int i = 0; i < cursor.getCount(); i++) {
                    if (i > 6) {
                        HmapForDates.put(cursor.getString(0).toString().trim(), cursor.getString(0).toString().trim());
                        System.out.println(cursor.getString(0).toString().trim());
                    }
                    cursor.moveToNext();
                }


            }
            HmapForDates.put("01-01-1900", "Older Stock");
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return HmapForDates;
        } finally {
            cursor.close();
            // close();
        }
    }

    public String[] getDistinctProdctName(int DistributorNodeID, int DistributorNodeType) {
        int LoncolumnIndex = 0;

        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT DISTINCT SKUName  FROM tblDistributorDayReport where DistributorNodeID=" + DistributorNodeID + " and DistributorNodeType=" + DistributorNodeType, null);
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];

            if (cursor2.moveToFirst()) {
                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStoreTypeNamesDetais[i] = cursor2.getString(0);
                    cursor2.moveToNext();
                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
        }
    }

    public String[] getPrdctIdAndSku(String SKUName, int DistribtrId, int DistributorNodeType) {
        int LoncolumnIndex = 0;

        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT ProductNodeID,FlvShortName  FROM tblDistributorDayReport where SKUName='" + SKUName + "' and DistributorNodeID=" + DistribtrId + " and DistributorNodeType=" + DistributorNodeType, null);
            String strStoreTypeNamesDetais[] = new String[cursor2.getCount()];

            if (cursor2.moveToFirst()) {
                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStoreTypeNamesDetais[i] = cursor2.getString(0) + "^" + cursor2.getString(1);
                    cursor2.moveToNext();
                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }
        }
    }

    public LinkedHashMap<String, String> fetchtblDistribtrOldStockData(int DistribtrId, int DistribtrNodeType) {
        //open();
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        LinkedHashMap<String, String> HmapDistrbutrSavedData;
        try {
            cursor = db.rawQuery("SELECT DistribtrTag,EnteredValue  FROM tblDistributorOldStockData where  DistribtrId=" + DistribtrId + " and DistributorNodeType=" + DistribtrNodeType, null);
            HmapDistrbutrSavedData = new LinkedHashMap<String, String>();

            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;

                    HmapDistrbutrSavedData.put(cursor.getString(0).toString().trim(), (String) cursor.getString(1).toString().trim());
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }
            }
            return HmapDistrbutrSavedData;
        } finally {
            //cursor.close();
            //close();
        }
    }

    public LinkedHashMap<String, String> fetchtblDistribtrSavedData(int DistribtrId, int DistribtrNodeType) {
        //open();
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        LinkedHashMap<String, String> HmapDistrbutrSavedData;
        try {
            cursor = db.rawQuery("SELECT ProductID,Date,EnteredValue,DistribtrId,DistributorNodeType,EntryType FROM tblDistributorSavedData where  DistribtrId=" + DistribtrId + " and DistributorNodeType=" + DistribtrNodeType, null);//,Case when UOMTypeID =''  then 3 else 1 end AS UOMTypeID
            HmapDistrbutrSavedData = new LinkedHashMap<String, String>();

            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;

                    HmapDistrbutrSavedData.put(cursor.getString(0).toString().trim() + "_" + (String) cursor.getString(1).toString().trim() + "_" + (String) cursor.getString(3).toString().trim() + "_" + (String) cursor.getString(4).toString().trim() + "_" + (String) cursor.getString(5).toString().trim(), (String) cursor.getString(2).toString().trim());// + "_" + (String) cursor.getString(6).toString().trim()
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }
            }
            return HmapDistrbutrSavedData;
        } finally {
            //cursor.close();
            // close();
        }


    }

    public LinkedHashMap<String, String> fetchtblDistribtrSavedUOMData(int DistribtrId, int DistribtrNodeType) {
        //open();
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        LinkedHashMap<String, String> HmapDistrbutrSavedData;
        try {
            cursor = db.rawQuery("SELECT ProductID,Case when UOMTypeID =''  then 3 else 1 end AS UOMTypeID FROM tblDistributorSavedData where  DistribtrId=" + DistribtrId + " and DistributorNodeType=" + DistribtrNodeType, null);//
            HmapDistrbutrSavedData = new LinkedHashMap<String, String>();

            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;

                    HmapDistrbutrSavedData.put(cursor.getString(0).toString().trim(), cursor.getString(1).toString().trim());// + "_" + (String) cursor.getString(6).toString().trim()
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }
            }
            return HmapDistrbutrSavedData;
        } finally {
            //cursor.close();
            // close();
        }


    }

    public int fnGetDistributorStockPcsCaseType(int DistribtrId, int DistributorNodeType) {

        //open();
        int ScodecolumnIndex = 0;

        Cursor cursor = null;
        //LinkedHashMap<String, String> HmapDistrbutrSavedData;
        try {
            cursor = db.rawQuery("SELECT DISTINCT StockPcsCaseType  FROM tblDistributorSavedData where DistribtrId=" + DistribtrId + " and DistributorNodeType=" + DistributorNodeType, null);

            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = Integer.parseInt(cursor.getString(0).toString().trim());
                    cursor.moveToNext();
                }
            }
            return ScodecolumnIndex;
        } finally {
            //cursor.close();
            // close();
        }

    }

    public String getDistinctStockDate() {
        //open();
        int LoncolumnIndex = 0;

        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT DISTINCT StockDate  FROM tblDistributorDayReport", null);
            String strStoreTypeNamesDetais = "NA";

            if (cursor2.moveToFirst()) {
                for (int i = 0; i < cursor2.getCount(); i++) {
                    strStoreTypeNamesDetais = cursor2.getString(0);
                    cursor2.moveToNext();
                }

            }
            return strStoreTypeNamesDetais;
        } finally {
            cursor2.close();
            // close();
        }
    }

    public long savetblDistributorOldStockData(int DistribtrId, int DistributorNodeType, String DistribtrTag, String EnteredValue) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("DistribtrId", DistribtrId);
        initialValues.put("DistributorNodeType", DistributorNodeType);
        initialValues.put("DistribtrTag", DistribtrTag.trim());
        initialValues.put("EnteredValue", EnteredValue.trim());

        return db.insert(DBHelper.TABLE_tblDistributorOldStockData, null, initialValues);
    }

    public long savetblDistributorDayReportColumnsDesc(String DistDayReportCoumnName, String DistDayReportColumnDisplayName, int CustomerNodeID, int CustomerNodeType) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("DistDayReportCoumnName", DistDayReportCoumnName);
        initialValues.put("DistDayReportColumnDisplayName", DistDayReportColumnDisplayName);
        initialValues.put("DistributorNodeID", CustomerNodeID);
        initialValues.put("DistributorNodeType", CustomerNodeType);

        return db.insert(DBHelper.TABLE_tblDistributorDayReportColumnsDesc, null, initialValues);
    }

    public long savetblDistributorDayReport(int ProductNodeID, int ProductNodeType, String SKUName, String FlvShortName, String StockDate, int CustomerNodeID, int CustomerNodeType) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("ProductNodeID", String.valueOf(ProductNodeID));
        initialValues.put("ProductNodeType", String.valueOf(ProductNodeType).trim());
        initialValues.put("SKUName", SKUName.trim());
        initialValues.put("FlvShortName", FlvShortName.trim());
        initialValues.put("StockDate", StockDate.trim());
        initialValues.put("DistributorNodeID", CustomerNodeID);
        initialValues.put("DistributorNodeType", CustomerNodeType);
        return db.insert(DBHelper.TABLE_tblDistributorDayReport, null, initialValues);
    }

    public void updateDistributorSstat() {

        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected = db.update("tblDistributorSavedData", values, "Sstat=?", new String[]{"3"});

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    public void updateDistributorCheckInSstat() {

        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
            int affected = db.update("tblDistributorSavedData", values, "Sstat=?", new String[]{"3"});
            int affected1 = db.update("tblSuplierMapping", values, "Sstat=?", new String[]{"3"});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    public long savetblTargetVsAchievedNote(String msgToDisplay) {
        //DATABASE_TABLE_MAIN236 = "create table tblTargetVsAchievedNote (MsgToDisplay text null);";
        ContentValues initialValues = new ContentValues();

        initialValues.put("TotalStores", msgToDisplay);


        return db.insert(DBHelper.DATABASE_TABLE_MAIN236, null, initialValues);
    }

    public String fetchNoteFromtblTargetVsAchievedNote() {
        //open();
        int ScodecolumnIndex = 0;
        ////DATABASE_TABLE_MAIN236 = "create table tblTargetVsAchievedNote (MsgToDisplay text null);";

        try {
            Cursor cursor = db.rawQuery("SELECT ifnull(TotalStores,'NA')  FROM tblTargetVsAchievedNote", null);
            String note = "";
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;
                    note = cursor.getString(0);
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                    // cursor.close();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return note;
        } finally {

            // close();
        }

    }

    public long savetblStoreWiseTarget(String StoreID, String TargetValue) {

        ContentValues initialValues = new ContentValues();


        initialValues.put("StoreID", StoreID.trim());
        initialValues.put("TargetValue", TargetValue.trim());

        return db.insert(DBHelper.DATABASE_TABLE_MAIN23, null, initialValues);
    }


    public String GetActiveRouteIDSunilAgain() {
        int LoncolumnIndex = 0;
        String activeRouteID = "0";
        // //open();
        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);


            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }
            if (!CommonInfo.ActiveRouteSM.equals("0")) {
                activeRouteID = CommonInfo.ActiveRouteSM;
            }
            return activeRouteID;
        } finally {
            cursor2.close();
            //close();
        }

    }

    public void Delete_tblStoreWiseTarget() {
        db.execSQL("DELETE FROM tblStoreWiseTarget");
    }

    public String fetchtblStoreWiseTarget(String StoreID) {

        //open();
        String LocIDDesc = "0";
        Cursor cursor = db.rawQuery("SELECT  TargetValue from tblStoreWiseTarget where StoreID='" + StoreID + "'", null);
        try {

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    LocIDDesc = (String) cursor.getString(0).toString().trim();
                    cursor.moveToNext();
                }

            }
            return LocIDDesc;
        } finally {
            cursor.close();
            // close();
        }


    }

    public ArrayList<Object> fetchIncentiveData() {
        ArrayList<Object> arrlstObjects = new ArrayList<Object>();
        ArrayList<LinkedHashMap<String, ArrayList<String>>> array = new ArrayList<LinkedHashMap<String, ArrayList<String>>>();
        ;
        LinkedHashMap<String, ArrayList<String>> HmapSecondaryMstrData = new LinkedHashMap<String, ArrayList<String>>();
        LinkedHashMap<String, ArrayList<String>> HmapMstrData = new LinkedHashMap<String, ArrayList<String>>();

        LinkedHashMap<String, ArrayList<String>> HmapIncMasterListData = new LinkedHashMap<String, ArrayList<String>>();

        LinkedHashMap<String, ArrayList<String>> HmapIncPastDetailData = new LinkedHashMap<String, ArrayList<String>>();
        LinkedHashMap<String, ArrayList<String>> HmapInnerData = new LinkedHashMap<String, ArrayList<String>>();
        String total_earning = "0", Incentive_msg = "NA";

        HmapIncMasterListData = fnGetIncentivesMasterListData();

        // open();
        try {

            for (String key : HmapIncMasterListData.keySet()) {

                int MasterIncId = Integer.parseInt(key);

                HmapMstrData.put("" + MasterIncId, HmapIncMasterListData.get("" + MasterIncId));
                array.add(HmapMstrData);
                Cursor cursor = db.rawQuery("SELECT tblIncentiveSecondaryMaster.IncSlabId,tblIncentiveSecondaryMaster.OutputType,tblIncentiveSecondaryMaster.IncSlabName,count(tblIncentiveDetailsColumnsDesc.IncSlabId) as ColumnCount,tblIncentiveSecondaryMaster.flgAcheived,tblIncentiveSecondaryMaster.Earning FROM tblIncentiveSecondaryMaster INNER JOIN tblIncentiveDetailsColumnsDesc ON tblIncentiveSecondaryMaster.IncSlabId = tblIncentiveDetailsColumnsDesc.IncSlabId WHERE tblIncentiveSecondaryMaster.IncId=" + MasterIncId + " group by tblIncentiveDetailsColumnsDesc.IncSlabId", null);//

                if (cursor.getCount() > 0) {
                    if (cursor.moveToFirst()) {
                        for (int i = 0; i < cursor.getCount(); i++) {
                            ArrayList<String> list_frstTbl = new ArrayList<String>();
                            list_frstTbl.add(0, cursor.getString(0).toString().trim());//IncSlabId
                            list_frstTbl.add(1, cursor.getString(1).toString().trim()); //output type
                            list_frstTbl.add(2, cursor.getString(2).toString().trim()); //incentive name
                            list_frstTbl.add(3, cursor.getString(3).toString().trim()); //count of incId frm columndesc tbl
                            list_frstTbl.add(4, cursor.getString(4).toString().trim()); //flgAchieved
                            list_frstTbl.add(5, cursor.getString(5).toString().trim()); //Earning

                            HmapSecondaryMstrData.put("" + MasterIncId + "^" + cursor.getString(0).toString().trim(), list_frstTbl);

                            HmapInnerData.put(cursor.getString(0).toString().trim(), fetchIncentiveInnerData(cursor.getString(0).toString().trim()));

                            ArrayList<String> list_pastDetail = new ArrayList<String>();
                            list_pastDetail = fetchIncPastDetailData(cursor.getString(0).toString().trim());
                            if (!list_pastDetail.isEmpty()) {
                                HmapIncPastDetailData.put(cursor.getString(0).toString().trim(), list_pastDetail);
                            }

                            list_frstTbl.add(5, String.valueOf(getCountFromIncPastDetails(cursor.getString(0).toString().trim())));

                            cursor.moveToNext();
                        }

                        array.add(HmapSecondaryMstrData);
                        array.add(HmapInnerData);
                        array.add(HmapIncPastDetailData);
                        arrlstObjects.add(array);
                        total_earning = fetchTotalEarning();
                        arrlstObjects.add(total_earning);
                        Incentive_msg = getMsgToDisplay();
                        arrlstObjects.add(Incentive_msg);
                        String flgToShowBankDetails = "" + getflgToShowBankDetails();
                        arrlstObjects.add(flgToShowBankDetails);
                        LinkedHashMap<String, String> hmapBankDetails = getIncentiveBankDetails();
                        arrlstObjects.add(hmapBankDetails);

                    }
                }
            }


        } catch (Exception e) {
            System.out.println("EXception.." + e);
        } finally {
            // close();
        }
        return arrlstObjects;
    }

    public LinkedHashMap<String, String> getIncentiveBankDetails() {
        LinkedHashMap<String, String> hmapBankDetails = new LinkedHashMap<String, String>();
        try {
            Cursor cursor = db.rawQuery("SELECT LvlName,Value FROM tblIncentiveBankDetails", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapBankDetails.put(cursor.getString(0).toString().trim(), cursor.getString(1).toString().trim());
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
        }
        return hmapBankDetails;
    }

    public int getflgToShowBankDetails() {
        int val = 0;
        try {
            Cursor cursor = db.rawQuery("SELECT flgBankDetailsToShow FROM tblIncentiveMsgToDisplay", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    val = Integer.parseInt(cursor.getString(0).toString().trim());
                    System.out.println("MSG FETCHED..." + val);
                }
            }
        } finally {
        }
        return val;
    }

    public ArrayList<String> fetchIncentiveInnerData(String IncSlabId) {
        LinkedHashMap<String, ArrayList<String>> HmapInnerData = new LinkedHashMap<String, ArrayList<String>>();
        String columnIncentives = "";
        String columnIncentivesForTableDisplay = "";
        ArrayList<String> list_frstTbl = new ArrayList<String>();
        int ColumnCount = 0;
        try {
            Cursor cursor = db.rawQuery("SELECT Distinct ReportColumnName,DisplayColumnName FROM tblIncentiveDetailsColumnsDesc where IncSlabId='" + IncSlabId + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        ArrayList<String> arrIncenticeData = new ArrayList<String>();
                        if (columnIncentives.equals("")) {
                            columnIncentives = "IFNULL(" + cursor.getString(0).toString().trim() + ",' ')";
                            columnIncentivesForTableDisplay = cursor.getString(1).toString().trim();
                            ColumnCount = 0;
                        } else {
                            columnIncentives = columnIncentives + ",IFNULL(" + cursor.getString(0).toString().trim() + ",' ')";
                            ;
                            columnIncentivesForTableDisplay = columnIncentivesForTableDisplay + "^" + cursor.getString(1).toString().trim();
                            ColumnCount = ColumnCount + 1;

                        }
											/*	ArrayList<String> list_frstTbl=new ArrayList<String>();
												list_frstTbl.add(cursor.getString(1).toString().trim()); //column desc to show in tbl

												;*/

                        if (i == (cursor.getCount() - 1)) {
                            list_frstTbl.add(columnIncentivesForTableDisplay);
                            arrIncenticeData = fetchColumnData(IncSlabId, columnIncentives, ColumnCount, list_frstTbl);
                        }

                        cursor.moveToNext();
                    }

                }
            }
            return list_frstTbl;
        } finally {
        }
    }

    public ArrayList<String> fetchColumnData(String IncSlabId, String columnIncentives, int ColumnCount, ArrayList<String> list_frstTbl) {
        try {
            Cursor cursor = db.rawQuery("SELECT " + columnIncentives + " FROM tblIncentiveDetailsData where IncSlabId='" + IncSlabId + "'", null);

            System.out.println("PASSED INFO..." + "IncSlabId:" + IncSlabId + " columnIncentives:" + columnIncentives + " ColumnCount:" + ColumnCount);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        Boolean val = false;
                        String incentiveColumnsData = "";
                        for (int j = 0; j <= ColumnCount; j++) {
                            if (incentiveColumnsData.equals("") && val == false) {
                                incentiveColumnsData = cursor.getString(j).toString().trim();
                                val = true;
                            } else {
                                if (j == (ColumnCount)) {
                                    if (cursor.getString(j).toString().trim().equals("")) {
                                        incentiveColumnsData = incentiveColumnsData + "^" + "NA";
                                        System.out.println("j:" + j + "-" + incentiveColumnsData + "-" + cursor.getColumnName(j).toString());
                                    } else {
                                        incentiveColumnsData = incentiveColumnsData + "^" + cursor.getString(j).toString().trim();
                                    }

                                    System.out.println("END OF LOOP: " + "IncSlabId" + IncSlabId + "-" + incentiveColumnsData);
                                } else {
                                    incentiveColumnsData = incentiveColumnsData + "^" + cursor.getString(j).toString().trim();
                                }
                            }

                        }
                        list_frstTbl.add(incentiveColumnsData); //column desc to show in tbl
                        cursor.moveToNext();
                    }
                }
            }
            return list_frstTbl;
        } finally {
        }
    }

    public String fetchTotalEarning() {
        String total_earning = "NA";
        try {
            Cursor cursor = db.rawQuery("SELECT Total_Earning FROM tblTotalEarning", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    total_earning = cursor.getString(0).toString().trim();
                    System.out.println("TOTAL EARNING: " + total_earning);
                    cursor.moveToNext();
                }
            }
        } finally {
            return total_earning;
        }
    }


    public ArrayList<String> fetchIncPastDetailData(String IncSlabId) {
        LinkedHashMap<String, ArrayList<String>> HmapInnerData = new LinkedHashMap<String, ArrayList<String>>();

        String columnIncentives = "";
        String columnIncentivesForTableDisplay = "";
        ArrayList<String> list_frstTbl = new ArrayList<String>();
        int ColumnCount = 0;

        try {
            Cursor cursor = db.rawQuery("SELECT Distinct ReportColumnName,DisplayColumnName FROM tblIncentivePastDetailsColumnsDesc where IncSlabId='" + IncSlabId + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        ArrayList<String> arrIncenticeData = new ArrayList<String>();

                        if (columnIncentives.equals("")) {
                            columnIncentives = cursor.getString(0).toString().trim();
                            columnIncentivesForTableDisplay = cursor.getString(1).toString().trim();
                            ColumnCount = 0;
                        } else {
                            columnIncentives = columnIncentives + "," + cursor.getString(0).toString().trim();
                            columnIncentivesForTableDisplay = columnIncentivesForTableDisplay + "^" + cursor.getString(1).toString().trim();
                            ColumnCount = ColumnCount + 1;
                        }

                        if (i == (cursor.getCount() - 1)) //in end
                        {
                            list_frstTbl.add(columnIncentivesForTableDisplay);
                            fetchIncPastDetailColumnData(IncSlabId, columnIncentives, ColumnCount, list_frstTbl);
                        }

                        cursor.moveToNext();
                    }
                }
            }
            return list_frstTbl;
        } finally {
        }
    }

    public void fetchIncPastDetailColumnData(String IncSlabId, String columnIncentives, int ColumnCount, ArrayList<String> list_frstTbl) {
        try {
            Cursor cursor = db.rawQuery("SELECT " + columnIncentives + " FROM tblIncentivePastDetailsData where IncSlabId='" + IncSlabId + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        String incentiveColumnsData = "";

                        for (int j = 0; j <= ColumnCount; j++) {
                            if (incentiveColumnsData.equals("")) {
                                incentiveColumnsData = cursor.getString(j).toString().trim();
                            } else {
                                incentiveColumnsData = incentiveColumnsData + "^" + cursor.getString(j).toString().trim();
                            }
                        }
                        list_frstTbl.add(incentiveColumnsData); //column desc to show in tbl
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
        }
    }

    public int getCountFromIncPastDetails(String IncSlabId) {
        int cal = 0;
        try {
            Cursor cursor = db.rawQuery("SELECT IncSlabId as ColumnCount FROM tblIncentivePastDetailsColumnsDesc where IncSlabId='" + IncSlabId + "'", null);

            if (cursor.getCount() > 0) {
                cal = cursor.getCount();
                System.out.println("COUNT..." + cal + "IncSlab ID.." + IncSlabId);
            }
        } finally {
        }
        return cal;
    }


    public String getMsgToDisplay() {
        String val = "NA";
        try {
            Cursor cursor = db.rawQuery("SELECT MsgToDisplay FROM tblIncentiveMsgToDisplay", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    val = cursor.getString(0).toString().trim();
                    System.out.println("MSG FETCHED..." + val);
                }
            }
        } finally {
        }
        return val;
    }

    public void truncatetblTargetVsAchievedSummary() {
        db.execSQL("DELETE FROM tblTargetVsAchievedSummary");

    }

    public String[] fetchAllDataFromtblTargetVsAchievedSummary() {
        int ScodecolumnIndex = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT *  FROM tblTargetVsAchievedSummary", null);
        try {
            String allData[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    ScodecolumnIndex = 1;
                    String val4 = "0";
                    String val8 = "0";
                    if (cursor.getString(4) != null) {
                        val4 = cursor.getString(4).toString();
                    }
                    if (cursor.getString(8) != null) {
                        val8 = cursor.getString(8).toString();
                    }

                    allData[i] = (String) cursor.getString(0).toString().trim() + "^" + (String) cursor.getString(1).toString().trim() + "^" + (String) cursor.getString(2).toString().trim() + "^" + (String) cursor.getString(3).toString().trim() + "^" + val4 + "^" + (String) cursor.getString(5).toString().trim() + "^" + (String) cursor.getString(6).toString().trim() + "^" + (String) cursor.getString(7).toString().trim() + "^" + val8 + "^" + (String) cursor.getString(9).toString().trim() + "^" + String.valueOf(cursor.getInt(10));
                    //// System.out.println("Value inserting 231 fetching :"+allData[i]);
                    cursor.moveToNext();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return allData;
        } finally {
            cursor.close();
            //close();
        }

    }

    public List<TblActualVsTargetReport> fetchAllRecordsFromtblTargetVsAchievedSummary() {

        List<TblActualVsTargetReport> tblAllRecordsActualVsTarget = new ArrayList<TblActualVsTargetReport>();

        int ScodecolumnIndex = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT Descr,TodayTarget,TodayAchieved,TodayBal,Todayflg,MonthTarget,MonthAchieved,MonthBal,Monthflg,ValTgtOrPrdctFlg,flgLevel,flgStyleBold,IsStoreLevel  FROM tblTargetVsAchievedSummary", null);
        try {
            String allData[] = new String[cursor.getCount()];
            if (cursor != null && cursor.getCount() > 0 && cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    TblActualVsTargetReport tblActualVsTargetReportRecord = new TblActualVsTargetReport();
                    tblActualVsTargetReportRecord.setDescr(cursor.getString(0));
                    tblActualVsTargetReportRecord.setTodayTarget(cursor.getDouble(1));
                    tblActualVsTargetReportRecord.setTodayAchieved(cursor.getInt(2));
                    tblActualVsTargetReportRecord.setTodayBal(cursor.getFloat(3));
                    tblActualVsTargetReportRecord.setTodayflg(cursor.getInt(4));
                    tblActualVsTargetReportRecord.setMonthTarget(cursor.getFloat(5));
                    tblActualVsTargetReportRecord.setMonthAchieved(cursor.getFloat(6));
                    tblActualVsTargetReportRecord.setMonthBal(cursor.getFloat(7));
                    tblActualVsTargetReportRecord.setMonthflg(cursor.getFloat(8));
                    tblActualVsTargetReportRecord.setValTgtOrPrdctFlg(cursor.getInt(9));
                    tblActualVsTargetReportRecord.setFlgLevel(cursor.getInt(10));
                    tblActualVsTargetReportRecord.setFlgStyleBold(cursor.getInt(11));
                    tblActualVsTargetReportRecord.setIsStoreLevel(cursor.getInt(12));
                    tblAllRecordsActualVsTarget.add(tblActualVsTargetReportRecord);
                    cursor.moveToNext();
                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return tblAllRecordsActualVsTarget;
        } finally {
            cursor.close();
            //close();
        }

    }

    public void deleteIncentivesTbles() {
        try {
            db.execSQL("DELETE FROM tblIncentiveMainMaster");
            db.execSQL("DELETE FROM tblIncentiveSecondaryMaster");
            db.execSQL("DELETE FROM tblIncentiveDetailsData");
            db.execSQL("DELETE FROM tblIncentiveDetailsColumnsDesc");
            db.execSQL("DELETE FROM tblTotalEarning");
            db.execSQL("DELETE FROM tblIncentivePastDetailsData");
            db.execSQL("DELETE FROM tblIncentivePastDetailsColumnsDesc");
            db.execSQL("DELETE FROM tblIncentiveMsgToDisplay");
            db.execSQL("DELETE FROM tblIncentiveBankDetails");

        } catch (Exception e) {
        } finally {
        }
    }

    public void insertRestartStoreInfo(String prvsStoreID, String CrntStoreID, String isSavedOrSubmittedStore, String MsgToRestartPopUpShown, String isRestartDoneByDSR, int Sstat, String ActionTime) {
        //tblsameLocationForStoreRestartDone(UniqueID INTEGER PRIMARY KEY AUTOINCREMENT,prvsStoreID text null,CrntStoreID text null,isSavedOrSubmittedStore text null,is MsgToRestartPopUpShown text null,isRestartDoneByDSR text null ,prvsStoreFlag text null,Sstat text null);";
        //open();

        Cursor cursor = db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where prvsStoreID='" + CrntStoreID + "'", null);

        ContentValues values = new ContentValues();


        values.put("Sstat", Sstat);

        if (cursor.getCount() > 0) {


            db.update(DBHelper.DATABASE_TABLE_tblSameLocationForStoreRestartDone, values, "prvsStoreID=?", new String[]{prvsStoreID});
        } else {
            fnDeleteFlgStoreUnusedPrvs("0");

            values.put("ActionTime", ActionTime);
            values.put("CrntStoreID", CrntStoreID);
            values.put("prvsStoreID", prvsStoreID);
            values.put("isMsgToRestartPopUpShown", MsgToRestartPopUpShown);
            values.put("isSavedOrSubmittedStore", isSavedOrSubmittedStore);
            values.put("isRestartDoneByDSR", isRestartDoneByDSR);
            db.insert(DBHelper.DATABASE_TABLE_tblSameLocationForStoreRestartDone, null, values);
        }


        //close();


    }

    public void updateMsgToRestartPopUpShown(String prvsStoreId, String visitSTime) {
        //open();
        ContentValues values = new ContentValues();
        values.put("isMsgToRestartPopUpShown", "1");
        values.put("ActionTime", visitSTime);
        db.update(DBHelper.DATABASE_TABLE_tblSameLocationForStoreRestartDone, values, "prvsStoreID=?", new String[]{prvsStoreId});
        // close();
    }

    public boolean isPrvsStoreMsgShownAndRestrtDone(String prvsStoreId) {
        //open();
        boolean isToShowPopUpForResart = true;
        try {
            Cursor cur = db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where isMsgToRestartPopUpShown='1' AND isRestartDoneByDSR='1' AND prvsStoreID='" + prvsStoreId + "'", null);
            if (cur.getCount() > 0) {
                isToShowPopUpForResart = false;
            }
        } catch (Exception e) {

        } finally {
            //close();
            return isToShowPopUpForResart;
        }

    }

    public String PrvsStoreMsgShownAndRestrtDone() {
        //open();
        String storeShowPopUpForResartAndDone = "";
        try {
            Cursor cur = db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where isMsgToRestartPopUpShown='1' AND isRestartDoneByDSR='1' AND UniqueID=(SELECT MAX(UniqueID) FROM tblsameLocationForStoreRestartDone)", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    storeShowPopUpForResartAndDone = cur.getString(0);
                }

            } else {
                cur.close();
                Cursor cursor = db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where isMsgToRestartPopUpShown='1' AND isRestartDoneByDSR='0' AND UniqueID=(SELECT MAX(UniqueID) FROM tblsameLocationForStoreRestartDone)", null);
                if (cursor.getCount() > 0) {
                    if (cursor.moveToFirst()) {
                        storeShowPopUpForResartAndDone = cursor.getString(0);
                    }

                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            // close();
            return storeShowPopUpForResartAndDone;
        }

    }

    public void updateisRestartDoneByDSR(String prvsStoreId) {
        //open();
        ContentValues values = new ContentValues();
        values.put("isRestartDoneByDSR", "1");
        db.update(DBHelper.DATABASE_TABLE_tblSameLocationForStoreRestartDone, values, "prvsStoreID=?", new String[]{prvsStoreId});
        //close();
    }

    public void updateCurrentStoreId(String crntStoreID, String prvsStoreId) {
        //open();
        ContentValues values = new ContentValues();
        values.put("CrntStoreID", crntStoreID);
        db.update(DBHelper.DATABASE_TABLE_tblSameLocationForStoreRestartDone, values, "prvsStoreID=?", new String[]{prvsStoreId});
        //close();
    }

    public String getPreviousStoreId() {
        String prvsStoreId = "";
        //open();
        try {
            Cursor cursor = db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where UniqueID=(SELECT MAX(UniqueID) FROM tblsameLocationForStoreRestartDone)", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    prvsStoreId = cursor.getString(0);
                }

            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            // close();
            return prvsStoreId;
        }

    }

    public String getPreviousShownPopUpStoreId() {
        String prvsStoreId = "";
        //open();
        try {
            Cursor cursor = db.rawQuery("Select prvsStoreID from tblsameLocationForStoreRestartDone where UniqueID=(SELECT MAX(UniqueID) FROM tblsameLocationForStoreRestartDone) AND isMsgToRestartPopUpShown='1'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    prvsStoreId = cursor.getString(0);
                }

            }
        } catch (Exception e) {

        } finally {
            //close();
            return prvsStoreId;
        }

    }

    public void fnDeleteFlgStoreUnusedPrvs(String MsgToRestartPopUpShown) {
        try {
            db.execSQL("DELETE FROM tblsameLocationForStoreRestartDone WHERE isMsgToRestartPopUpShown='" + MsgToRestartPopUpShown + "'");// and sectionID="+sectionID
        } catch (Exception e) {

        }


    }

    public String[] getAllStoreIDIntblNewAddedStorePhotoDetail() {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tableImage where Sstat=5", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public String[] getAllStoreIDIntblStoreCheckIn() {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblStoreCheckInPic where Sstat=5", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public int getExistingPicNosForNewAddedStore(String StoreID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tableImage where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public int getExistingPicNosForStoreCheckIn(String StoreID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblStoreCheckInPic where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public String[] getImgsPathForNewAddedStore(String StoreID) {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT imageName FROM tableImage WHERE StoreID ='" + StoreID + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public String[] getImgsPathForStoreCheckIn(String StoreID) {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT imageName FROM tblStoreCheckInPic WHERE StoreID ='" + StoreID + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public void updateImageRecordsSyncdForNewAddedStore(String PhotoName) {

        try {
            //open();
            //System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tableImage", values, "imageName=?", new String[]{PhotoName});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            // close();
        }


    }

    public void updateImageRecordsSyncdForStoreCheckIN(String PhotoName) {

        try {
            //open();
            //System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tblStoreCheckInPic", values, "imageName=?", new String[]{PhotoName});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            // close();
        }


    }

    public LinkedHashMap<String, LinkedHashMap<String, String>> fetchTblRowSummary() {
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        LinkedHashMap<String, LinkedHashMap<String, String>> hmapCatgryAll = new LinkedHashMap<String, LinkedHashMap<String, String>>();

        Cursor cursor = db.rawQuery("SELECT DISTINCT TableNo FROM tblAllSummaryDay", null);
        try {
            String allData[] = new String[cursor.getCount()];
            if (cursor.moveToFirst()) {

                for (int i = 0; i < cursor.getCount(); i++) {
                    allData[i] = (String) cursor.getString(0).toString().trim();

                    hmapCatgry = fetch_Summary_Detail_DayData(allData[i]);
                    hmapCatgryAll.put(allData[i], hmapCatgry);
                    cursor.moveToNext();

                }

            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return hmapCatgryAll;
        } finally {
            cursor.close();
        }

    }


    public String fetchTblLastRefreshTimeReport() {
        String LastRefreshTimeReport="NA";
        Cursor cursor = db.rawQuery("SELECT LastRefreshTime FROM tblLastRefreshTimeReport", null);
        try {
            if (cursor!=null && cursor.getCount()>0) {
                cursor.moveToFirst();
                LastRefreshTimeReport =cursor.getString(0).toString().trim();
            }
            ////// System.out.println("value  of new store is in DBadapter"+ScodecolumnIndex);
            return LastRefreshTimeReport;
        } finally {
            if(cursor!=null)
            cursor.close();
        }

    }

    public LinkedHashMap<String, String> fetch_Summary_Detail_DayData(String TableNo) {
//		//open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        try {
            Cursor cursor = db.rawQuery("SELECT Measures,TodaysSummary,MTDSummary,ColorCode FROM tblAllSummaryDay WHERE TableNo='" + TableNo + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapCatgry.put(cursor.getString(0).toString(), cursor.getString(1).toString() + "^" + cursor.getString(2).toString() + "^" + cursor.getString(3).toString());
                        cursor.moveToNext();
                    }
                }

            }

            return hmapCatgry;
        } finally {
//			cursor.close();
//			close();
        }
    }


//nitika


    //nitika


    public void updateFlgCrediBal(String storeId, int flgCreditRetailBal) {
        //flgRetailerCreditBalnce
        // tblStoreList(StoreID text not null, StoreType string not null, StoreName string not null, StoreLatitude real not null, StoreLongitude real not null, LastVisitDate string not null, LastTransactionDate string not null, Sstat integer not null, ForDate string not null, ActualLatitude text null, ActualLongitude text null, VisitStartTS text null, VisitEndTS text null,AutoIdStore int null, LocProvider text null, Accuracy text null, BateryLeftStatus text null,StoreClose integer null,StoreNextDay integer null,chainID integer null,ISNewStore int null,StoreRouteID int null,RouteNodeType int null,StoreCatNodeId int null,IsNewStoreDataCompleteSaved int null,flgFromWhereSubmitStatus int null,StoreAddress text null,PaymentStage text null,flgHasQuote int null,flgAllowQuotation int null,flgSubmitFromQuotation int null,flgGSTCapture text null,flgGSTCompliance text null,GSTNumber text null,flgGSTRecordFromServer int null,DistanceNear int null,flgLocationServicesOnOff int null,flgGPSOnOff int null,flgNetworkOnOff int null,flgFusedOnOff int null,flgInternetOnOffWhileLocationTracking int null,flgRestart int null,flgStoreOrder int null,StoreCity text null,StorePinCode text not null,StoreState text null,flgRetailerCreditBalnce text null);";
        //open();
        try {

            ContentValues values = new ContentValues();
            values.put("flgRetailerCreditBalnce", flgCreditRetailBal);

            db.update(DBHelper.DATABASE_TABLE_STOREVISIT, values, "StoreID=?", new String[]{storeId});

        } catch (Exception e) {

        } finally {
            // close();
        }

    }

    public boolean isFlgCrediBalSubmitted(String storeId) {
        boolean isRtalrCreditBalSbmtd = true;
        Cursor cur = null;
        //open();
        try {

            cur = db.rawQuery("Select flgRetailerCreditBalnce from tblStoreVisitMstr where StoreID='" + storeId + "' AND flgRetailerCreditBalnce<>-1", null);
            if (cur.getCount() > 0) {
                isRtalrCreditBalSbmtd = true;
            }
        } catch (Exception e) {

        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
            return isRtalrCreditBalSbmtd;
        }
    }


    public int fetchtblStockUploadedCycleId() {
        //open();
        int retVal = 0;
        try {
            Cursor cur = db.rawQuery("Select VanLoadUnLoadCycID from tblStockUploadedStatus", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        retVal = Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            // close();
            return retVal;
        }
    }

    public int fetchtblVanCycleId() {
        //open();
        int retVal = -1;
        try {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null);";
            Cursor cur = db.rawQuery("Select CycleID from tblCycleID", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        retVal = Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            // close();
            return retVal;
        }
    }

    public String fetchtblVanCycleTime() {
        //open();
        String CycStartTime = "";
        try {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null,CycleTime text null);";
            Cursor cur = db.rawQuery("Select CycleTime from tblCycleID", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        CycStartTime = cur.getString(0);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            // close();
            return CycStartTime;
        }
    }


    public void updateOriginalStock(HashMap<String, Integer> hmapProductStock, String distId) {
        //open();
        for (Entry<String, Integer> entry : hmapProductStock.entrySet()) {
            ContentValues values = new ContentValues();
            System.out.println("hmapProductStock = " + entry.getKey() + " : " + entry.getValue());
            values.put("OriginalStock", String.valueOf(entry.getValue()));
            db.update(DBHelper.DATABASE_TABLE_DISTRIBUTOR_STOCK, values, "DistributorNodeIdNodeType=? AND PrdctId=?", new String[]{distId, entry.getKey()});
        }

        // close();
    }


    public void insertStockOut(int flgStockOutEntryDone) {
        ////open();

        ContentValues values = new ContentValues();


        values.put("flgStockOutEntryDone", flgStockOutEntryDone);

        db.insert(DBHelper.DATABASE_TABLE_tblStockOut, null, values);


        //close();
    }

    public String getDistinctInvoiceNumbers() {
        //open();
        String distIDOrderId = "";
        Cursor cur = null;

        //tblDistributorOrderPdaId(DistributorNodeIdNodeType text null,OrderPDAID text null,ProductId text null,OrderQntty text null,Sstat integer not null);";
        try {
            cur = db.rawQuery("Select DISTINCT ServingDBRId,InvoiceNumber from tblInvoiceDetails", null);
            if (cur.getCount() > 0) {
                StringBuilder sb = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        if (i == 0) {
                            sb.append(cur.getString(0)).append("|").append(cur.getString(1));
                        } else {
                            sb.append("^").append(cur.getString(0)).append("|").append(cur.getString(1));
                        }
                        cur.moveToNext();
                    }
                }
                distIDOrderId = sb.toString();
            }
        } catch (Exception e) {

        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
            return distIDOrderId;
        }

    }


    public String getDistinctCollectionPaymentIds() {
        //open();
        String strStoreCollectionUniquneVisitId = "";
        Cursor cur = null;
        try {
            cur = db.rawQuery("Select DISTINCT StoreVisitCode from tblAllCollectionData WHERE Sstat in(3,5,6)", null);
            if (cur.getCount() > 0) {
                StringBuilder sb = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        if (i == 0) {
                            sb.append(cur.getString(0));
                        } else {
                            sb.append("^").append(cur.getString(0));
                        }
                        cur.moveToNext();
                    }
                }
                strStoreCollectionUniquneVisitId = sb.toString();
            }
        } catch (Exception e) {

        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
            return strStoreCollectionUniquneVisitId;
        }

    }

    public void insertDistributorPDAOrderId(String distributorNodeIdNodeType, String orderId, String productId, String orderQntty, int Sstat) {
        //tblDistributorOrderPdaId(DistributorNodeIdNodeType text null,OrderPDAID text null,ProductId text null,OrderQntty text null,Sstat integer not null);";
        //open();
//tblDistributorOrderPdaId
        Cursor cur = db.rawQuery("Select DistributorNodeIdNodeType from tblDistributorOrderPdaId where OrderPDAID='" + orderId + "' AND ProductId='" + productId + "' AND DistributorNodeIdNodeType='" + distributorNodeIdNodeType + "'", null);
        ContentValues values = new ContentValues();
        values.put("Sstat", Sstat);

        values.put("OrderQntty", orderQntty);
        if (cur.getCount() > 0) {
            if (cur != null) {
                cur.close();
            }
            db.update(DBHelper.DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID, values, "OrderPDAID=? AND DistributorNodeIdNodeType=? AND ProductId=?", new String[]{orderId, distributorNodeIdNodeType, productId});
        } else {

            values.put("ProductId", productId);

            values.put("DistributorNodeIdNodeType", distributorNodeIdNodeType);
            values.put("OrderPDAID", orderId);

            long insertd = db.insert(DBHelper.DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID, null, values);
            System.out.println("Nitish Entered = " + insertd);
        }

        // close();
    }

    public void deleteExistStockTable(String distributorNodeIdNodeType, String orderId, String ProductId) {
        //open();
        Cursor cur = db.rawQuery("Select DistributorNodeIdNodeType from tblDistributorOrderPdaId where OrderPDAID='" + orderId + "' AND DistributorNodeIdNodeType='" + distributorNodeIdNodeType + "' AND ProductId='" + ProductId + "'", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID, "DistributorNodeIdNodeType=? AND OrderPDAID=? AND ProductId=?", new String[]{distributorNodeIdNodeType, orderId, ProductId});
        }
        // close();
    }

    public HashMap<String, String> getProductStock(String orderPDAId, String distId) {
        //open();
        HashMap<String, String> hmapPrdctStock = new HashMap<String, String>();
        Cursor cur = db.rawQuery("Select ProductId,OrderQntty from tblDistributorOrderPdaId where DistributorNodeIdNodeType='" + distId + "' AND OrderPDAID='" + orderPDAId + "'", null);
        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                for (int i = 0; i < cur.getCount(); i++) {
                    hmapPrdctStock.put(cur.getString(0), cur.getString(1));
                    cur.moveToNext();
                }
            }
        }
        // close();
        return hmapPrdctStock;
    }

    public void deleteCompleteDataDistStock() {


        db.execSQL("DELETE FROM tblTmpDistributorStock");
        db.execSQL("DELETE FROM tblDistributorStockOutFlg");
        db.execSQL("DELETE FROM tblCycleID");
//tblStockConfirm


        db.execSQL("DELETE FROM tblVanIDOrderIDLeft");


    }


    public String fngetSalesPersonMstrData() {
        String abcd = "0^0";
        Cursor cursor = null;
        try {
            //open();
            cursor = db.rawQuery("SELECT PersonNodeID,PersonNodeType from tblUserAuthenticationMstr", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        abcd = cursor.getString(0) + "^" + cursor.getString(1);
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
            return abcd;
        }
    }


    public LinkedHashMap<String, String> getDistStockCountName() {
        // tblVanProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null);";
        LinkedHashMap<String, String> hmapDistPrdctStockCount = new LinkedHashMap<>();
        int flgVal = flgConfirmedWareHouse();

        Cursor cur = null;
        if (flgVal == 0)//tblTmpDistributorStock
        {
            if (CommonInfo.hmapAppMasterFlags.get("flgVanStockCalculate") == 1) {
                cur = db.rawQuery(" SELECT DISTINCT S.PrdctId,S.SKUName,(S.StockQntty-ifnull(X.OrderQty,0)) AS Stqty,S.OpeningStock,S.CycleAddedStock,S.NetSalesQty+ifnull(X.OrderQty,0) AS OrdQty,S.CategoryID,S.CycleUnloadStk FROM tblTmpDistributorStock S LEFT join tblVanProductStock ST ON S.PrdctId=ST.PrdctId LEFT OUTER JOIN (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceDetails AS ID WHERE ID.InvoiceNumber NOT IN (SELECT D.OrderId FROM tblVanIDOrderIDLeft AS D WHERE D.flgProcessedInvoice=1) GROUP BY ID.ProdID) X ON S.PrdctId=X.ProdID ", null);
            } else {
                cur = db.rawQuery(" SELECT DISTINCT S.PrdctId,S.SKUName,(S.StockQntty-ifnull(X.OrderQty,0)) AS Stqty,S.OpeningStock,S.CycleAddedStock,S.NetSalesQty+ifnull(X.OrderQty,0) AS OrdQty,S.CategoryID,S.CycleUnloadStk FROM tblTmpDistributorStock S LEFT join tblVanProductStock ST ON S.PrdctId=ST.PrdctId LEFT OUTER JOIN (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceDetails AS ID WHERE ID.TmpInvoiceCodePDA NOT IN (SELECT D.OrderId FROM tblVanIDOrderIDLeft AS D WHERE D.flgProcessedInvoice=1) GROUP BY ID.ProdID) X ON S.PrdctId=X.ProdID ", null);
            }
        } else {
            if (CommonInfo.hmapAppMasterFlags.get("flgVanStockCalculate") == 1) {
                cur = db.rawQuery(" SELECT DISTINCT S.PrdctId,S.SKUName,S.StockQntty-ifnull(D.OrderQty,0) AS Stqty,S.OpeningStock,S.CycleAddedStock,S.NetSalesQty+ifnull(D.OrderQty,0) AS OrdQty,S.CategoryID,S.CycleUnloadStk FROM tblVanProductStock S LEFT OUTER JOIN \n" +
                        " (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId", null);
            } else {
                cur = db.rawQuery(" SELECT DISTINCT S.PrdctId,S.SKUName,S.StockQntty-ifnull(D.OrderQty,0) AS Stqty,S.OpeningStock,S.CycleAddedStock,S.NetSalesQty+ifnull(D.OrderQty,0) AS OrdQty,S.CategoryID,S.CycleUnloadStk FROM tblVanProductStock S LEFT OUTER JOIN \n" +
                        " (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.TmpInvoiceCodePDA=I.TmpInvoiceCodePDA  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId", null);
            }
        }
        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                for (int i = 0; i < cur.getCount(); i++) {
                    hmapDistPrdctStockCount.put(cur.getString(0) + "^" + cur.getString(1), cur.getString(2) + "^" + cur.getString(3) + "^" + cur.getString(4) + "^" + cur.getString(5) + "^" + cur.getString(6) + "^" + cur.getString(7));
                    cur.moveToNext();
                }
            }


        }


        // } catch(Exception e)
        // {
        //  System.out.println("Error to Done = "+e.toString());
        //  }

       /* finally
        {*/
        // close();
        return hmapDistPrdctStockCount;
        // }


    }

    public String getUserId() {
        // tblVanProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null);";
        String userId = "0";
        int flgVal = flgConfirmedWareHouse();
        Cursor cur = null;
        //open();
        try {
            if (flgVal == 0) {
                cur = db.rawQuery("Select DISTINCT DistributorNodeIdNodeType from tblTmpDistributorStock", null);
            } else {
                //  tblVanProductStock
                cur = db.rawQuery("Select DISTINCT DistributorNodeIdNodeType from tblVanProductStock", null);
            }
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        userId = cur.getString(0);
                        cur.moveToNext();
                    }
                }


            }


        } catch (Exception e) {

        } finally {
            //  close();
            return userId;
        }


    }

    public int getLeftProductToAddBasedOnInvoiceNumberQantity(int NetStockQty, String distId, String PrdctId) {
        int netStock = 0;
        //tblTmpInvoiceDetails (IMEIno text not null,RouteID int null,StoreID text not null,CatID text  null,ProdID text not null,TransDate string not null,Stock integer not null,OrderQty integer not null,OrderVal real not null,FreeQty integer not null,DisVal real not null,Sstat integer not null,SampleQuantity int null,ProductShortName text null,ProductPrice real null, TaxRate real null,TaxValue real null,StoreCatNodeId int null,OrderIDPDA text null,flgIsQuoteRateApplied int null,distibutorID text null,flgWholeSellApplicable int null,TmpInvoiceCodePDA text null);";
        try {
            boolean isPrdctFound = false;
            //Cursor cur=db.rawQuery("Select tblTmpInvoiceDetails.ProdID , tblTmpInvoiceDetails.OrderQty from tblTmpInvoiceDetails inner join tblVanIDOrderIDLeft ON tblTmpInvoiceDetails.FinalAllotedInvoiceIds=tblVanIDOrderIDLeft.OrderId where tblTmpInvoiceDetails.distibutorID='"+distId+"' AND tblTmpInvoiceDetails.FinalAllotedInvoiceIds<>'NA'",null);
            Cursor cur = db.rawQuery("Select tblInvoiceDetails.ProdID , tblInvoiceDetails.OrderQty from tblInvoiceDetails inner join tblVanIDOrderIDLeft ON tblInvoiceDetails.InvoiceNumber=tblVanIDOrderIDLeft.OrderId where  tblInvoiceDetails.InvoiceNumber<>'NA' AND tblVanIDOrderIDLeft.flgProcessedInvoice=0", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        if (PrdctId.equals(cur.getString(0))) {
                            netStock = NetStockQty + Integer.parseInt(cur.getString(1));
                            NetStockQty = netStock;
                            isPrdctFound = true;

                        }


                        cur.moveToNext();
                    }
                }
            } else {
                netStock = NetStockQty;
            }

            if (!isPrdctFound) {
                netStock = NetStockQty;
            }

        } catch (Exception e) {
            Log.e("Error", e.toString());
        } finally {
            {
                return netStock;
            }
        }


    }


    public String getDisId(String storeId) {
        //open();
        String dbstID = "";
        boolean isDBRPresent = false;
        Cursor cur = null;
        try {


            cur = db.rawQuery("Select DBR from tblStoreList where StoreID='" + storeId + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    if (!cur.getString(0).equals("0")) {
                        isDBRPresent = true;
                        dbstID = cur.getString(0);
                    }
                }
            }
            if (!isDBRPresent) {
                cur = db.rawQuery("Select DBR from tblStoreList where DBR<>'0' Limit 1", null);
                if (cur.getCount() > 0) {
                    if (cur.moveToFirst()) {
                        if (!cur.getString(0).equals("0")) {
                            dbstID = cur.getString(0);
                        }
                    }
                }
            }
        } catch (Exception e) {

        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
            return dbstID;
        }
    }

    public void updateRtlrCrdtBal(String storeId) {
        ContentValues values = new ContentValues();
        values.put("flgRetailerCreditBalnce", 1);
        try {
            db.update(DBHelper.DATABASE_TABLE_STOREVISIT, values, "StoreID=?", new String[]{storeId});
        } catch (Exception e) {

        }

    }

    public void deleteOrderId(String orderId) {
        //"Select DistributorNodeIdNodeType from tblDistributorOrderPddb.insert(DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID,null,values);
        Cursor cur = db.rawQuery("Select DistributorNodeIdNodeType from tblDistributorOrderPdaId where OrderPDAID='" + orderId + "'", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.DATABASE_TABLE_DISTRIBUTOR_ORDERPDAID, "OrderPDAID=?", new String[]{orderId});
        }
    }

    public String[] getAllDSRSignatureAndSelfi() {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(PDACode) FROM tblDsrRegDetails", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                        cursor.moveToNext();
                    }
                }

            }

            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public int getExistingPicNosForSignatureAndSelfi() {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT ifnull(SelfiePath,''),ifnull(SignPath,'') FROM tblDsrRegDetails", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        if (!cursor.getString(ScodecolumnIndex).toString().equals("")) {
                            strProdStockQty = 1;
                        }
                        if (!cursor.getString(1).toString().equals("")) {
                            strProdStockQty = 2;
                        }
                        ///strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public String[] getImgsPathForSignatureAndSelfi() {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT ifnull(SelfieName,''),ifnull(SignName,'') FROM tblDsrRegDetails", null);
        try {

            String StoreName[] = new String[cursor.getCount() + 1];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.getString(SnamecolumnIndex1).toString().equals("")) {
                        StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    }
                    if (!cursor.getString(1).toString().equals("")) {
                        StoreName[1] = (String) cursor.getString(1).toString();
                    }

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public void updateImageRecordsSyncdForDSRRegistrationAndSelfi() {

        try {
            //open();
            db.execSQL("Update tblDsrRegDetails SET Sstat=4");

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            //close();
        }


    }

    public void UpdateDistributerFlag(String SuplierUniqueId, int flag2set) {

        try {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected = db.update("tblSuplierMapping", values, "SuplierUniqueId=?", new String[]{SuplierUniqueId});
        } catch (Exception ex) {
            String ex1 = ex.getMessage();
        }

    }

    public String fngetDIdAndDType(String DistribtrUniqueId) {

        String flgCheckIfStoreExists = "0^0";
        //tblStoreDetails(StoreID
        Cursor cursor2 = db.rawQuery("SELECT NodeID,NodeType FROM tblSuplierMapping WHERE tblSuplierMapping.SuplierUniqueId='" + DistribtrUniqueId + "'", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {

                    flgCheckIfStoreExists = (String) cursor2.getString(0).toString() + "^" + (String) cursor2.getString(1).toString();

                }
            }
        } catch (Exception e) {
            String ex1 = e.getMessage();
        } finally {
            cursor2.close();

        }
        return flgCheckIfStoreExists;
    }

    public void fnupdateSuplierMstrLocationtrackRemapFlg(String DistribtrUniqueId) {
        //open();
        String DIdAndDType = fngetDIdAndDType(DistribtrUniqueId);
        db.execSQL("UPDATE tblSupplierMstrList SET flgRemap=0 WHERE tblSupplierMstrList.NodeID='" + DIdAndDType.split(Pattern.quote("^"))[0] + "' AND tblSupplierMstrList.NodeType='" + DIdAndDType.split(Pattern.quote("^"))[1] + "'");
        //  close();

    }

    public void Delete_tblDistributorMstr() {
        db.execSQL("DELETE FROM tblSupplierMstrList");
    }


    public void deletetblStoreList() {
        //open();
        db.execSQL("DELETE FROM tblStoreList");
        // close();


    }

    public String[] SaveStoreList() {

        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;

        Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList WHERE Sstat = 1 or Sstat = 3", null);
        try {
            String strAreaIdsDetais[] = new String[cursor2.getCount()];
            ////// System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());
            if (cursor2.moveToFirst()) {
                for (int i = 0; i < cursor2.getCount(); i++) {
                    strAreaIdsDetais[i] = (String) cursor2.getString(LoncolumnIndex) + "%" + (String) cursor2.getString(LoncolumnIndex2);

                    ////// System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }

            }
            return strAreaIdsDetais;
        } finally {
            cursor2.close();
        }

    }

    public LinkedHashMap<String, String> fetch_Route_List() {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT ID,RouteType,Descr FROM tblRouteListMaster Order by Descr", null);
        //Cursor cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster where CoverageAreaNodeID='"+CommonInfo.CoverageAreaNodeID+"' and CoverageAreaNodeType='"+CommonInfo.CoverageAreaNodeType+"'", null);

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (i == 0) {
                            hmapCatgry.put("All", "0_0");
                        }
                        hmapCatgry.put(cursor.getString(0).toString() + "-" + cursor.getString(2).toString(), cursor.getString(0).toString() + "_" + cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("No Routes", "0");
            }
            return hmapCatgry;
        } finally {
            cursor.close();
            // close();
        }
    }

    public int checkDSRCheckIntblSuplierMapping() {
        int chkI = 0;
        //open();
        Cursor cursorE2 = null;

        try {
            //cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblSuplierMapping WHERE Sstat =4", null);
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblSuplierMapping", null);
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }
            //chkI=checkDSRCheckIntblDistributorSavedData();

        } finally {
            cursorE2.close();
            // close();
        }
        return chkI;
    }
    //Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList WHERE Sstat = 1 ",null);

    public int checkDSRCheckIntblDistributorSavedData() {
        int chkI = 0;
        Cursor cursorE2 = null;

        try {
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblDistributorSavedData WHERE Sstat =4", null);
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();

        }
        return chkI;
    }

    public String GetActiveRouteDescr() {
        int LoncolumnIndex = 0;

        //open();
        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT ID,Descr FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);

            String activeRouteID = "0";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(1);//cursor2.getString(0).toString() + "-" +
                    cursor2.moveToNext();

                }

            }
            if (activeRouteID.equals("0")) {
                activeRouteID = GetNoActiveRouteDescr();
            }
            return activeRouteID;
        } finally {
            cursor2.close();
            //close();
        }

    }

    public String GetNoActiveRouteDescr() {
        int LoncolumnIndex = 0;


        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT Descr FROM tblRouteListMaster WHERE flgTodayRoute = 0 Limit 1", null);

            String activeRouteID = "0";
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    activeRouteID = cursor2.getString(LoncolumnIndex);
                    cursor2.moveToNext();

                }

            }

            return activeRouteID;
        } finally {
            cursor2.close();

        }

    }

    public String[] FetchStoreRouteIdType(String rID) {
        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;

        Cursor cursor = db.rawQuery("SELECT StoreRouteID, RouteNodeType FROM tblStoreList ORDER BY DistanceNear", null);// where StoreRouteID='"+ rID +"'
        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString() + "_" + (String) cursor.getString(SnamecolumnIndex).toString();
                    cursor.moveToNext();
                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public boolean checkDistributorLocatioExists(String DistribtrId) {
        // int entryCount;
        //open();
        Cursor cursorE2 = null;
        boolean chkI = false;
        try {
            cursorE2 = db.rawQuery("SELECT count(*) FROM tblSuplierMapping WHERE SuplierId ='" + DistribtrId + "'", null);
            if (cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    ////// System.out.println("Stock prev.. entered!");
                    chkI = true;
                } else {
                    chkI = false;
                }
            }

        } finally {
            cursorE2.close();
            // close();
        }
        return chkI;
    }

    public void deleteStorecloseLocationTable() {
        db.execSQL("DELETE FROM tblStoreCloseLocationDetails");
    }

    public void deleteStorecloseLocationTableBasedOnStoreID(String StoreID, String StoreVisitCode) {
        db.execSQL("DELETE FROM tblStoreCloseLocationDetails where StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "'");
    }

    public long saveTblStorecloseLocationDetails(String StoreID,
                                                 String Lattitude, String Longitude, String Accuracy,
                                                 String Address, String City, String Pincode, String State,
                                                 String fnAccurateProvider, String GpsLat, String GpsLong,
                                                 String GpsAccuracy, String NetwLat, String NetwLong,
                                                 String NetwAccuracy, String FusedLat, String FusedLong,
                                                 String FusedAccuracy, String AllProvidersLocation, String GpsAddress,
                                                 String NetwAddress, String FusedAddress,
                                                 String FusedLocationLatitudeWithFirstAttempt, String FusedLocationLongitudeWithFirstAttempt,
                                                 String FusedLocationAccuracyWithFirstAttempt, int Sstat, String StoreVisitCode) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("StoreID", StoreID);

        initialValues.put("Lattitude", Lattitude);
        initialValues.put("Longitude", Longitude);
        initialValues.put("Accuracy", Accuracy);
        initialValues.put("Address", Address);
        initialValues.put("City", City);
        initialValues.put("Pincode", Pincode);
        initialValues.put("State", State);
        initialValues.put("fnAccurateProvider", fnAccurateProvider);
        initialValues.put("GpsLat", GpsLat);
        initialValues.put("GpsLong", GpsLong);
        initialValues.put("GpsAccuracy", GpsAccuracy);
        initialValues.put("NetwLat", NetwLat);
        initialValues.put("NetwLong", NetwLong);
        initialValues.put("NetwAccuracy", NetwAccuracy);
        initialValues.put("FusedLat", FusedLat);
        initialValues.put("FusedLong", FusedLong);
        initialValues.put("FusedAccuracy", FusedAccuracy);

        initialValues.put("AllProvidersLocation", AllProvidersLocation);
        initialValues.put("GpsAddress", GpsAddress);
        initialValues.put("NetwAddress", NetwAddress);
        initialValues.put("FusedAddress", FusedAddress);
        initialValues.put("FusedLocationLatitudeWithFirstAttempt", FusedLocationLatitudeWithFirstAttempt);
        initialValues.put("FusedLocationLongitudeWithFirstAttempt", FusedLocationLongitudeWithFirstAttempt);
        initialValues.put("FusedLocationAccuracyWithFirstAttempt", FusedLocationAccuracyWithFirstAttempt);

        initialValues.put("Sstat", Sstat);

        return db.insert(DBHelper.DATABASE_TABLE_tblStoreCloseLocationDetails, null, initialValues);
    }

    public long inserttblStoreClosedPhotoDetail(String storeId, String ClickedDateTime, String PhotoName,
                                                String PDAPhotoPath, int Sstat, String StoreVisitCode) {

        //open();
        ContentValues initialValues = new ContentValues();
        //StoreID text null,ClickedDateTime text null,PhotoName text null,PDAPhotoPath text null,Sstat integer null
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("ClickedDateTime", ClickedDateTime.trim());
        initialValues.put("PhotoName", PhotoName.trim());
        initialValues.put("PDAPhotoPath", PDAPhotoPath.trim());
        initialValues.put("Sstat", Sstat);

        long inserted = db.insert(DBHelper.DATABASE_TABLE_tblStoreClosedPhotoDetail, null, initialValues);
        // close();
        return inserted;
    }

    public void validateAndDelStoreClosePic(String StoreId, String imgName, String StoreVisitCode) {
        //open();
        try {
            /*tblPutStckRoomPhotoDetails(TempId text null,StoreId text null,PhotoName text null,PhotoPath text null,ClickedDateTime text null,ClickTagPhoto text null,Sstat text null);";*/
            Cursor cur = db.rawQuery("Select PhotoName from tblStoreClosedPhotoDetail where StoreId='" + StoreId + "'" +
                    "and PhotoName='" + imgName + "' AND StoreVisitCode='" + StoreVisitCode + "'", null);

            if (cur.getCount() > 0) {
                db.delete(DBHelper.DATABASE_TABLE_tblStoreClosedPhotoDetail, "StoreID=? and PhotoName=?",
                        new String[]{StoreId, imgName});
            }
        } catch (SQLiteException ex) {
            System.out.println("validate pic..." + ex);
        } finally {
            // close();
        }
    }

    public ArrayList<String> getStoreClosedImgNameByStoreId(String StoreID, String StoreVisitCode) {
        //open();
        ArrayList<String> list = new ArrayList<>();
        try {
            Cursor cur = db.rawQuery("Select PhotoName from tblStoreClosedPhotoDetail where StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        list.add(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getStoreClosedImgNameByStoreId = " + e.toString());
        } finally {
            //close();
            return list;
        }
    }

    public void upDateCloseStoreReason(String StoreID, String ReasonID, String ReasonDesc, String StoreVisitCode) {
        try {
            //open();
            final ContentValues values = new ContentValues();
            values.put("ReasonID", ReasonID);
            values.put("ReasonDesc", ReasonDesc);
            //values.put("StoreVisitCode", StoreVisitCode);

            int affected = db.update("tblStoreCloseReasonSaving", values, "StoreID=? AND StoreVisitCode=?",
                    new String[]{StoreID, StoreVisitCode});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            // close();
        }
    }

    public void savetblStoreCloseReasonMaster(List<TblStoreCloseReasonMaster> tblStoreCloseReasonMaster) {
//    public void savetblStoreCloseReasonMaster(int CloseReasonID, String CloseReasonDescr) {
        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblStoreCloseReasonMaster + " (CloseReasonID, CloseReasonDescr) VALUES (?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblStoreCloseReasonMaster tbl : tblStoreCloseReasonMaster) {
                stmt.bindLong(1, tbl.getCloseReasonID());
                stmt.bindString(2, tbl.getCloseReasonDescr());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }

//        ContentValues values = new ContentValues();
//        values.put("CloseReasonID", CloseReasonID);
//        values.put("CloseReasonDescr", CloseReasonDescr);
//        db.insert(DBHelper.DATABASE_TABLE_tblStoreCloseReasonMaster, null, values);
    }

    public void deletetblStoreCloseReasonMaster() {
        db.execSQL("DELETE FROM tblStoreCloseReasonMaster");
    }

    public LinkedHashMap<String, String> getStoreClosedReasons() {
        //open();
        LinkedHashMap<String, String> list = new LinkedHashMap<>();
        try {
            Cursor cur = db.rawQuery("Select CloseReasonID,CloseReasonDescr from tblStoreCloseReasonMaster", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        if (i == 0) {
                            list.put("00", "Select");
                            list.put(cur.getString(0), cur.getString(1));
                        } else {
                            list.put(cur.getString(0), cur.getString(1));
                        }
                        cur.moveToNext();
                    }
                }
            } else {
                list.put("00", "Select");
            }
        } catch (Exception e) {
            System.out.println("Error getStoreClosedReasons = " + e.toString());
        } finally {
            // close();
            return list;
        }
    }

    public Boolean checkIfRouteExist() {
        //open();
        Boolean isRoute = false;
        Cursor cur = null;
        try {
            cur = db.rawQuery("Select * from tblRouteListMaster", null);
            if (cur.getCount() > 0) {
                isRoute = true;
            }
        } catch (SQLiteException exception) {
            exception.printStackTrace();
        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
            return isRoute;
        }
    }

    public String getOtherReason(String StoreID, String StoreVisitCode) {
        //open();
        String list = "00^NA";
        try {
            Cursor cur = db.rawQuery("Select ReasonID,ReasonDescr from tblStoreCloseReasonSaving where StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        list = cur.getString(0) + "^" + cur.getString(1);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            // close();
            return list;
        }
    }

    //changes
    public String getLatLongForDistrbtrMap(String DistribtrId) {
        //open();
        String list = "NA";
        try {
            Cursor cur = db.rawQuery("Select fnLati,fnLongi from tblSuplierMapping where SuplierId='" + DistribtrId + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        list = cur.getString(0) + "^" + cur.getString(1);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getLatLongForDistrbtrMap = " + e.toString());
        } finally {
            //close();
            return list;
        }
    }

    public long inserttblStoreCloseReasonSaving(String storeId, String ReasonID, String ReasonDescr, int Sstat, String StoreVisitCode) {
        //open();
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", storeId.trim());
        initialValues.put("ReasonID", ReasonID.trim());
        initialValues.put("ReasonDescr", ReasonDescr.trim());
        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("Sstat", Sstat);

        long inserted = db.insert(DBHelper.DATABASE_TABLE_tblStoreCloseReasonSaving, null, initialValues);
        // close();
        return inserted;
    }

    //map distributor
    public long savetblIsDBRStockSubmitted(int IsDBRStockSubmitted) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("IsDBRStockSubmitted", IsDBRStockSubmitted);


        return db.insert(DBHelper.TABLE_tblIsDBRStockSubmitted, null, initialValues);
    }

    public int fetchtblIsDBRStockSubmitted() {
        //open();
        int retVal = 0;
        try {
            Cursor cur = db.rawQuery("Select IsDBRStockSubmitted from tblIsDBRStockSubmitted", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        retVal = Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            // close();
            return retVal;
        }
    }

    public int counttblSupplierMstrList()//If fnChkFlgTodayRoute=1 it will get added to Actual Call On Route Else get Added in Off Route
    {

        //open();
        int ActualCall = 0;
        Cursor cursor2 = db.rawQuery("SELECT Count(*) FROM tblSupplierMstrList", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {

                        if (!cursor2.isNull(0)) {
                            ActualCall = Integer.parseInt(cursor2.getString(0).toString());
                            cursor2.moveToNext();
                        }
                    }
                }
            }

            return ActualCall;
        } finally {
            cursor2.close();
            //close();
        }
    }

    public LinkedHashMap<String, String> fnGetPaymentMode() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        Cursor cursor = db.rawQuery("SELECT InstrumentModeId,InstrumentMode from tblInstrumentMaster   ", null);// Where PNodeID='"+TSIID+"'
        // (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            // close();
        }
    }

    public LinkedHashMap<String, String> fnGetBankIdData() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        Cursor cursor = db.rawQuery("SELECT BankId,BankName from tblBankMaster   ", null);// Where PNodeID='"+TSIID+"'
        // (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            // close();
        }
    }

    public LinkedHashMap<String, String> fnGettblBankMaster() {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();
        // Cursor cursor = db.rawQuery("SELECT SST_NameId,SST_Name_des from tbl_SST_NameMstr Order By Sequence ASC  ", null);// Where PNodeID='"+TSIID+"'
        Cursor cursor = db.rawQuery("SELECT BankId,BankName from tblBankMaster   ", null);// Where PNodeID='"+TSIID+"'
        // (String) cursor.getString(0).toString()+"^"+(String) cursor.getString(1).toString()+"^"+(String) cursor.getString(2).toString()+"^"+(String) cursor.getString(3).toString()+"^"+(String) cursor.getString(4).toString()+"^"+(String) cursor.getString(5).toString()+"^"+(String) cursor.getString(6).toString()+"^"+(String) cursor.getString(7).toString()+"^"+(String) cursor.getString(8).toString()+"^"+(String) cursor.getString(9).toString()+"^"+(String) cursor.getString(10).toString()
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapQuestionMstr.put((String) cursor.getString(1).toString(), (String) cursor.getString(0).toString());
                        //    System.out.println("QuestID:"+(String)cursor.getString(0).toString()+"QuestCode:"+(String) cursor.getString(1).toString()+"QuestDesc:"+(String) cursor.getString(2).toString()+"QuestType:"+(String) cursor.getString(3).toString()+"AnsControlType:"+(String) cursor.getString(4).toString()+"AnsControlInputTypeID:"+(String) cursor.getString(5).toString()+"AnsControlInputTypeMaxLength:"+(String) cursor.getString(6).toString()+"AnsMustRequiredFlg:"+(String) cursor.getString(7).toString()+"QuestBundleFlg:"+(String) cursor.getString(8).toString()+"ApplicationTypeID:"+(String) cursor.getString(9).toString()+"Sequence:"+(String) cursor.getString(10).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapQuestionMstr;
        } finally {
            cursor.close();
            // close();
        }
    }

    public void deleteWhereStoreId(String StoreID, String OrderPDAID, String TmpInvoiceCodePDA) {

        db.execSQL("DELETE FROM tblAllCollectionData WHERE StoreID ='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
    }

    public long savetblAllCollectionData(String StoreVisitCode, String StoreID, String paymentMode, String PaymentModeID, String Amount,
                                         String RefNoChequeNoTrnNo, String Date, String Bank, String TmpInvoiceCodePDA, String CollectionCode) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("StoreID", StoreID.toString().trim());
        initialValues.put("PaymentMode", paymentMode.toString().trim());
        initialValues.put("PaymentModeID", PaymentModeID.toString().trim());
        initialValues.put("Amount", Amount.toString().trim());
        initialValues.put("RefNoChequeNoTrnNo", RefNoChequeNoTrnNo.toString().trim());
        initialValues.put("Date", Date.toString().trim());
        initialValues.put("Bank", Bank.toString().trim());
        initialValues.put("Sstat", "1");
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("CollectionCode", CollectionCode);
       /* initialValues.put("AmountChequesOrDD", AmountSecondString.toString().trim());
        initialValues.put("CashID", "1");
        initialValues.put("RefNoChequeNoTrnNo", ChequeNoSecondString.toString().trim());
        initialValues.put("DateChequesOrDD", DateSecondString.toString().trim());
        initialValues.put("BankChequesOrDD", BankSecondString.toString().trim());

        initialValues.put("ElectronicID", "3");
        initialValues.put("PaymentModeElectronic", paymentModeThirdString.toString().trim());
        initialValues.put("AmountElectronic", AmountThirdString.toString().trim());
        initialValues.put("RefNoChequeNoTrnNoElectronic", ChequeNoThirdString.toString().trim());
        initialValues.put("DateElectronic", DateThirdString.toString().trim());
        initialValues.put("BankElectronic",  BankThirdString.toString().trim());
        initialValues.put("Sstat", "1");
        initialValues.put("OrderPDAID", OrderPDAID);*/


        return db.insert(DBHelper.DATABASE_TABLE_tblAllCollectionData, null, initialValues);
    }

    public String fnRetrieveCollectionDataBasedOnStoreID(String StoreVisitCode, String StoreID, String OrderPDAID, String TmpInvoiceCodePDA) {
        String flag = "0";
        try {
            //open();
            Cursor cursor = db.rawQuery("SELECT PaymentMode, PaymentModeID,Amount,RefNoChequeNoTrnNo,Date,Bank from tblAllCollectionData where StoreID = '" + StoreID + "' and StoreVisitCode='" + StoreVisitCode + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (flag.equals("0")) {
                            flag = cursor.getString(0).toString() + "^" + cursor.getString(1).toString() + "^" + cursor.getString(2).toString() + "^" + cursor.getString(3).toString() + "^" + cursor.getString(4).toString() + "^" + cursor.getString(5).toString();

                        } else {
                            flag = flag + "$" + cursor.getString(0).toString() + "^" + cursor.getString(1).toString() + "^" + cursor.getString(2).toString() + "^" + cursor.getString(3).toString() + "^" + cursor.getString(4).toString() + "^" + cursor.getString(5).toString();
                        }
                        cursor.moveToNext();
                    }

                }
            }
            return flag;
        } catch (Exception e) {

        } finally {

            // close();
            return flag;
        }
    }

    public void deleteAllCollectionTables() {

        db.execSQL("DELETE FROM tblBankMaster");
        db.execSQL("DELETE FROM tblInstrumentMaster");
        db.execSQL("DELETE FROM tblAllCollectionData");


    }

    //Activity Amount Collection Functions


    public String fnCheckNewOrUpdateAndRetrieveCollectionData(String StoreID) {
        String flag = "NEW";
        try {
            //open();
            Cursor cursor = db.rawQuery("SELECT PaymentMode, Amount,RefNoChequeNoTrnNo,Date,Bank from tblAllCollectionData where StoreID = '" + StoreID + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (flag.equals("NEW")) {
                            flag = cursor.getString(0).toString() + "^" + cursor.getString(1).toString() + "^" + cursor.getString(2).toString() + "^" + cursor.getString(3).toString() + "^" + cursor.getString(4).toString();
                        } else {
                            flag = flag + "~" + cursor.getString(0).toString() + "^" + cursor.getString(1).toString() + "^" + cursor.getString(2).toString() + "^" + cursor.getString(3).toString() + "^" + cursor.getString(4).toString();
                        }
                        cursor.moveToNext();
                    }

                }
            }
            return flag;
        } catch (Exception e) {

        } finally {

            //close();
            return flag;
        }
    }

    public int fetchTblStockOut() {
        //open();
        int retVal = 0;
        try {
            Cursor cur = db.rawQuery("Select flgStockOutEntryDone from tblDistributorStockOutFlg", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        retVal = Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            // close();
            return retVal;
        }
    }

    public void inserttblStockUploadedStatus(Integer flgStockTrans, Integer VanLoadUnLoadCycID, BigInteger CycleTime, Integer statusId, Integer flgDayEnd) {

        ContentValues values = new ContentValues();
//tblStockUploadedStatus(flgStockTrans int null,VanLoadUnLoadCycID int null,CycleTime text null);";
        values.put("flgStockTrans", flgStockTrans);
        values.put("VanLoadUnLoadCycID", VanLoadUnLoadCycID);
        values.put("CycleTime", "" + CycleTime);
        values.put("StatusId", statusId);
        values.put("flgDayEnd", flgDayEnd);
       /* SharedPreferences sharedPref = mContext.getSharedPreferences(CommonInfo.Preference, MODE_PRIVATE);
        SharedPreferences.Editor editorFinalSubmit = sharedPref.edit();
        editorFinalSubmit.putInt("FinalSubmit", flgDayEnd);
        editorFinalSubmit.commit();*/
        db.insert(DBHelper.DATABASE_TABLE_tblStockUploadedStatus, null, values);


    }

    public int fetchtblStockUploadedStatus() {
        //open();
        int retVal = 0;
        try {
            Cursor cur = db.rawQuery("Select flgStockTrans from tblStockUploadedStatus", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        retVal = Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            //close();
            return retVal;
        }
    }

    public int fetchtblDayEndStatus() {
        //open();
        int retVal = 0;
        try {
            Cursor cur = db.rawQuery("Select flgDayEnd from tblStockUploadedStatus", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {

                    retVal = cur.getInt(0);
                    cur.moveToNext();

                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            //close();
            return retVal;
        }
    }

    public String[] getAllStoreClosePhotoDetail() {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblStoreClosedPhotoDetail where Sstat=5", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }

            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public int getExistingPicNosForStoreClose(String StoreID) {

        int ScodecolumnIndex = 0;
        // tblStoreClosedPhotoDetail
        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblStoreClosedPhotoDetail where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public String[] getImgsPathForStoreClose(String StoreID) {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT PhotoName FROM tblStoreClosedPhotoDetail WHERE StoreID ='" + StoreID + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public void updateImageRecordsSyncdForStoreClose(String PhotoName) {

        try {
            //open();
            //System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tblStoreClosedPhotoDetail", values, "PhotoName=?", new String[]{PhotoName});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            //close();
        }


    }

    public void UpdateStoreClosephotoFlag(String sID, int flag2set) {
        try {
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected16 = db.update("tblStoreClosedPhotoDetail", values, "StoreID=?", new String[]{sID});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
    }

    public LinkedHashMap<String, String> getPrdctIdAndSkuWrehouse() {
        //private static final String CREATE_TABLE_tblDistributorDayReport="
        // create table tblDistributorDayReport(ProductNodeID text null, ProductNodeType text null, SKUName text null, FlvShortName text null,StockDate text null,DistributorNodeID int null,DistributorNodeType int null);";
        LinkedHashMap<String, String> hmapGetData = new LinkedHashMap<>();
        int LoncolumnIndex = 0;

        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT ProductNodeID,FlvShortName  FROM tblDistributorDayReport ", null);


            if (cursor2.moveToFirst()) {
                for (int i = 0; i < cursor2.getCount(); i++) {
                    hmapGetData.put(cursor2.getString(0), cursor2.getString(1));
                    cursor2.moveToNext();
                }

            }
            return hmapGetData;
        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }
        }
    }

    public void deleteConfirmWArehouse() {
        //open();
        db.execSQL("Delete from tblStockConfirm");
        //close();
    }

    public void insertConfirmWArehouse(String UserId, String confirmFlg) {

        //open();
        deleteVanConfirmFlag();
        ContentValues values = new ContentValues();
        values.put("UserId", UserId);
        values.put("confirmFlg", confirmFlg);
        db.insert(DBHelper.DATABASE_TABLE_tblStockConfirm, null, values);
        db.execSQL("DELETE FROM tblVanProductStock");
//PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,SKUName text null,OpeningStock text null,TodaysAddedStock text null,CycleAddedStock text null,NetSalesQty text null,TodaysUnloadStk text null,CycleUnloadStk text null,CategoryID
        db.execSQL("INSERT INTO " + DBHelper.DATABASE_TABLE_DISTRIBUTOR_STOCK + " SELECT * FROM " + DBHelper.DATABASE_TABLE_TMP_DISTRIBUTOR_STOCK);
        db.execSQL("DELETE FROM tblTmpDistributorStock");
        updateInvoiceExecuted();

        if (SplashScreen.sPrefVanStockChanged != null) {
            Editor editor = SplashScreen.sPrefVanStockChanged.edit();
            editor.clear();
            editor.commit();
        }
        CommonInfo.VanLoadedUnloaded = 0;
        //DATABASE_TABLE_TMP_DISTRIBUTOR_STOCK
        //  DATABASE_TABE_DISTRIBUTOR_STOCK

        //close();

    }


    public void updateInvoiceExecuted() {
        // flgProcessedInvoice,InvoiceNumber
        //tblVanIDOrderIDLeft(DistributorNodeIdNodeType text null,OrderId text null,flgProcessedInvoice int not null);";
        //tblInvoiceHeader (StoreVisitCode text not null,InvoiceNumber int not null,TmpInvoiceCodePDA text null, StoreID text not null, InvoiceDate string not null, TotalBeforeTaxDis real not null, TaxAmt real not null, TotalDis real not null, InvoiceVal real not null, FreeTotal integer not null, Sstat integer not null, InvAfterDis real not null, AddDis real not null,  NoCoupon int null, TotalCoupunAmount real null,TransDate string not null,FlgInvoiceType text not null,flgWholeSellApplicable int null,flgProcessedInvoice int not null,CycleID  int not null);";

        //  if(CommonInfo.flgDrctslsIndrctSls==1) {
        if (CommonInfo.hmapAppMasterFlags.containsKey("flgVanStockCalculate") || CommonInfo.hmapAppMasterFlags.containsKey("flgDBRStockCalculate")) {
            if (CommonInfo.hmapAppMasterFlags.get("flgVanStockCalculate") != null) {
                if (CommonInfo.hmapAppMasterFlags.get("flgVanStockCalculate") == 1) {
                    //db.execSQL("UPDATE tblInvoiceHeader SET tblInvoiceHeader.flgProcessedInvoice=(Select tblVanIDOrderIDLeft.flgProcessedInvoice from tblVanIDOrderIDLeft inner join tblInvoiceHeader ON  tblInvoiceHeader.InvoiceNumber=tblVanIDOrderIDLeft.OrderId Where tblInvoiceHeader.InvoiceNumber=tblVanIDOrderIDLeft.InvoiceNumber AND tblVanIDOrderIDLeft.flgProcessedInvoice<>null) D where D.flgProcessedInvoice<>null");
                    if (fnCounttblVanProductLeft() > 0) {
                        db.execSQL("UPDATE tblInvoiceHeader SET flgProcessedInvoice=(Select tblVanIDOrderIDLeft.flgProcessedInvoice from tblVanIDOrderIDLeft Where (tblInvoiceHeader.InvoiceNumber=tblVanIDOrderIDLeft.OrderId))");
                    }
                }
            }
            if (CommonInfo.hmapAppMasterFlags.get("flgDBRStockCalculate") != null) {
                if (CommonInfo.hmapAppMasterFlags.get("flgDBRStockCalculate") == 1) {
                    if (fnCounttblDistributorProductLeft() > 0) {
                        db.execSQL("UPDATE tblInvoiceHeader SET flgProcessedInvoice=(Select ifnull(flgProcessedInvoice,0) from tblDistributorIDOrderIDLeft Where (tblInvoiceHeader.TmpInvoiceCodePDA=tblDistributorIDOrderIDLeft.OrderId))");
                    }
                }
            }

        }

        //  }
       /* else
        {
            db.execSQL("UPDATE tblInvoiceHeader SET flgProcessedInvoice=(Select flgProcessedInvoice from tblVanIDOrderIDLeft Where (tblInvoiceHeader.TmpInvoiceCodePDA=tblVanIDOrderIDLeft.OrderId))");
        }*/
    }

    public void deleteVanConfirmFlag() {

        db.execSQL("DELETE FROM tblStockConfirm");

    }

    public int flgConfirmedWareHouse() {
        int flgConfirm = 0;
        //open();
        try {


            Cursor cur = db.rawQuery("Select * from tblStockConfirm", null);
            if (cur.getCount() > 0) {
                flgConfirm = 1;
            }
        } catch (SQLException exception) {

        } finally {
            //close();
            return flgConfirm;
        }
    }

    public double fnGettblPriceApplycutoffvalue(String storeID) {
        //open();
        Double cutoffvalue = 0.0;
        Cursor cursor = db.rawQuery("Select ifnull(cutoffvalue,0.0) from tblPriceApplyType", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                cutoffvalue = Double.parseDouble(cursor.getString(0));
                //cutoffvalue=Double.parseDouble(decimalFormat.format(cutoffvalue));
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        // close();
        return cutoffvalue;
    }

    public LinkedHashMap<String, String> fetch_Store_RemaningStockStatus() {

        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
//tblVanProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,SKUName text null,OpeningStock text null,TodaysAddedStock text null,CycleAddedStock text null,NetSalesQty text null,TodaysUnloadStk text null,CycleUnloadStk text null,CategoryID text null);";
        Cursor cursor = db.rawQuery("Select DISTINCT S.SKUName,S.StockQntty-ifnull(D.OrderQty,0) AS StockAvailable,((S.OpeningStock+S.TodaysAddedStock)-S.TodaysUnloadStk) As openingStk,S.NetSalesQty+ifnull(D.OrderQty,0) from tblVanProductStock S left outer join (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId", null);

//Cursor cur=db.rawQuery("Select PrdctId,OriginalStock from tblVanProductStock where DistributorNodeIdNodeType='"+distId+"'",null);
        //  Cursor	cursor = db.rawQuery("SELECT Distinct ProductShortName,IFNULL(StockQntty,0),IFNULL(OriginalStock,0) from tblVanProductStock inner join tblProductListMaster on tblVanProductStock.PrdctId=tblProductListMaster.ProductID", null); //order by AutoIdOutlet Desc
//Cursor	cursor = db.rawQuery("SELECT tblStoreList.StoreID, tblStoreList.StoreName, IFNULL(tblTmpInvoiceHeader.InvoiceVal,0) FROM tblStoreList left outer join tblTmpInvoiceHeader on tblStoreList.StoreID=tblTmpInvoiceHeader.StoreID", null); //order by AutoIdOutlet Desc
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        // hmapCatgry.put((i+1)+")  "+cursor.getString(0).toString(), "[Stock Left: "+cursor.getString(2).toString()+"]");//[Stock Loaded:->"+cursor.getString(1).toString()+ "]
                        hmapCatgry.put((i + 1) + ")  " + cursor.getString(0).toString(), cursor.getString(1).toString() + "^" + cursor.getString(2).toString() + "^" + cursor.getString(3).toString());//[Stock Loaded:->"+cursor.getString(1).toString()+ "]

                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("No Stock", "0");
            }
            return hmapCatgry;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }
    }

    public Double fetch_Store_MaxCollectionAmount(String StoreID, String TmpInvoiceCodePDA) {
//tv_GrossInvVal
        //open();
        Double dblMaxCollectionAmount = 0.0;
        Cursor cursor = db.rawQuery("SELECT ifnull(tblLastOutstanding.Outstanding,'0.0'),tblTmpInvoiceHeader.InvoiceVal from tblTmpInvoiceHeader left outer join tblLastOutstanding on tblTmpInvoiceHeader.StoreID=tblLastOutstanding.StoreID WHERE tblTmpInvoiceHeader.StoreID='" + StoreID + "' AND tblTmpInvoiceHeader.TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null); //order by AutoIdOutlet Desc
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        dblMaxCollectionAmount = Double.parseDouble(cursor.getString(0).toString()) + Double.parseDouble(cursor.getString(1).toString());

                        cursor.moveToNext();
                    }
                }

            } else {
                dblMaxCollectionAmount = 0.0;
            }
            return dblMaxCollectionAmount;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }
    }

    public Double fetch_Store_InvValAmount(String StoreID, String TmpInvoiceCodePDA) {
//tv_GrossInvVal
        //open();
        Double dblMaxCollectionAmount = 0.0;
        // Cursor   cursor = db.rawQuery("SELECT tblTmpInvoiceHeader.InvoiceVal from tblTmpInvoiceHeader WHERE tblTmpInvoiceHeader.StoreID='"+StoreID+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null); //order by AutoIdOutlet Desc
        Cursor cursor = db.rawQuery("SELECT tblTmpInvoiceHeader.InvoiceVal from tblTmpInvoiceHeader WHERE tblTmpInvoiceHeader.StoreID='" + StoreID + "'", null); //order by AutoIdOutlet Desc
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        dblMaxCollectionAmount = Double.parseDouble(cursor.getString(0).toString());

                        cursor.moveToNext();
                    }
                }

            } else {
                dblMaxCollectionAmount = 0.0;
            }
            return dblMaxCollectionAmount;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public double fnGetStoretblLastOutstanding(String storeID) {
        //open();
        double LastOutstanding = 0.0;
        Cursor cursor = db.rawQuery("Select ifnull(Outstanding,'0.0') from tblLastOutstanding WHERE StoreID='" + storeID + "'", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                LastOutstanding = Double.parseDouble(cursor.getString(0));
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        // close();
        return LastOutstanding;
    }

    public Double fnTotCollectionAmtAgainstStore(String StoreID, String TmpInvoiceCodePDA, String StoreVisitCode) {
        //open();
        Double TotCollectionAmt = 0.0;
        Cursor cursor=null;
        try {

            cursor = db.rawQuery("SELECT  SUM(IFNULL(Amount,0.0)) from tblAllCollectionData where StoreID = '" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
            if (cursor!=null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    TotCollectionAmt = Double.parseDouble(cursor.getString(0).toString());
                }
            }
        } catch (Exception e) {

        } finally {
            if (cursor != null) {
                cursor.close();

            }
            // close();
            // return flag;
        }
        return TotCollectionAmt;
    }

    public String[] fetch_Store_tblInvoiceLastVisitDetails(String StoreID) {
//tv_GrossInvVal
        //open();

        Cursor cursor = db.rawQuery("SELECT ifnull(tblInvoiceLastVisitDetails.InvCode,'0.0'),ifnull(tblInvoiceLastVisitDetails.InvDate,'NA'),ifnull(tblInvoiceLastVisitDetails.OutstandingAmt,'0.0'),ifnull(tblInvoiceLastVisitDetails.AmtOverdue,'0.0') from tblInvoiceLastVisitDetails WHERE tblInvoiceLastVisitDetails.StoreID='" + StoreID + "'", null); //order by AutoIdOutlet Desc
        String InvoiceLastVisitDetails[] = new String[cursor.getCount()];
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        InvoiceLastVisitDetails[i] = cursor.getString(0).toString() + "^" + cursor.getString(1).toString() + "^" + cursor.getString(2).toString() + "^" + cursor.getString(3).toString();
                        cursor.moveToNext();
                    }
                }
            }
            return InvoiceLastVisitDetails;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }

    public long savetblInvoiceCaption(String INVPrefix, int VanIntialInvoiceIds, String INVSuffix) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("INVPrefix", INVPrefix);
        initialValues.put("VanIntialInvoiceIds", VanIntialInvoiceIds);
        initialValues.put("INVSuffix", INVSuffix);
        return db.insert(DBHelper.DATABASE_TABLE_tblInvoiceCaption, null, initialValues);
    }

    public void Delete_tblInvoiceCaption() {
        db.execSQL("DELETE FROM tblInvoiceCaption");

    }


    public String fnGetExistingInvoiceNumber(String StoreID) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT TmpInvoiceCodePDA FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND Sstat=1", null);
        String TmpInvoiceCodePDA = "0";
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    TmpInvoiceCodePDA = cursorE2.getString(0).toString();
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            // close();
        }
        return TmpInvoiceCodePDA;
    }

    public void updateOutstandingOfStore(String StoreID, Double OutStandingAmt) {

        //open();
        //
        try {
            db.execSQL("Update tblLastOutstanding Set  Outstanding=" + OutStandingAmt + " WHERE StoreID='" + StoreID + "'");
        } catch (Exception ex) {

        }


        // close();
    }

    public void deletetblDistributorOrderPdaId() {


        db.execSQL("DELETE FROM tblDistributorOrderPdaId");
        //db.execSQL("DELETE FROM tblVanProductStock");
        db.execSQL("DELETE FROM tblVanIDOrderIDLeft");
        //db.execSQL("DELETE FROM tblDistributorOrderPdaId");

        db.execSQL("DELETE FROM tblDistributorStockOutFlg");


    }

    public HashMap<String, String> checkForStoreIdVisitStatus() {
        Cursor cursor = db.rawQuery("Select StoreID,VisitTypeStatus from tblStoreVisitMstr", null);
        HashMap<String, String> hmapStoreIdVisitStatus = new HashMap<String, String>();
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapStoreIdVisitStatus.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapStoreIdVisitStatus;
    }


    public void updateVisitTypeStatusOfStore(String StoreID, String VisitTypeStatus, String StoreVisitCode) {
        //open();
        try {
            db.execSQL("Update tblStoreVisitMstr Set  VisitTypeStatus=" + VisitTypeStatus + " WHERE StoreID='" + StoreID + "' and StoreVisitCode='" + StoreVisitCode + "'");
        } catch (Exception ex) {

        }
        // close();
    }

    public int fnStoreCountWithVisitTypeStatus() {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT Count(VisitTypeStatus) FROM tblStoreVisitMstr WHERE VisitTypeStatus=1 OR VisitTypeStatus=3", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = Integer.valueOf(cursorE2.getCount());
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public int fnStoreCountWithsStatStatus() {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT Count(Sstat) FROM tblStoreList WHERE Sstat=1", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = Integer.valueOf(cursorE2.getCount());
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public void UpdateStoreFlagAtDayEndOrChangeRouteWithOnlyVistOrCollection(String sID, int flag2set) {

        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            int affected24 = db.update("tblStoreOrderBillAddressDetails", values, "StoreID=?", new String[]{sID});
            int affected25 = db.update("tblStoreSalesOrderPaymentDetails", values, "StoreId=?", new String[]{sID});
            int affected26 = db.update("tblRateDistribution", values, "StoreId=?", new String[]{sID});
            // int affected27 = db.update("tableImage", values,"StoreID=?", new String[] { sID });

            //tblNewStoreSalesQuotePaymentDetails (StoreId text null,PymtStageId text null,Sstat text null);";
            int affected23 = db.update("tblNewStoreSalesQuotePaymentDetails", values, "StoreId=?", new String[]{sID});

            //tblOutletQuestAnsMstr
            ////// System.out.println("Updating Status for Store ID: " + sID);
            int affected = db.update("tblStoreList", values, "StoreID=?", new String[]{sID});
            int affected61 = db.update("tblStoreCheckInPic", values, "StoreID=?", new String[]{sID});
            int affected121 = db.update("tblNewAddedStoreLocationDetails", values, "StoreID=?", new String[]{sID});
            //int affected2 = db.update("tblTransac", values, "StoreID=?",new String[] { sID });

            int affected4 = db.update("tblNewStoreListEntries", values, "StoreID=?", new String[]{sID});

            //int affected4 = db.update("tblDistributionStoreProductWiseDetails", values, "StoreID=?",new String[] { sID });
            //int affected5 = db.update("tblDistributionStoreProductMstr", values, "StoreID=?",new String[] { sID });

            int affected9 = db.update("tblNewStoreEntries", values, "StoreID=?", new String[]{sID});
            int affected10 = db.update("tblTemp", values, "StoreID=?", new String[]{sID});

            //   int affected3 = db.update("tblTmpInvoiceHeader", values, "StoreID=? ",new String[] { sID });

            //int affected4 = db.update("tblDistributionStoreProductWiseDetails", values, "StoreID=?",new String[] { sID });
            //int affected5 = db.update("tblDistributionStoreProductMstr", values, "StoreID=?",new String[] { sID });
            int affected5 = db.update("tblPDAProductReturnMstr", values,
                    "StoreID=? ", new String[]{sID});

            // int affected7 = db.update("tblTmpInvoiceDetails", values,"StoreID=?  ", new String[] { sID });
            int affected8 = db.update("tblStoreProductAppliedSchemesBenifitsRecords", values, "StoreID=? ", new String[]{sID});


            int affected11 = db.update("tblStoreReturnDetail", values, "StoreID=? ", new String[]{sID});

            //int affected12 = db.update("tblStoreReturnDetail", values,"StoreID=?", new String[] { sID });
            int affected13 = db.update("tblProductMappedWithSchemeSlabApplied", values, "StoreId=? ", new String[]{sID});
            //StoreId text null,ProductID text null,schSlabId text null,schmIdMapped text null,Sstat int null);";
            int affected14 = db.update("tblStoreProductPhotoDetail", values, "StoreID=? ", new String[]{sID});

            int affected21 = db.update("tblOutletQuestAnsMstr", values, "OutletID=?", new String[]{sID});


            int affected17 = db.update("tblSalesQuotePersonMeetMstr", values, "StoreId=?", new String[]{sID});

            //int affected171 = db.update("tblAllCollectionData", values,"StoreID=?", new String[] { sID });

            // int affected19 = db.update("tblDsrRegDetails", values, "StoreID=?",new String[] { sID });

            db.execSQL("UPDATE tblDsrRegDetails SET Sstat=" + flag2set);

            LinkedHashMap<String, String> hmapDistinctSalesQuotePersonMeetMstr = fngetDistinctSalesQuotePersonMeetMstrForSstatUpdate(sID);


            Iterator it11new = hmapDistinctSalesQuotePersonMeetMstr.entrySet().iterator();

            while (it11new.hasNext()) {
                Entry pair = (Entry) it11new.next();
                if (hmapDistinctSalesQuotePersonMeetMstr.containsKey(pair.getKey().toString())) {
                    //crntPID	=pair.getKey().toString();
                    int affected18 = db.update("tblSalesQuoteProductsMstr", values, "SalesQuoteId=?", new String[]{pair.getKey().toString()});
                }

            }


            int chkValue = fnChkStoreIdExistsInReturnMstrDayEndChangeRoute(sID);

            if (chkValue == 1) {
                int productreturnmstrid = fnGetAutoIdStoreOnReturnPAge(sID);

                int chkValueReturnDetails = fnChkAutoIdMstrForReturnDetailsChangeRouteDayEnd(productreturnmstrid);
                if (chkValueReturnDetails == 1) {
                    int affected6 = db.update("tblPDAProductReturnDetails",
                            values, "ReturnIdMstr=? ", new String[]{""
                                    + productreturnmstrid});
                }
            }

            Log.w(TAG, "affected records: " + affected);

            Log.w(TAG, "Record(s) Updated..");

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public LinkedHashMap<String, String> fnGetStoreListToProcessWithoutAlret() {
        //open();
        int LoncolumnIndex = 0;
        int LoncolumnIndex2 = 1;
        LinkedHashMap<String, String> hmapStoreListToProcessWithoutAlret = new LinkedHashMap<String, String>();
        //Cursor cursor2 = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList WHERE (Sstat = 1  OR StoreNextDay = 1) and Sstat<>4  and Sstat<>5 and Sstat<>6",null);//OR StoreClose = 1
        Cursor cursor2 = db.rawQuery("SELECT tblStoreVisitMstr.StoreID, tblStoreList.StoreName FROM tblStoreVisitMstr inner join tblStoreList On tblStoreVisitMstr.StoreID=tblStoreList.StoreID WHERE tblStoreVisitMstr.Sstat = 1 AND (VisitTypeStatus='1' OR VisitTypeStatus='3')", null);//OR StoreClose = 1
        try {
            String strAreaIdsDetais[] = new String[cursor2.getCount()];
            ////// System.out.println("records count[ProcessStoreReq]: "+cursor2.getCount());
            if (cursor2.moveToFirst()) {
                for (int i = 0; i < cursor2.getCount(); i++) {
                    hmapStoreListToProcessWithoutAlret.put((String) cursor2.getString(LoncolumnIndex), (String) cursor2.getString(LoncolumnIndex2)); //(String) cursor2.getString(LoncolumnIndex)+ "%"+ (String) cursor2.getString(LoncolumnIndex2);
                    ////// System.out.println("VAL1: "+(String) cursor2.getString(LoncolumnIndex) + "  "+"VAL2: "+(String) cursor2.getString(LoncolumnIndex2));
                    cursor2.moveToNext();
                }
            }
            return hmapStoreListToProcessWithoutAlret;
        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }
            // close();
        }

    }

    public int fnCounttblDistributorProductLeft() {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblDistributorIDOrderIDLeft", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = Integer.valueOf(cursorE2.getCount());
                }
            }
        } catch (Exception ex) {

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public int fnCounttblVanProductLeft() {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblVanIDOrderIDLeft", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = Integer.valueOf(cursorE2.getCount());
                }
            }
        } catch (Exception ex) {

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }

    public String fnGetRouteIDWhilePurshase() {
        int LoncolumnIndex = 0;


        Cursor cursor3 = null;
        try {
            //cursor2 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 1 Limit 1", null);
            cursor3 = db.rawQuery("SELECT ID FROM tblRouteListMaster WHERE flgTodayRoute = 0 Limit 1", null);


            String activeRouteID = "0";
            if (cursor3.moveToFirst()) {

                for (int i = 0; i < cursor3.getCount(); i++) {
                    activeRouteID = cursor3.getString(LoncolumnIndex);
                    cursor3.moveToNext();

                }

            }
            return activeRouteID;
        } finally {
            if (cursor3 != null) {
                cursor3.close();
            }

        }

    }

    public LinkedHashMap<String, String> fetch_Category_ForWarehouseCheckIn() {
        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT DISTINCT CategoryID,CategoryDescr FROM tblCategoryMaster  Order by CatOrdr", null);
        //  Cursor cursorStock = db.rawQuery("SELECT DISTINCT tblVanProductStock.CategoryID,tblCategoryMaster.CategoryDescr FROM tblCategoryMaster inner join tblVanProductStock ON tblVanProductStock.CategoryID=tblCategoryMaster.CategoryID Order by tblCategoryMaster.CatOrdr",null);
        //"Select PrdctId,SKUName,OriginalStock,OpeningStock,AddedStock,NetStockQty,CategoryID from tblVanProductStock",null);
        // System.out.println("Count to ="+cursorCat.getCount()+" : "+cursorStock.getCount());
        // Cursor cursor = db.rawQuery("SELECT DISTINCT tblVanProductStock.CategoryID,CategoryDescr FROM tblCategoryMaster inner join tblVanProductStock ON tblVanProductStock.CategoryID=tblCategoryMaster.CategoryID Order by CatOrdr",null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        hmapCatgry.put(cursor.getString(1).toString(), cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("No Category", "0");
            }
            return hmapCatgry;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }
    }

    /*public String fnGetFinalAllotedInvoiceIds(String StoreID)
     {
         //open();
         String VanFinalAllotedInvoiceId="";
         Cursor cursor=db.rawQuery("Select INVPrefix,VanIntialInvoiceIds from tblInvoiceCaption",null);

         if(cursor.getCount()>0)
         {
             if(cursor.moveToFirst())
             {
                 VanFinalAllotedInvoiceId=(cursor.getString(0))+(Integer.parseInt(cursor.getString(1)));
             }
         }
         if(cursor!=null) {
             cursor.close();
         }
         close();
         return VanFinalAllotedInvoiceId;
     }*/
   /*public void updateFinalAllotedInvoiceIdstblInvoiceCaption()
    {
        int FinalAllotedInvoiceIds=fnGettblInvoiceAllotmentId();
        //open();
///tblInvoiceCaption(INVPrefix text null,VanIntialInvoiceIds int null,FinalAllotedInvoiceIds int null);";
        db.execSQL("Update tblInvoiceCaption Set  VanIntialInvoiceIds="+(FinalAllotedInvoiceIds+1));
      //  db.execSQL("Update tblInvoiceCaption Set  VanIntialInvoiceIds="+(FinalAllotedInvoiceIds+1));

        close();
    }*/
    public int fnGettblInvoiceAllotmentId() {

        int VanInvoiceIds = 0;
        Cursor cursor = null;
        try {
            cursor = db.rawQuery("Select VanIntialInvoiceIds from tblInvoiceCaption", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    VanInvoiceIds = Integer.parseInt(cursor.getString(0));
                }
            }
        } catch (Exception ex) {

        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }

        return VanInvoiceIds;
    }

    /* public String fnGetFinalAllotedInvoiceIdsAgainstInvoiceTable(String StoreID)
      {
          //open();
          String VanFinalAllotedInvoiceId="NA";
          Cursor cursor=db.rawQuery("Select INVPrefix,VanIntialInvoiceIds from tblInvoiceCaption",null);

          if(cursor.getCount()>0)
          {
              if(cursor.moveToFirst())
              {
                  VanFinalAllotedInvoiceId=(cursor.getString(0))+(Integer.parseInt(cursor.getString(1)));
              }
          }
          if(cursor!=null) {
              cursor.close();
          }
          close();
          return VanFinalAllotedInvoiceId;
      }*/
    public int fnGetStoreCurrentOutsStat(String StoreID) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT Sstat FROM  tblStoreList where StoreID='" + StoreID + "'", null);
        int StoreCurrentOutsStat = 0;

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {


                    StoreCurrentOutsStat = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return StoreCurrentOutsStat;
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }

    }

    public String fnGetStoreVisitCode(String StoreID) {
        //open();
        String StoreVisitCode = "NA";
        Cursor cursor = db.rawQuery("Select StoreVisitCode from tblStoreVisitMstr Where StoreID='" + StoreID + "'", null);

        if (cursor!=null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                StoreVisitCode = cursor.getString(0);
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        //close();
        return StoreVisitCode;
    }



    public String fnGetStoreVisitCodeForAlert(String StoreID) {
        //open();
        String StoreVisitCode = "NA";
        Cursor cursor = db.rawQuery("Select StoreVisitCode from tblStoreVisitMstr Where StoreID='" + StoreID + "' AND Sstat=1", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                StoreVisitCode = cursor.getString(0);
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        //close();
        return StoreVisitCode;
    }
    public void fnInsertOrUpdate_tblStoreVisitMstr(String StoreVisitCode, String StoreID, int Sstat, String ForDate, String ActualLatitude, String ActualLongitude,
                                                   String VisitTimeOutSideStore, String VisitTimeInSideStore, String VisitTimeCheckStore, String VisitEndTS,
                                                   String LocProvider, String Accuracy, String BateryLeftStatus, int StoreClose, int StoreNextDay, int ISNewStore,
                                                   int IsNewStoreDataCompleteSaved, int flgFromWhereSubmitStatus, int flgSubmitFromQuotation, int flgLocationServicesOnOff,
                                                   int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgStoreOrder,
                                                   int flgRetailerCreditBalnce, int VisitTypeStatus, int flgVisitCollectionMarkedStatus, String MapAddress, String MapCity,
                                                   String MapPinCode, String MapState, String routeId, String routetype, String imei, int flgOrderType, int inRange, int isLocationRadioChecked,int flgIncomingOrCall) {

        //open();
        int flgVisitType = 0;
        if (flgOrderType == 1) {
            flgVisitType = 0;
        } else {
            flgVisitType = 1;
        }
        try {
            Cursor cursor = db.rawQuery("SELECT StoreVisitCode FROM tblStoreVisitMstr where StoreVisitCode='" + StoreVisitCode + "' AND StoreID='" + StoreID + "'", null);// AND Sstat=1
            ContentValues initialValues = new ContentValues();
            initialValues.put("PDACode", imei);
            initialValues.put("Sstat", Sstat);

            initialValues.put("VisitEndTS", VisitEndTS);
            initialValues.put("flgFromWhereSubmitStatus", flgFromWhereSubmitStatus);
            initialValues.put("flgVisitType", flgVisitType);
            initialValues.put("flgIncomingOrCall", flgIncomingOrCall);
            // initialValues.put("flgOrderType", flgOrderType);
            //flgOrderType
            //flgFromWhereSubmitStatus
            if (cursor.getCount() > 0) {
                int affected = db.update(DBHelper.DATABASE_TABLE_STOREVISIT, initialValues, "StoreID=? AND StoreVisitCode=?", new String[]{StoreID, StoreVisitCode});
            } else {
                initialValues.put("BateryLeftStatus", BateryLeftStatus);
                initialValues.put("IsNewStoreDataCompleteSaved", 0);
                initialValues.put("StoreVisitCode", StoreVisitCode);
                initialValues.put("StoreID", StoreID);
                initialValues.put("ForDate", ForDate);
                initialValues.put("ActualLatitude", ActualLatitude);
                initialValues.put("ActualLongitude", ActualLongitude);
                initialValues.put("VisitTimeOutSideStore", VisitTimeOutSideStore);
                initialValues.put("VisitTimeInSideStore", VisitTimeInSideStore);
                initialValues.put("VisitTimeCheckStore", VisitTimeCheckStore);//01-JAN-1900
                initialValues.put("LocProvider", LocProvider);
                initialValues.put("Accuracy", Accuracy);
                initialValues.put("StoreClose", StoreClose);
                initialValues.put("StoreNextDay", StoreNextDay);
                initialValues.put("ISNewStore", ISNewStore);
                initialValues.put("isVisitInRange", inRange);
                initialValues.put("isLocationRadioChecked", isLocationRadioChecked);
                // initialValues.put("IsNewStoreDataCompleteSaved", IsNewStoreDataCompleteSaved);
                initialValues.put("flgSubmitFromQuotation", flgSubmitFromQuotation);
                initialValues.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
                initialValues.put("flgGPSOnOff", flgGPSOnOff);
                initialValues.put("flgNetworkOnOff", flgNetworkOnOff);
                initialValues.put("flgFusedOnOff", flgFusedOnOff);
                initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
                initialValues.put("flgStoreOrder", flgStoreOrder);
                initialValues.put("flgRetailerCreditBalnce", flgRetailerCreditBalnce);
                initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
                initialValues.put("VisitTypeStatus", VisitTypeStatus);
                initialValues.put("flgVisitCollectionMarkedStatus", flgVisitCollectionMarkedStatus);
                initialValues.put("SelfCreditNote", 0.0);
                initialValues.put("MapAddress", MapAddress);
                initialValues.put("MapCity", MapCity);
                initialValues.put("MapState", MapState);
                initialValues.put("MapPinCode", MapPinCode);
                initialValues.put("RouteNodeID", routeId);
                initialValues.put("RouteNodeType", routetype);
                initialValues.put("CloseCallID", 0);
                initialValues.put("closeCallComment", "NA");
                initialValues.put("OrderComments", "NA");
                initialValues.put("flgIsPicsAllowed", 1);
                initialValues.put("NoPicsReason", "NA");


                db.insert(DBHelper.DATABASE_TABLE_STOREVISIT, null, initialValues);
            }
        } finally {
            // close();
        }
    }


    public LinkedHashMap<String, String> fngetStoreBasicDetails(String StoreID) {
        LinkedHashMap<String, String> hmapStoreBasicDetails = new LinkedHashMap<String, String>();//=null;
        Cursor cur = null;
        //open();
        try {
            cur = db.rawQuery("Select ifnull(StoreName,'NA'),ifnull(OwnerName,'NA'),ifnull(StoreContactNo,'NA'),ifnull(StoreAddress,'NA'),ifnull(StoreCatType,'NA'),ifnull(SalesPersonName,'NA'),ifnull(SalesPersonContact,'NA') from tblStoreList where StoreID = '" + StoreID + "'", null);//
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                    hmapStoreBasicDetails.put("StoreName", cur.getString(0));
                    hmapStoreBasicDetails.put("OwnerName", cur.getString(1));
                    hmapStoreBasicDetails.put("StoreContactNo", cur.getString(2));
                    hmapStoreBasicDetails.put("StoreAddress", cur.getString(3));
                    hmapStoreBasicDetails.put("StoreCatType", cur.getString(4));
                    hmapStoreBasicDetails.put("SalesPersonName", cur.getString(5));
                    hmapStoreBasicDetails.put("SalesPersonContact", cur.getString(6));

                }

            }

        } catch (Exception ex) {
            hmapStoreBasicDetails.put("StoreName", "NA");
            hmapStoreBasicDetails.put("OwnerName", "NA");
            hmapStoreBasicDetails.put("StoreContactNo", "NA");
            hmapStoreBasicDetails.put("StoreAddress", "NA");
            hmapStoreBasicDetails.put("StoreCatType", "NA");
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
        }
        return hmapStoreBasicDetails;
    }

    public String fnGetInvoiceCodePDA(String StoreID, String StoreVisitCode) {


        int flginvoiceAnyInPErmanentTable = fnCheckForNewInvoiceOrPreviousValueFromPermanentTable(StoreID, StoreVisitCode);
        Cursor cursorE2 = null;
        String InvoiceCodePDA = "0";
        if (CommonInfo.flgDrctslsIndrctSls == 2) {
            if (flginvoiceAnyInPErmanentTable == 0) {
                cursorE2 = db.rawQuery("SELECT TmpInvoiceCodePDA FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "' AND Sstat=1", null);
            } else {
                cursorE2 = db.rawQuery("SELECT TmpInvoiceCodePDA FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "'", null);
            }
        } else {
            cursorE2 = db.rawQuery("SELECT TmpInvoiceCodePDA FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "' AND Sstat=1", null);
        }

        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    InvoiceCodePDA = cursorE2.getString(0).toString();
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        //open();
      /*  Cursor cursorE2 = db.rawQuery("SELECT TmpInvoiceCodePDA FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='"+StoreVisitCode+"' AND Sstat=1", null);
        String InvoiceCodePDA = "0";
        try {
            if(cursorE2.getCount()>0)
            {
                if (cursorE2.moveToFirst()) {
                    InvoiceCodePDA = cursorE2.getString(0).toString();
                }
            }
        } finally {
            if(cursorE2!=null) {
                cursorE2.close();
            }
           // close();
        }
        return InvoiceCodePDA;*/
        return InvoiceCodePDA;
    }


    // function given by Abhianv Sir Start

    public long saveStoreTempInvoice(String StoreVisitCode, String TmpInvoiceCodePDA, String storeID, String pickerDate, Double TBtaxDis, Double TAmt, Double Dis, Double INval,
                                     int Ftotal, Double InvAfterDis, Double AddDis, int NoOfCouponValue, Double TotalCoupunAmount, String pickerDateWithTime, int flgTransType,
                                     int flgWholeSellApplicable, int flgRuleTaxVal, int Outstat, int flgTransferStatus, String routeID, String routetype, String TeleCallingID)// , Double CreditAmt, Double

    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("InvoiceDate", pickerDate);
        initialValues.put("TotalBeforeTaxDis", TBtaxDis);
        initialValues.put("TaxAmt", TAmt);
        initialValues.put("TotalDis", Dis);
        initialValues.put("InvoiceVal", INval);
        initialValues.put("FreeTotal", Ftotal);
        initialValues.put("InvAfterDis", InvAfterDis);
        initialValues.put("AddDis", AddDis);
        initialValues.put("NoCoupon", NoOfCouponValue);
        initialValues.put("TotalCoupunAmount", TotalCoupunAmount);
        initialValues.put("TransDate", pickerDateWithTime);
        initialValues.put("FlgInvoiceType", flgTransType);
        initialValues.put("flgWholeSellApplicable", flgWholeSellApplicable);
        initialValues.put("flgTransferStatus", flgTransferStatus);
        initialValues.put("RouteNodeID", routeID);
        initialValues.put("RouteNodetype", routetype);
        initialValues.put("TeleCallingID", TeleCallingID);
        //  initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        //flgTransferStatus
        initialValues.put("Sstat", Outstat);

        return db.insert(DBHelper.DATABASE_TABLE_MAIN32, null, initialValues);
    }

    public long fnsaveStoreFinalInvoiceSummaryEntry(String StoreVisitCode, String TmpInvoiceCodePDA, String storeID, String pickerDate, Double TBtaxDis, Double TAmt, Double Dis, Double INval,
                                                    int Ftotal, Double InvAfterDis, Double AddDis, int NoOfCouponValue, Double TotalCoupunAmount, String pickerDateWithTime, int flgTransType,
                                                    int flgWholeSellApplicable, int flgRuleTaxVal, int Outstat, String FinalInvoiceNumberGenerated, String routeID, String routetype)// , Double CreditAmt, Double

    {
        int CycleID = fetchtblVanCycleIdForInvoiceHeader();

        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("InvoiceDate", pickerDate);
        initialValues.put("TotalBeforeTaxDis", TBtaxDis);
        initialValues.put("TaxAmt", TAmt);
        initialValues.put("TotalDis", Dis);
        initialValues.put("InvoiceVal", INval);
        initialValues.put("FreeTotal", Ftotal);
        initialValues.put("InvAfterDis", InvAfterDis);
        initialValues.put("AddDis", AddDis);
        initialValues.put("NoCoupon", NoOfCouponValue);
        initialValues.put("TotalCoupunAmount", TotalCoupunAmount);
        initialValues.put("TransDate", pickerDateWithTime);
        initialValues.put("FlgInvoiceType", flgTransType);
        initialValues.put("flgWholeSellApplicable", flgWholeSellApplicable);
        //initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        initialValues.put("InvoiceNumber", FinalInvoiceNumberGenerated);

        initialValues.put("flgProcessedInvoice", 0);
        initialValues.put("CycleID", CycleID);
        initialValues.put("Sstat", Outstat);
        initialValues.put("RouteNodeID ", routeID);
        initialValues.put("RouteNodetype ", routetype);
        return db.insert(DBHelper.DATABASE_TABLE_INVOICE_HEADER, null, initialValues);


    }

    public long saveStoreFinalInvoiceDetails(String TmpInvoiceCodePDA, String storeID, String PCateId, String ProductID, Double PRate, Double TaxRate, int flgRuleTaxVal, int OrderQTY, int SelectedUOMId, Double LineValBfrTxAftrDscnt, Double LineValAftrTxAftrDscnt, int OrderFreeQty, Double OrderDisVal, int SampleQTY, String PName, Double TaxValue, String strGlobalOrderID, int flgIsQuoteRateApplied, int PriceApplyDiscountLevelType, String distID, int Outstat, String FinalInvoiceNumberGenerated) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("CatID", PCateId);
        initialValues.put("ProdID", ProductID);
        initialValues.put("ProductPrice", PRate);
        initialValues.put("TaxRate", TaxRate);
        initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        initialValues.put("OrderQty", OrderQTY);
        initialValues.put("UOMId", SelectedUOMId);

        initialValues.put("LineValBfrTxAftrDscnt", LineValBfrTxAftrDscnt);

        initialValues.put("LineValAftrTxAftrDscnt", LineValAftrTxAftrDscnt);
        initialValues.put("FreeQty", OrderFreeQty);
        initialValues.put("DisVal", OrderDisVal);
        initialValues.put("SampleQuantity", SampleQTY);
        initialValues.put("ProductShortName", PName);

        initialValues.put("TaxValue", TaxValue);
        initialValues.put("OrderIDPDA", strGlobalOrderID);
        initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
        initialValues.put("ServingDBRId", distID);
        initialValues.put("flgWholeSellApplicable", PriceApplyDiscountLevelType);
        //initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("InvoiceNumber", FinalInvoiceNumberGenerated);
        initialValues.put("Sstat", Outstat);

        return db.insert(DBHelper.DATABASE_TABLE_INVOICE_DETAILS, null, initialValues);
    }

    public String fnGetDateTimeString() {
        long syncTIMESTAMP = System.currentTimeMillis();
        Date dateobj = new Date(syncTIMESTAMP);
        SimpleDateFormat df = new SimpleDateFormat("dd-MMM-yyyy HH:mm:ss", Locale.ENGLISH);
        String StampEndsTime = TimeUtils.getNetworkDateTime(mContext, TimeUtils.DATE_TIME_FORMAT);

        return StampEndsTime;
    }

    public void UpdateStoreActualLatLongi(String StoreID,
                                          String ActualLatitude, String ActualLongitude, String Accuracy,
                                          String LocProvider, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgRestart, int flgStoreOrder, String StoreVisitCode, String VisitTimeInSideStore) {
        String GetDateTimeString = fnGetDateTimeString();
        //open();
        final ContentValues values = new ContentValues();
        values.put("ActualLatitude", ActualLatitude);
        values.put("ActualLongitude", ActualLongitude);
        values.put("Accuracy", Accuracy);
        values.put("LocProvider", LocProvider);
        /*   values.put("VisitTimeInSideStore", VisitTimeInSideStore);*/
        values.put("VisitEndTS", GetDateTimeString);
        values.put("VisitTimeCheckStore", "01-Jan-1900");
        values.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
        values.put("flgGPSOnOff", flgGPSOnOff);
        values.put("flgNetworkOnOff", flgNetworkOnOff);
        values.put("flgFusedOnOff", flgFusedOnOff);
        values.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
        // values.put("flgRestart", flgRestart);


        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?", new String[]{StoreID, StoreVisitCode});
        // close();
        Log.w(TAG, "affected records: " + affected);

        Log.w(TAG, "UpdateStoreActualLatLongi added..");
    }

    public long fnsaveStoreTempOrderEntryDetails(String TmpInvoiceCodePDA, String storeID, String PCateId, String ProductID, Double PRate, Double TaxRate, int flgRuleTaxVal, int OrderQTY, int SelectedUOMId, Double LineValBfrTxAftrDscnt, Double LineValAftrTxAftrDscnt,
                                                 int OrderFreeQty, Double OrderDisVal, int SampleQTY, String PName, Double TaxValue, String strGlobalOrderID, int flgIsQuoteRateApplied, int PriceApplyDiscountLevelType, String distID, int Outstat, int ProductExtraOrder, String OrderValue, int SuggestedQty, int OrderQTYToShow, int UOMSeleted, int flgTeleCallerProduct, int flgUserEditedProduct, int OriginalTeleCallerProductQty, String TeleCallingID,String CartonID,int flgInCarton,double DiscountPerUOM,double OverAllDiscount) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("CatID", PCateId);
        initialValues.put("ProdID", ProductID);
        initialValues.put("ProductPrice", PRate);
        initialValues.put("TaxRate", TaxRate);
        initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        initialValues.put("OrderQty", OrderQTY);
        initialValues.put("UOMId", SelectedUOMId);

        initialValues.put("LineValBfrTxAftrDscnt", LineValBfrTxAftrDscnt);

        initialValues.put("LineValAftrTxAftrDscnt", LineValAftrTxAftrDscnt);
        initialValues.put("FreeQty", OrderFreeQty);
        initialValues.put("DisVal", OrderDisVal);
        initialValues.put("SampleQuantity", SampleQTY);
        initialValues.put("ProductShortName", PName);

        initialValues.put("TaxValue", TaxValue);
        initialValues.put("OrderIDPDA", strGlobalOrderID);
        initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
        initialValues.put("ServingDBRId", distID);
        initialValues.put("flgWholeSellApplicable", PriceApplyDiscountLevelType);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("ProductExtraOrder", ProductExtraOrder);
        initialValues.put("Sstat", Outstat);
        initialValues.put("OrderVal", OrderValue);
        initialValues.put("SuggestedQty", SuggestedQty);
        initialValues.put("OrderQtyDataToShow", OrderQTYToShow);
        initialValues.put("flgPicsOrCases", UOMSeleted);
        initialValues.put("flgTeleCallerProduct", flgTeleCallerProduct);
        initialValues.put("flgUserEditedProduct", flgUserEditedProduct);
        initialValues.put("OriginalTeleCallerProductQty", OriginalTeleCallerProductQty);
        initialValues.put("CartonID", CartonID);
        initialValues.put("flgInCarton", flgInCarton);
        initialValues.put("DiscountPerUOM", DiscountPerUOM);
        initialValues.put("OverAllDiscount", OverAllDiscount);
        // initialValues.put("TeleCallingID", TeleCallingID);


        //SuggestedQty int null


        //return db.insert(DBHelper.DATABASE_TABLE_MAIN210, null, initialValues);
        return db.insert(DBHelper.DATABASE_TABLE_tblTmpInvoiceDetailsLocalOrder, null, initialValues);
    }

    public LinkedHashMap<String, Integer> fnGetFinalInvoiceQtyProductWise(int flgDrctslsIndrctSls) {
        LinkedHashMap<String, Integer> hmapFinalInvoiceQtyProductWise = new LinkedHashMap<String, Integer>();
        //open();
        Cursor cursor = null;// db.rawQuery("SELECT DISTINCT S.PrdctId,S.StockQntty-ifnull(D.OrderQty,0) AS StockAvailable  from tblVanProductStock S left outer join (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId", null);


        if (CommonInfo.hmapAppMasterFlags.containsKey("flgVanStockCalculate") && CommonInfo.hmapAppMasterFlags.get("flgVanStockCalculate") == 1) {
            cursor = db.rawQuery("SELECT DISTINCT S.PrdctId,S.StockQntty-ifnull(D.OrderQty,0) AS StockAvailable  from tblVanProductStock S left outer join (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId", null);
        } else {
            cursor = db.rawQuery("SELECT DISTINCT PrdctId, StockQntty  from tblVanProductStock", null);
        }


       /* else
        {
            cursor= db.rawQuery("SELECT DISTINCT S.PrdctId,S.StockQntty-ifnull(D.OrderQty,0) AS StockAvailable  from tblVanProductStock S left outer join (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.TmpInvoiceCodePDA=I.TmpInvoiceCodePDA  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId", null);
        }*/
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapFinalInvoiceQtyProductWise.put((String) cursor.getString(0).toString(), Integer.parseInt(cursor.getString(1)));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }

        return hmapFinalInvoiceQtyProductWise;
    }

    public void UpdateStoreVisitWiseTables(String sID, int flag2set, String StoreVisitCode, String TmpInvoiceCodePDA) {

        try {
//open();
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);


            //int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { sID });


            int affected121223 = db.update("tblStoreImageDetail", values, "StoreID=?", new String[]{sID});
            int affected1 = db.update("tblAllCollectionData", values, "StoreID=? AND StoreVisitCode=? AND TmpInvoiceCodePDA=?", new String[]{sID, StoreVisitCode, TmpInvoiceCodePDA});
            int affected2 = db.update("tblInvoiceHeader", values, "StoreID=? AND StoreVisitCode=? AND TmpInvoiceCodePDA=?", new String[]{sID, StoreVisitCode, TmpInvoiceCodePDA});
            int affected3 = db.update("tblInvoiceDetails", values, "StoreID=? AND TmpInvoiceCodePDA=?", new String[]{sID, TmpInvoiceCodePDA});

            int affected74 = db.update("tblStoreCartonDetails", values, "StoreID=? AND TmpInvoiceCodePDA=?", new String[]{sID, TmpInvoiceCodePDA});
            int affected75 = db.update("tblStoreCartonMaster", values, "StoreID=? AND TmpInvoiceCodePDA=?", new String[]{sID, TmpInvoiceCodePDA});
            int affected76 = db.update("tblStoreDSROverAllDiscountApplied", values, "StoreID=?", new String[]{sID});

            int affected4 = db.update("tblStoreVisitMstr", values, "StoreID=?", new String[]{sID});// AND StoreVisitCode=?, //, StoreVisitCode
            int affected71 = db.update("tblStoreCloseLocationDetails", values, "StoreID=? AND StoreVisitCode=?", new String[]{sID, StoreVisitCode});

            int affected72 = db.update("tblStoreClosedPhotoDetail", values, "StoreID=? AND StoreVisitCode=?", new String[]{sID, StoreVisitCode});

            int affected73 = db.update("tblStoreCloseReasonSaving", values, "StoreID=? AND StoreVisitCode=?", new String[]{sID, StoreVisitCode});
            int affected78 = db.update("tblStoreOrderVisitDayActivity", values, "StoreID=? AND StoreVisitCode=?", new String[]{sID, StoreVisitCode});
//tblStoreOrderVisitDayActivity
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
//close();
    }

    // function given by Abhianv Sir End

    public void UpdateStoreVisitMStrTable(String sID, int flag2set, String StoreVisitCode) {
        //open();
        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            int affected4 = db.update("tblStoreVisitMstr", values, "StoreID=?", new String[]{sID});// AND StoreVisitCode=?,//, StoreVisitCode


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            // close();
        }

    }

    public String fetchtblVanCycStartTime() {
        //open();
        String CycStartTime = "";
        try {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null,CycleTime text null);";
            Cursor cur = db.rawQuery("Select CycStartTime from tblCycleID", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        CycStartTime = cur.getString(0);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            // close();
            return CycStartTime;
        }
    }

    public String fetchtblStatusCycleTime() {
        //open();
        String CycStartTime = "0";
        try {
            //tblStockUploadedStatus(flgStockTrans int null,VanLoadUnLoadCycID int null,CycleTime text null,StatusID int null);";
            Cursor cur = db.rawQuery("Select CycleTime from tblStockUploadedStatus", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        CycStartTime = cur.getString(0);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            //  close();
            return CycStartTime;
        }
    }

    public String fnGetInvoiceCodePDAWhileSync(String StoreID, String StoreVisitCode) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT TmpInvoiceCodePDA FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "' AND Sstat=1", null);
        String InvoiceCodePDA = "0";
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    InvoiceCodePDA = cursorE2.getString(0).toString();
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }
        return InvoiceCodePDA;
    }

    public void UpdateStoreClose(String sID, int flag2set) {

        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);


            int affected = db.update("tblStoreList", values, "StoreID=?", new String[]{sID});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void fnInsert_tblNewAddedStoreLocationDetails(String StoreID, int Sstat, String ActualLatitude, String ActualLongitude, String VisitEndTS, String LocProvider, String Accuracy, String BateryLeftStatus, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff, int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking) {


        try {

            //// "create table tblNewAddedStoreLocationDetails(StoreID text not null, VisitEndTS text null, LocProvider text null,
            /// Accuracy text null, BateryLeftStatus text null,flgLocationServicesOnOff int null," +
            //      "flgGPSOnOff int null,flgNetworkOnOff int null,flgFusedOnOff int null,flgInternetOnOffWhileLocationTracking int null, Sstat integer not null);";

            ContentValues initialValues = new ContentValues();

            initialValues.put("StoreID", StoreID);
            initialValues.put("VisitEndTS", VisitEndTS);
            initialValues.put("LocProvider", LocProvider);
            initialValues.put("Accuracy", Accuracy);
            initialValues.put("BateryLeftStatus", BateryLeftStatus);

            initialValues.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
            initialValues.put("flgGPSOnOff", flgGPSOnOff);
            initialValues.put("flgNetworkOnOff", flgNetworkOnOff);
            initialValues.put("flgFusedOnOff", flgFusedOnOff);
            initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);

            initialValues.put("Sstat", 3);

            db.insert(DBHelper.DATABASE_TABLE_NewAddedStoreLocationDetails, null, initialValues);


        } finally {

        }

    }

    public void inserttblDayCheckIn(int confirmFlg) {

        //open();
        long syncTIMESTAMP = System.currentTimeMillis();
        Date dateobj = new Date(syncTIMESTAMP);
        SimpleDateFormat sdfPDaDate = new SimpleDateFormat("dd-MMM-yyyy", Locale.ENGLISH);
        String DateOfDayCheckIn = TimeUtils.getNetworkDateTime(mContext, TimeUtils.DATE_FORMAT);
        ContentValues values = new ContentValues();
        values.put("DateOfDayCheckIn", DateOfDayCheckIn);
        values.put("flgDayDayCheckIn", confirmFlg);
        db.insert(DBHelper.DATABASE_TABLE_DayCheckIn, null, values);

        // close();

    }

    public int fnCkechDayStart() {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblDayCheckIn", null);
        int flgCkechDayStart = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    flgCkechDayStart = 1;
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }
        return flgCkechDayStart;
    }

    public int confirmedStock() {
        int statusId = 0;
        //tblStockUploadedStatus(flgStockTrans int null,VanLoadUnLoadCycID int null,CycleTime text null,StatusID int null);";
        //open();
        try {
            Cursor cur = db.rawQuery("Select StatusID from tblStockUploadedStatus", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    statusId = cur.getInt(0);
                }

            }
        } catch (Exception excptn) {
            System.out.println("Error = " + excptn.toString());
        } finally {
            // close();
            return statusId;
        }

    }

    public int CheckStoreListPresentOrNot() {
        Cursor cursorE2 = null;
        int chkI = 0;

        try {
            //open();
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblStoreList", null);

            if (cursorE2.moveToFirst()) {
                if (Integer.parseInt(cursorE2.getString(0)) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            // close();
        }
        return chkI;
    }

    public int fnCheckForPendingImages() {
        //open();
        Cursor cursor = null;
        int check = 0;
        try {

            cursor = db.rawQuery("SELECT StoreID FROM tableImage WHERE  Sstat =5", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        check = 1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {

        } finally {
            cursor.close();
            //close();
        }
        return check;
    }

    // function by Sunil

    public ArrayList<String> getImageDetails(int sStat) {
        //open();
        ArrayList<String> listImageDetails = new ArrayList<String>();
        try {
            Cursor cursor = db.rawQuery("Select StoreID,imagePath,imageName from tableImage where Sstat='" + sStat + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        listImageDetails.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //  close();
            return listImageDetails;
        }
    }


    public ArrayList<String> getStoreCheckInImages(int sStat) {
        //open();
        ArrayList<String> listImageDetails = new ArrayList<String>();
        try {
            Cursor cursor = db.rawQuery("Select StoreID,picClkdPath,imageName from tblStoreCheckInPic where Sstat='" + sStat + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        listImageDetails.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //  close();
            return listImageDetails;
        }
    }


    public ArrayList<String> getStoreClosedImages(int sStat) {
        //open();
        ArrayList<String> listImageDetails = new ArrayList<String>();
        try {
            Cursor cursor = db.rawQuery("Select StoreID,PDAPhotoPath,PhotoName from tblStoreClosedPhotoDetail where Sstat='" + sStat + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        listImageDetails.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //  close();
            return listImageDetails;
        }
    }

    public void updateSSttImage(String imageName, int sStat) {
        //open();
        Cursor cursorImage = db.rawQuery("Select StoreID from tableImage where imageName='" + imageName + "'", null);
        if (cursorImage.getCount() > 0) {
            ContentValues value = new ContentValues();
            value.put("Sstat", sStat);
            db.update(DBHelper.TABLE_IMAGE, value, "imageName=?", new String[]{imageName});
        }

        //close();
    }

    public void updateSSttStoreCheckImageImage(String imageName, int sStat) {
        //open();
        Cursor cursorImage = db.rawQuery("Select StoreID from tblStoreCheckInPic where imageName='" + imageName + "'", null);
        if (cursorImage.getCount() > 0) {
            ContentValues value = new ContentValues();
            value.put("Sstat", sStat);
            db.update(DBHelper.DATABASE_TABLE_tblStoreCheckInPic, value, "imageName=?", new String[]{imageName});
        }

        //close();
    }

    public void fndeleteSbumittedStoreImagesOfSotre(int Sstat) {

        //open();

        db.execSQL("DELETE FROM tblStoreCheckInPic WHERE  Sstat='" + Sstat + "'");

        // close();
    }

    public void fndeleteSbumittedStoreImagesOfSotreCheckIn(int Sstat) {

        //open();

        db.execSQL("DELETE FROM tableImage WHERE  Sstat='" + Sstat + "'");

        // close();
    }

    public int fnCheckForPendingXMLFilesInTable() {
        //open();
        Cursor cursor = null;
        int check = 0;
        try {


            cursor = db.rawQuery("SELECT XmlFileName FROM tbl_XMLfiles WHERE  Sstat=3", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        check = 1;
                        cursor.moveToNext();
                    }
                }

            }


        } catch (Exception e) {

        } finally {
            cursor.close();
            // close();
        }
        return check;
    }

    public void fnUpdateProcessedInvoiceflg(String InvoiceNumber, int flag2set) {

        try {

            final ContentValues values = new ContentValues();
            values.put("flgProcessedInvoice", flag2set);


            int affected = db.update("tblInvoiceHeader", values, "InvoiceNumber=?", new String[]{InvoiceNumber});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public String[] deletFromSDcCardPhotoNewStoreValidationBasedSstat(String Sstat) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  imageName from tableImage where Sstat='" + Sstat + "'", null);
        try {
            if (cursor.getCount() > 0) {
                imageNameToBeDeleted = new String[cursor.getCount()];
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        imageNameToBeDeleted[i] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            } else {
                imageNameToBeDeleted = new String[1];
                imageNameToBeDeleted[0] = "No Data";
            }
        } finally {
            cursor.close();
            // close();
        }


        return imageNameToBeDeleted;
    }

    public int fetchtblVanCycleIdForInvoiceHeader() {

        int retVal = -1;
        Cursor cur = null;
        try {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null);";
            cur = db.rawQuery("Select CycleID from tblCycleID", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        retVal = Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
            return retVal;
        }
    }

    public int fetchtblInvoiceReviewLineCount(String sID, String TmpInvoiceCodePDA) {
        //open();
        int retVal = 0;
        Cursor cur = null;
        try {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null);";
            cur = db.rawQuery("Select DISTINCT ProdID from tblTmpInvoiceDetails Where StoreID='" + sID + "'  and flgTeleCallerProduct=0", null);
            if (cur!=null && cur.getCount() > 0) {
                        retVal = cur.getCount();
            }
        } catch (Exception e) {
            System.out.println("Error fetchtblInvoiceReviewLineCount = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
            return retVal;
        }
    }

    public int fetchtblInvoiceReviewCount(String sID, String TmpInvoiceCodePDA) {
        //open();
        int retVal = 0;
        Cursor cur = null;
        try {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null);";
            cur = db.rawQuery("Select ifnull(SUM(OrderQtyDataToShow),0) from tblTmpInvoiceDetails Where StoreID='" + sID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgTeleCallerProduct=0", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        retVal = Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error fetchtblInvoiceReviewCount = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }
            //  close();
            return retVal;
        }
    }

    public void getInvoiceNumber() {
        //tblInvoiceHeader (StoreVisitCode text not null,InvoiceNumber text not null,TmpInvoiceCodePDA text null, StoreID text not null, InvoiceDate string not null, TotalBeforeTaxDis real not null, TaxAmt real not null, TotalDis real not null, InvoiceVal real not null, FreeTotal integer not null, Sstat integer not null, InvAfterDis real not null, AddDis real not null,  NoCoupon int null, TotalCoupunAmount real null,TransDate string not null,FlgInvoiceType text not null,flgWholeSellApplicable int null,flgProcessedInvoice int not null,CycleID  int not null);";
    }

    public void UpdateStoreVisitWiseTablesAfterSync(int flag2set) {

        try {
            //open();
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);


            //int affected = db.update("tblStoreList", values, "StoreID=?",new String[] { sID });
            int affected1 = db.update("tblAllCollectionData", values, "Sstat=?", new String[]{"5"});
            int affected2 = db.update("tblInvoiceHeader", values, "Sstat=?", new String[]{"5"});
            int affected3 = db.update("tblInvoiceDetails", values, "Sstat=?", new String[]{"5"});

            int affected75 = db.update("tblStoreCartonDetails", values, "Sstat=?", new String[]{"5"});
            int affected76 = db.update("tblStoreCartonMaster", values, "Sstat=?", new String[]{"5"});
            int affected77 = db.update("tblStoreDSROverAllDiscountApplied", values, "Sstat=?", new String[]{"5"});
            int affected4 = db.update("tblStoreVisitMstr", values, "Sstat=?", new String[]{"5"});
            int affected71 = db.update("tblStoreCloseLocationDetails", values, "Sstat=?", new String[]{"5"});

            int affected72 = db.update("tblStoreClosedPhotoDetail", values, "Sstat=?", new String[]{"5"});

            int affected73 = db.update("tblStoreCloseReasonSaving", values, "Sstat=?", new String[]{"5"});
            int affected74 = db.update("tblNewAddedStoreLocationDetails", values, "Sstat=?", new String[]{"5"});

//            int affected8 = db.update("tblInvoiceDetails", values,"Sstat=?", new String[] { "5" });
//            int affected9 = db.update("tblInvoiceHeader", values,"Sstat=?", new String[] { "5" });


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
        // close();
    }

    public int checkVisitTypeStatus(String StoreID, String StoreVisitCode) {
//open();
        int check = 0;
        Cursor cursor = db.rawQuery("SELECT VisitTypeStatus FROM tblStoreVisitMstr WHERE  StoreID ='" + StoreID + "' and StoreVisitCode='" + StoreVisitCode + "'", null);

        try {


            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        check = Integer.parseInt(cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }

            }
            return check;

        } finally {
            cursor.close();
            // close();
        }

    }

    public void fnTransferDataFromTempToPermanent(String storeID, String StoreVisitCode, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls) {
        //open();
        int InvoiceNumber = 0;
        int CycleID = 0;
        int flgProcessedInvoice = 0;
        if (flgDrctslsIndrctSls == 2) {

            db.execSQL("Delete from tblInvoiceHeader Where tblInvoiceHeader.StoreID='" + storeID + "' AND StoreVisitCode='" + StoreVisitCode + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");

            db.execSQL("Delete from tblInvoiceDetails Where StoreID='" + storeID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
            flgProcessedInvoice = 2;

        }
        if (CommonInfo.flgDrctslsIndrctSls == 1) {
            InvoiceNumber = fnFetchInvoiceNumber();
            CycleID = fetchtblVanCycleIdForInvoiceHeader();
        }

        try {
            int flgTransferStatus = 1;
            fnUpdateflgTransferStatusInInvoiceHeader(storeID, StoreVisitCode, TmpInvoiceCodePDA, flgTransferStatus);
       /* db.execSQL("INSERT INTO tblInvoiceHeader(StoreVisitCode,TmpInvoiceCodePDA,StoreID,InvoiceDate,TotalBeforeTaxDis,TaxAmt,TotalDis,InvoiceVal,FreeTotal,Sstat,InvAfterDis,AddDis,NoCoupon,TotalCoupunAmount,TransDate,FlgInvoiceType,flgWholeSellApplicable,InvoiceNumber,flgProcessedInvoice,CycleID) SELECT StoreVisitCode,TmpInvoiceCodePDA,StoreID,InvoiceDate,TotalBeforeTaxDis,TaxAmt,TotalDis,InvoiceVal,FreeTotal,3,InvAfterDis,AddDis,NoCoupon,TotalCoupunAmount,TransDate,FlgInvoiceType,flgWholeSellApplicable,"+InvoiceNumber+",0,"+CycleID+" FROM tblTmpInvoiceHeader Where tblTmpInvoiceHeader.StoreVisitCode='"+StoreVisitCode+"' AND  tblTmpInvoiceHeader.TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' AND tblTmpInvoiceHeader.StoreID='"+storeID+"'");

        db.execSQL("INSERT INTO tblInvoiceDetails(InvoiceNumber,TmpInvoiceCodePDA,StoreID,CatID,ProdID,ProductPrice,TaxRate,flgRuleTaxVal,OrderQty,UOMId,LineValBfrTxAftrDscnt,LineValAftrTxAftrDscnt,FreeQty,DisVal,Sstat,SampleQuantity,ProductShortName,TaxValue,OrderIDPDA,flgIsQuoteRateApplied,ServingDBRId,flgWholeSellApplicable,ProductExtraOrder) SELECT "+InvoiceNumber+",TmpInvoiceCodePDA,StoreID,CatID,ProdID,ProductPrice,TaxRate,flgRuleTaxVal,OrderQty,UOMId,LineValBfrTxAftrDscnt,LineValAftrTxAftrDscnt,FreeQty,DisVal,3,SampleQuantity,ProductShortName,TaxValue,OrderIDPDA,flgIsQuoteRateApplied,ServingDBRId,flgWholeSellApplicable,ProductExtraOrder FROM tblTmpInvoiceDetails Where tblTmpInvoiceDetails.TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' AND tblTmpInvoiceDetails.StoreID='"+storeID+"'");
*/
            db.execSQL("INSERT INTO tblInvoiceHeader(StoreVisitCode,TmpInvoiceCodePDA,StoreID,InvoiceDate,TotalBeforeTaxDis,TaxAmt,TotalDis,InvoiceVal,FreeTotal,Sstat,InvAfterDis,AddDis,NoCoupon,TotalCoupunAmount,TransDate,FlgInvoiceType,flgWholeSellApplicable,InvoiceNumber,flgProcessedInvoice,CycleID,flgDrctslsIndrctSls,RouteNodeID,RouteNodetype,TeleCallingID) SELECT StoreVisitCode,TmpInvoiceCodePDA,StoreID,InvoiceDate,TotalBeforeTaxDis,TaxAmt,TotalDis,InvoiceVal,FreeTotal,3,InvAfterDis,AddDis,NoCoupon,TotalCoupunAmount,TransDate,FlgInvoiceType,flgWholeSellApplicable," + InvoiceNumber + "," + flgProcessedInvoice + "," + CycleID + "," + flgDrctslsIndrctSls + ",RouteNodeID,RouteNodetype,ifnull(TeleCallingID,'0') FROM tblTmpInvoiceHeader Where tblTmpInvoiceHeader.StoreVisitCode='" + StoreVisitCode + "' AND  tblTmpInvoiceHeader.TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' AND tblTmpInvoiceHeader.StoreID='" + storeID + "'");

            db.execSQL("INSERT INTO tblInvoiceDetails(InvoiceNumber,TmpInvoiceCodePDA,StoreID,CatID,ProdID,ProductPrice,TaxRate,flgRuleTaxVal,OrderQty,UOMId,LineValBfrTxAftrDscnt,LineValAftrTxAftrDscnt,FreeQty,DisVal,Sstat,SampleQuantity,ProductShortName,TaxValue,OrderIDPDA,flgIsQuoteRateApplied,ServingDBRId,flgWholeSellApplicable,ProductExtraOrder,flgDrctslsIndrctSls,OrderVal,SuggestedQty,OrderQtyDataToShow,flgTeleCallerProduct,flgUserEditedProduct,OriginalTeleCallerProductQty,CartonID,flgInCarton,DiscountPerUOM,OverAllDiscount,flgPicsOrCases) SELECT " + InvoiceNumber + ",TmpInvoiceCodePDA,StoreID,CatID,ProdID,ProductPrice,TaxRate,flgRuleTaxVal,OrderQty,UOMId,LineValBfrTxAftrDscnt,LineValAftrTxAftrDscnt,FreeQty,DisVal,3,SampleQuantity,ProductShortName,TaxValue,OrderIDPDA,flgIsQuoteRateApplied,ServingDBRId,flgWholeSellApplicable,ProductExtraOrder," + flgDrctslsIndrctSls + ",ifnull(OrderVal,0.0) AS OrderVal,SuggestedQty,OrderQtyDataToShow,flgTeleCallerProduct,flgUserEditedProduct,OriginalTeleCallerProductQty,CartonID,flgInCarton,DiscountPerUOM,OverAllDiscount,flgPicsOrCases FROM tblTmpInvoiceDetails Where tblTmpInvoiceDetails.TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' AND tblTmpInvoiceDetails.StoreID='" + storeID + "'");

            flgTransferStatus = 2;
            fnUpdateflgTransferStatusInInvoiceHeader(storeID, StoreVisitCode, TmpInvoiceCodePDA, flgTransferStatus);
            // fnUpdateInvoiceNumber(storeID,StoreVisitCode,TmpInvoiceCodePDA,InvoiceNumber);
        } catch (Exception ex) {
            System.out.println("Error While trnasfering data from temp to permanent.");
        } finally {
            //close();
        }

    }

    public static void fnUpdateflgTransferStatusInInvoiceHeader(String storeID, String StoreVisitCode, String TmpInvoiceCodePDA, int flgTransferStatus) {
        final ContentValues values = new ContentValues();
        values.put("flgTransferStatus", flgTransferStatus);
        int affected1 = db.update("tblTmpInvoiceHeader", values, "StoreID=? AND StoreVisitCode=? AND TmpInvoiceCodePDA=?", new String[]{storeID, StoreVisitCode, TmpInvoiceCodePDA});
    }

    public int fnFetchInvoiceNumber() {

        int flCheckPrevoiusInvoiceNumberIfAnyGenerated = 0;
        int InNumber = 0;
        flCheckPrevoiusInvoiceNumberIfAnyGenerated = fnCheckForPrevoiusInvoiceNumberIfAnyGenerated();
        if (flCheckPrevoiusInvoiceNumberIfAnyGenerated == 0) {
            InNumber = fnGettblInvoiceAllotmentId();
        } else {
            InNumber = fnGetMaxInvoiceNumberIfAnyGenerated();
        }
        return InNumber;
    }

    public int fnCheckForPrevoiusInvoiceNumberIfAnyGenerated() {
        int flCheckPrevoiusInvoiceNumberIfAnyGenerated = 0;
        Cursor cursor = db.rawQuery("SELECT InvoiceNumber FROM tblInvoiceHeader", null);

        try {


            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    flCheckPrevoiusInvoiceNumberIfAnyGenerated = 1;

                }

            }
            return flCheckPrevoiusInvoiceNumberIfAnyGenerated;

        } finally {
            cursor.close();

        }


    }

    public int fnGetMaxInvoiceNumberIfAnyGenerated() {
        int MaxInvoiceNumberGenerated = 0;
        Cursor cursor = db.rawQuery("SELECT Max(InvoiceNumber) FROM tblInvoiceHeader", null);

        try {


            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    MaxInvoiceNumberGenerated = Integer.parseInt(cursor.getString(0)) + 1;

                }

            }
            return MaxInvoiceNumberGenerated;

        } finally {
            cursor.close();

        }


    }

    public LinkedHashMap<String, String> fetch_InvoiceCaptionPrefixAndSuffix() {

        // //open();
        LinkedHashMap<String, String> hmapInvoiceCaptionPrefixAndSuffix = new LinkedHashMap<String, String>();


        Cursor cursor = db.rawQuery("SELECT ifnull(INVPrefix,''),ifnull(INVSuffix,'') FROM tblInvoiceCaption", null); //order by AutoIdOutlet Desc

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    hmapInvoiceCaptionPrefixAndSuffix.put("INVPrefix", cursor.getString(0));
                    hmapInvoiceCaptionPrefixAndSuffix.put("INVSuffix", cursor.getString(1));

                }
            } else {
                hmapInvoiceCaptionPrefixAndSuffix.put("INVPrefix", "");
                hmapInvoiceCaptionPrefixAndSuffix.put("INVSuffix", "");
            }

            return hmapInvoiceCaptionPrefixAndSuffix;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //   close();
        }
    }

    public ArrayList<String> getImageNameToDel(String StoreID) {
        //open();
        ArrayList<String> listImagePath = new ArrayList<String>();
        try {
//
            //tableImage(StoreID text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,ImageClicktime text null,Sstat integer null);";
            //imagButtonTag+"~"+tempId+"~"+uriSavedImage.toString()+"~"+clkdTime+"~"+"2";
            Cursor cursor = db.rawQuery("Select imageName from tableImage where StoreID='" + StoreID + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        listImagePath.add(cursor.getString(0));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //  close();
            return listImagePath;
        }
    }

    public void deleteImageDataCanceled(String storeId) {
        //tableImage(tempId text null,QstIdAnsCntrlTyp text null,imageName text null,imagePath text null,Sstat integer null);";
        //open();
        Cursor cur = db.rawQuery("Select imageName from tableImage where StoreID='" + storeId + "'", null);
        if (cur.getCount() > 0) {
            db.delete(DBHelper.TABLE_IMAGE, "StoreID=?", new String[]{storeId});
        }
        if (cur != null) {
            cur.close();
        }
        //close();
    }

    public int fnCheckflgTransferStatus(String storeID, String StoreVisitCode, String TmpInvoiceCodePDA) {
        //open();
        int flgTransferStatus = 0;
        Cursor cursor = db.rawQuery("SELECT ifnull(flgTransferStatus,0) FROM tblTmpInvoiceHeader WHERE tblTmpInvoiceHeader.StoreVisitCode='" + StoreVisitCode + "' AND  tblTmpInvoiceHeader.TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' AND tblTmpInvoiceHeader.StoreID=='" + storeID + "'", null);

        try {


            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    flgTransferStatus = Integer.parseInt(cursor.getString(0));

                }

            }


        } finally {
            if (cursor != null) {
                cursor.close();
            }
//close();
        }
        return flgTransferStatus;

    }

    public void deleteMasterTblFromParmanentInvoiceTables(String StoreID, String TmpInvoiceCodePDA) {
        //open();
        db.execSQL("DELETE FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
        db.execSQL("DELETE FROM tblInvoiceDetails WHERE StoreID='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'");
        // close();
    }

    public LinkedHashMap<String, String> getPerUnitName() {
        LinkedHashMap<String, String> hmapPerUnitName = new LinkedHashMap<>();
        //open();
        //tblProductListMaster(ProductID text  null,RptUnitName text null,PerbaseUnit text null);";
        Cursor cur = null;
        try {
            cur = db.rawQuery("Select ProductID,'('||RptUnitName ||' : '||PerbaseUnit||')' As perUnitName from tblProductListMaster", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapPerUnitName.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception excptn) {
            System.out.println("Error getPerUnitName= " + excptn.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
            return hmapPerUnitName;
        }

    }

    public LinkedHashMap<String, String> getPerBaseQty() {
        LinkedHashMap<String, String> hmapPerBaseQty = new LinkedHashMap<>();
        //open();
        //tblProductListMaster(ProductID text  null,RptUnitName text null,PerbaseUnit text null);";
        Cursor cur = null;
        try {
            cur = db.rawQuery("Select ProductID,PerbaseUnit from tblProductListMaster", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapPerBaseQty.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception excptn) {
            System.out.println("Error getPerUnitName= " + excptn.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
            return hmapPerBaseQty;
        }

    }

    public void UpdateStorWhileAdding(String sID, int flag2set) {
        //open();
        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected1 = db.update("tblStoreList", values, "StoreID=?", new String[]{sID});
            int affected2 = db.update("tblNewAddedStoreLocationDetails", values, "StoreID=?", new String[]{sID});
            int affected29 = db.update("tblStoreListForUpdateMstr", values, "StoreID=?", new String[]{sID});
            int affected3 = db.update("tblNewStoreListEntries", values, "StoreID=?", new String[]{sID});
            int affected4 = db.update("tblNewStoreSalesQuotePaymentDetails", values, "StoreId=?", new String[]{sID});
            int affected5 = db.update("tblOutletQuestAnsMstr", values, "OutletID=?", new String[]{sID});
            int affected6 = db.update("tableImage", values, "StoreID=?", new String[]{sID});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
        //close();

    }


    public void UpdateXMLCreatedFilesTablesFlag(int flag2set) {
        //open();
        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);//
            int affected1 = db.update("tblStoreList", values, "Sstat=?", new String[]{"3"});
            int affected61 = db.update("tblStoreCheckInPic", values, "Sstat=?", new String[]{"3"});
            int affected20 = db.update("tblActualVisitStock", values, "Sstat=?", new String[]{"3"});
            int affected2 = db.update("tblNewAddedStoreLocationDetails", values, "Sstat=?", new String[]{"3"});
            int affected3 = db.update("tblNewStoreListEntries", values, "Sstat=?", new String[]{"3"});
            int affected4 = db.update("tblNewStoreSalesQuotePaymentDetails", values, "Sstat=?", new String[]{"3"});
            int affected5 = db.update("tblOutletQuestAnsMstr", values, "Sstat=?", new String[]{"3"});
            int affected6 = db.update("tableImage", values, "Sstat=?", new String[]{"3"});
            int affected12 = db.update("tblStoreImageDetail", values, "Sstat=?", new String[]{"3"});


            int affected7 = db.update("tblStoreVisitMstr", values, "Sstat=?", new String[]{"3"});
            int affected8 = db.update("tblInvoiceDetails", values, "Sstat=?", new String[]{"3"});

            int affected74 = db.update("tblStoreCartonDetails", values, "Sstat=?", new String[]{"3"});
            int affected75 = db.update("tblStoreCartonMaster",  values, "Sstat=?", new String[]{"3"});
            int affected77 = db.update("tblStoreDSROverAllDiscountApplied", values, "Sstat=?", new String[]{"3"});
            int affected9 = db.update("tblInvoiceHeader", values, "Sstat=?", new String[]{"3"});
            int affected10 = db.update("tblAllCollectionData", values, "Sstat=?", new String[]{"3"});
            int affected11 = db.update("tblStoreProductPhotoDetail", values, "Sstat=?", new String[]{"3"});
            int affected1132 = db.update("tblNewStoreEntries", values, "Sstat=?", new String[]{"3"});
            int affected13 = db.update("tblNoVisitStoreDetails", values, "Sstat=?", new String[]{"3"});
            int affected14 = db.update("tblSelectedManagerDetails", values, "Sstat=?", new String[]{"3"});
            int affected15 = db.update("tblLatLongDetails", values, "Sstat=?", new String[]{"3"});
            int affected16 = db.update("tblStoreCloseLocationDetails", values, "Sstat=?", new String[]{"3"});
            int affected17 = db.update("tblStoreClosedPhotoDetail", values, "Sstat=?", new String[]{"3"});
            int affected18 = db.update("tblStoreCloseReasonSaving", values, "Sstat=?", new String[]{"3"});
            int affected19 = db.update("tblRouteChangeListDeatils", values, "Sstat=?", new String[]{"3"});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
        //  close();

    }


    public int fnGetCollectionOutSstat(String StoreID) {
        //open();
        Cursor cursorE2 = db.rawQuery("SELECT Sstat FROM  tblAllCollectionData where StoreID='" + StoreID + "'", null);
        int StoreCurrentOutsStat = 0;

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {


                    StoreCurrentOutsStat = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return StoreCurrentOutsStat;
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //  close();
        }

    }


    public String fnGetStoreCollectionCode(String StoreID) {
        //open();
        String StoreCollectionCode = "NA";
        Cursor cursor = db.rawQuery("Select CollectionCode from tblAllCollectionData Where StoreID='" + StoreID + "' AND Sstat=1", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                StoreCollectionCode = cursor.getString(0);
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        //close();
        return StoreCollectionCode;
    }


    public int checkflgVisitCollectionMarkedStatus(String StoreID, String StoreVisitCode) {
        //open();
        int check = 0;
        Cursor cursor = db.rawQuery("SELECT flgVisitCollectionMarkedStatus FROM tblStoreVisitMstr WHERE  StoreID ='" + StoreID + "' and StoreVisitCode='" + StoreVisitCode + "'", null);

        try {


            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    check = Integer.parseInt(cursor.getString(0).toString());

                }

            }
            return check;

        } finally {
            cursor.close();
            // close();
        }

    }

    public void fnUpdateflgVisitCollectionMarkedStatus(String storeID, String StoreVisitCode, String TmpInvoiceCodePDA, int flgVisitCollectionMarkedStatus) {
        // Cursor cursor = db.rawQuery("SELECT flgVisitCollectionMarkedStatus FROM tblStoreVisitMstr WHERE  StoreID ='"+ StoreID + "' and StoreVisitCode='"+StoreVisitCode+"'", null);
        //open();
        final ContentValues values = new ContentValues();
        values.put("flgVisitCollectionMarkedStatus", flgVisitCollectionMarkedStatus);
        int affected1 = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?", new String[]{storeID, StoreVisitCode});
        // close();
    }


    public String getDefaultCity() {
        //open();
        String defaultCity = "";
        Cursor cur = null;
        try {
            cur = db.rawQuery("Select City from tblStateCityMaster where CityDefault=1", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    defaultCity = cur.getString(0);
                }
            }
        } catch (SQLiteException exception) {

        } finally {
            if (cur != null) {
                cur.close();
            }
            //  close();
            return defaultCity;
        }
    }

    public LinkedHashMap<String, String> getCityAgainstState() {
        //open();
        LinkedHashMap<String, String> hmapCityAgainstState = new LinkedHashMap<String, String>();
        Cursor cur = null;
        try {
            cur = db.rawQuery("Select City,State from tblStateCityMaster", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapCityAgainstState.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }
        } catch (SQLiteException exception) {

        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
            return hmapCityAgainstState;

        }
    }

    public LinkedHashMap<String, String> fngetCityList() {

        //open();
        Cursor cur = null;
        LinkedHashMap<String, String> hmapCityList = new LinkedHashMap<String, String>();
        try {
            cur = db.rawQuery("Select CityID,City from tblStateCityMaster", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapCityList.put(cur.getString(1).trim(), cur.getString(0));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
            return hmapCityList;
        }
    }

    public LinkedHashMap<String, String> fngetDistinctState() {

        //open();
        Cursor cur = null;
        LinkedHashMap<String, String> hmapDistinctStates = new LinkedHashMap<String, String>();
        try {
            cur = db.rawQuery("Select Distinct StateID,State from tblStateCityMaster", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapDistinctStates.put(cur.getString(1), cur.getString(0));
                        cur.moveToNext();
                    }
                }

            }

        } catch (SQLiteException e) {
            // TODO: handle exception
        } finally {
            if (cur != null) {
                cur.close();
            }
            //  close();
            return hmapDistinctStates;
        }
    }


    public LinkedHashMap<String, String> fngetDistinctCityRegion() {

        //open();
        Cursor cur = null;
        LinkedHashMap<String, String> hmapDistinctStates = new LinkedHashMap<String, String>();
        try {
            cur = db.rawQuery("Select Distinct City,RegionID from tblStateCityMaster", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapDistinctStates.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (SQLiteException e) {
            // TODO: handle exception
        } finally {
            if (cur != null) {
                cur.close();
            }
            //  close();
            return hmapDistinctStates;
        }
    }

    public void updateAllDefaultCity(String cityId) {
        //open();
        try {


            db.execSQL("UPDATE tblStateCityMaster SET CityDefault=0");
            ContentValues values = new ContentValues();
            values.put("CityDefault", 1);
            db.update(DBHelper.TABLE_tblStateCityMaster, values, "CityID=?", new String[]{cityId});
        } catch (SQLiteException exception) {

        } finally {
            // close();
        }

    }

    public void deletetblStateCityMaster() {

        db.execSQL("DELETE FROM tblStateCityMaster");

    }

    public void fnsavetblStateCityMaster(List<TblStateCityMaster> tblStateCityMaster) {
//    public void fnsavetblStateCityMaster(String StateID, String State, String CityID, String City, int cityDefault) {

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_tblStateCityMaster + " (StateID, State, CityID, City, CityDefault,RegionID)" +
                    " VALUES (?,?,?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);
            for (TblStateCityMaster tbl : tblStateCityMaster) {
                stmt.bindLong(1, tbl.getStateID());
                stmt.bindString(2, tbl.getState());
                stmt.bindLong(3, tbl.getCityID());
                stmt.bindString(4, checkNullOrEmpty(tbl.getCity(), "", "NA"));
                stmt.bindLong(5, tbl.getCityDefault());
                stmt.bindLong(6, tbl.getRegionID());
                stmt.execute();
            }
            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
//        ContentValues values = new ContentValues();
//        values.put("StateID", Integer.parseInt(StateID));
//        values.put("State", State);
//        values.put("CityID", Integer.parseInt(CityID));
//        values.put("City", City);
//        values.put("CityDefault", cityDefault);
//
//        db.insert(DBHelper.TABLE_tblStateCityMaster, null, values);

    }

    public LinkedHashMap<Integer, String> fetch_Reason_List_for_option() {
        //open();
        LinkedHashMap<Integer, String> hmapCatgry = new LinkedHashMap<Integer, String>();
        Cursor cursor = db.rawQuery("SELECT ReasonId,ReasonDescr FROM tblDayStartAttendanceOptions where flgDSRApplicable='" + 1 + "' and flgNoVisitOption='" + 0 + "' and flgDelayedReason='" + 0 + "' and ReasonId<>'15' order by SeqNo asc", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapCatgry.put(Integer.parseInt(cursor.getString(0).toString()), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }

            } else {
                // hmapCatgry.put(0, "No Reason");
            }
            return hmapCatgry;
        } finally {
            cursor.close();
            // close();
        }
    }

    public LinkedHashMap<Integer, String> fetch_NoWorking_Reason_List() {
        //open();
        LinkedHashMap<Integer, String> hmapCatgry = new LinkedHashMap<Integer, String>();
        Cursor cursor = db.rawQuery("SELECT ReasonId,ReasonDescr FROM tblDayStartAttendanceOptions where flgDSRApplicable='" + 1 + "' and flgNoVisitOption=" + 1, null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    // hmapCatgry.put("Select Reason", "0");
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapCatgry.put(Integer.parseInt(cursor.getString(0).toString()), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }

            } else {
                // hmapCatgry.put(0, "No Reason");
            }
            return hmapCatgry;
        } finally {
            cursor.close();
            //close();
        }
    }

    public void fnSettblAttandanceDetails() {

        try {

            //open();
            db.execSQL("UPDATE tblAttandanceDetails SET Sstat= 4");
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            //close();
        }

    }

    public long savetblAttandanceDetails(String AttandanceTime, String PersonNodeID, String PersonNodeType, String PersonName,
                                         String OptionID, String OptionDesc, String ReasonID, String ReasonDesc,
                                         String Address,
                                         String PinCode, String City, String State, String fnLati,
                                         String fnLongi, String fnAccuracy, String flgLocNotFound, String fnAccurateProvider,
                                         String AllProvidersLocation, String fnAddress, String GpsLat, String GpsLong,
                                         String GpsAccuracy, String GpsAddress, String NetwLat, String NetwLong,
                                         String NetwAccuracy, String NetwAddress, String FusedLat, String FusedLong,
                                         String FusedAccuracy, String FusedAddress, String FusedLocationLatitudeWithFirstAttempt,
                                         String FusedLocationLongitudeWithFirstAttempt, String FusedLocationAccuracyWithFirstAttempt,
                                         int Sstat, int flgLocationServicesOnOff, int flgGPSOnOff, int flgNetworkOnOff,
                                         int flgFusedOnOff, int flgInternetOnOffWhileLocationTracking, int flgRestart
            , String CityId, String StateId, String MapAddress, String MapCity, String MapPinCode, String MapState, String fDate, String LeaveStartDate, String LeaveEndDate,String SelfieName,String SelfieURL) {
        try {
            db.execSQL("DELETE FROM tblAttandanceDetails");
        } catch (Exception e) {

        }

        ContentValues initialValues = new ContentValues();
        String aa = fnGetPersonNodeIDAndPersonNodeType();


        initialValues.put("AttandanceTime", AttandanceTime.trim());
        initialValues.put("PersonNodeID", aa.split(Pattern.quote("^"))[0].trim());
        initialValues.put("PersonNodeType", aa.split(Pattern.quote("^"))[1].trim());

        initialValues.put("OptionID", OptionID.trim());
        initialValues.put("OptionDesc", OptionDesc.trim());
        initialValues.put("ReasonID", ReasonID.trim());
        initialValues.put("ReasonDesc", ReasonDesc.trim());

        initialValues.put("Address", Address.trim());
        initialValues.put("PinCode", PinCode.trim());
        initialValues.put("City", City.trim());
        initialValues.put("State", State.trim());

        initialValues.put("fnLati", fnLati.trim());
        initialValues.put("fnLongi", fnLongi.trim());
        initialValues.put("fnAccuracy", fnAccuracy.trim());
        initialValues.put("flgLocNotFound", flgLocNotFound.trim());
        initialValues.put("fnAccurateProvider", fnAccurateProvider.trim());
        initialValues.put("AllProvidersLocation", AllProvidersLocation.trim());
        initialValues.put("fnAddress", fnAddress.trim());

        initialValues.put("GpsLat", GpsLat.trim());
        initialValues.put("GpsLong", GpsLong.trim());
        initialValues.put("GpsAccuracy", GpsAccuracy.trim());
        initialValues.put("GpsAddress", GpsAddress.trim());

        initialValues.put("NetwLat", NetwLat.trim());
        initialValues.put("NetwLong", NetwLong.trim());
        initialValues.put("NetwAccuracy", NetwAccuracy.trim());
        initialValues.put("NetwAddress", NetwAddress.trim());

        initialValues.put("FusedLat", FusedLat.trim());
        initialValues.put("FusedLong", FusedLong.trim());
        initialValues.put("FusedAccuracy", FusedAccuracy.trim());
        initialValues.put("FusedAddress", FusedAddress.trim());

        initialValues.put("FusedLocationLatitudeWithFirstAttempt", FusedLocationLatitudeWithFirstAttempt.trim());
        initialValues.put("FusedLocationLongitudeWithFirstAttempt", FusedLocationLongitudeWithFirstAttempt.trim());
        initialValues.put("FusedLocationAccuracyWithFirstAttempt", FusedLocationAccuracyWithFirstAttempt.trim());
        initialValues.put("Sstat", Sstat);

        initialValues.put("flgLocationServicesOnOff", flgLocationServicesOnOff);
        initialValues.put("flgGPSOnOff", flgGPSOnOff);
        initialValues.put("flgNetworkOnOff", flgNetworkOnOff);
        initialValues.put("flgFusedOnOff", flgFusedOnOff);
        initialValues.put("flgInternetOnOffWhileLocationTracking", flgInternetOnOffWhileLocationTracking);
        initialValues.put("flgRestart", flgRestart);

        initialValues.put("MapAddress", MapAddress);
        initialValues.put("MapCity", MapCity);
        initialValues.put("MapPinCode", MapPinCode);
        initialValues.put("MapState", MapState);
        initialValues.put("CityId", CityId);
        initialValues.put("StateId", StateId);
        initialValues.put("DistributorId", "0");
        initialValues.put("DistributorNodeType", "0");
        initialValues.put("DistributorName", "NA");
        initialValues.put("AttenDate", fDate);
        initialValues.put("LeaveStartDate", LeaveStartDate);
        initialValues.put("LeaveEndDate", LeaveEndDate);

        initialValues.put("SelfieName", SelfieName);
        initialValues.put("SelfieURL", SelfieURL);

        return db.insert(DBHelper.TABLE_tblAttandanceDetails, null, initialValues);
    }

    public void updatetblAttandanceDetails(String OptionID, String OptionDesc, String ReasonID, String ReasonDesc,
                                           String Comment, String DistributorId, String DistributorNodeType, String DistributorName, String LeaveStartDate, String LeaveEndDate,String SelfieName,String SelfieURL) {
        //open();
        try {


            ContentValues values = new ContentValues();
            values.put("OptionID", OptionID.trim());
            values.put("OptionDesc", OptionDesc.trim());
            values.put("ReasonID", ReasonID.trim());
            values.put("ReasonDesc", ReasonDesc);
            values.put("Comment", Comment);

            values.put("DistributorId", DistributorId.trim());
            values.put("DistributorNodeType", DistributorNodeType);
            values.put("DistributorName", DistributorName);
            values.put("LeaveStartDate", LeaveStartDate);
            values.put("LeaveEndDate", LeaveEndDate);
            values.put("SelfieName", SelfieName);
            values.put("SelfieURL", SelfieURL);

            db.update(DBHelper.TABLE_tblAttandanceDetails, values, "", new String[]{});
        } catch (SQLiteException exception) {

        } finally {
            //close();
        }

    }

    public String fnGetPersonNodeIDAndPersonNodeType() {
        String SONodeIdAndNodeType = "0^0";


        Cursor cursor = db.rawQuery("Select PersonNodeID,PersonNodeType from tblUserAuthenticationMstr", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                SONodeIdAndNodeType = cursor.getString(0) + "^" + cursor.getString(1);
            }
        }

        return SONodeIdAndNodeType;
    }

    public int FetchflgPersonTodaysAtt() {
        int CatId = 0;

        Cursor cursor = db.rawQuery("SELECT flgPersonTodaysAtt from tblUserAuthenticationMstr", null);
        try {

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    String abc = (String) cursor.getString(0).toString();
                    CatId = Integer.parseInt(abc);
                    cursor.moveToNext();
                }

            }
            return CatId;
        } finally {
            cursor.close();
        }

    }

    public void deleteActualVisitData(String storeID) {
        //open();
        db.execSQL("DELETE FROM tblActualVisitStock where storeID='" + storeID + "'");
        // close();
    }

    public ArrayList<ActualVisitProductInfo> getFileredProductListMapStoreCheck(String _searchString,
                                                                                int BusinessSegmentId,
                                                                                String ctgryId,
                                                                                int flgCompanyCompetitorProducts,
                                                                                String StoreID, int RegionID) {
        //tblProductList (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";
        int SectorID=fnGetSectorID();
        String searchString = "";
        LinkedHashMap<String, String> hmapFilterProductListCompanyCompetitor = new LinkedHashMap<String, String>();
        ArrayList<ActualVisitProductInfo> productInfoArrayList = new ArrayList<>();
        Cursor cur = null;
        try {
            if (_searchString.indexOf(":") != -1) {
                String[] arrsearchString = _searchString.split(Pattern.quote(","));
                for (int i = 0; i < arrsearchString.length; i++) {
                    if (i == 0) {
                        searchString = " LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    } else {
                        searchString += " AND LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    }
                }
            }

            if (_searchString.indexOf(",") != -1) {
                String[] arrsearchString = _searchString.split(Pattern.quote(","));
                for (int i = 0; i < arrsearchString.length; i++) {
                    if (i == 0) {
                        searchString = " LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    } else {
                        searchString += " AND LOWER(SearchField) LIKE '%" + arrsearchString[i].trim().toLowerCase() + "%'";
                    }
                }
            } else {
                if (ctgryId.equals("0") && TextUtils.isEmpty(_searchString)) {
                    _searchString = "All";
                    searchString = " LOWER(SearchField) LIKE '%" + _searchString.trim().toLowerCase() + "%'";
                } else {
                    searchString = " LOWER(SearchField) LIKE '%" + _searchString.trim().toLowerCase() + "%'";
                }

            }

            if(SectorID==1)
            {
                if (flgCompanyCompetitorProducts == 0) {
                    if (!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0")) {
                        cur = db.rawQuery("Select DISTINCT proList.ProductID,ProductShortName,'Pcs' AS DisplayUnit " +
                                "from tblProductListMaster as proList  inner join tblProductSegementMap " +
                                "on proList.ProductID=tblProductSegementMap.ProductID  inner join tblPrdMstrTransactionUOMConfig on  tblProductSegementMap.ProductID=tblPrdMstrTransactionUOMConfig.NodeID  " +
                                "where (" + searchString + ")   " +
                                " and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId + " " +
                                "AND proList.CategoryID='" + ctgryId +
                                "' and RegionID=" + RegionID + " and tblProductSegementMap.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID and (tblPrdMstrTransactionUOMConfig.flgStoreCheck=1 or tblPrdMstrTransactionUOMConfig.flgStoreCheck=2)   order by PrdOrdr Asc", null);
                    } else {
                        cur = db.rawQuery("Select DISTINCT proList.ProductID,ProductShortName,'Pcs' AS DisplayUnit " +
                                "from tblProductListMaster as proList  " +
                                "inner join tblProductSegementMap " +
                                "on proList.ProductID=tblProductSegementMap.ProductID   inner join tblPrdMstrTransactionUOMConfig on  tblProductSegementMap.ProductID=tblPrdMstrTransactionUOMConfig.NodeID " +
                                "where (" + searchString + ")  " +
                                " and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId +
                                "  and RegionID=" + RegionID + " and tblProductSegementMap.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID and (tblPrdMstrTransactionUOMConfig.flgStoreCheck=1 or tblPrdMstrTransactionUOMConfig.flgStoreCheck=2)    order by PrdOrdr Asc", null);
                    }
                }

                if (flgCompanyCompetitorProducts == 1) {

                    if (!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0")) {
                        cur = db.rawQuery("Select DISTINCT proList.ProductID,ProductShortName,'Pcs' AS DisplayUnit " +
                                "from tblProductListMaster as proList   " +
                                "inner join tblProductSegementMap " +
                                "on proList.ProductID=tblProductSegementMap.ProductID " +
                                "where (" + searchString + ")  " +
                                " and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId + " " +
                                "AND proList.CategoryID='" + ctgryId +
                                "'   and RegionID=" + RegionID + "  and proList.ProductID not in(Select tblProductListLastVisitStockOrOrderMstr.PrdID from tblProductListLastVisitStockOrOrderMstr Where tblProductListLastVisitStockOrOrderMstr.StoreID='" + StoreID + "') order by PrdOrdr Asc", null);
                    } else {
                        cur = db.rawQuery("Select DISTINCT proList.ProductID,ProductShortName,'Pcs' AS DisplayUnit " +
                                "from tblProductListMaster as proList   " +
                                "inner join tblProductSegementMap " +
                                "on proList.ProductID=tblProductSegementMap.ProductID " +
                                "where (" + searchString + ") " +
                                " and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId +
                                "  and RegionID=" + RegionID + "  and proList.ProductID not in(Select tblProductListLastVisitStockOrOrderMstr.PrdID from tblProductListLastVisitStockOrOrderMstr Where tblProductListLastVisitStockOrOrderMstr.StoreID='" + StoreID + "' ) order by PrdOrdr Asc", null);
                    }
                }
            }
            else
            {
                if (flgCompanyCompetitorProducts == 0) {
                    if (!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0")) {
                        cur = db.rawQuery("Select DISTINCT proList.ProductID,ProductShortName,'Pcs' AS DisplayUnit " +
                                "from tblProductListMaster as proList inner join tblProductSectorMapping on proList.ProductID= tblProductSectorMapping.PrdNodeID inner join tblProductSegementMap " +
                                "on proList.ProductID=tblProductSegementMap.ProductID  inner join tblPrdMstrTransactionUOMConfig on  tblProductSegementMap.ProductID=tblPrdMstrTransactionUOMConfig.NodeID  " +
                                "where (" + searchString + ")  and tblProductSectorMapping.SectorID="+SectorID+"" +
                                " and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId + " " +
                                "AND proList.CategoryID='" + ctgryId +
                                "' and RegionID=" + RegionID + " and tblProductSegementMap.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID and (tblPrdMstrTransactionUOMConfig.flgStoreCheck=1 or tblPrdMstrTransactionUOMConfig.flgStoreCheck=2)   order by PrdOrdr Asc", null);
                    } else {
                        cur = db.rawQuery("Select DISTINCT proList.ProductID,ProductShortName,'Pcs' AS DisplayUnit " +
                                "from tblProductListMaster as proList  inner join tblProductSectorMapping on proList.ProductID= tblProductSectorMapping.PrdNodeID " +
                                "inner join tblProductSegementMap " +
                                "on proList.ProductID=tblProductSegementMap.ProductID   inner join tblPrdMstrTransactionUOMConfig on  tblProductSegementMap.ProductID=tblPrdMstrTransactionUOMConfig.NodeID " +
                                "where (" + searchString + ")  and tblProductSectorMapping.SectorID="+SectorID+""+
                                " and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId +
                                "  and RegionID=" + RegionID + " and tblProductSegementMap.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID and (tblPrdMstrTransactionUOMConfig.flgStoreCheck=1 or tblPrdMstrTransactionUOMConfig.flgStoreCheck=2)    order by PrdOrdr Asc", null);
                    }
                }

                if (flgCompanyCompetitorProducts == 1) {

                    if (!TextUtils.isEmpty(ctgryId) && !ctgryId.equals("0")) {
                        cur = db.rawQuery("Select DISTINCT proList.ProductID,ProductShortName,'Pcs' AS DisplayUnit " +
                                "from tblProductListMaster as proList  inner join tblProductSectorMapping on proList.ProductID= tblProductSectorMapping.PrdNodeID " +
                                "inner join tblProductSegementMap " +
                                "on proList.ProductID=tblProductSegementMap.ProductID " +
                                "where (" + searchString + ")  and tblProductSectorMapping.SectorID="+SectorID+"" +
                                " and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId + " " +
                                "AND proList.CategoryID='" + ctgryId +
                                "'   and RegionID=" + RegionID + "  and proList.ProductID not in(Select tblProductListLastVisitStockOrOrderMstr.PrdID from tblProductListLastVisitStockOrOrderMstr Where tblProductListLastVisitStockOrOrderMstr.StoreID='" + StoreID + "') order by PrdOrdr Asc", null);
                    } else {
                        cur = db.rawQuery("Select DISTINCT proList.ProductID,ProductShortName,'Pcs' AS DisplayUnit " +
                                "from tblProductListMaster as proList  inner join tblProductSectorMapping on proList.ProductID=tblProductSectorMapping.PrdNodeID " +
                                "inner join tblProductSegementMap " +
                                "on proList.ProductID=tblProductSegementMap.ProductID " +
                                "where (" + searchString + ") and tblProductSectorMapping.SectorID="+SectorID+"" +
                                " and tblProductSegementMap.BusinessSegmentId=" + BusinessSegmentId +" "+
                                "  and RegionID=" + RegionID + "  and proList.ProductID not in(Select tblProductListLastVisitStockOrOrderMstr.PrdID from tblProductListLastVisitStockOrOrderMstr Where tblProductListLastVisitStockOrOrderMstr.StoreID='" + StoreID + "' ) order by PrdOrdr Asc", null);
                    }
                }
            }
         

            if (cur!=null && cur.getCount() > 0) {
                ActualVisitProductInfo visitProductInfo;
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        visitProductInfo = new ActualVisitProductInfo(cur.getString(1), cur.getString(0), cur.getString(2), 1);
                        visitProductInfo.setIsDefaultProduct(0);
                        visitProductInfo.setStoreId(StoreID);
                        visitProductInfo.setTblUOMMasterList(fnGetUOMAgainstProductActualVisitOnly(cur.getInt(0), cur.getString(1), RegionID));
                        productInfoArrayList.add(visitProductInfo);
                        //hmapFilterProductListCompanyCompetitor.put(cur.getString(0), cur.getString(1) + "+^" + cur.getString(2));
                        cur.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            String ecsdc=e.getMessage().toString();
            // TODO: handle exception
        } finally {
            if(cur!=null)
                cur.close();

            return productInfoArrayList;
        }
    }

    public void saveTblActualVisitStock(String storeID, String ProductID, String Stock, int sStat, int isDefaultProduct, String displayUnit, String StoreVisitCode) {
//(tblActualVisitStock (storeID text null,ProductID text null,Stock text null,Sstat integer null);";

        ContentValues initialValues = new ContentValues();
        initialValues.put("storeID", storeID);
        initialValues.put("ProductID", ProductID.trim());
        initialValues.put("Stock", Stock.trim());
        initialValues.put("Sstat", sStat);
        initialValues.put("isDefaultProduct", isDefaultProduct);
        initialValues.put("displayUnit", displayUnit);
        initialValues.put("StoreVisitCode", StoreVisitCode);


        db.insert(DBHelper.DATABASE_TABLE_tblActualVisitStock, null, initialValues);

    }

    public LinkedHashMap<String, String> fetchActualVisitData(String storeID) {
//tblActualVisitStock (ProductID text null,Stock text null);";
        LinkedHashMap<String, String> hmapData = new LinkedHashMap<>();
        Cursor cursor = null;

        try {
            //   cursor = db.rawQuery("SELECT ProductID,Sstat,Stock,isDefaultProduct,'Pcs' As displayUnit from tblActualVisitStock  where storeID='" + storeID + "'", null);
            cursor = db.rawQuery("SELECT ProductID,Stock from tblActualVisitStock  where storeID='" + storeID + "'", null);//,StockType
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        hmapData.put(cursor.getString(0), cursor.getString(1));//+ "^" + cursor.getString(2)
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if (cursor != null)
                cursor.close();
            return hmapData;
        }
    }

    public ArrayList<ActualVisitProductInfo> fetchActualVisitDataForActualVisitStock(String storeID) {
//tblActualVisitStock (ProductID text null,Stock text null);";
        Cursor cursor = null;
        ArrayList<ActualVisitProductInfo> productInfoArrayList = null;
        ActualVisitProductInfo visitProductInfo;
        try {
            cursor = db.rawQuery("SELECT ProductID,Sstat,Stock,isDefaultProduct, unitType,displayUnit from tblActualVisitStock  where storeID='" + storeID + "'", null);
            if (cursor!=null && cursor.getCount() > 0) {
                productInfoArrayList = new ArrayList<ActualVisitProductInfo>();
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        visitProductInfo = new ActualVisitProductInfo(storeID,
                                cursor.getString(0),
                                cursor.getInt(1),
                                cursor.getString(2),
                                cursor.getInt(3),
                                cursor.getString(5),
                                cursor.getInt(4));
                        productInfoArrayList.add(visitProductInfo);
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if (cursor != null)
                cursor.close();

        }
        return productInfoArrayList;
    }

    public LinkedHashMap<String, Integer> fetchProductIDIsRefrigerator() {
        LinkedHashMap<String, Integer> hmapData = new LinkedHashMap<String, Integer>();
        Cursor cursor = null;

        try {
            cursor = db.rawQuery("SELECT ProductID,IsRefrigeration from tblProductListMaster Order By PrdOrdr", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        hmapData.put(cursor.getString(0), cursor.getInt(1));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if (cursor != null)
                cursor.close();
            return hmapData;
        }
    }

    public LinkedHashMap<String, String> fetchProductDataForActualVisit() {
        LinkedHashMap<String, String> hmapData = new LinkedHashMap<>();
        Cursor cursor = null;

        try {
            cursor = db.rawQuery("SELECT ProductID,ProductShortName from tblProductListMaster Order By PrdOrdr", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        hmapData.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if (cursor != null)
                cursor.close();
            return hmapData;
        }
    }


    public LinkedHashMap<String, String> fetchProductStockFromPurchaseTable(String storeID) {
//tblActualVisitStock (ProductID text null,Stock text null);";
        LinkedHashMap<String, String> hmapData = new LinkedHashMap<>();
        Cursor cursor = null;

        try {
            cursor = db.rawQuery("SELECT ProdID,Stock from tblTmpInvoiceDetails  where StoreID='" + storeID + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        hmapData.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if (cursor != null)
                cursor.close();
            return hmapData;
        }
    }

    public ArrayList<ActualVisitProductInfo> fetchProductListLastvisitAndOrderBasis(String StoreID, int RegionID) {
//tblActualVisitStock (ProductID text null,Stock text null);";
        LinkedHashMap<String, String> hmapData = new LinkedHashMap<>();
        Cursor cursor = null;
        ActualVisitProductInfo visitProductInfo;
        int SectorID=fnGetSectorID();
        ArrayList<ActualVisitProductInfo> productInfoArrayList = new ArrayList<>();
        try {
            if(SectorID==1)
            {
                cursor = db.rawQuery("SELECT  Distinct " +
                        "tblProductListLastVisitStockOrOrderMstr.PrdID,tblProductListMaster.ProductShortName,'Pcs' AS DisplayUnit " +
                        "from tblProductListLastVisitStockOrOrderMstr " +
                        "inner join tblProductListMaster on tblProductListLastVisitStockOrOrderMstr.PrdID=tblProductListMaster.ProductID   inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID   inner join tblPrdMstrTransactionUOMConfig on  tblProductSegementMap.ProductID=tblPrdMstrTransactionUOMConfig.NodeID " +
                        "where   tblProductListLastVisitStockOrOrderMstr.StoreID='" + StoreID + "' and tblProductSegementMap.RegionID=" + RegionID + " and tblProductSegementMap.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID and (tblPrdMstrTransactionUOMConfig.flgStoreCheck=1 or tblPrdMstrTransactionUOMConfig.flgStoreCheck=2)", null);

            }
            else
            {
                cursor = db.rawQuery("SELECT  Distinct " +
                        "tblProductListLastVisitStockOrOrderMstr.PrdID,tblProductListMaster.ProductShortName,'Pcs' AS DisplayUnit " +
                        "from tblProductListLastVisitStockOrOrderMstr " +
                        "inner join tblProductListMaster on tblProductListLastVisitStockOrOrderMstr.PrdID=tblProductListMaster.ProductID inner join tblProductSectorMapping on tblProductListMaster.ProductID= tblProductSectorMapping.PrdNodeID  inner join tblProductSegementMap on tblProductListMaster.ProductID=tblProductSegementMap.ProductID   inner join tblPrdMstrTransactionUOMConfig on  tblProductSegementMap.ProductID=tblPrdMstrTransactionUOMConfig.NodeID " +
                        "where  tblProductSectorMapping.SectorID="+SectorID+" and tblProductListLastVisitStockOrOrderMstr.StoreID='" + StoreID + "' and tblProductSegementMap.RegionID=" + RegionID + " and tblProductSegementMap.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID and (tblPrdMstrTransactionUOMConfig.flgStoreCheck=1 or tblPrdMstrTransactionUOMConfig.flgStoreCheck=2)", null);

            }
           
            if (cursor!=null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        visitProductInfo = new ActualVisitProductInfo(cursor.getString(1),
                                cursor.getString(0),
                                cursor.getString(2), 1);
                        visitProductInfo.setIsDefaultProduct(1);
                        visitProductInfo.setStoreId(StoreID);
                        visitProductInfo.setTblUOMMasterList(fnGetUOMAgainstProductActualVisit(cursor.getInt(0), cursor.getString(1), RegionID));
                        productInfoArrayList.add(visitProductInfo);
                        //hmapData.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println(e);
        } finally {
            if (cursor != null) {
                cursor.close();
            }

            return productInfoArrayList;
        }
    }


/*
    public LinkedHashMap<String,String>   fetchProductListLastvisitAndOrderBasis(String StoreID){
//tblActualVisitStock (ProductID text null,Stock text null);";
        LinkedHashMap<String,String> hmapData=new LinkedHashMap<>();
        Cursor cursor=null;
        //open();
        try {
            cursor = db.rawQuery("SELECT  Distinct tblProductListLastVisitStockOrOrderMstr.PrdID,tblProductListMaster.ProductShortName from tblProductListLastVisitStockOrOrderMstr inner join tblProductListMaster on tblProductListLastVisitStockOrOrderMstr.PrdID=tblProductListMaster.ProductID   where tblProductListLastVisitStockOrOrderMstr.StoreID='"+StoreID+"'", null);
            if(cursor.getCount()>0)
            {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++)
                    {

                        hmapData.put(cursor.getString(0),cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
        }
        catch (Exception e){
            System.out.println(e);
        }finally {
            if(cursor !=null){
                cursor.close();
            }

            //close();
            return hmapData;
        }
    }
*/

    public void deletetblProductListLastVisitStockOrOrderMstr() {
        db.execSQL("DELETE FROM tblProductListLastVisitStockOrOrderMstr");

    }


    public String fnGetLastStockDate(String ssStoreID) {
        String lstStockDate = "";
        //open();
        Cursor cursor = db.rawQuery("SELECT Date123 FROM tblPDAGetLastVisitDetails where StoreID= '" + ssStoreID + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {

                        lstStockDate = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            }
            return lstStockDate;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }

    }

    public HashMap<String, String> fnGetLastStockByDMS_Or_SFA(String ssStoreID) {
        HashMap<String, String> hmapProductIdLastStock = new HashMap<String, String>();
        //open();
        Cursor cursor = db.rawQuery("SELECT ProductID,Stock FROM tblPDAGetLastVisitDetails where StoreID= '" + ssStoreID + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {

                        hmapProductIdLastStock.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapProductIdLastStock;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }

    }


    // store list page methods
    public int fnGetExistingOutletIDFromOutletMstr(String ODescr) {
        int existOutID = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT Count(StoreID)  from tblPreAddedStores where StoreName like '" + ODescr + "%'", null);
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (cursor.getInt(0) > 0) {
                        existOutID = 1;
                    }

                }
            }
            return existOutID;
        } finally {
            cursor.close();
            // close();
        }
    }

    public LinkedHashMap<String, String> fnGeStoreListSM(int DistanceRange) {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();

        try {

            // Cursor cursor = db.rawQuery("SELECT OutletID,OutletDescr,BeatName,RetailerNo,ifnull(OutletNew,0),Sstat from tblOutletMstr", null);

            // Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear,flgReMap from tblPreAddedStores WHERE (LatCode<>'0' AND LatCode<>'NA') ORDER BY DistanceNear", null);//
            Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear,flgReMap from tblPreAddedStores ORDER BY DistanceNear", null);//

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String StoreLat = "0.00";
                        String StoreLon = "0.00";
                        if (!cursor.getString(2).toString().equals("NA")) {
                            StoreLat = (String) cursor.getString(2).toString();
                            StoreLon = (String) cursor.getString(3).toString();
                        }

                        hmapQuestionMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString() + "^" + StoreLat + "^" + StoreLon + "^" + (String) cursor.getString(4).toString() + "^" + (String) cursor.getString(6).toString());

                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            // System.out.println("Error fnGettblUOMMstr= "+e.toString());
        } finally {

            // close();
            fnGeNewlyAddedStoreList(hmapQuestionMstr);
            return hmapQuestionMstr;
        }
    }

    public int fncheckCountNearByStoreExistsOrNotSM(int DistanceRange) {
        int flgCheck = 0;
        //open();

        try {

            // Cursor cursor = db.rawQuery("SELECT Count(*) from tblPreAddedStores WHERE (LatCode<>'0' AND LatCode<>'NA')    ORDER BY DistanceNear ASC", null);//
            Cursor cursor = db.rawQuery("SELECT Count(*) from tblPreAddedStores  ORDER BY DistanceNear ASC", null);//

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    if (cursor.getInt(0) > 0) {
                        flgCheck = 1;
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();
            if (flgCheck == 0) {
                flgCheck = fncheckCountNewAddedNearByStoreExistsOrNot(flgCheck);
            }
            return flgCheck;
        }
    }

    public void UpdateStoreDistanceNearSM(String OutletID, int DistanceNear) {
        try {

            final ContentValues values = new ContentValues();
            values.put("DistanceNear", DistanceNear);
            int affected = db.update("tblPreAddedStores", values, "StoreID=?", new String[]{OutletID});
        } catch (Exception e) {

        } finally {

        }

    }

    public void delete_all_storeDetailTables() {
        db.execSQL("DELETE FROM tblUserName");
        db.execSQL("DELETE FROM tblStoreCountDetails");
        db.execSQL("DELETE FROM tblPreAddedStores");
        db.execSQL("DELETE FROM tblPreAddedStoresDataDetails");
        // db.execSQL("DELETE FROM tblLocationDetails");
    }

    public long saveTblUserName(String UserName) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("UserName", UserName);

        return db.insert(DBHelper.DATABASE_TABLE_tblUserName, null, initialValues);
    }

    public long saveTblStoreCountDetails(String TotStoreAdded, String TodayStoreAdded) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("TotStoreAdded", Integer.parseInt(TotStoreAdded.toString().trim()));
        initialValues.put("TodayStoreAdded", Integer.parseInt(TodayStoreAdded.toString().trim()));

        return db.insert(DBHelper.DATABASE_TABLE_tblStoreCountDetails, null, initialValues);
    }


    public LinkedHashMap<String, String> fnCompleteRouteList() {
        LinkedHashMap<String, String> hmapRouteMstr = new LinkedHashMap<String, String>();
        //open();

        try {

            Cursor cursor = db.rawQuery("SELECT ID,Descr from tblRouteListMaster ", null);//

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        if (i == 0) {
                            hmapRouteMstr.put("All", "0");
                        }

                        hmapRouteMstr.put((String) cursor.getString(1).toString(), (String) cursor.getString(0).toString());

                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            // System.out.println("Error fnGettblUOMMstr= "+e.toString());
        } finally {

            //close();

            return hmapRouteMstr;
        }
    }

    public String getUsername() {
        String userName = "0" + "^" + "0";

        //open();
        try {
            Cursor cur = db.rawQuery("Select UserName from tblUserName", null);

            if (cur.getCount() > 0) {
                StringBuilder sBuilder = new StringBuilder();
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        userName = cur.getString(0);
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            //close();
            return userName;
        }
    }

    public LinkedHashMap<String, String> fnGeStoreListAgainstRoute(int RouteID) {
        LinkedHashMap<String, String> hmapQuestionMstr = new LinkedHashMap<String, String>();
        //open();

        try {

            Cursor cursor = db.rawQuery("SELECT StoreID,StoreName,LatCode,LongCode,DateAdded,DistanceNear,flgReMap from tblPreAddedStores where RouteID=" + RouteID, null);//

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String StoreLat = "0.00";
                        String StoreLon = "0.00";
                        if (!cursor.getString(2).toString().equals("NA")) {
                            StoreLat = (String) cursor.getString(2).toString();
                            StoreLon = (String) cursor.getString(3).toString();
                        }

                        hmapQuestionMstr.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString() + "^" + StoreLat + "^" + StoreLon + "^" + (String) cursor.getString(4).toString() + "^" + (String) cursor.getString(6).toString());

                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            // System.out.println("Error fnGettblUOMMstr= "+e.toString());
        } finally {

            // close();
            fnGeNewlyAddedStoreList(hmapQuestionMstr);
            return hmapQuestionMstr;
        }
    }

    public LinkedHashMap<String, String> fnGetHampGetLastProductExecution(String StoreID) {
        LinkedHashMap<String, String> hampGetLastProductExecution = new LinkedHashMap<String, String>();
        //open();
        Cursor cursor = db.rawQuery("SELECT tblProductListMaster.ProductID,ifnull(tblPDAGetLastVisitDetails.ExecutionQty,0) FROM tblProductListMaster left outer join tblPDAGetLastVisitDetails  WHERE tblPDAGetLastVisitDetails.StoreID ='" + StoreID + "'", null);

        try {


            if (cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hampGetLastProductExecution.put(cursor.getString(0).toString(), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hampGetLastProductExecution;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }

    }


    public ArrayList<HashMap<String, String>> getDayStartSuplierOtherData() {
        ArrayList<HashMap<String, String>> arrDiatributorOtherDetails = new ArrayList<HashMap<String, String>>();
        HashMap<String, String> hmapCurrentDistributorNodeIdType = new HashMap<String, String>();
        HashMap<String, String> hmapDistflgPerviousLocation = new HashMap<String, String>();
        HashMap<String, String> hmapDistLatLocation = new HashMap<String, String>();
        HashMap<String, String> hmapDistLongLocation = new HashMap<String, String>();
        Cursor cursor2 = null;
        //open();
        try {
            cursor2 = db.rawQuery("SELECT *  FROM tblSupplierMstrList Where flgDefault=1", null);
            String strStoreTypeNamesDetais[] = null;// new String[cursor2.getCount()];
            if (cursor2.getCount() > 0) {
                strStoreTypeNamesDetais = new String[cursor2.getCount() + 1];
                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        hmapCurrentDistributorNodeIdType.put("CurrentDistribuotrNodeIdType", cursor2.getString(0).toString() + "^" + cursor2.getString(1));
                        hmapDistflgPerviousLocation.put(cursor2.getString(0).toString() + "^" + cursor2.getString(1), cursor2.getString(5));
                        hmapDistLatLocation.put(cursor2.getString(0).toString() + "^" + cursor2.getString(1), cursor2.getString(3));
                        hmapDistLongLocation.put(cursor2.getString(0).toString() + "^" + cursor2.getString(1), cursor2.getString(4));
                        //strStoreTypeNamesDetais[i+1] = cursor2.getString(0).toString()+"^"+cursor2.getString(1)+"^"+cursor2.getString(2);
                        cursor2.moveToNext();
                    }
                }
                arrDiatributorOtherDetails.add(hmapCurrentDistributorNodeIdType);
                arrDiatributorOtherDetails.add(hmapDistflgPerviousLocation);
                arrDiatributorOtherDetails.add(hmapDistLatLocation);
                arrDiatributorOtherDetails.add(hmapDistLongLocation);
            } else {
                strStoreTypeNamesDetais = new String[1];
                strStoreTypeNamesDetais[0] = "0^0^Select Distributor";

            }
            return arrDiatributorOtherDetails;
        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }
            // close();
        }
    }

    public void UpdateStoreReturnphotoFlagSM(String StoreID, String StoreName, int flgReMap) {
        try {
            //
            final ContentValues values = new ContentValues();
            values.put("StoreName", StoreName);
            values.put("flgReMap", flgReMap);


            int affected16 = db.update("tblPreAddedStores", values, "StoreID=?", new String[]{StoreID});
        } catch (Exception ex) {

        }
    }

    public Double fnTotCollectionAmtAgainstStoreIrespectiveOfVisit(String StoreID) {
        //open();
        Double TotCollectionAmt = 0.0;
        try {

            Cursor cursor = db.rawQuery("SELECT  IFNULL(SUM(Amount),0.0) from tblAllCollectionData  where tblAllCollectionData.StoreID='" + StoreID + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    TotCollectionAmt = Double.parseDouble(cursor.getString(0).toString());
                }
            }
        } catch (Exception e) {

        } finally {
            if (cursor != null) {
                cursor.close();
                ;
            }
            //close();
            // return flag;
        }
        return TotCollectionAmt;
    }


    public Double fnTotInvoicesAmtAgainstStoreIrespectiveOfVisit(String StoreID) {
        //open();
        Double TotCollectionAmt = 0.0;
        try {

            Cursor cursor = db.rawQuery("SELECT  IFNULL(SUM(InvoiceVal),0.0) from tblInvoiceHeader where tblInvoiceHeader.StoreID = '" + StoreID + "'", null);

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    TotCollectionAmt = Double.parseDouble(cursor.getString(0).toString());
                }
            }
        } catch (Exception e) {

        } finally {
            if (cursor != null) {
                cursor.close();
                ;
            }
            //close();
            // return flag;
        }
        return TotCollectionAmt;
    }


    public Double fetch_Store_AllOustandings(String StoreID) {
//tv_GrossInvVal
        //open();
        Double TotCollectionAmt = 0.0;

        Cursor cursor = db.rawQuery("SELECT ifnull(SUM(tblInvoiceLastVisitDetails.OutstandingAmt),'0.0') from tblInvoiceLastVisitDetails WHERE tblInvoiceLastVisitDetails.StoreID='" + StoreID + "'", null); //order by AutoIdOutlet Desc
        String InvoiceLastVisitDetails[] = new String[cursor.getCount()];
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        TotCollectionAmt = Double.parseDouble(cursor.getString(0).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return TotCollectionAmt;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }
    }


    public void insertStoreCheckInPic(String storeId, LinkedHashMap<String, String> hmapPicData) {
        //open();
        db.beginTransaction();

        ContentValues value = new ContentValues();
        for (Entry<String, String> entry : hmapPicData.entrySet()) {
            value.put("StoreID", storeId);
            value.put("imageName", entry.getKey());
            value.put("picClkdPath", entry.getValue().split(Pattern.quote("^"))[0]);
            value.put("clkdDateTime", entry.getValue().split(Pattern.quote("^"))[1]);
            value.put("Sstat", 1);
            db.insert(DBHelper.DATABASE_TABLE_tblStoreCheckInPic, null, value);

        }

        db.setTransactionSuccessful();
        db.endTransaction();
        //close();
    }

    public void validateStoreCheckIn(String StoreID, String imgName) {
        //open();
        try {
            Cursor cur = db.rawQuery("Select imageName from tblStoreCheckInPic where StoreID='" + StoreID + "' and imageName='" + imgName + "'", null);

            if (cur.getCount() > 0) {
                db.delete(DBHelper.DATABASE_TABLE_tblStoreCheckInPic, "StoreID=? and imageName=?",
                        new String[]{StoreID, imgName});
            }
        } catch (SQLiteException ex) {
            System.out.println("validate pic..." + ex);
        } finally {
            // close();
        }
    }

    public ArrayList<String> getImageNameForStoreCheckIn(String StoreID) {
        //open();
        ArrayList<String> list = new ArrayList<>();
        try {

            Cursor cur = db.rawQuery("Select imageName from tblStoreCheckInPic where StoreID='" + StoreID + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        list.add(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error tblCategoryPhotoDetails = " + e.toString());
        } finally {
            // close();
            return list;
        }

    }

    public Double fnGetStoreVisitSelfCreditNote(String StoreID, String StoreVisitCode) {

        Double valSelfCreditNote = 0.0;
        //open();
        Cursor cursor2 = db.rawQuery("SELECT ifnull(SelfCreditNote,0.0) FROM tblStoreVisitMstr Where StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "'", null);
        try {
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    valSelfCreditNote = Double.parseDouble(cursor2.getString(0));
                }
            }

        } catch (Exception ex) {

        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }
            //close();
        }
        return valSelfCreditNote;
    }

    public void UpdateStoreVisitSelfCreditNote(String StoreID, String StoreVisitCode, Double SelfCreditNote) {
        //open();
        final ContentValues values = new ContentValues();
        values.put("SelfCreditNote", SelfCreditNote);
        int affected = db.update("tblStoreVisitMstr", values, "StoreID=? AND StoreVisitCode=?", new String[]{StoreID, StoreVisitCode});
        //close();
    }

    public long saveWarehouseMstrData(int NodeID, int NodeType, String Descr, String latCode,
                                      String LongCode, int flgMapped, String Address, String State, String City, String PinCode, String PhoneNo, String TaxNumber) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("NodeID", NodeID);
        initialValues.put("NodeType", NodeType);
        initialValues.put("Descr", Descr.trim());
        initialValues.put("latCode", latCode.trim());
        initialValues.put("LongCode", LongCode.trim());
        initialValues.put("flgMapped", flgMapped);   //0=Not To be mapped Again,1=Can Map Distributor
        initialValues.put("Address", Address.trim());
        initialValues.put("State", State.trim());
        initialValues.put("City", City.trim());
        initialValues.put("PinCode", PinCode.trim());
        initialValues.put("PhoneNo", PhoneNo.trim());
        initialValues.put("TaxNumber", TaxNumber.trim());

        return db.insert(DBHelper.TABLE_tblWarehouseMstr, null, initialValues);
    }

    public void Delete_tblWarehouseMstr() {
        db.execSQL("DELETE FROM tblWarehouseMstr");
    }

    public void Delete_tblAppMasterFlags() {
        db.execSQL("DELETE FROM tblAppMasterFlags");
    }

    public ArrayList<LinkedHashMap<String, ArrayList<String>>> fnFetch_InvoiceReportForPrint(String VisitCode, String StoreID, int WarehouseNodeID, int WarehouseNodeType) {

        ArrayList<LinkedHashMap<String, ArrayList<String>>> arrResult = new ArrayList<LinkedHashMap<String, ArrayList<String>>>();

        //--------------Ware House Details Starts Here--------------------------------
        LinkedHashMap<String, ArrayList<String>> hmapWareHouseDetails = new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> arrWareHouseDetails = new ArrayList<String>();
        arrWareHouseDetails = fnGetWarehouseDataForPrint(VisitCode, StoreID, WarehouseNodeID, WarehouseNodeType);
        hmapWareHouseDetails.put("WarehouseDetails", arrWareHouseDetails);

        //--------------Ware House Details Ends Here--------------------------------
        //--------------Store  Details Starts Here--------------------------------

        LinkedHashMap<String, ArrayList<String>> hmapStoreBasicDetails = fnGetStoreDetailsDataForPrint(VisitCode, StoreID);

        //--------------Store Details Ends Here--------------------------------

        //--------------Store Invoice  Details Starts Here--------------------------------

        LinkedHashMap<String, ArrayList<String>> hmapInvoiceRecodsToPrint = fnGetInvoiceListForPrint(VisitCode, StoreID);

        //--------------Store Invoice Details Ends Here--------------------------------

        //--------------Store Invoice  Before Tax And After Tax Starts Here--------------------------------

        LinkedHashMap<String, ArrayList<String>> hmapTotalBfrAftrTaxVal = fnGetTotalBfrAftrTaxVal(StoreID, VisitCode);

        //--------------Store Invoice Before Tax And After Tax Ends Here--------------------------------

        //--------------Store Invoice  Tax wise Product Details Starts Here--------------------------------

        LinkedHashMap<String, ArrayList<String>> hmapTaxWisePrdctDtlt = fnGetTaxWisePrdctDtl(StoreID, VisitCode);

        //--------------Store Invoice Tax wise Product Details  Ends Here--------------------------------

        //--------------Store Invoice  Tax wise Product Details Starts Here--------------------------------

        LinkedHashMap<String, ArrayList<String>> hmapOverAllProductOrderQtyValue = fnGetOverAllProductOrderQtyValue(StoreID, VisitCode);

        //--------------Store Invoice Tax wise Product Details  Ends Here--------------------------------

        arrResult.add(hmapWareHouseDetails);
        arrResult.add(hmapStoreBasicDetails);
        arrResult.add(hmapInvoiceRecodsToPrint);
        arrResult.add(hmapTotalBfrAftrTaxVal);
        arrResult.add(hmapTaxWisePrdctDtlt);
        arrResult.add(hmapOverAllProductOrderQtyValue);
        return arrResult;
    }

    public ArrayList<String> fnGetWarehouseDataForPrint(String VisitCode, String StoreID, int WarehouseNodeID, int WarehouseNodeType) {
        ArrayList<String> arrWareHouseDetails = new ArrayList<String>();
        try {
            Cursor cursor2 = db.rawQuery("SELECT Descr,ifnull(State,'') AS State,ifnull(Address,'') AS Address,ifnull(City,'') AS City,ifnull(PinCode,'') AS PinCode,ifnull(PhoneNo,'NA') AS PhoneNo,ifnull(TaxNumber,'Not Registered') AS TaxNumber FROM tblWarehouseMstr Where NodeID=" + WarehouseNodeID + " and NodeType=" + WarehouseNodeType, null);

            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    arrWareHouseDetails.add(cursor2.getString(0));
                    arrWareHouseDetails.add(cursor2.getString(1));
                    arrWareHouseDetails.add(cursor2.getString(2));
                    arrWareHouseDetails.add(cursor2.getString(3));
                    arrWareHouseDetails.add(cursor2.getString(4));
                    arrWareHouseDetails.add(cursor2.getString(5));
                    arrWareHouseDetails.add(cursor2.getString(6));
                    int IsCompositeStatus = fnGetStoreIsCompositeStatus(StoreID);
                    if (IsCompositeStatus == 0) {
                        arrWareHouseDetails.add("No");
                    }
                    if (IsCompositeStatus == 1) {
                        arrWareHouseDetails.add("Yes");
                    }

                }
            } else {
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                arrWareHouseDetails.add("Not Available");
                int IsCompositeStatus = 0;
                if (IsCompositeStatus == 0) {
                    arrWareHouseDetails.add("No");
                }
                if (IsCompositeStatus == 1) {
                    arrWareHouseDetails.add("Yes");
                }
            }
            return arrWareHouseDetails;
        } finally {

        }
    }

    public int fnGetStoreIsCompositeStatus(String StoreID) {
        int IsCompositeStatus = 0;
        try {
            Cursor cursor2 = db.rawQuery("SELECT ifnull(IsComposite,0) AS IsComposite FROM tblStoreList Where StoreID='" + StoreID + "'", null);

            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    IsCompositeStatus = Integer.parseInt(cursor2.getString(0));
                }
            }
            return IsCompositeStatus;
        } finally {

        }
    }

    public long savetblStoreLastDeliveryNoteNumber(int LastDeliveryNoteNumber) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("LastDeliveryNoteNumber", LastDeliveryNoteNumber);
        return db.insert(DBHelper.TABLE_tblStoreLastDeliveryNoteNumber, null, initialValues);
    }

    public void fnupdatetblStoreLastDeliveryNoteNumber() {
        int valExistingDeliveryNoteNumber = 0;
        valExistingDeliveryNoteNumber = fnGettblStoreLastDeliveryNoteNumber();
        db.execSQL("UPDATE tblStoreLastDeliveryNoteNumber SET LastDeliveryNoteNumber=" + (valExistingDeliveryNoteNumber + 1) + "");
        fnWriteTextFile(valExistingDeliveryNoteNumber + 1);

    }


    public void Delete_tblStoreLastDeliveryNoteNumber() {
        db.execSQL("DELETE FROM tblStoreLastDeliveryNoteNumber");
    }

    public int fnGettblStoreLastDeliveryNoteNumber() {
        int valExistingDeliveryNoteNumber = 0;
        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT LastDeliveryNoteNumber FROM tblStoreLastDeliveryNoteNumber", null);

            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    valExistingDeliveryNoteNumber = Integer.parseInt(cursor2.getString(0));
                }
            }
            return valExistingDeliveryNoteNumber;
        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }
        }
    }


    public LinkedHashMap<String, ArrayList<String>> fnGetStoreDetailsDataForPrint(String StoreVisitCode, String StoreID) {
        LinkedHashMap<String, ArrayList<String>> hmapStoreBasicDetails = new LinkedHashMap<String, ArrayList<String>>();

        Cursor cursor2 = null;
        ArrayList<String> arrStoreDetails = new ArrayList<String>();
        try {
            cursor2 = db.rawQuery("SELECT StoreName,ifnull(StoreAddress,'') AS StoreAddress,ifnull(StoreState,'') AS StoreState,ifnull(StoreCity,'') AS StoreCity,ifnull(StorePinCode,'') AS StorePinCode,ifnull(StoreContactNo,'') AS StoreContactNo,ifnull(GSTNumber,'Not Registered') AS GSTNumber FROM tblStoreList Where StoreID='" + StoreID + "'", null);
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {

                    arrStoreDetails.add(cursor2.getString(0));
                    arrStoreDetails.add(cursor2.getString(1));
                    arrStoreDetails.add(cursor2.getString(2));
                    arrStoreDetails.add(cursor2.getString(3));
                    arrStoreDetails.add(cursor2.getString(4));
                    arrStoreDetails.add(cursor2.getString(5));
                    if (cursor2.getString(6).toString().equals("NA") || cursor2.getString(6).toString().equals("0")) {
                        arrStoreDetails.add("Not Registered");
                    } else {
                        arrStoreDetails.add(cursor2.getString(6));
                    }
                }
            }
            hmapStoreBasicDetails.put("StoreDetails", arrStoreDetails);
            return hmapStoreBasicDetails;
        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }
        }
    }

    public LinkedHashMap<String, ArrayList<String>> fnGetInvoiceListForPrint(String StoreVisitCode, String StoreID) {
        LinkedHashMap<String, ArrayList<String>> hmapInvoiceRecodsToPrint = new LinkedHashMap<String, ArrayList<String>>();

        Cursor cursor21 = null;
        try {
            cursor21 = db.rawQuery("SELECT tblInvoiceDetails.ProdID,ifnull(tblProductListMaster.HSNCode,'') AS HSNCode,ifnull(tblInvoiceDetails.ProductShortName,'NA') AS ProductShortName,ifnull(tblInvoiceDetails.ProductPrice,'0') AS ProductPrice,ifnull(tblProductSegementMap.VatTax,'0') AS VatTax,ifnull(tblInvoiceDetails.OrderQty,'0') AS OrderQty,ifnull(tblInvoiceDetails.LineValAftrTxAftrDscnt,'0') AS OrdValue FROM tblInvoiceDetails inner join tblProductSegementMap on tblInvoiceDetails.ProdID=tblProductSegementMap.ProductID inner join tblProductListMaster on tblProductListMaster.ProductID=tblInvoiceDetails.ProdID inner join tblInvoiceHeader on tblInvoiceHeader.InvoiceNumber=tblInvoiceDetails.InvoiceNumber Where tblInvoiceHeader.StoreID='" + StoreID + "' AND tblInvoiceHeader.StoreVisitCode='" + StoreVisitCode + "' AND tblInvoiceDetails.OrderQty>0", null);
            if (cursor21.getCount() > 0) {
                if (cursor21.moveToFirst()) {
                    for (int i = 0; i < cursor21.getCount(); i++) {
                        ArrayList<String> arrProductInvoiceDetailsForPrint = new ArrayList<String>();
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(1));
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(2));
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(3));
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(4) + "%");
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(5));
                        arrProductInvoiceDetailsForPrint.add(cursor21.getString(6));
                        hmapInvoiceRecodsToPrint.put(cursor21.getString(0).toString().trim(), arrProductInvoiceDetailsForPrint);
                        cursor21.moveToNext();
                    }
                }
            }

            return hmapInvoiceRecodsToPrint;
        } finally {
            if (cursor21 != null) {
                cursor21.close();
            }
        }
    }

    private static int round(double d) {
        double dAbs = Math.abs(d);
        int i = (int) dAbs;
        double result = dAbs - (double) i;
        if (result < 0.5) {
            return d < 0 ? -i : i;
        } else {
            return d < 0 ? -(i + 1) : i + 1;
        }
    }

    public LinkedHashMap<String, ArrayList<String>> fnGetTotalBfrAftrTaxVal(String StoreID, String storeVisitCode) {
        LinkedHashMap<String, ArrayList<String>> hmapTotalBfrAftrTaxVal = new LinkedHashMap<String, ArrayList<String>>();
        // ArrayList<String> arrTaxWisePrdctDtlt=new ArrayList<String>();
        Cursor cursor21 = null;
        try {
            cursor21 = db.rawQuery("Select tblInvoiceHeader.TotalBeforeTaxDis,tblInvoiceHeader.InvoiceVal from tblInvoiceHeader where tblInvoiceHeader.StoreID='" + StoreID + "' AND tblInvoiceHeader.StoreVisitCode='" + storeVisitCode + "'"
                    , null);
            if (cursor21.getCount() > 0) {
                if (cursor21.moveToFirst()) {

                    // arrTaxWisePrdctDtlt.add(cursor21.getString(0));
                    ArrayList<String> arrTaxWisePrdctDtlt = new ArrayList<String>();
                    arrTaxWisePrdctDtlt.add(cursor21.getString(0));
                    arrTaxWisePrdctDtlt.add(cursor21.getString(1));

                    Double cntInVal = Double.parseDouble(cursor21.getString(1));
                    cntInVal = Double.parseDouble(new DecimalFormat("##.##").format(cntInVal));

                    int roundAmt = round(cntInVal);
                    Double cntroundAmt = Double.parseDouble("" + roundAmt);

                    Double roundOfVal = 0.00;
                    if (cntInVal > cntroundAmt) {
                        roundOfVal = cntInVal - cntroundAmt;
                    }
                    if (cntInVal < cntroundAmt) {
                        roundOfVal = cntroundAmt - cntInVal;
                    }
                    roundOfVal = Double.parseDouble(new DecimalFormat("##.##").format(roundOfVal));
                    arrTaxWisePrdctDtlt.add("" + roundOfVal);

                    arrTaxWisePrdctDtlt.add("" + cntroundAmt);
                    hmapTotalBfrAftrTaxVal.put("TotalInvoiceBeforeAfterTax", arrTaxWisePrdctDtlt);

                }
            }

            return hmapTotalBfrAftrTaxVal;
        } finally {
            if (cursor21 != null) {
                cursor21.close();
            }
        }
    }

    public LinkedHashMap<String, ArrayList<String>> fnGetTaxWisePrdctDtl(String StoreID, String StoreVisitCode) {
        LinkedHashMap<String, ArrayList<String>> hmapTaxWisePrdctDtlt = new LinkedHashMap<String, ArrayList<String>>();
        // ArrayList<String> arrTaxWisePrdctDtlt=new ArrayList<String>();
        Cursor cursor21 = null;
        try {
            cursor21 = db.rawQuery("Select DISTINCT tblProductSegementMap.VatTax,CASE WHEN ifnull(Sum(tblInvoiceDetails.LineValAftrTxAftrDscnt-tblInvoiceDetails.LineValBfrTxAftrDscnt),'0.0')=0 THEN '0.0' ELSE ifnull(Sum(tblInvoiceDetails.LineValAftrTxAftrDscnt-tblInvoiceDetails.LineValBfrTxAftrDscnt),'0.0') END AS TaxAmtPercent from tblProductSegementMap inner join tblInvoiceDetails On tblProductSegementMap.ProductID=tblInvoiceDetails.ProdID inner join tblInvoiceHeader on tblInvoiceHeader.InvoiceNumber=tblInvoiceDetails.InvoiceNumber where tblInvoiceDetails.StoreID='" + StoreID + "' AND tblInvoiceHeader.StoreVisitCode='" + StoreVisitCode + "' AND tblInvoiceDetails.OrderQty>0 group by tblProductSegementMap.VatTax Order by tblProductSegementMap.VatTax ASC", null);
            if (cursor21.getCount() > 0) {
                if (cursor21.moveToFirst()) {
                    for (int i = 0; i < cursor21.getCount(); i++) {
                        // arrTaxWisePrdctDtlt.add(cursor21.getString(0));
                        ArrayList arrTaxWisePrdctDtlt = new ArrayList<String>();
                        Double TaxSum = Double.parseDouble(cursor21.getString(1).toString());

                        if (TaxSum > 0.0) {
                            TaxSum = TaxSum / 2.0;
                        }

                        TaxSum = Double.parseDouble(new DecimalFormat("##.##").format(TaxSum));
                        arrTaxWisePrdctDtlt.add("" + TaxSum);

                        Double TaxRateToShow = Double.parseDouble(cursor21.getString(0).toString());

                        if (TaxRateToShow > 0.0) {
                            TaxRateToShow = TaxRateToShow / 2.0;
                        }
                        TaxRateToShow = Double.parseDouble(new DecimalFormat("##.##").format(TaxRateToShow));

                        hmapTaxWisePrdctDtlt.put("CGST " + TaxRateToShow + "%", arrTaxWisePrdctDtlt);
                        hmapTaxWisePrdctDtlt.put("SGST " + TaxRateToShow + "%", arrTaxWisePrdctDtlt);
                        cursor21.moveToNext();
                    }
                }
            }

            return hmapTaxWisePrdctDtlt;
        } finally {
            if (cursor21 != null) {
                cursor21.close();
            }
        }
    }


    public Double fnCollectionDetailsToPrint(String StoreID, String StoreVisitCode) {
        Double valCollectionDetailsToPrint = 0.0;
        // ArrayList<String> arrTaxWisePrdctDtlt=new ArrayList<String>();
        Cursor cursor21 = null;
        try {

            cursor21 = db.rawQuery("Select DISTINCT ifnull(Sum(tblAllCollectionData.Amount),'0.0') As Amount from tblAllCollectionData where tblAllCollectionData.StoreID='" + StoreID + "' AND tblAllCollectionData.StoreVisitCode='" + StoreVisitCode + "'", null);
            if (cursor21.getCount() > 0) {
                if (cursor21.moveToFirst()) {
                    valCollectionDetailsToPrint = Double.parseDouble(cursor21.getString(0).toString().trim());
                    cursor21.moveToNext();
                }
            }

            return valCollectionDetailsToPrint;
        } finally {
            if (cursor21 != null) {
                cursor21.close();
            }
        }
    }

    public ArrayList<String> fnFetch_tblWarehouseMstr() {
        ArrayList<String> arrResult = new ArrayList<String>();


        //  Cursor cursor = db.rawQuery("SELECT NodeID ,NodeType from tblWarehouseMstr", null); //order by AutoIdOutlet Desc
        try {
            Cursor cursor = db.rawQuery("SELECT NodeID,NodeType from tblWarehouseMstr", null); //order by AutoIdOutlet Desc
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        arrResult.add(0, cursor.getString(0));
                        arrResult.add(1, cursor.getString(1));
                        // cursor.moveToNext();
                    }

                }
            }


        } catch (Exception e) {
            System.out.println(e);
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return arrResult;

        }
    }

    public String fnFetch_StoreGST_Number(String StoreID) {

        String gstNo = "0";


        //  Cursor cursor = db.rawQuery("SELECT NodeID ,NodeType from tblWarehouseMstr", null); //order by AutoIdOutlet Desc
        try {
            Cursor cursor = db.rawQuery("SELECT StoreID from tblStoreList", null); //order by AutoIdOutlet Desc
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        gstNo = cursor.getString(0);
                        // cursor.moveToNext();
                    }

                }
            }


        } catch (Exception e) {
            System.out.println(e);
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return gstNo;

        }
    }


    public LinkedHashMap<String, ArrayList<String>> fnGetOverAllProductOrderQtyValue(String StoreID, String StoreVisitCode) {
        LinkedHashMap<String, ArrayList<String>> hmapOverAllProductOrderQtyValue = new LinkedHashMap<String, ArrayList<String>>();
        // ArrayList<String> arrTaxWisePrdctDtlt=new ArrayList<String>();
        Cursor cursor21 = null;
        try {
            cursor21 = db.rawQuery("Select ifnull(Sum(tblInvoiceDetails.OrderQty),'0') AS OrderQtyCount,ifnull(Sum(tblInvoiceDetails.LineValAftrTxAftrDscnt),'0.00') AS LineValAftrTxAftrDscntValue from tblInvoiceDetails inner join tblInvoiceHeader on tblInvoiceDetails.InvoiceNumber=tblInvoiceHeader.InvoiceNumber where tblInvoiceDetails.StoreID='" + StoreID + "' AND tblInvoiceHeader.StoreVisitCode='" + StoreVisitCode + "' AND tblInvoiceDetails.OrderQty>0", null);
            if (cursor21.getCount() > 0) {
                if (cursor21.moveToFirst()) {
                    ArrayList arrOverAllProductOrderQtyValue = new ArrayList<String>();
                   /* Double AllProductOrderQty=Double.parseDouble(cursor21.getString(0).toString());
                    AllProductOrderQty=Double.parseDouble(new DecimalFormat("##.##").format(AllProductOrderQty));*/
                    arrOverAllProductOrderQtyValue.add(cursor21.getString(0).toString());

                    Double AllProductOrderValue = Double.parseDouble(cursor21.getString(1).toString());
                    // AllProductOrderValue=Double.parseDouble(new DecimalFormat("##.##").format(AllProductOrderValue));
                    arrOverAllProductOrderQtyValue.add("" + String.format("%.2f", AllProductOrderValue));

                    hmapOverAllProductOrderQtyValue.put("OverAllProductOrderQtyValue", arrOverAllProductOrderQtyValue);
                }
            }
            return hmapOverAllProductOrderQtyValue;
        } finally {
            if (cursor21 != null) {
                cursor21.close();
            }
        }
    }


    public String fnGetExistingInvoiceNumberAgainstInvoiceNumebr(String StoreID, String StoreVisitCode) {
        //open();
        LinkedHashMap<String, String> hmapInvoiceCaptionPrefixAndSuffix = fetch_InvoiceCaptionPrefixAndSuffix();
        Cursor cursorE2 = db.rawQuery("SELECT InvoiceNumber FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "'", null);
        String InvoiceNumber = "0";
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    InvoiceNumber = hmapInvoiceCaptionPrefixAndSuffix.get("INVPrefix") + "-" + cursorE2.getString(0).toString() + "/" + hmapInvoiceCaptionPrefixAndSuffix.get("INVSuffix");
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            // close();
        }
        return InvoiceNumber;
    }


    public LinkedHashMap<String, String> fetch_Store_Req() {

        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();
//tblVanProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null,SKUName text null,OpeningStock text null,TodaysAddedStock text null,CycleAddedStock text null,NetSalesQty text null,TodaysUnloadStk text null,CycleUnloadStk text null,CategoryID text null);";
        Cursor cursor = db.rawQuery("Select DISTINCT S.PrdctId,S.StockQntty-ifnull(D.OrderQty,0) AS StockAvailable from tblVanProductStock S left outer join (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.InvoiceNumber=I.InvoiceNumber  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID) D ON D.ProdID=S.PrdctId", null);

//Cursor cur=db.rawQuery("Select PrdctId,OriginalStock from tblVanProductStock where DistributorNodeIdNodeType='"+distId+"'",null);
        //  Cursor	cursor = db.rawQuery("SELECT Distinct ProductShortName,IFNULL(StockQntty,0),IFNULL(OriginalStock,0) from tblVanProductStock inner join tblProductListMaster on tblVanProductStock.PrdctId=tblProductListMaster.ProductID", null); //order by AutoIdOutlet Desc
//Cursor	cursor = db.rawQuery("SELECT tblStoreList.StoreID, tblStoreList.StoreName, IFNULL(tblTmpInvoiceHeader.InvoiceVal,0) FROM tblStoreList left outer join tblTmpInvoiceHeader on tblStoreList.StoreID=tblTmpInvoiceHeader.StoreID", null); //order by AutoIdOutlet Desc
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        // hmapCatgry.put((i+1)+")  "+cursor.getString(0).toString(), "[Stock Left: "+cursor.getString(2).toString()+"]");//[Stock Loaded:->"+cursor.getString(1).toString()+ "]
                        hmapCatgry.put(cursor.getString(0), cursor.getString(1));//[Stock Loaded:->"+cursor.getString(1).toString()+ "]

                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("No Stock", "0");
            }
            return hmapCatgry;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }
    }

    public LinkedHashMap<String, String> fetch_Store_Req_Prdct() {

        //open();
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();

        Cursor cursor = db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblVanProductStock  on tblVanProductStock.PrdctId=tblProductListMaster.ProductID", null);

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        // hmapCatgry.put((i+1)+")  "+cursor.getString(0).toString(), "[Stock Left: "+cursor.getString(2).toString()+"]");//[Stock Loaded:->"+cursor.getString(1).toString()+ "]
                        hmapCatgry.put(cursor.getString(0), cursor.getString(1));//[Stock Loaded:->"+cursor.getString(1).toString()+ "]

                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("No Stock", "0");
            }
            return hmapCatgry;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }
    }

    public void insertUOMMstr(List<TblUOMMaster> tblUOMMaster) {
        db.execSQL("DELETE FROM " + DBHelper.TABLE_tblUOMMstr);

        try {
            //(StoreID text null,OrderID text,VisitID integer,InvDate text,ProductID integer,OrderQty int null, NetLiveOrderVal text null,NetOrderValue text null);";
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_tblUOMMstr + " (UOMId, UOM, flgBaseUnit) VALUES (?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblUOMMaster tbl : tblUOMMaster) {
                stmt.bindLong(1, tbl.getBUOMID());
                stmt.bindString(2, checkNullOrEmpty(tbl.getBUOMName(), "", "NA"));
                stmt.bindLong(3, tbl.getFlgRetailUnit());

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }/*

        ContentValues values = new ContentValues();
        values.put("UOMId", UOMId);
        values.put("UOM", UOM);
        values.put("flgBaseUnit", flgBaseUnit);
        db.insert(DBHelper.TABLE_tblUOMMstr, null, values);*/
    }


    public void insertUOMMapping(int nodeId, int nodeType, int BaseUnitID, int PackUnitId, Double BaseValue, int flgDefaultUOM) {

        ContentValues values = new ContentValues();
        values.put("NodeId", nodeId);
        values.put("NodeType", nodeType);
        values.put("BaseUnitID", BaseUnitID);
        values.put("PackUnitId", PackUnitId);
        values.put("BaseValue", BaseValue);
        values.put("flgDefaultUOM", flgDefaultUOM);

        db.insert(DBHelper.TABLE_tblUOMMapping, null, values);
    }


    public ArrayList<LinkedHashMap<String, String>> getUOMMstrForRqstStock() {
        // open();
        ArrayList<LinkedHashMap<String, String>> listUOMMstr = new ArrayList<LinkedHashMap<String, String>>();
        LinkedHashMap<String, String> hmapUOMMstrNameId = new LinkedHashMap<String, String>();
        LinkedHashMap<String, String> hmapUOMMstrIdName = new LinkedHashMap<String, String>();
        Cursor cur = null;

        try {
            cur = db.rawQuery("Select UOM,UOMId from tblUOMMaster", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapUOMMstrNameId.put(cur.getString(0).trim(), cur.getString(1));
                        hmapUOMMstrIdName.put(cur.getString(1).trim(), cur.getString(0));
                        cur.moveToNext();
                    }
                    listUOMMstr.add(hmapUOMMstrNameId);
                    listUOMMstr.add(hmapUOMMstrIdName);
                }
            }
        } catch (Exception e) {
            System.out.println("Error = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
        }
        return listUOMMstr;
    }


    public LinkedHashMap<String, String> getBaseUOMId() {
        // open();
        LinkedHashMap<String, String> hmapbaseUomId = new LinkedHashMap<String, String>();
        Cursor cur = null;

        try {
//         cur=db.rawQuery("Select NodeId||'^'||PackUnitId As prdId_packId,BaseValue from tblUOMMapping where BaseUnitID="+baseUOMID+"  Order by NodeId",null);
            cur = db.rawQuery("Select DISTINCT NodeId,BaseUnitID  from tblUOMMapping ", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapbaseUomId.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }


                }
            }
        } catch (Exception e) {
            System.out.println("Error = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }
            //  close();
        }
        return hmapbaseUomId;
    }

    public LinkedHashMap<String, String> getBaseUOMCalcValue() {
        // open();
        LinkedHashMap<String, String> hmapUOMMstrPrdtWise = new LinkedHashMap<String, String>();
        Cursor cur = null;

        try {
            cur = db.rawQuery("Select NodeId||'^'||PackUnitId As prdId_packId,BaseValue from tblUOMMapping  Order by NodeId", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {


                    for (int i = 0; i < cur.getCount(); i++) {

                        hmapUOMMstrPrdtWise.put(cur.getString(0), cur.getString(1));

                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }

        }
        return hmapUOMMstrPrdtWise;
    }


    public LinkedHashMap<String, ArrayList<String>> getPrdctMpngWithUOM() {
        // open();
        LinkedHashMap<String, ArrayList<String>> hmapUOMMstrPrdtWise = new LinkedHashMap<String, ArrayList<String>>();
        Cursor cur = null;

        try {
            cur = db.rawQuery("Select NodeId,BaseUnitID,PackUnitId from tblUOMMapping Order by NodeId", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    ArrayList<String> listUOM = new ArrayList<String>();
                    String prdctId = "0", prvsPrdctId = "0";
                    for (int i = 0; i < cur.getCount(); i++) {
                        prdctId = cur.getString(0);
                        if (i == 0) {
                            prvsPrdctId = prdctId;
                            //listUOM.add(cur.getString(1));
                            listUOM.add(cur.getString(2));
                        } else {
                            if (prvsPrdctId.equals(prdctId)) {
                                listUOM.add(cur.getString(2));
                            } else {
                                hmapUOMMstrPrdtWise.put(prvsPrdctId, listUOM);
                                listUOM = new ArrayList<String>();
                                prvsPrdctId = prdctId;
                                // listUOM.add(cur.getString(1));
                                listUOM.add(cur.getString(2));
                            }
                        }
                        if (i == (cur.getCount() - 1)) {
                            hmapUOMMstrPrdtWise.put(prvsPrdctId, listUOM);
                        }

                        // hmapUOMMstr.put(cur.getString(0).trim(),cur.getInt(1));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }

        }
        return hmapUOMMstrPrdtWise;
    }

    public void insertStockReq(int prdctId, int reqStock, int dfltUOMId, int slctdUOMId) {


        ContentValues values = new ContentValues();
        values.put("ProductID", prdctId);
        values.put("ReqStock", reqStock);
        values.put("dfltUOMId", dfltUOMId);
        values.put("SlctdUOMID", slctdUOMId);
        db.insert(DBHelper.TABLE_tbl_StockRqst, null, values);
    }

    public void deletePrvsStkRqst() {
        db.execSQL("Delete from tblStockRqst");
    }

    public LinkedHashMap<String, String> getStockReq() {
        // open();
        LinkedHashMap<String, String> hmapStockReqData = new LinkedHashMap<String, String>();
        Cursor cur = null;

        try {
            cur = db.rawQuery("Select ProductID,ReqStock,SlctdUOMID from tblStockRqst", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapStockReqData.put(cur.getString(0).trim(), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
        }
        return hmapStockReqData;
    }


    public int fetchtblStockUploadedStatusForRqstStatus() {
        //open();
        int retVal = 0;
        try {
            Cursor cur = db.rawQuery("Select StatusID from tblStockUploadedStatus", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        retVal = Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getOtherReason = " + e.toString());
        } finally {
            //close();
            return retVal;
        }
    }

    public String fngetSalesPersonCvrgIdCvrgNdTyp() {
        String abcd = "0^0";
        Cursor cursor = null;
        try {
            //open();
            cursor = db.rawQuery("SELECT CoverageNodeId,CoverageNodeType from tblUserAuthenticationMstr", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        abcd = cursor.getString(0) + "^" + cursor.getString(1);
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
            return abcd;
        }
    }


    public LinkedHashMap<String, String> getPrdctDfltMpngWithUOM() {
        // open();
        LinkedHashMap<String, String> hmapDfltUOMMstrPrdtWise = new LinkedHashMap<String, String>();
        Cursor cur = null;

        try {
            cur = db.rawQuery("Select NodeId,PackUnitId from tblUOMMapping where flgDefaultUOM=1", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {

                        hmapDfltUOMMstrPrdtWise.put(cur.getString(0), cur.getString(1));

                        // hmapUOMMstr.put(cur.getString(0).trim(),cur.getInt(1));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }

        }
        return hmapDfltUOMMstrPrdtWise;
    }


    public ArrayList<LinkedHashMap<String, ArrayList<String>>> fnGetDayEndOverAllCollectionReport() {
        ArrayList<LinkedHashMap<String, ArrayList<String>>> arrList = new ArrayList<LinkedHashMap<String, ArrayList<String>>>();
        Double dblAllInvoiceAmount = fetch_AllInvoiceAmount();
        LinkedHashMap<String, ArrayList<String>> hmapAllInvoiceAmount = new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> arrFirstSectionDetails = new ArrayList<String>();
        arrFirstSectionDetails.add("" + dblAllInvoiceAmount);
        //hmapAllInvoiceAmount.put("AllInvValue",arrFirstSectionDetails);
        Double BalAmount = 0.0;


        Double ChequeCollectedAmountDetails = fnGetAllChequeCollectedAmountDetails();
        Double CashCollectedAmountDetails = fnGetAllCashCollectedAmountDetails();
        arrFirstSectionDetails.add("" + CashCollectedAmountDetails);
        arrFirstSectionDetails.add("" + ChequeCollectedAmountDetails);

        Double BalanceAmount = dblAllInvoiceAmount - (ChequeCollectedAmountDetails + CashCollectedAmountDetails);
        arrFirstSectionDetails.add("" + BalanceAmount);
        hmapAllInvoiceAmount.put("FirstSectionDetails", arrFirstSectionDetails);
        // Cursor cur=null;

        try {
       /*      cur=db.rawQuery("Select DISTINCT PaymentMode, ifnull(SUM(Amount)) AS CollectedAmtVal FROM tblAllCollectionData GROUP BY PaymentMode",null);
            if(cur.getCount()>0)
            {
                if(cur.moveToFirst())
                {
                    for(int i=0;i<cur.getCount()-1;i++)
                    {
                        ArrayList<String> arrAllPaymentModes=new ArrayList<String>();
                        arrAllPaymentModes.add(cur.getString(1));
                        hmapAllInvoiceAmount.put(cur.getString(0),arrAllPaymentModes);
                        cur.moveToNext();
                    }
                }
            }*/
            arrList.add(hmapAllInvoiceAmount);
            LinkedHashMap<String, ArrayList<String>> hmapAllChequeCollectedDetails = fnGetAllChequeCollectedDetails();
            arrList.add(hmapAllChequeCollectedDetails);


        } catch (Exception e) {
            System.out.println("Error = " + e.toString());
        } finally {
          /*  if(cur!=null)
            {
                cur.close();
            }*/

        }
        return arrList;
    }

    public LinkedHashMap<String, ArrayList<String>> fnGetAllChequeCollectedDetails() {
        LinkedHashMap<String, ArrayList<String>> hmapAllChequeCollectedDetails = new LinkedHashMap<String, ArrayList<String>>();
        Cursor cursor = db.rawQuery("SELECT RefNoChequeNoTrnNo,Amount,Date,tblBankMaster.BankName from tblAllCollectionData inner join tblBankMaster ON tblAllCollectionData.Bank=tblBankMaster.BankId WHERE PaymentModeID=2", null); //order by AutoIdOutlet Desc
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        ArrayList<String> arrChequeDetails = new ArrayList<String>();
                        arrChequeDetails.add(cursor.getString(1) + "^" + cursor.getString(2) + "^" + cursor.getString(3));
                        hmapAllChequeCollectedDetails.put(cursor.getString(0).toString(), arrChequeDetails);
                        cursor.moveToNext();
                    }
                }

            }
            return hmapAllChequeCollectedDetails;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public double fnGetAllChequeCollectedAmountDetails() {
        Double ChequeCollectedAmountDetails = 0.0;
        Cursor cursor = db.rawQuery("SELECT ifnull(SUM(Amount),'0.00') CheckAmount from tblAllCollectionData WHERE PaymentModeID=2", null); //order by AutoIdOutlet Desc
        try {
            if (cursor.getCount() > 0) {
                cursor.moveToFirst();
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    ChequeCollectedAmountDetails = Double.parseDouble(cursor.getString(0));
                }
            }
            return ChequeCollectedAmountDetails;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public double fnGetAllCashCollectedAmountDetails() {
        Double CashCollectedAmountDetails = 0.0;
        Cursor cursor = db.rawQuery("SELECT ifnull(SUM(Amount),'0.00') CashAmount from tblAllCollectionData WHERE PaymentModeID=1", null); //order by AutoIdOutlet Desc
        try {
            if (cursor.getCount() > 0) {
                cursor.moveToFirst();
                CashCollectedAmountDetails = Double.parseDouble(cursor.getString(0));

            }
            return CashCollectedAmountDetails;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }

    public Double fetch_AllInvoiceAmount() {
//tv_GrossInvVal
        //open();
        Double dblAllInvoiceAmount = 0.0;
        // Cursor   cursor = db.rawQuery("SELECT tblTmpInvoiceHeader.InvoiceVal from tblTmpInvoiceHeader WHERE tblTmpInvoiceHeader.StoreID='"+StoreID+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null); //order by AutoIdOutlet Desc
        Cursor cursor = db.rawQuery("SELECT ifnull(SUM(tblInvoiceHeader.InvoiceVal),'0.0') from tblInvoiceHeader", null); //order by AutoIdOutlet Desc
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                    dblAllInvoiceAmount = Double.parseDouble(cursor.getString(0).toString());

                }

            } else {
                dblAllInvoiceAmount = 0.0;
            }
            return dblAllInvoiceAmount;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public LinkedHashMap<String, String> fnGetAllStoreWiseCollectionReport() {
        LinkedHashMap<String, String> hmapAllStoreWiseCollectionReport = new LinkedHashMap<String, String>();
        LinkedHashMap<String, String> hmapAllStoreWiseCollectionReportModified = new LinkedHashMap<String, String>();
        hmapAllStoreWiseCollectionReportModified = fnGetAllDistinctStoreWithInvoiceOrCollectionModified();

        LinkedHashMap<String, String> hmapAllDistinctStoreWithInvoiceOrCheque = new LinkedHashMap<String, String>();
        hmapAllDistinctStoreWithInvoiceOrCheque = fnGetAllDistinctStoreWithInvoiceOrChequeModified();

        Cursor cursor = db.rawQuery("SELECT StoreName,ifnull(SUM(tblInvoiceHeader.InvoiceVal),'0.00') InvAmount,ifnull((select SUM(tblAllCollectionData.Amount) from tblAllCollectionData  where tblSt.StoreID=tblAllCollectionData.StoreID AND tblAllCollectionData.PaymentModeID='1'),'0.00') CashCollection,ifnull((select SUM(tblAllCollectionData.Amount) from tblAllCollectionData   where tblSt.StoreID=tblAllCollectionData.StoreID AND tblAllCollectionData.PaymentModeID='2'),'0.00')ChequeCollection,'0.00' AS BalAmount,tblSt.StoreID from tblStoreList tblSt inner join tblInvoiceHeader ON tblSt.StoreID=tblInvoiceHeader.StoreID Group By tblSt.StoreID,tblSt.StoreName", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                        String txtInvoiceAmount = cursor.getString(1);
                        String txtCollection = cursor.getString(2);
                        String txtChqAmt = cursor.getString(3);
                        if (hmapAllStoreWiseCollectionReportModified != null && hmapAllStoreWiseCollectionReportModified.size() > 0) {
                            if (hmapAllStoreWiseCollectionReportModified.containsKey(cursor.getString(5) + "^" + cursor.getString(0).toString())) {
                                txtCollection = hmapAllStoreWiseCollectionReportModified.get(cursor.getString(5) + "^" + cursor.getString(0).toString());
                            }
                        }
                        if (hmapAllDistinctStoreWithInvoiceOrCheque != null && hmapAllDistinctStoreWithInvoiceOrCheque.size() > 0) {
                            if (hmapAllDistinctStoreWithInvoiceOrCheque.containsKey(cursor.getString(5) + "^" + cursor.getString(0).toString())) {
                                txtChqAmt = hmapAllDistinctStoreWithInvoiceOrCheque.get(cursor.getString(5) + "^" + cursor.getString(0).toString());
                            }
                        }
                        //Double BalAmt=Double.parseDouble(txtInvoiceAmount)-(Double.parseDouble(txtCollection)+Double.parseDouble(txtChqAmt));
                        Double BalAmt = (Double.parseDouble(txtCollection) + Double.parseDouble(txtChqAmt));


                        hmapAllStoreWiseCollectionReport.put(cursor.getString(5) + "^" + cursor.getString(0).toString(), txtInvoiceAmount + "^" + txtCollection + "^" + txtChqAmt + "^" + BalAmt);

                        cursor.moveToNext();
                    }
                }

            }
            // hmapAllStoreWiseCollectionReport.putAll(hmapAllStoreWiseCollectionReportModified);
           /* if(hmapAllStoreWiseCollectionReportModified.containsKey(cursor.getString(5)+"^"+cursor.getString(0).toString()))
            {
                hmapAllStoreWiseCollectionReport.put(cursor.getString(5)+"^"+cursor.getString(0).toString(),hmapAllStoreWiseCollectionReportModified.get(cursor.getString(5)+"^"+cursor.getString(0).toString()));
            }*/
            return hmapAllStoreWiseCollectionReport;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }

    public void fnWriteTextFile(int VanIntialInvoiceIdNum) {

        try {

            JSONArray jArray = new JSONArray();
            JSONObject jsonObjMain = new JSONObject();
            JSONObject jOnew = new JSONObject();
            jOnew.put("VanIntialInvoiceIdNum", VanIntialInvoiceIdNum);
            jArray.put(jOnew);
            jsonObjMain.put(CommonInfo.TextFileArrayName, jArray);
            File jsonTxtFolder = new File(Environment.getExternalStorageDirectory(), CommonInfo.TextFileFolder);
            if (!jsonTxtFolder.exists()) {
                jsonTxtFolder.mkdirs();

            }
            String txtFileNamenew = CommonInfo.TextFileName;
            File file = new File(jsonTxtFolder, txtFileNamenew);
            // If file does not exists, then create it
            if (!file.exists()) {
                try {
                    file.createNewFile();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }


            FileWriter fw;
            try {
                fw = new FileWriter(file.getAbsoluteFile());

                BufferedWriter bw = new BufferedWriter(fw);

                bw.write(jsonObjMain.toString());

                bw.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } finally {

        }
    }


    public String[] FetchAllStoreListForCollectionReport() {
        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;

        //Cursor cursor = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList   ORDER BY DistanceNear", null); //where StoreRouteID='"+ rID +"'
        Cursor cursor = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList", null); //where StoreRouteID='"+ rID +"'

        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString() + "_" + (String) cursor.getString(SnamecolumnIndex).toString();
                    cursor.moveToNext();
                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }


    public void fnDeleteInsertCollectionReportCashChange(String StoreID, String PreviousCashCollectionAmt, String ModifiedCashCollectionAmt, String Sstat) {
        db.execSQL("DELETE FROM tblCollectionReportCashChange Where StoreID='" + StoreID + "'");
        ContentValues values = new ContentValues();
        values.put("StoreID", StoreID);
        values.put("PreviousCashCollectionAmt", PreviousCashCollectionAmt);
        values.put("ModifiedCashCollectionAmt", ModifiedCashCollectionAmt);
        values.put("Sstat", Sstat);
        db.insert(DBHelper.TABLE_tblCollectionReportCashChange, null, values);
    }

    public void fnDeletetblCollectionReportChequeChange(String StoreID) {
        db.execSQL("DELETE FROM tblCollectionReportChequeChange Where StoreID='" + StoreID + "'");
    }


    public long fnsavetblCollectionReportChequeChange(String StoreID, String PaymentMode_Old, String PaymentModeID_Old, String Amount_Old,
                                                      String RefNoChequeNoTrnNo_Old, String Date_Old, String Bank_Old, String PaymentMode_New, String PaymentModeID_New, String Amount_New,
                                                      String RefNoChequeNoTrnNo_New, String Date_New, String Bank_New, int flgDeleteModifyNew) {
        //db.execSQL("DELETE FROM tblCollectionReportChequeChange Where StoreID='"+StoreID+"'");
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", StoreID.toString().trim());
        initialValues.put("PaymentMode_Old", PaymentMode_Old.toString().trim());
        initialValues.put("PaymentModeID_Old", PaymentModeID_Old.toString().trim());
        initialValues.put("Amount_Old", Amount_Old.toString().trim());
        initialValues.put("RefNoChequeNoTrnNo_Old", RefNoChequeNoTrnNo_Old.toString().trim());
        initialValues.put("Date_Old", Date_Old.toString().trim());
        initialValues.put("Bank_Old", Bank_Old.toString().trim());
        initialValues.put("PaymentMode_New", PaymentMode_New.toString().trim());
        initialValues.put("PaymentModeID_New", PaymentModeID_New.toString().trim());
        initialValues.put("Amount_New", Amount_New.toString().trim());
        initialValues.put("RefNoChequeNoTrnNo_New", RefNoChequeNoTrnNo_New.toString().trim());
        initialValues.put("Date_New", Date_New.toString().trim());
        initialValues.put("Bank_New", Bank_New.toString().trim());
        initialValues.put("Sstat", "3");
        initialValues.put("flgDeleteModifyNew", flgDeleteModifyNew);
        return db.insert(DBHelper.DATABASE_TABLE_tblCollectionReportChequeChange, null, initialValues);
    }

    public ArrayList<LinkedHashMap<String, LinkedHashMap<String, String>>> fnRetrievetblCollectionReportChequeChange(String StoreID) {
        ArrayList<LinkedHashMap<String, LinkedHashMap<String, String>>> arrStoreChequeDetails = new ArrayList<LinkedHashMap<String, LinkedHashMap<String, String>>>();
        Cursor cursor = null;
        LinkedHashMap<String, LinkedHashMap<String, String>> hmapStoreAllChequeDetails = new LinkedHashMap<String, LinkedHashMap<String, String>>();
        try {
            cursor = db.rawQuery("SELECT ifnull(PaymentMode_Old,'NA')PaymentMode_Old,ifnull(PaymentModeID_Old,0) PaymentMode_Old,ifnull(Amount_Old,0.0)Amount_Old,ifnull(RefNoChequeNoTrnNo_Old,'NA') RefNoChequeNoTrnNo_Old,ifnull(Date_Old,'NA') Date_Old,ifnull(Bank_Old,0) Bank_Old,PaymentMode_New,PaymentModeID_New,Amount_New,RefNoChequeNoTrnNo_New,Date_New,Bank_New,flgDeleteModifyNew from tblCollectionReportChequeChange where StoreID='" + StoreID + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        LinkedHashMap<String, String> hmapChequeRecords = new LinkedHashMap<String, String>();

                        String PaymentMode_Old = cursor.getString(0).toString();
                        int PaymentModeID_Old = Integer.parseInt(cursor.getString(1).toString());
                        Double Amount_Old = Double.parseDouble(cursor.getString(2).toString());
                        String RefNoChequeNoTrnNo_Old = cursor.getString(3).toString();
                        String Date_Old = cursor.getString(4).toString();
                        String Bank_Old = cursor.getString(5).toString();
                        String PaymentMode_New = cursor.getString(6).toString();
                        int PaymentModeID_New = Integer.parseInt(cursor.getString(7).toString());
                        Double Amount_New = Double.parseDouble(cursor.getString(8).toString());
                        String RefNoChequeNoTrnNo_New = cursor.getString(9).toString();
                        String Date_New = cursor.getString(10).toString();
                        String Bank_New = cursor.getString(11).toString();
                        int flgDeleteModifyNew = Integer.parseInt(cursor.getString(12).toString());

                        String oldChequeRecord = PaymentMode_Old + "^" + PaymentModeID_Old + "^" + Amount_Old + "^" + RefNoChequeNoTrnNo_Old + "^" + Date_Old + "^" + Bank_Old;
                        String newChequeRecord = PaymentMode_New + "^" + PaymentModeID_New + "^" + Amount_New + "^" + RefNoChequeNoTrnNo_New + "^" + Date_New + "^" + Bank_New;

                        hmapChequeRecords.put("Old", oldChequeRecord);
                        hmapChequeRecords.put("New", newChequeRecord);

                        hmapStoreAllChequeDetails.put("" + (i + 1) + "^" + flgDeleteModifyNew, hmapChequeRecords);
                        cursor.moveToNext();

                    }

                }
                arrStoreChequeDetails.add(hmapStoreAllChequeDetails);
            }
            // return arrStoreChequeDetails;
        } catch (Exception e) {

        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
        return arrStoreChequeDetails;
    }


    public int fnCheckflgCollectionReportChequeChangeAgainstStore(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblCollectionReportChequeChange WHERE StoreID='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    if (!cursorE2.isNull(0)) {
                        chkI = 1;
                    } else {
                        chkI = 0;
                    }
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }

    public ArrayList<LinkedHashMap<String, LinkedHashMap<String, String>>> fnRetrievetblCollectionChequeAgainstStore(String StoreID) {
        ArrayList<LinkedHashMap<String, LinkedHashMap<String, String>>> arrStoreChequeDetails = new ArrayList<LinkedHashMap<String, LinkedHashMap<String, String>>>();
        Cursor cursor = null;
        LinkedHashMap<String, LinkedHashMap<String, String>> hmapStoreAllChequeDetails = new LinkedHashMap<String, LinkedHashMap<String, String>>();
        try {
            cursor = db.rawQuery("SELECT PaymentMode,PaymentModeID,Amount,RefNoChequeNoTrnNo,Date,Bank from tblAllCollectionData where StoreID='" + StoreID + "' AND PaymentModeID=2", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        LinkedHashMap<String, String> hmapChequeRecords = new LinkedHashMap<String, String>();

                        String PaymentMode_Old = cursor.getString(0).toString();
                        int PaymentModeID_Old = Integer.parseInt(cursor.getString(1).toString());
                        Double Amount_Old = Double.parseDouble(cursor.getString(2).toString());
                        String RefNoChequeNoTrnNo_Old = cursor.getString(3).toString();
                        String Date_Old = cursor.getString(4).toString();
                        String Bank_Old = cursor.getString(5).toString();

                        int flgDeleteModifyNew = 2;

                        String oldChequeRecord = PaymentMode_Old + "^" + PaymentModeID_Old + "^" + Amount_Old + "^" + RefNoChequeNoTrnNo_Old + "^" + Date_Old + "^" + Bank_Old;
                        String newChequeRecord = PaymentMode_Old + "^" + PaymentModeID_Old + "^" + Amount_Old + "^" + RefNoChequeNoTrnNo_Old + "^" + Date_Old + "^" + Bank_Old;

                        hmapChequeRecords.put("Old", oldChequeRecord);
                        hmapChequeRecords.put("New", newChequeRecord);

                        hmapStoreAllChequeDetails.put("" + (i + 1) + "^" + flgDeleteModifyNew, hmapChequeRecords);
                        cursor.moveToNext();

                    }
                }
                arrStoreChequeDetails.add(hmapStoreAllChequeDetails);
            }
            // return arrStoreChequeDetails;
        } catch (Exception e) {

        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
        return arrStoreChequeDetails;
    }


    public double fnGetAllCashCollectedAmountDetailsAgainstStore(String StoreID) {
        Double CashCollectedAmountDetailsAgainstStore = 0.0;
        Cursor cursor = db.rawQuery("SELECT ifnull(SUM(Amount),'0.00') CashAmount from tblAllCollectionData WHERE PaymentModeID=1 And StoreID='" + StoreID + "'", null); //order by AutoIdOutlet Desc
        try {
            if (cursor.getCount() > 0) {
                cursor.moveToFirst();
                CashCollectedAmountDetailsAgainstStore = Double.parseDouble(cursor.getString(0));

            }
            return CashCollectedAmountDetailsAgainstStore;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public Double fnfetchModifiedCollectionReportCashChange(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT ModifiedCashCollectionAmt FROM tblCollectionReportCashChange WHERE StoreID='" + StoreID + "'", null);
        Double chkI = 0.0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    if (!cursorE2.isNull(0)) {
                        chkI = Double.parseDouble((cursorE2.getString(0)));
                    } else {
                        chkI = 0.0;
                    }
                }
            }

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }

    public LinkedHashMap<String, String> fnGetAllDistinctStoreWithInvoiceOrCollectionModified() {
        LinkedHashMap<String, String> hmapAllDistinctStoreWithInvoiceOrCollection = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT StoreName,ifnull(SUM(tblCollectionReportCashChange.ModifiedCashCollectionAmt),'0.00') CashCollection,tblStoreList.StoreID from tblStoreList inner join tblCollectionReportCashChange ON tblStoreList.StoreID=tblCollectionReportCashChange.StoreID Group By tblStoreList.StoreID,tblStoreList.StoreName", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //  Double BalAmt=Double.parseDouble(cursor.getString(1))-(Double.parseDouble(cursor.getString(2))+Double.parseDouble(cursor.getString(3)));
                        hmapAllDistinctStoreWithInvoiceOrCollection.put(cursor.getString(2) + "^" + cursor.getString(0).toString(), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapAllDistinctStoreWithInvoiceOrCollection;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
    }

    public LinkedHashMap<String, String> fnGetAllDistinctStoreWithInvoiceOrChequeModified() {
        LinkedHashMap<String, String> hmapAllDistinctStoreWithInvoiceOrCheque = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("SELECT StoreName,ifnull(SUM(tblCollectionReportChequeChange.Amount_New),'0.00') AS ChequeCollection,tblStoreList.StoreID from tblStoreList inner join tblCollectionReportChequeChange ON tblStoreList.StoreID=tblCollectionReportChequeChange.StoreID Group By tblStoreList.StoreID,tblStoreList.StoreName", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapAllDistinctStoreWithInvoiceOrCheque.put(cursor.getString(2) + "^" + cursor.getString(0).toString(), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapAllDistinctStoreWithInvoiceOrCheque;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
    }


    public long saveAppMasterFlags(int flgShowSalesTargetValue, int flgShowDistributorStock, int flgShowInvoice, int flgShowPOSM, int flgShowPaymentStageAtLastVisitPage, int flgShowDeliveryAddressButtonOnOrder, int flgShowManagerOnStoreList, int flgShowTragetVsAchived, int flgFilterProductOnCategoryOrSearchBasis, int flgNeedStock, int flgCalculateStock, int flgControlStock, int flgManageCollection, int flgControlCollection, int flgManageScheme, int flgManageSalesQuotation, int flgManageExecution) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("flgShowSalesTargetValue", flgShowSalesTargetValue);
        initialValues.put("flgShowDistributorStock", flgShowDistributorStock);
        initialValues.put("flgShowInvoice", flgShowInvoice);
        initialValues.put("flgShowPOSM", flgShowPOSM);
        initialValues.put("flgShowPaymentStageAtLastVisitPage", flgShowPaymentStageAtLastVisitPage);
        initialValues.put("flgShowDeliveryAddressButtonOnOrder", flgShowDeliveryAddressButtonOnOrder);   //0=Not To be mapped Again,1=Can Map Distributor
        initialValues.put("flgShowManagerOnStoreList", flgShowManagerOnStoreList);
        initialValues.put("flgShowTragetVsAchived", flgShowTragetVsAchived);
        initialValues.put("flgFilterProductOnCategoryOrSearchBasis", flgFilterProductOnCategoryOrSearchBasis);
        initialValues.put("flgNeedStock", flgNeedStock);
        initialValues.put("flgCalculateStock", flgCalculateStock);
        initialValues.put("flgControlStock", flgControlStock);
        initialValues.put("flgManageCollection", flgManageCollection);
        initialValues.put("flgControlCollection", flgControlCollection);
        initialValues.put("flgManageScheme", flgManageScheme);
        initialValues.put("flgManageSalesQuotation", flgManageSalesQuotation);
        initialValues.put("flgManageExecution", flgManageExecution);
        return db.insert(DBHelper.TABLE_tblAppMasterFlags, null, initialValues);
    }

    public LinkedHashMap<String, Integer> fnGetAppMasterFlags(int flgDrctslsIndrctSls) {
        LinkedHashMap<String, Integer> hmapAppMasterFlags = new LinkedHashMap<String, Integer>();
        //0             1                   2                  3                       4                    5              6            7          8                   9                  10                11                 12                       13              14                        15                       16                          17                       18                 19              20           21                              22                         23                 24                                   25                            26                  27          28         29
        Cursor cursor = db.rawQuery("SELECT flgDistributorCheckIn ,flgDBRStockInApp ,flgDBRStockEdit ,flgDBRStockCalculate ,flgDBRStockControl ,flgCollRequired ,flgCollReqOrdr ,flgCollTab ,flgCollDefControl ,flgCashDiscount ,flgCollControlRule ,flgSchemeAvailable ,flgSchemeAllowEntry ,flgSchemeAllowEdit ,flgQuotationIsAvailable ,flgExecutionIsAvailable ,flgExecutionPhotoCompulsory,flgTargetShowatStart,flgIncentiveShowatStart,flgInvoicePrint,flgShowPOSM,flgVisitStartOutstandingDetails,flgVisitStartSchemeDetails,flgStoreDetailsEdit,flgShowDeliveryAddressButtonOnOrder,flgShowManagerOnStoreList,flgRptTargetVsAchived,SalesNodeID,SalesNodetype,WorkingTypeID,flgVanStockInApp,flgVanStockEdit,flgVanStockCalculate,flgVanStockControl,flgStockRefillReq,flgDayEnd,flgStockUnloadAtCycleEnd,flgStockUnloadAtDayEnd,flgCollReqATCycleEnd,flgCollReqATDayEnd,flgDayEndSummary,flgStoreCheckInApplicable,flgStoreCheckInPhotoCompulsory,flgDBRStockCanSkipFillInDayStart  from tblAppMasterFlags Where WorkingTypeID=" + flgDrctslsIndrctSls, null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    hmapAppMasterFlags.put("flgDistributorCheckIn", cursor.getInt(0));
                    hmapAppMasterFlags.put("flgDBRStockInApp", cursor.getInt(1));
                    hmapAppMasterFlags.put("flgDBRStockEdit", cursor.getInt(2));
                    hmapAppMasterFlags.put("flgDBRStockCalculate", cursor.getInt(3));
                    hmapAppMasterFlags.put("flgDBRStockControl", cursor.getInt(4));
                    hmapAppMasterFlags.put("flgCollRequired", cursor.getInt(5));   //0=Not To be mapped Again,1=Can Map Distributor
                    hmapAppMasterFlags.put("flgCollReqOrdr", cursor.getInt(6));
                    hmapAppMasterFlags.put("flgCollTab", cursor.getInt(7));
                    hmapAppMasterFlags.put("flgCollDefControl", cursor.getInt(8));
                    hmapAppMasterFlags.put("flgCashDiscount", cursor.getInt(9));
                    hmapAppMasterFlags.put("flgCollControlRule", cursor.getInt(10));
                    hmapAppMasterFlags.put("flgSchemeAvailable", cursor.getInt(11));
                    hmapAppMasterFlags.put("flgSchemeAllowEntry", cursor.getInt(12));
                    hmapAppMasterFlags.put("flgSchemeAllowEdit", cursor.getInt(13));
                    hmapAppMasterFlags.put("flgQuotationIsAvailable", cursor.getInt(14));
                    hmapAppMasterFlags.put("flgExecutionIsAvailable", cursor.getInt(15));
                    hmapAppMasterFlags.put("flgExecutionPhotoCompulsory", cursor.getInt(16));

                    hmapAppMasterFlags.put("flgTargetShowatStart", cursor.getInt(17));
                    hmapAppMasterFlags.put("flgIncentiveShowatStart", cursor.getInt(18));
                    hmapAppMasterFlags.put("flgInvoicePrint", cursor.getInt(19));
                    hmapAppMasterFlags.put("flgShowPOSM", cursor.getInt(20));
                    hmapAppMasterFlags.put("flgVisitStartOutstandingDetails", cursor.getInt(21));
                    hmapAppMasterFlags.put("flgVisitStartSchemeDetails", cursor.getInt(22));
                    hmapAppMasterFlags.put("flgStoreDetailsEdit", cursor.getInt(23));
                    hmapAppMasterFlags.put("flgShowDeliveryAddressButtonOnOrder", cursor.getInt(24));
                    hmapAppMasterFlags.put("flgShowManagerOnStoreList", cursor.getInt(25));
                    hmapAppMasterFlags.put("flgRptTargetVsAchived", cursor.getInt(26));

                    hmapAppMasterFlags.put("SalesNodeID", cursor.getInt(27));
                    hmapAppMasterFlags.put("SalesNodetype", cursor.getInt(28));
                    hmapAppMasterFlags.put("WorkingTypeID", cursor.getInt(29));

                    hmapAppMasterFlags.put("flgVanStockInApp", cursor.getInt(30));
                    hmapAppMasterFlags.put("flgVanStockEdit", cursor.getInt(31));
                    hmapAppMasterFlags.put("flgVanStockCalculate", cursor.getInt(32));
                    hmapAppMasterFlags.put("flgVanStockControl", cursor.getInt(33));
                    hmapAppMasterFlags.put("flgStockRefillReq", cursor.getInt(34));
                    hmapAppMasterFlags.put("flgDayEnd", cursor.getInt(35));
                    hmapAppMasterFlags.put("flgStockUnloadAtCycleEnd", cursor.getInt(36));
                    hmapAppMasterFlags.put("flgStockUnloadAtDayEnd", cursor.getInt(37));
                    hmapAppMasterFlags.put("flgCollReqATCycleEnd", cursor.getInt(38));
                    hmapAppMasterFlags.put("flgCollReqATDayEnd", cursor.getInt(39));
                    hmapAppMasterFlags.put("flgDayEndSummary", cursor.getInt(40));
                    hmapAppMasterFlags.put("flgStoreCheckInApplicable", cursor.getInt(41));
                    hmapAppMasterFlags.put("flgStoreCheckInPhotoCompulsory", cursor.getInt(42));
                    hmapAppMasterFlags.put("flgDBRStockCanSkipFillInDayStart", cursor.getInt(43));


                }
            }
            return hmapAppMasterFlags;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
    }

    public LinkedHashMap<String, ArrayList<String>> fetchtblDAGetAddedOutletSummaryReport() {
        LinkedHashMap<String, ArrayList<String>> hmap = new LinkedHashMap<>();
        Cursor cursor = null;
        try {
            cursor = db.rawQuery("SELECT Distinct Header from tblDAGetAddedOutletSummaryReport where FlgNormalOverall=1", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String abc = cursor.getString(0);
                        hmap.put(abc, fetchOutletSummaryByHeader(abc));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if (cursor != null)
                cursor.close();
            return hmap;
        }

    }

    public String fetchtblDAGetAddedOutletOverAllData() {
        String hmap = "NA";
        Cursor cursor = null;
        try {
            cursor = db.rawQuery("SELECT TotalStores,Validated,Pending from tblDAGetAddedOutletSummaryReport where FlgNormalOverall=0", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmap = cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2);
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if (cursor != null)
                cursor.close();
            return hmap;
        }
    }

    public ArrayList<String> fetchOutletSummaryByHeader(String Header) {
        ArrayList<String> arrData = new ArrayList<>();
        Cursor cursor = null;

        try {
            cursor = db.rawQuery("SELECT Child,TotalStores,Validated,Pending from tblDAGetAddedOutletSummaryReport where Header='" + Header + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        arrData.add(cursor.getString(0) + "^" + cursor.getString(1) + "^" + cursor.getString(2) + "^" + cursor.getString(3));
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if (cursor != null)
                cursor.close();
            return arrData;
        }
    }


    public void createtblDAGetAddedOutletSummaryReport() {
        try {
            db.execSQL(DBHelper.DATABASE_CREATE_TABLE_tblDAGetAddedOutletSummaryReport);
        } catch (Exception e) {

        }
    }

    public void droptblDAGetAddedOutletSummaryReport() {
        db.execSQL("DROP TABLE IF EXISTS tblDAGetAddedOutletSummaryReport");

    }

    public int fnGetCountStoreVisitCode(String StoreID) {

        int StoreVisitCodecnt = 0;
        Cursor cursor = db.rawQuery("Select Count(*) from tblStoreVisitMstr Where StoreID='" + StoreID + "'", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                StoreVisitCodecnt = Integer.parseInt(cursor.getString(0));
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        return StoreVisitCodecnt;
    }

    public String fnGetStoreVisitCodeInCaseOfIndrectSales(String StoreID) {

        String StoreVisitCode = "NA";
        Cursor cursor = db.rawQuery("Select StoreVisitCode from tblStoreVisitMstr Where StoreID='" + StoreID + "'", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                StoreVisitCode = cursor.getString(0);
            }
        }
        if (cursor != null) {
            cursor.close();
        }

        return StoreVisitCode;
    }


    public void fnInsertOrUpdate_tblStoreOrderVisitDayActivity(String StoreVisitCode, String StoreID, String TempStoreVisitCode, String ForDate, int Sstat, String VisitTimeStartAtStore, String VisitTimeEndStore, String imei,double VisitLatCode,double VisitLongCode,int flgTelephonic) {

        //open();
        int flgVisitType = 0;
        if (flgTelephonic == 1) {
            flgVisitType = 0;
        } else {
            flgVisitType = 1;
        }
        try {
            Cursor cursor = db.rawQuery("SELECT TempStoreVisitCode FROM tblStoreOrderVisitDayActivity where StoreVisitCode='" + StoreVisitCode + "' AND StoreID='" + StoreID + "' AND Sstat=1", null);
            ContentValues initialValues = new ContentValues();
            initialValues.put("PDACode", imei);
            initialValues.put("Sstat", Sstat);

           // initialValues.put("VisitTimeEndStore", VisitTimeEndStore);
            if (cursor.getCount() > 0) {
                int affected = db.update(DBHelper.DATABASE_TABLE_tblStoreOrderVisitDayActivity, initialValues, "StoreID=? AND StoreVisitCode=? AND TempStoreVisitCode=?", new String[]{StoreID, StoreVisitCode, TempStoreVisitCode});
            } else {
                initialValues.put("StoreVisitCode", StoreVisitCode);
                initialValues.put("StoreID", StoreID);
                initialValues.put("TempStoreVisitCode", TempStoreVisitCode);
                initialValues.put("ForDate", ForDate);
                initialValues.put("VisitTimeStartAtStore", VisitTimeStartAtStore);
                initialValues.put("VisitTimeEndStore", VisitTimeEndStore);
                initialValues.put("VisitLatCode", VisitLatCode);
                initialValues.put("VisitLongCode", VisitLongCode);
                initialValues.put("flgTelephonic", flgVisitType);

                db.insert(DBHelper.DATABASE_TABLE_tblStoreOrderVisitDayActivity, null, initialValues);
            }
        } finally {
            // close();
        }
    }

    /*public void UpdatetblStoreOrderVisitDayActivitySstat(String StoreID, int Sstat,String StoreVisitCode,String TempStoreVisitCode)
    {


        final ContentValues values = new ContentValues();
        values.put("Sstat", Sstat);

        int affected22 = db.update("tblStoreOrderVisitDayActivity", values, "StoreID=? AND StoreVisitCode=? AND TempStoreVisitCode=?",new String[] { StoreID,StoreVisitCode,TempStoreVisitCode });

    }*/
    public void UpdatetblStoreOrderVisitDayActivitySstat(String StoreID, int Sstat, String StoreVisitCode, String TempStoreVisitCode) {


        final ContentValues values = new ContentValues();
        values.put("Sstat", Sstat);

        int affected22 = db.update("tblStoreOrderVisitDayActivity", values, "StoreID=?", new String[]{StoreID});

    }

    public String fnGetStoreTempStoreVisitCodeFromtblStoreOrderVisitDayActivity(String StoreID) {
        //open();
        String TempStoreVisitCode = "NA";
        Cursor cursor = db.rawQuery("Select TempStoreVisitCode from tblStoreOrderVisitDayActivity Where StoreID='" + StoreID + "' AND Sstat=1", null);

        if (cursor!=null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                TempStoreVisitCode = cursor.getString(0);
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        //close();
        return TempStoreVisitCode;
    }



    public void Delete_bloodGroupMstr() {

        db.execSQL("DELETE FROM tblBloodGroup");
    }

    public void Delete_tblStoreSuggestedQtyMstrList() {

        db.execSQL("DELETE FROM tblStoreSuggestedQtyMstr");
    }


    public void Delete_tblFocusbrandSKU() {

        db.execSQL("DELETE FROM tblFocusbrandSKU");
    }

    public void Delete_tblReplenishmentSKU() {

        db.execSQL("DELETE FROM tblReplenishmentSKU");
    }

    public void Delete_tblEducationQuali() {

        db.execSQL("DELETE FROM tblEducationQuali");
    }

    public void Delete_tblQuestIDForOutChannel() {

        db.execSQL("DELETE FROM tblQuestIDForOutChannel");
    }

    public void Delete_tblGetPDAQuestMstr() {

        db.execSQL("DELETE FROM tblGetPDAQuestMstr");
    }

    public void savetblQuestionMstrRetroFit(List<TblGetPDAQuestMstr> tblGetPDAQuestMstr) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblGetPDAQuestMstr PDAQuestMstr : tblGetPDAQuestMstr) {
            int flgQuestIDForOutChannel = 0;
            initialValues.put("QuestCode", PDAQuestMstr.getQuestCode());
            initialValues.put("QuestID", PDAQuestMstr.getQuestID());
            initialValues.put("QuestDesc", PDAQuestMstr.getQuestDesc());
            initialValues.put("QuestType", PDAQuestMstr.getQuestType());
            initialValues.put("AnsControlType", PDAQuestMstr.getAnsControlType());
            initialValues.put("AnsControlInputTypeID", PDAQuestMstr.getAsnControlInputTypeID());

            initialValues.put("AnsControlInputTypeMaxLength", PDAQuestMstr.getAnsControlInputTypeMaxLength());
            initialValues.put("AnsMustRequiredFlg", PDAQuestMstr.getAnsMustRequiredFlg());
            initialValues.put("QuestBundleFlg", PDAQuestMstr.getQuestBundleFlg());
            initialValues.put("ApplicationTypeID", PDAQuestMstr.getApplicationTypeID());
            initialValues.put("Sequence", PDAQuestMstr.getSequence());//AnsControlInputTypeMinLength
            initialValues.put("AnsControlInputTypeMinLength", PDAQuestMstr.getAnsControlIntputTypeMinLength());

            initialValues.put("AnswerHint", PDAQuestMstr.getAnswerHint());
            if (gblQuestIDForOutChannel == PDAQuestMstr.getQuestID()) {
                flgQuestIDForOutChannel = 1;
            }
            initialValues.put("flgQuestIDForOutChannel", flgQuestIDForOutChannel);

            //initialValues.put("QuestDescHindi", );
            db.insert(DBHelper.TABLE_QuestionMstr, null, initialValues);
        }

        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public void Delete_tblQuestIDForName() {

        db.execSQL("DELETE FROM tblQuestIDForName");
    }

    public void Delete_tblPDAQuestGrpMappingMstr() {

        db.execSQL("DELETE FROM tblGetPDAQuestGrpMapping");
    }

    public void savetblPDAQuestGrpMappingMstr(List<TblGetPDAQuestGrpMapping> tblGetPDAQuestGrpMappings) {
        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_QuestGrpMappingMstr + " (GrpQuestID, QuestID, GrpID,GrpNodeID, GrpDesc, SectionNo,GrpCopyID, QuestCopyID, Sequence)" +
                    " VALUES (?,?,?,?,?,?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblGetPDAQuestGrpMapping tbl : tblGetPDAQuestGrpMappings) {
                stmt.bindLong(1, tbl.getGrpQuestID());
                stmt.bindLong(2, tbl.getQuestID());
                stmt.bindLong(3, tbl.getGrpID());
                stmt.bindLong(4, tbl.getGrpNodeID());
                stmt.bindString(5, tbl.getGrpDesc());
                stmt.bindLong(6, tbl.getSectionNo());
                stmt.bindLong(7, tbl.getGrpCopyID());
                stmt.bindLong(8, tbl.getQuestCopyID());
                stmt.bindLong(9, tbl.getSequence());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }

//        ContentValues initialValues = new ContentValues();
//        for (TblGetPDAQuestGrpMapping GetPDAQuestGrpMapping : tblGetPDAQuestGrpMappings) {
//            initialValues.put("GrpQuestID", GetPDAQuestGrpMapping.getGrpQuestID());
//            initialValues.put("QuestID", GetPDAQuestGrpMapping.getQuestID());
//            initialValues.put("GrpID", GetPDAQuestGrpMapping.getGrpID());
//            initialValues.put("GrpNodeID", GetPDAQuestGrpMapping.getGrpNodeID());
//            initialValues.put("GrpDesc", GetPDAQuestGrpMapping.getGrpDesc());
//            initialValues.put("SectionNo", GetPDAQuestGrpMapping.getSectionNo());
//            initialValues.put("GrpCopyID", GetPDAQuestGrpMapping.getGrpCopyID());
//            initialValues.put("QuestCopyID", GetPDAQuestGrpMapping.getQuestCopyID());
//            initialValues.put("Sequence", GetPDAQuestGrpMapping.getSequence());
//            long inserted = db.insert(DBHelper.TABLE_QuestGrpMappingMstr, null, initialValues);
//        }
    }

    public void Delete_tblOptionMstr() {

        db.execSQL("DELETE FROM tblGetPDAQuestOptionMstr");
    }

    public void savetblOptionMstrRetrofit(List<TblGetPDAQuestOptionMstr> tblGetPDAQuestOptionMstr) {

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_OptionMstr + " (OptID, QuestID, OptionDescr, Sequence)" +
                    " VALUES (?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblGetPDAQuestOptionMstr tbl : tblGetPDAQuestOptionMstr) {
                stmt.bindString(1, tbl.getOptID());
                stmt.bindLong(2, tbl.getQuestID());
                stmt.bindString(3, tbl.getOptionDescr());
                stmt.bindLong(4, tbl.getSequence());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
//        db.beginTransaction();
//        ContentValues initialValues = new ContentValues();
//        for (TblGetPDAQuestOptionMstr GetPDAQuestOptionMstr : tblGetPDAQuestOptionMstr) {
//            initialValues.put("OptID", GetPDAQuestOptionMstr.getOptID());
//            initialValues.put("QuestID", GetPDAQuestOptionMstr.getQuestID());
//
//            initialValues.put("OptionDescr", GetPDAQuestOptionMstr.getOptionDescr());
//            initialValues.put("Sequence", GetPDAQuestOptionMstr.getSequence());
//
//            db.insert(DBHelper.TABLE_OptionMstr, null, initialValues);
//
//        }
//        db.setTransactionSuccessful();
//        db.endTransaction();

    }

    public void Delete_tblQuestionDependentMstr() {

        db.execSQL("DELETE FROM tblGetPDAQuestionDependentMstr");
    }

    //Add New Store Section wise Code starts Here
    public void savetblQuestionDependentMstr(List<TblGetPDAQuestionDependentMstr> tblGetPDAQuestionDependentMstr) {
//    public long savetblQuestionDependentMstr(int QuestionID, String OptionID, int DependentQuestionID, int GrpID, int GrpDepQuestID) {
        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_QuestionDependentMstr + " (QuestionID, OptionID, DependentQuestionID, GrpID, GrpDepQuestID)" +
                    " VALUES (?,?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);
            for (TblGetPDAQuestionDependentMstr tbl : tblGetPDAQuestionDependentMstr) {
                stmt.bindLong(1, tbl.getQuestID());
                stmt.bindString(2, tbl.getOptID());
                stmt.bindLong(3, tbl.getDependentQuestID());
                stmt.bindLong(4, tbl.getGrpQuestID());
                stmt.bindLong(5, tbl.getGrpDepQuestID());
                stmt.execute();
            }
            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
//        ContentValues initialValues = new ContentValues();
//        initialValues.put("QuestionID", QuestionID);
//        initialValues.put("OptionID", OptionID);
//        initialValues.put("DependentQuestionID", DependentQuestionID);
//        initialValues.put("GrpID", GrpID);
//        initialValues.put("GrpDepQuestID", GrpDepQuestID);
//        System.out.println("QuestionID2:" + QuestionID + "OptionID2:" + OptionID + "DependentQuestionID2:" + DependentQuestionID);
//        return db.insert(DBHelper.TABLE_QuestionDependentMstr, null, initialValues);
    }

    public void Delete_tblPDAQuestOptionDependentMstr() {

        db.execSQL("DELETE FROM tblPDAQuestOptionDependentMstr");
    }

    public void savetblPDAQuestOptionDependentMstr(List<TblPDAQuestOptionDependentMstr> tblPDAQuestOptionDependentMstr) {
//    public void savetblPDAQuestOptionDependentMstr(int QstID, int DepQstId, int GrpQuestID, int GrpDepQuestID) {
        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_QuestOptionDependentMstr + " (QstID, DepQstId, GrpQuestID, GrpDepQuestID)" +
                    " VALUES (?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);
            for (TblPDAQuestOptionDependentMstr tbl : tblPDAQuestOptionDependentMstr) {
                stmt.bindLong(1, tbl.getQstId());
                stmt.bindLong(2, tbl.getDepQstId());
                stmt.bindLong(3, tbl.getQstId());
                stmt.bindLong(4, tbl.getGrpDepQuestID());
                stmt.execute();
            }
            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
//        ContentValues values = new ContentValues();
//        values.put("QstID", QstID);
//        values.put("DepQstId", DepQstId);
//        values.put("GrpQuestID", GrpQuestID);
//        values.put("GrpDepQuestID", GrpDepQuestID);
//        db.insert(DBHelper.TABLE_QuestOptionDependentMstr, null, values);

    }

    public void Delete_tblPDAQuestOptionValuesDependentMstr() {

        db.execSQL("DELETE FROM tblPDAQuestOptionValuesDependentMstr");
    }

    public void Delete_tblNotificationMstr() {
        db.execSQL("DELETE FROM tblPDANotificationMaster");


    }

    public long inserttblNotificationMstr(int SerialNo, String IMEI, String Noti_text, String Noti_DateTime,
                                          int Noti_ReadStatus, int Noti_NewOld,
                                          String Noti_ReadDateTime, int Sstat, int MsgServerID) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("SerialNo", SerialNo);
        initialValues.put("PDACode", IMEI.trim());
        initialValues.put("Noti_text", Noti_text.trim());
        initialValues.put("Noti_DateTime", Noti_DateTime.trim());
        initialValues.put("Noti_ReadStatus", Noti_ReadStatus);
        initialValues.put("Noti_NewOld", Noti_NewOld);
        initialValues.put("Noti_ReadDateTime", Noti_ReadDateTime.trim());
        initialValues.put("Sstat", Sstat);
        initialValues.put("MsgServerID", MsgServerID);


        return db.insert(DBHelper.TABLE_tblPDANotificationMaster_Define, null, initialValues);
    }

    public void saveTblPreAddedStoresRetrofit(List<TblPreAddedStores> tblPreAddedStores, HashMap<String, String> hmapPreAddedStoreIdSstat) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblPreAddedStores preAddedStores : tblPreAddedStores) {

            if (hmapPreAddedStoreIdSstat.containsKey(preAddedStores.getStoreID())) {
                initialValues.put("StoreID", preAddedStores.getStoreID().toString());
            } else {
                initialValues.put("StoreID", preAddedStores.getStoreIDDB().toString());
            }

            // initialValues.put("StoreID", preAddedStores.getStoreIDDB());
            initialValues.put("StoreName", preAddedStores.getStoreName());
            initialValues.put("LatCode", preAddedStores.getLatCode());
            initialValues.put("LongCode", preAddedStores.getLongCode());
            initialValues.put("DateAdded", preAddedStores.getDateAdded());
            initialValues.put("DistanceNear", 1000);
            initialValues.put("flgOldNewStore", 0);
            initialValues.put("flgReMap", preAddedStores.getFlgRemap());
            initialValues.put("Sstat", 0);
            initialValues.put("RouteID", preAddedStores.getRouteNodeID());
            initialValues.put("RouteNodeType", preAddedStores.getRouteNodeType());


            db.insert(DBHelper.DATABASE_TABLE_tblPreAddedStores, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }

    public void saveTblPreAddedStoresDataDetailsRetrofit(List<TblPreAddedStoresDataDetails> tblPreAddedStoresDataDetails) {
        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblPreAddedStoresDataDetails + " (StoreIDDB, GrpQuestID, GrpQuestID, AnsControlTypeID, AnsTextVal, flgPrvVal)" +
                    " VALUES (?,?,?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);
            for (TblPreAddedStoresDataDetails tbl : tblPreAddedStoresDataDetails) {
                stmt.bindLong(1, tbl.getStoreIDDB());
                stmt.bindLong(2, tbl.getGrpQuestID());
                stmt.bindLong(3, tbl.getQstId());
                stmt.bindLong(4, tbl.getAnsControlTypeID());
                stmt.bindString(5, tbl.getAns());
                stmt.bindLong(6, 2);
                stmt.execute();
            }
            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
//        db.beginTransaction();
//        ContentValues initialValues = new ContentValues();
//        for (TblPreAddedStoresDataDetails preAddedStoresDataDetails : tblPreAddedStoresDataDetails) {
//            initialValues.put("StoreIDDB", preAddedStoresDataDetails.getStoreIDDB());
//            initialValues.put("GrpQuestID", preAddedStoresDataDetails.getGrpQuestID());
//            initialValues.put("QstId", preAddedStoresDataDetails.getQstId());
//            initialValues.put("AnsControlTypeID", preAddedStoresDataDetails.getAnsControlTypeID());
//            initialValues.put("AnsTextVal", preAddedStoresDataDetails.getAns());
//            initialValues.put("flgPrvVal", 2);
//            db.insert(DBHelper.DATABASE_TABLE_tblPreAddedStoresDataDetails, null, initialValues);
//        }
//        db.setTransactionSuccessful();
//        db.endTransaction();

    }

    public void saveSOAPdataProductListRetrofit(List<TblProductListMaster> tblProductListMaster) {
        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_MAIN14 + " (CategoryID, ProductID, ProductShortName, DisplayUnit" +
                    ", CalculateKilo, KGLiter, CatOrdr, PrdOrdr, StoreCatNodeId, SearchField, ManufacturerID, RptUnitName, PerbaseUnit, HSNCode" +
                    ", IsRefrigeration, ProductTypeNodeID, ProductType,RptUnitID, ImageURL,flgActive,UOMType,PcsInBox,UOMValue)" +
                    " VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);
            for (TblProductListMaster tbl : tblProductListMaster) {
                stmt.bindLong(1, tbl.getCatID());
                stmt.bindLong(2, tbl.getProductID());
                stmt.bindString(3, tbl.getProductShortName());
                if (tbl.getDisplayUnit() != null)
                    stmt.bindString(4, tbl.getDisplayUnit());
                else
                    stmt.bindString(4, "NA");
                stmt.bindLong(5, tbl.getCalculateKilo());
                stmt.bindLong(6, tbl.getkGLiter());
                stmt.bindLong(7, 0);
                stmt.bindLong(8, tbl.getPrdOrdr());
                stmt.bindLong(9, tbl.getCatID());
                stmt.bindString(10, tbl.getSearchField());
                stmt.bindLong(11, tbl.getManufacturerID());
                stmt.bindString(12, checkNullOrEmpty(tbl.getRptUnitName(), "", "NA"));
                stmt.bindLong(13, tbl.getPerbaseUnit());
                stmt.bindString(14, checkNullOrEmpty(tbl.gethSNCode(), "", "NA"));
                stmt.bindLong(15, tbl.getIsRefrigeration());
                stmt.bindLong(16, tbl.getProductTypeNodeID());
                stmt.bindString(17, tbl.getProductType());
                stmt.bindLong(18, tbl.getRptUnitID());
                stmt.bindString(19, checkNullOrEmpty(tbl.getImageURL(), "", "NA"));
                stmt.bindLong(20, tbl.getFlgActive());
                stmt.bindString(21, checkNullOrEmpty(tbl.getUOMType(), "", "NA"));
                stmt.bindDouble(22, tbl.getPcsInBox());
                stmt.bindLong(23, tbl.getUOMValue());
                stmt.execute();
            }
            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }

//        db.beginTransaction();
//        ContentValues initialValues = new ContentValues();
//        for (TblProductListMaster ProductListMaster : tblProductListMaster) {
//            initialValues.put("CategoryID", ProductListMaster.getCatID());
//            initialValues.put("ProductID", ProductListMaster.getProductID());
//            initialValues.put("ProductShortName", ProductListMaster.getProductShortName());
//            initialValues.put("DisplayUnit", ProductListMaster.getDisplayUnit());
//            initialValues.put("CalculateKilo", ProductListMaster.getCalculateKilo());
//            initialValues.put("KGLiter", ProductListMaster.getKGLiter());
//            initialValues.put("CatOrdr", 0);//as per abhinav sir not present in table
//            initialValues.put("PrdOrdr", ProductListMaster.getPrdOrdr());
//            initialValues.put("StoreCatNodeId", ProductListMaster.getCatID());
//            initialValues.put("SearchField", ProductListMaster.getSearchField());
//            initialValues.put("ManufacturerID", ProductListMaster.getManufacturerID());
//            initialValues.put("RptUnitName", ProductListMaster.getRptUnitName());
//            initialValues.put("PerbaseUnit", ProductListMaster.getPerbaseUnit());
//            initialValues.put("HSNCode", ProductListMaster.getHSNCode());
//            initialValues.put("IsRefrigeration", ProductListMaster.getIsRefrigeration());
//            initialValues.put("ProductTypeNodeID", ProductListMaster.getProductTypeNodeID());
//            initialValues.put("ProductType", ProductListMaster.getProductType());
//            initialValues.put("RptUnitID", ProductListMaster.getRptUnitID());
//            initialValues.put("ImageURL", ProductListMaster.getImageURL());
//
//
//            db.insert(DBHelper.DATABASE_TABLE_MAIN14, null, initialValues);
//        }
//        db.setTransactionSuccessful();
//        db.endTransaction();

    }

    public void saveProductSegementMapRetrofit(List<TblProductSegementMap> tblProductSegementMap) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblProductSegementMap ProductSegementMap : tblProductSegementMap) {

            initialValues.put("ProductID", ProductSegementMap.getProductId());
            initialValues.put("ProductMRP", ProductSegementMap.getProductMRP());
            initialValues.put("ProductRLP", ProductSegementMap.getProductRLP());
            initialValues.put("ProductTaxAmount", ProductSegementMap.getProductTaxAmount());
            initialValues.put("RetMarginPer", ProductSegementMap.getRetMarginPer());
            initialValues.put("VatTax", ProductSegementMap.getTax());//need to be changed
            initialValues.put("StandardRate", ProductSegementMap.getStandardRate());
            initialValues.put("StandardRateBeforeTax", ProductSegementMap.getStandardRateBeforeTax());
            initialValues.put("StandardTax", ProductSegementMap.getStandardTax());
            initialValues.put("flgPriceAva", ProductSegementMap.getFlgPriceAva());

            //flgPriceAva
            initialValues.put("BusinessSegmentId", ProductSegementMap.getBusinessSegmentId());
            initialValues.put("flgWholeSellApplicable", ProductSegementMap.getFlgPrdBulkPriceapplicable());
            initialValues.put("PriceRangeWholeSellApplicable", ProductSegementMap.getCutoffvalue());
            initialValues.put("StandardRateWholeSale", ProductSegementMap.getStandardRateWholeSale());
            initialValues.put("StandardRateBeforeTaxWholeSell", ProductSegementMap.getStandardRateBeforeTaxWholeSale());
            initialValues.put("StandardTaxWholeSale", ProductSegementMap.getStandardRateWholeSale());

            initialValues.put("NHILTax", 0.0);// ProductSegementMap.getNHIL());
            initialValues.put("GetFundTax", 0.0);// ProductSegementMap.getGetFund());
            initialValues.put("RegionID", ProductSegementMap.getRegionID());
            initialValues.put("UOMID", ProductSegementMap.getUOMID());
            db.insert(DBHelper.DATABASE_TABLE_MAINProductSegementMap, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }

    public void delete_tblManagerMstr() {
        db.execSQL("DELETE FROM tblManagerMstr");

    }

    public long saveCategory(Integer CategoryID, String CategoryDescr, int CatOrdr, int ProductTypeNodeID, String ProductType, int PrdClassOrdr, int PrdTypeOrdr) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("CategoryID", CategoryID);
        initialValues.put("CategoryDescr", CategoryDescr);
        initialValues.put("CatOrdr", CatOrdr);


        initialValues.put("ProductTypeNodeID", ProductTypeNodeID);
        initialValues.put("ProductType", ProductType);

        initialValues.put("PrdClassOrdr", PrdClassOrdr);
        initialValues.put("PrdTypeOrdr", PrdTypeOrdr);

        ////// System.out.println("inserting records in table 3..");

        return db.insert(DBHelper.DATABASE_TABLE_MAIN15, null, initialValues);
    }

    public void deletetblBankMaster() {

        db.execSQL("DELETE FROM tblBankMaster");
        db.execSQL("DELETE FROM tblInstrumentMaster");

    }

    public void savetblBankMaster(List<TblBankMaster> tblBankMaster) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblBankMaster BankMaster : tblBankMaster) {

            initialValues.put("BankId", BankMaster.getBankId());
            initialValues.put("BankName", BankMaster.getBankName());
            /*initialValues.put("LoginIdIns", BankMaster.getLoginIdIns());
            initialValues.put("TimeStampIns", BankMaster.getTimeStampIns());
            initialValues.put("LoginIdUpd", BankMaster.getLoginIdUpd());
            initialValues.put("TimeStampUpd", BankMaster.getTimeStampUpd());*/
            db.insert(DBHelper.DATABASE_TABLE_tblBankMaster, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }

    public void deleteTblInstrumentMaster() {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_tblInstrumentMaster);
    }

    public void savetblInstrumentMaster(List<TblInstrumentMaster> tblInstrumentMasters) {
        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblInstrumentMaster + " (InstrumentModeId, InstrumentMode, InstrumentType) VALUES (?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblInstrumentMaster tbl : tblInstrumentMasters) {
                stmt.bindLong(1, tbl.getInstrumentModeId());
                stmt.bindString(2, tbl.getInstrumentMode());
                stmt.bindLong(3, tbl.getInstrumentType());

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }

    }

    public void insertCycleId(List<TblCycleID> tblCycleID) {
       /* try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_CYCLEID + " (CycleID, CycStartTime, CycleTime, Sstat) VALUES (?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblCycleID tbl : TblCycleID) {
                stmt.bindLong(1, tbl.getCycleID());
                stmt.bindString(2, tbl.getCycStartTime());
                stmt.bindDouble(3, tbl.getCycleTime());
                stmt.bindLong(4, 3);

                stmt.execute();
            }
            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed "+e.getMessage());
        } finally {
            db.endTransaction();
        }*/
//    public void insertCycleId(Integer cycleId, String CycStartTime, BigInteger CycleTime) {
        ////open();

        db.beginTransaction();
        ContentValues values = new ContentValues();
        for (TblCycleID tbl : tblCycleID) {
            values.put("CycleID", tbl.getCycleID());
            values.put("CycStartTime", tbl.getCycStartTime());
            values.put("CycleTime", "" + tbl.getCycleTime());
            values.put("Sstat", 3);
            db.insert(DBHelper.DATABASE_TABLE_CYCLEID, null, values);
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public void Delete_tblGetReturnsReasonForPDAMstr() {
        db.execSQL("DELETE FROM tblGetReturnsReasonForPDAMstr");

    }

    public void fnInsertTBLReturnRsn(Integer stockStatusId, String stockStatus) {
        //tblGetReturnsReasonForPDAMstr(StockStatusId text not null,StockStatus text not null);";
        ContentValues content = new ContentValues();
        content.put("StockStatusId", stockStatusId);
        content.put("StockStatus", stockStatus);
        db.insertOrThrow(DBHelper.TABLE_RETURN_REASON, null, content);
    }

    public void Delete_tblSupplierMstrList() {
        db.execSQL("DELETE FROM tblSupplierMstrList");

    }

    public void savetblLastOutstanding(List<TblLastOutstanding> tblLastOutstanding) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblLastOutstanding tblLastOutstandingData : tblLastOutstanding) {
            initialValues.put("StoreID", "" + tblLastOutstandingData.getStoreid());
            initialValues.put("Outstanding", tblLastOutstandingData.getOutStanding());
            initialValues.put("AmtOverdue", 0.0);
            db.insert(DBHelper.DATABASE_TABLE_tblLastOutstanding, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();
        System.out.println("DATAENSERTEDEnd");


    }

    public void savetblInvoiceLastVisitDetails(List<TblInvoiceLastVisitDetails> tblInvoiceLastVisitDetails) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblInvoiceLastVisitDetails tblInvoiceLastVisitDetailsData : tblInvoiceLastVisitDetails) {
            initialValues.put("StoreID", "" + tblInvoiceLastVisitDetailsData.getStoreid());
            initialValues.put("InvCode", "" + tblInvoiceLastVisitDetailsData.getInvCode());
            initialValues.put("InvDate", "" + tblInvoiceLastVisitDetailsData.getInvDate());
            initialValues.put("OutstandingAmt", "" + tblInvoiceLastVisitDetailsData.getOutStandingAmt());
            // initialValues.put("AmtOverdue", ""));
            db.insert(DBHelper.DATABASE_TABLE_tblInvoiceLastVisitDetails, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }

    public void deltblPDAGetExecutionSummary() {
        db.execSQL("DELETE FROM tblPDAGetExecutionSummary");
    }

    public void inserttblForPDAGetExecutionSummary(List<TblPDAGetExecutionSummary> tblPDAGetExecutionSummary) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblPDAGetExecutionSummary tblPDAGetExecutionSummaryData : tblPDAGetExecutionSummary) {
            initialValues.put("StoreID", tblPDAGetExecutionSummaryData.getStoreID());
            initialValues.put("OrderDate", tblPDAGetExecutionSummaryData.getOrderDate());
            initialValues.put("ProductID", tblPDAGetExecutionSummaryData.getProductID());
            initialValues.put("OrderQty", tblPDAGetExecutionSummaryData.getOrderQty());
            initialValues.put("flgInvStatus", tblPDAGetExecutionSummaryData.getFlgInvStatus());
            initialValues.put("ProductQty", tblPDAGetExecutionSummaryData.getProductQty());
            initialValues.put("PrdName", tblPDAGetExecutionSummaryData.getPrdName());
            initialValues.put("OrderDate1", tblPDAGetExecutionSummaryData.getOrderDate1());

            db.insert(DBHelper.DATABASE_TABLE_MAIN146, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }

    public void deletetblPDAGetLastOrderDetailsTotalValues() {
        db.execSQL("DELETE from tblPDAGetLastOrderDetailsTotalValues");
    }

    public void inserttblspForPDAGetLastOrderDetails_TotalValues(List<TblPDAGetLastOrderDetailsTotalValues> tblPDAGetLastOrderDetailsTotalValues) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblPDAGetLastOrderDetailsTotalValues tblPDAGetLastOrderDetailsTotalValuesData : tblPDAGetLastOrderDetailsTotalValues) {


            initialValues.put("StoreID", tblPDAGetLastOrderDetailsTotalValuesData.getStoreID());
            initialValues.put("OrderValue", tblPDAGetLastOrderDetailsTotalValuesData.getOrderValue());
            initialValues.put("ExecutionValue", tblPDAGetLastOrderDetailsTotalValuesData.getExecutionValue());

            db.insert(DBHelper.DATABASE_TABLE_MAIN145, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }

    public void deltblPDAGetLastOrderDetailsData() {
        db.execSQL("Delete from tblPDAGetLastOrderDetails");
    }

    public void inserttblForPDAGetLastOrderDetails(List<TblPDAGetLastOrderDetails> tblPDAGetLastOrderDetails) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblPDAGetLastOrderDetails tblPDAGetLastOrderDetailsData : tblPDAGetLastOrderDetails) {
            initialValues.put("StoreID", tblPDAGetLastOrderDetailsData.getStoreID());
            initialValues.put("OrderDate", tblPDAGetLastOrderDetailsData.getOrderDate());
            initialValues.put("ProductID", tblPDAGetLastOrderDetailsData.getProductID());
            initialValues.put("OrderQty", tblPDAGetLastOrderDetailsData.getOrderQty());
            initialValues.put("FreeQty", tblPDAGetLastOrderDetailsData.getFreeQty());
            initialValues.put("PrdName", tblPDAGetLastOrderDetailsData.getPrdName());
            initialValues.put("ExecutionQty", tblPDAGetLastOrderDetailsData.getExecutionQty());

            db.insert(DBHelper.DATABASE_TABLE_MAIN144, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }

    public void deletetblPDAGetLastVisitDetails() {
        db.execSQL("DELETE FROM tblPDAGetLastVisitDetails");

    }

    public void insertDistributorLeftOrderId(String distributorNodeIdNodeType, String orderId, Integer flgProcessedInvoice) {
        ////open();

        ContentValues values = new ContentValues();

//tblDistributorProductLeft(DistributorNodeIdNodeType text null,OrderId text null,ProductId text null,OrderQntty text null);";
        values.put("DistributorNodeIdNodeType", distributorNodeIdNodeType);
        values.put("OrderId", orderId);
        values.put("flgProcessedInvoice", flgProcessedInvoice);

        db.insert(DBHelper.DATABASE_TABLE_DISTRIBUTOR_LEFTPRODUCT, null, values);


        //close();
    }

    public void inserttblForPDAGetLastVisitDetails(List<TblPDAGetLastVisitDetails> tblPDAGetLastVisitDetails) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblPDAGetLastVisitDetails tblPDAGetLastVisitDetailsData : tblPDAGetLastVisitDetails) {
            initialValues.put("StoreID", tblPDAGetLastVisitDetailsData.getStoreID());
            initialValues.put("Date123", tblPDAGetLastVisitDetailsData.getDate());
            initialValues.put("Order123", tblPDAGetLastVisitDetailsData.getOrder());
            initialValues.put("Stock", tblPDAGetLastVisitDetailsData.getStock());
            initialValues.put("SKUName", tblPDAGetLastVisitDetailsData.getSKUName());
            initialValues.put("ExecutionQty", tblPDAGetLastVisitDetailsData.getExecutionQty());
            initialValues.put("ProductID", tblPDAGetLastVisitDetailsData.getProductID());
            // // System.out.println("Tbl creation string for Sunil Data Print Data insert in  DATABASE_TABLE_MAIN143");
            db.insert(DBHelper.DATABASE_TABLE_MAIN143, null, initialValues);

        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }

    public void deletetblPDAGetLastOrderDateData() {
        db.execSQL("Delete from tblPDAGetLastOrderDate");
    }

    public void inserttblForPDAGetLastOrderDate(List<TblPDAGetLastOrderDate> tblPDAGetLastOrderDate) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblPDAGetLastOrderDate tblPDAGetLastOrderDateData : tblPDAGetLastOrderDate) {
            initialValues.put("StoreID", tblPDAGetLastOrderDateData.getStoreID());
            initialValues.put("OrderDate", tblPDAGetLastOrderDateData.getOrderDate());
            initialValues.put("flgExecutionSummary", tblPDAGetLastOrderDateData.getFlgExecutionSummary());


            db.insert(DBHelper.DATABASE_TABLE_MAIN142, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }

    public void deletetblPDAGetLastVisitDate() {
        db.execSQL("Delete from tblPDAGetLastVisitDate");
    }

    public void inserttblForPDAGetLastVisitDate(List<TblPDAGetLastVisitDate> tblPDAGetLastVisitDate) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblPDAGetLastVisitDate tblPDAGetLastVisitDateData : tblPDAGetLastVisitDate) {
            initialValues.put("StoreID", tblPDAGetLastVisitDateData.getStoreID());
            initialValues.put("VisitDate", tblPDAGetLastVisitDateData.getVIsitDate());
            initialValues.put("flgOrder", tblPDAGetLastVisitDateData.getFlgOrder());
            db.insert(DBHelper.DATABASE_TABLE_MAIN141, null, initialValues);
        }

        db.setTransactionSuccessful();
        db.endTransaction();


    }

    public void deletetblPDAGetLODQty() {
        db.execSQL("Delete from tblPDAGetLODQty");
    }

    public void inserttblLODOnLastSalesSummary(List<TblPDAGetLODQty> tblPDAGetLODQty) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblPDAGetLODQty tblPDAGetLODQtyData : tblPDAGetLODQty) {
            initialValues.put("StoreID", tblPDAGetLODQtyData.getStoreID());
            initialValues.put("Date", tblPDAGetLODQtyData.getDate());
            initialValues.put("SKUID", tblPDAGetLODQtyData.getSKUID());
            initialValues.put("Qty", tblPDAGetLODQtyData.getQty());
            initialValues.put("SKUName", tblPDAGetLODQtyData.getSKUName());

            //// // System.out.println("Aaaj insert  value table 103");

            db.insert(DBHelper.DATABASE_TABLE_MAIN103, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }

    public void savetblProductListLastVisitStockOrOrderMstr(List<TblProductListLastVisitStockOrOrderMstr> tblProductListLastVisitStockOrOrderMstr) {
//(tblActualVisitStock (storeID text null,ProductID text null,Stock text null,Sstat integer null);";
       /* ContentValues initialValues = new ContentValues();
        for (TblProductListLastVisitStockOrOrderMstr tblProductListLastVisitStockOrOrderMstrData : tblProductListLastVisitStockOrOrderMstr) {

            initialValues.put("StoreID", tblProductListLastVisitStockOrOrderMstrData.getStoreID());
            initialValues.put("PrdID", tblProductListLastVisitStockOrOrderMstrData.getPrdID());
            initialValues.put("OrderDate", tblProductListLastVisitStockOrOrderMstrData.getOrderDate());
            initialValues.put("OrderValue", tblProductListLastVisitStockOrOrderMstrData.getOrderValue());//need to be changed


            db.insert(DBHelper.DATABASE_TABLE_tblProductListLastVisitStockOrOrderMstr, null, initialValues);

        }*/


        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblProductListLastVisitStockOrOrderMstr + " (StoreID,PrdID,OrderDate,OrderValue) VALUES (?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblProductListLastVisitStockOrOrderMstr tbl : tblProductListLastVisitStockOrOrderMstr) {
                stmt.bindLong(1, tbl.getStoreID());
                stmt.bindLong(2, tbl.getPrdID());
                if(tbl.getOrderDate()!=null)
                stmt.bindString(3, tbl.getOrderDate());
                else
                    stmt.bindString(3, "NA");


                stmt.bindDouble(4, tbl.getOrderValue());

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }

    private void deleteAlreadyStoreIdExist(String CustomStoreID, String StoreIDPDA) {
        db.execSQL("DELETE FROM tblStoreList WHERE StoreID ='" + CustomStoreID + "' OR StoreID='" + StoreIDPDA + "'");
        db.execSQL("DELETE FROM tblNewStoreListEntries WHERE StoreID ='" + CustomStoreID + "' OR StoreID='" + StoreIDPDA + "'");

    }

    public void saveSOAPdataStoreList(List<TblStoreListMaster> tblStoreListMaster, HashMap<String, String> hmapStoreIdSstat, HashMap<String, String> hmapflgOrderType, HashMap<String, String> hmapStoreIdNewStore, HashMap<String, String> hmapStoreIdflgMapped, HashMap<String, String> hmapStoreIdUpdatedContactNumber,HashMap<String, String> hmapStoreIdflgisDiscountApplicable, HashMap<String, String> hmapStoreIdflgisDiscountAllowed) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblStoreListMaster tblStoreListMasterData : tblStoreListMaster) {
            deleteAlreadyStoreIdExist(tblStoreListMasterData.getStoreID().toString(), tblStoreListMasterData.getStoreIDPDA());
            int Sstat = 0;
            int flgOrderType = 0;
            int ISNewStore = 0;
            int DiscountApplicable=0;
            String DiscountAllowed="No";
            initialValues.put("PDACode", AppUtils.getToken(mContext));


            if (hmapStoreIdSstat != null && hmapStoreIdSstat.size() > 0) {
                if (hmapStoreIdSstat.containsKey(tblStoreListMasterData.getStoreIDPDA()) || hmapStoreIdSstat.containsKey(tblStoreListMasterData.getStoreID())) {
                    if (hmapStoreIdSstat.containsKey(tblStoreListMasterData.getStoreIDPDA())) {
                        initialValues.put("StoreID", tblStoreListMasterData.getStoreIDPDA().toString());
                        tblStoreListMasterData.setStoreID(tblStoreListMasterData.getStoreIDPDA());
                    } else {
                        initialValues.put("StoreID", tblStoreListMasterData.getStoreID().toString());
                    }

                    // String storeInTable=hmapStoreIdSstat.get(tblStoreListMasterData.getStoreIDPDA());

                } else {
                    initialValues.put("StoreID", tblStoreListMasterData.getStoreID().toString());
                }

                if (hmapStoreIdSstat.containsKey("" + tblStoreListMasterData.getStoreID()) || hmapStoreIdSstat.containsKey("" + tblStoreListMasterData.getStoreIDPDA())) {
//                    try {
                    Sstat = Integer.parseInt(hmapStoreIdSstat.get("" + tblStoreListMasterData.getStoreID()));
                    ISNewStore = Integer.parseInt(hmapStoreIdNewStore.get(tblStoreListMasterData.getStoreID()));
                    flgOrderType = Integer.parseInt(hmapflgOrderType.get("" + tblStoreListMasterData.getStoreID()));
                    DiscountApplicable= Integer.parseInt(hmapStoreIdflgisDiscountApplicable.get("" + tblStoreListMasterData.getStoreID()));
                    DiscountAllowed=hmapStoreIdflgisDiscountAllowed.get("" + tblStoreListMasterData.getStoreID());
//                    } catch (Exception e) {
//                        e.printStackTrace();
//                    }
                } else {
                    Sstat = Integer.parseInt(tblStoreListMasterData.getSstat().toString());
                    DiscountApplicable = tblStoreListMasterData.getIsDiscountApplicable();
                    DiscountAllowed= tblStoreListMasterData.getIsDiscountAllow();
                    ISNewStore = 0;

                }
            } else {
                try {
                    Sstat = Integer.parseInt(tblStoreListMasterData.getSstat().toString());
                    DiscountApplicable = tblStoreListMasterData.getIsDiscountApplicable();
                    DiscountAllowed= tblStoreListMasterData.getIsDiscountAllow();
                } catch (Exception e) {

                }
                initialValues.put("StoreID", tblStoreListMasterData.getStoreID().toString());
            }

            if (hmapStoreIdflgMapped != null && hmapStoreIdflgMapped.size() > 0 && (hmapStoreIdflgMapped.containsKey("" + tblStoreListMasterData.getStoreID()) || hmapStoreIdSstat.containsKey("" + tblStoreListMasterData.getStoreIDPDA()))) {
                initialValues.put("flgMapped", hmapStoreIdflgMapped.get("" + tblStoreListMasterData.getStoreID()));
            } else {
                initialValues.put("flgMapped", 1);
            }

            if (hmapStoreIdUpdatedContactNumber != null && hmapStoreIdUpdatedContactNumber.size() > 0 && (hmapStoreIdUpdatedContactNumber.containsKey("" + tblStoreListMasterData.getStoreID()) || hmapStoreIdUpdatedContactNumber.containsKey("" + tblStoreListMasterData.getStoreIDPDA()))) {
                initialValues.put("UpdatedContactnumber", hmapStoreIdUpdatedContactNumber.get("" + tblStoreListMasterData.getStoreID()));
            } else {
                initialValues.put("UpdatedContactnumber", tblStoreListMasterData.getStoreContactNo());
            }

            // initialValues.put("StoreID", tblStoreListMasterData.getStoreID());
            initialValues.put("OwnerName", tblStoreListMasterData.getOwnerName());
            initialValues.put("StoreContactNo", tblStoreListMasterData.getStoreContactNo());
            initialValues.put("StoreType", tblStoreListMasterData.getStoreType());
            initialValues.put("StoreCatType", tblStoreListMasterData.getStoreCatType());
            initialValues.put("StoreName", tblStoreListMasterData.getStoreName());
            if (!AppUtils.isNullOrEmpty(tblStoreListMasterData.getStoreTypeDesc(), "")) {
                initialValues.put("StoreTypeDesc", tblStoreListMasterData.getStoreTypeDesc());
            } else {
                initialValues.put("StoreTypeDesc", "NA");
            }
            try {
                initialValues.put("StoreAddress", tblStoreListMasterData.getStoreAddress().replaceAll("\n", " "));
            } catch (Exception e) {
            }
            initialValues.put("chainID", 1);
            initialValues.put("IsNewStoreDataCompleteSaved", 0);

            initialValues.put("SalesPersonName", tblStoreListMasterData.getSalesPersonName());
            initialValues.put("SalesPersonContact", tblStoreListMasterData.getSalesPersonContact());


            initialValues.put("StoreLatitude", tblStoreListMasterData.getStoreLatitude());
            initialValues.put("StoreLongitude", tblStoreListMasterData.getStoreLongitude());
            initialValues.put("LastVisitDate", tblStoreListMasterData.getLastVisitDate());
            initialValues.put("LastTransactionDate", tblStoreListMasterData.getLastTransactionDate());
            // initialValues.put("Sstat", tblStoreListMasterData.getSstat());
            initialValues.put("Sstat", Sstat);
            initialValues.put("ISNewStore", ISNewStore);
            initialValues.put("PaymentStage", tblStoreListMasterData.getPaymentStage());
            initialValues.put("StoreRouteID", tblStoreListMasterData.getRouteID());
            initialValues.put("RouteNodeType", tblStoreListMasterData.getRouteNodeType());


            initialValues.put("flgHasQuote", tblStoreListMasterData.getFlgHasQuote());
            initialValues.put("flgAllowQuotation", tblStoreListMasterData.getFlgAllowQuotation());

            initialValues.put("StoreCatNodeId", "0");
            initialValues.put("flgGSTCapture", tblStoreListMasterData.getFlgGSTCapture());
            initialValues.put("flgGSTCompliance", "0");
            if (tblStoreListMasterData.getTaxNumber() != null)
                initialValues.put("GSTNumber", tblStoreListMasterData.getTaxNumber());
            initialValues.put("flgGSTRecordFromServer", "0");
            initialValues.put("flgStoreOrder", "0");

            initialValues.put("OutStanding", tblStoreListMasterData.getOutStanding());
            initialValues.put("OverDue", tblStoreListMasterData.getOverDue());
            initialValues.put("flgRuleTaxVal", tblStoreListMasterData.getFlgRuleTaxVal());


            initialValues.put("StoreCity", tblStoreListMasterData.getStoreCity());
            initialValues.put("StorePinCode", tblStoreListMasterData.getStorePinCode());
            initialValues.put("StoreState", tblStoreListMasterData.getStoreState());

            initialValues.put("DBR", tblStoreListMasterData.getDBR());
            initialValues.put("flgTransType", tblStoreListMasterData.getFlgTransType());

            initialValues.put("StoreClose", tblStoreListMasterData.getIsClose());
            initialValues.put("IsComposite", tblStoreListMasterData.getIsComposite());
            initialValues.put("StoreStateID", tblStoreListMasterData.getStateID());
            initialValues.put("StoreCityID", tblStoreListMasterData.getCityID());
            initialValues.put("flgOrderType", flgOrderType);
            initialValues.put("flgCollDefControl", tblStoreListMasterData.getFlgCollDefControl());
            initialValues.put("CollectionPer", tblStoreListMasterData.getCollectionPer());
            initialValues.put(DBHelper.IS_NETWORK_TIME_RECORDED, TimeUtils.isNetworkTimeTaken());
            initialValues.put(DBHelper.DEVICE_TIME, TimeUtils.getCurrentDeviceDateTime(TimeUtils.DATE_TIME_FORMAT));
            if (ISNewStore == 1) {
                initialValues.put("flgStoreEdit", 0);
                initialValues.put("flgLocationEdit", 0);
            } else {
                initialValues.put("flgStoreEdit", tblStoreListMasterData.getFlgStoreEdit());
                initialValues.put("flgLocationEdit", tblStoreListMasterData.getFlgLocationEdit());
            }
            initialValues.put("EmailID", tblStoreListMasterData.getEmailID());
            initialValues.put("Landline", tblStoreListMasterData.getLandlineNum());
            initialValues.put("WhatsappNumber", tblStoreListMasterData.getWhatsappNumber());

            if (tblStoreListMasterData.getDistributor() != null)
                initialValues.put("Distributor", tblStoreListMasterData.getDistributor());
            else
                initialValues.put("Distributor", "NA");

            if (tblStoreListMasterData.getRegion() != null)
                initialValues.put("Region", tblStoreListMasterData.getRegion());
            else
                initialValues.put("Region", "NA");

            if (tblStoreListMasterData.getStoreCode() != null)
                initialValues.put("StoreCode", tblStoreListMasterData.getStoreCode());
            else
                initialValues.put("StoreCode", "NA");


            initialValues.put("RegionID", tblStoreListMasterData.getRegionID());
            initialValues.put("IsDiscountApplicable", DiscountApplicable);
            initialValues.put("IsDiscountAllow", DiscountAllowed);
            initialValues.put("flgStarStore", tblStoreListMasterData.getFlgStarStore());
            initialValues.put("flgUnProductiveStore", tblStoreListMasterData.getFlgUnProductiveStore());

            db.insert(DBHelper.DATABASE_TABLE_MAIN13, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();

       /* int flgIfStoreHasRecords=0;
        try {
            flgIfStoreHasRecords=CheckTotalStoreCount();
        }
        catch (Exception ex)
        {

        }

        if(flgGSTCapture.equals(""))
        {
            flgGSTCapture="1";
        }
        if(flgGSTCompliance.equals(""))
        {
            flgGSTCompliance="0";
        }
        if(GSTNumber.equals(""))
        {
            GSTNumber="0";
        }*/


    }

    public void saveSOAPdataStoreListAddressMap(List<TblStoreListWithPaymentAddress> tblStoreListWithPaymentAddress) {
        db.beginTransaction();
        for (TblStoreListWithPaymentAddress tblStoreListWithPaymentAddressData : tblStoreListWithPaymentAddress) {
            ContentValues initialValues = new ContentValues();

            initialValues.put("StoreID", tblStoreListWithPaymentAddressData.getStoreID());
            initialValues.put("OutAddTypeID", tblStoreListWithPaymentAddressData.getOutAddTypeID());
            initialValues.put("Address", tblStoreListWithPaymentAddressData.getAddress());
            initialValues.put("AddressDet", tblStoreListWithPaymentAddressData.getAddressDet());
            initialValues.put("OutAddID", tblStoreListWithPaymentAddressData.getOutAddID());

            db.insert(DBHelper.DATABASE_TABLE_StoreAddressMapDetailsMstr, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }

    public void insertMinDelQty(List<TblStoreSomeProdQuotePriceMstr> tblStoreSomeProdQuotePriceMstr) {

        // "create table tblMinDeliverQntty (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
        db.beginTransaction();
        ContentValues values = new ContentValues();
        if (tblStoreSomeProdQuotePriceMstr != null && tblStoreSomeProdQuotePriceMstr.size() > 0) {
            for (TblStoreSomeProdQuotePriceMstr tblStoreSomeProdQuotePriceMstrData : tblStoreSomeProdQuotePriceMstr) {
                if (tblStoreSomeProdQuotePriceMstrData.getStoreId() != null) {
                    values.put("PrdId", tblStoreSomeProdQuotePriceMstrData.getPrdId());
                    values.put("StoreID", tblStoreSomeProdQuotePriceMstrData.getStoreId());
                    values.put("QPBT", tblStoreSomeProdQuotePriceMstrData.getQPBT());
                    values.put("QPAT", tblStoreSomeProdQuotePriceMstrData.getQPAT());
                    values.put("QPTaxAmount", tblStoreSomeProdQuotePriceMstrData.getQPTaxAmt());
                    values.put("MinDlvrQty", tblStoreSomeProdQuotePriceMstrData.getMinDlvryQty());
                    values.put("UOMID", tblStoreSomeProdQuotePriceMstrData.getUOMID());

                    db.insert(DBHelper.TABLE_StoreSomeProdQuotePriceMstr, null, values);
                }
            }
        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }


    //map distributor
 /*  public long  saveSuplierMstrData(int NodeID, int NodeType, String Descr, Double latCode,Double LongCode, int flgMapped,String Address,String State,String City,Integer PinCode,String ContactNumber,String TaxNumber,String EmailID,int flgStockManage,int flgDefault)
    {
        ContentValues initialValues = new ContentValues();

        initialValues.put("NodeID", NodeID);
        initialValues.put("NodeType", NodeType);
        initialValues.put("Descr", Descr);
        initialValues.put("latCode", latCode);
        initialValues.put("LongCode", LongCode);
        initialValues.put("flgMapped", flgMapped);
        initialValues.put("Address", Address);
        initialValues.put("State", State);
        initialValues.put("City", City);
        initialValues.put("PinCode", PinCode);
        initialValues.put("ContactNumber", ContactNumber);
        initialValues.put("TaxNumber", TaxNumber);
        initialValues.put("flgStockManage", flgStockManage);
        initialValues.put("EmailID", EmailID);
        initialValues.put("flgDefault", flgDefault);
        //0=Not To be mapped Again,1=Can Map Distributor

        return db.insert(TABLE_tblSupplierMstrList, null, initialValues);
    }*/

    public void saveSuplierMstrData(List<TblSupplierMstrList> tblSupplierMstrLists, HashMap<String, String> hmapSupplierMarkedForInActive) {

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            //NodeID int not null,NodeType int not null,Descr text not null,latCode real null,LongCode real null,flgMapped int not null,Address text null,State text null
            // ,City text null,PinCode text null,ContactNumber text null,TaxNumber text null,
            // flgStockManage int not null,EmailID text null,flgDefault int not null,IsDiscountAllow text null,IsDiscountApplicable int null
            String sql = "INSERT INTO " + DBHelper.TABLE_tblSupplierMstrList + " (NodeID, NodeType, Descr, latCode, LongCode,flgMapped,Address,State,City,PinCode,ContactNumber,TaxNumber,flgStockManage,EmailID,flgDefault,IsDiscountAllow,IsDiscountApplicable,flgRequiredUpdate,flgMarkedForInActive)" +
                    " VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);
            for (TblSupplierMstrList tbl : tblSupplierMstrLists) {
                stmt.bindLong(1, tbl.getNodeID());
                stmt.bindLong(2, tbl.getNodeType());
                stmt.bindString(3, tbl.getDescr());
                stmt.bindDouble(4, tbl.getLatCode());
                stmt.bindDouble(5, tbl.getLongCode());
                stmt.bindLong(6, tbl.getFlgMapped());
                stmt.bindString(7, tbl.getAddress());
                stmt.bindString(8, tbl.getState());
                stmt.bindString(9, tbl.getCity());
                stmt.bindString(10, tbl.getPinCode());
                stmt.bindString(11, tbl.getPhoneNo());
                stmt.bindString(12, tbl.getTaxNumber());
                stmt.bindLong(13, tbl.getFlgStockManage());
                stmt.bindString(14, tbl.getEMailID());
                stmt.bindLong(15, tbl.getFlgDefault());
                stmt.bindString(16, tbl.getIsDiscountAllow());
                stmt.bindLong(17, tbl.getIsDiscountApplicable());
                stmt.bindLong(18, tbl.getFlgRequiredUpdate());
                if(hmapSupplierMarkedForInActive!=null && hmapSupplierMarkedForInActive.size()>0 && hmapSupplierMarkedForInActive.containsKey(""+tbl.getNodeID()))
                {
                    stmt.bindLong(19, Integer.parseInt(hmapSupplierMarkedForInActive.get(""+tbl.getNodeID())));
                }
                else
                    stmt.bindLong(19, tbl.getFlgMarkInActive());
               /* stmt.bindLong(1, tbl.getQuestID());
                stmt.bindString(2, tbl.getOptID());
                stmt.bindLong(3, tbl.getDependentQuestID());
                stmt.bindLong(4, tbl.getGrpQuestID());
                stmt.bindLong(5, tbl.getGrpDepQuestID());*/
                stmt.execute();
            }
            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }

    }

    public static long saveTblPreAddedStoresAddStoreDynamic(String StoreID, String StoreName, String LatCode, String LongCode, String DateAdded, int flgOldNewStore, int flgReMap, int Sstat, String RouteNodeID, String RouteNodeType) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreID", StoreID);
        initialValues.put("StoreName", StoreName);
        initialValues.put("LatCode", LatCode);
        initialValues.put("LongCode", LongCode);
        initialValues.put("DateAdded", DateAdded);
        initialValues.put("DistanceNear", 1000);
        initialValues.put("flgOldNewStore", flgOldNewStore);
        initialValues.put("flgReMap", flgReMap);
        initialValues.put("Sstat", Sstat);
        initialValues.put("RouteID", RouteNodeID);
        initialValues.put("RouteNodeType", RouteNodeType);


        return db.insert(DBHelper.DATABASE_TABLE_tblPreAddedStores, null, initialValues);
    }

    public void insertDistributorStock(List<TblVanProductStock> tblVanProductStock) {
        db.beginTransaction();
        ContentValues values = new ContentValues();
        for (TblVanProductStock tblVanProductStockData : tblVanProductStock) {
            values.put("PrdctId", tblVanProductStockData.getProductNodeID());

            values.put("DistributorNodeIdNodeType", tblVanProductStockData.getCustomer());
            values.put("SKUName", tblVanProductStockData.getSKUName());

            values.put("OpeningStock", tblVanProductStockData.getDayOpeningStock());
            values.put("TodaysAddedStock", tblVanProductStockData.getTodaysAddedStock());
            values.put("CycleAddedStock", tblVanProductStockData.getCycleAddedStock());

            values.put("StockQntty", tblVanProductStockData.getFinalStockQty());
            values.put("NetSalesQty", tblVanProductStockData.getNetSalesQty());
            values.put("TodaysUnloadStk", tblVanProductStockData.getTodaysUnloadStock());
            values.put("CycleUnloadStk", tblVanProductStockData.getCycleUnloadStock());

            values.put("CategoryID", tblVanProductStockData.getCategoryID());

            db.insert(DBHelper.DATABASE_TABLE_TMP_DISTRIBUTOR_STOCK, null, values);
        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }


    public void updateflgOrderTypeIntblStoreList(String StoreID, int flgOrderType) {

        try {
            final ContentValues values = new ContentValues();
            values.put("flgOrderType", flgOrderType);

            int affected = db.update("tblStoreList", values, "StoreID=?",
                    new String[]{StoreID});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
        }

    }


    public int fnGetflgOrderTypeAgainstStore(String StoreID) {

        int flgOrderType = 0;
        Cursor cursor = db.rawQuery("SELECT flgOrderType FROM tblStoreList WHERE StoreID='" + StoreID + "'", null);

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    flgOrderType = Integer.parseInt(cursor.getString(0));
                }

            }
            return flgOrderType;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }

    }

    public void fnInsertOrUpdate_tblAllServicesCalledSuccessfull(int flgAllServicesCalledOrNot) {
        try {
            Cursor cursor = db.rawQuery("SELECT * FROM " + DBHelper.TABLE_tblAllServicesCalledSuccessfull + "", null);
            ContentValues initialValues = new ContentValues();
            initialValues.put("flgAllServicesCalledOrNot", flgAllServicesCalledOrNot);
            if (cursor.getCount() > 0) {
                if (cursor != null) {
                    cursor.close();
                }
                db.execSQL("UPDATE tblAllServicesCalledSuccessfull SET flgAllServicesCalledOrNot=" + flgAllServicesCalledOrNot);

            } else {
                if (cursor != null) {
                    cursor.close();
                }
                db.insert(DBHelper.TABLE_tblAllServicesCalledSuccessfull, null, initialValues);
            }
        } catch (Exception ex) {
            String ex1 = ex.getMessage();
        } finally {

        }
    }


    public int fnhasRecodsRetrofitApiCalledSucessfullyOrNot() {
        Cursor cursorE2 = db.rawQuery("SELECT Count(*) FROM tblAllServicesCalledSuccessfull", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                cursorE2.moveToFirst();
                chkI = Integer.parseInt(cursorE2.getString(0).toString());
            }

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }

    public int fnCheckRetrofitApiCalledSucessfullyOrNot() {
        Cursor cursorE2 = db.rawQuery("SELECT ifnull(flgAllServicesCalledOrNot,0) FROM tblAllServicesCalledSuccessfull", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                cursorE2.moveToFirst();
                chkI = Integer.parseInt(cursorE2.getString(0).toString());
            }

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }


    public void inserttblInvoiceExecutionProductList(List<TblInvoiceExecutionProductList> tblInvoiceExecutionProductList) {

        db.beginTransaction();
        ContentValues values = new ContentValues();
        for (TblInvoiceExecutionProductList tblInvoiceExecutionProductListData : tblInvoiceExecutionProductList) {
            values.put("ProductId", tblInvoiceExecutionProductListData.getProductId());

            values.put("ProductName", tblInvoiceExecutionProductListData.getProductName());
//            System.out.println("Abhinav Raj and Mona:" + tblInvoiceExecutionProductListData.getProductId() + "^" + tblInvoiceExecutionProductListData.getProductName());

            db.insert(DBHelper.DATABASE_TABLE_MAIN112, null, values);
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public void inserttblProductWiseInvoice(List<TblProductWiseInvoice> tblProductWiseInvoice, HashMap<String, String> hmapInvoiceOrderIDandStatus) {


        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblProductWiseInvoice tblProductWiseInvoiceData : tblProductWiseInvoice) {
            int flgToInsrtOrNot = 0;
            if (hmapInvoiceOrderIDandStatus.containsKey(tblProductWiseInvoiceData.getOrderID())) {
                if (hmapInvoiceOrderIDandStatus.get(tblProductWiseInvoiceData.getOrderID()).equals("4") || hmapInvoiceOrderIDandStatus.get(tblProductWiseInvoiceData.getOrderID()).equals("7") || hmapInvoiceOrderIDandStatus.get(tblProductWiseInvoiceData.getOrderID()).equals("9")) {

                } else {
                    flgToInsrtOrNot = 1;

                }
            } else {
                flgToInsrtOrNot = 1;
            }
            if (flgToInsrtOrNot == 1) {
                initialValues.put("StoreID", tblProductWiseInvoiceData.getStoreID());
                initialValues.put("ProductID", tblProductWiseInvoiceData.getProductId());
                initialValues.put("OrderQty", tblProductWiseInvoiceData.getOrderQty());
                initialValues.put("ProductPrice", tblProductWiseInvoiceData.getProductPrice());
                initialValues.put("InvoiceForDate", tblProductWiseInvoiceData.getInVoiceForDate());
                initialValues.put("OrderID", tblProductWiseInvoiceData.getOrderID());
                initialValues.put("CatID", tblProductWiseInvoiceData.getCatID());
                initialValues.put("Freeqty", tblProductWiseInvoiceData.getFreeQty());
                initialValues.put("TotLineDiscVal", tblProductWiseInvoiceData.getTotLineDiscVal());

                db.insert(DBHelper.DATABASE_TABLE_MAIN113, null, initialValues);
            }

        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public void truncateAllSummaryDayDataTable() {
        db.execSQL("DELETE FROM tblAllSummaryDay");
        db.execSQL("DELETE FROM tblLastRefreshTimeReport");
    }


    //nitika

     public void savetblAllSummaryLastRefreshTimeReport(List<TblLastRefreshTimeReport> tblLastRefreshTimeReportList) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblLastRefreshTimeReport tblLastRefreshTimeReport : tblLastRefreshTimeReportList) {
            initialValues.put("LastRefreshTime", tblLastRefreshTimeReport.getLastRefreshTime());
            db.insert(DBHelper.DATABASE_TABLE_tblLastRefreshTimeReport, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public void savetblAllSummaryDayAndMTD(List<TblAllSummaryDay> tblAllSummaryDays) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        int AutoId = 0;
        for (TblAllSummaryDay tblAllSummaryDaysData : tblAllSummaryDays) {
            initialValues.put("AutoId", AutoId);
            initialValues.put("Measures", tblAllSummaryDaysData.getMeasures());
            initialValues.put("TodaysSummary", tblAllSummaryDaysData.getTodaysSummary());
            initialValues.put("MTDSummary", tblAllSummaryDaysData.getMTDSummary());

            initialValues.put("TableNo", tblAllSummaryDaysData.getTableNo());
            initialValues.put("ColorCode", tblAllSummaryDaysData.getColorCode());

            db.insert(DBHelper.DATABASE_TABLE_DayAndSummary, null, initialValues);
            AutoId = AutoId + 1;
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    public void savetblSKUWiseDaySummary(List<TblSKUWiseDaySummary> tblSKUWiseDaySummary) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        int AutoId = 0;
        for (TblSKUWiseDaySummary tblSKUWiseDaySummaryData : tblSKUWiseDaySummary) {
            initialValues.put("AutoId", AutoId);
            initialValues.put("ProductId", tblSKUWiseDaySummaryData.getProductId());
            initialValues.put("Product", tblSKUWiseDaySummaryData.getProduct());
            initialValues.put("MRP", tblSKUWiseDaySummaryData.getMRP());
            initialValues.put("Rate", tblSKUWiseDaySummaryData.getRate());
            initialValues.put("NoofStores", tblSKUWiseDaySummaryData.getNoofStores());
            initialValues.put("OrderQty", tblSKUWiseDaySummaryData.getOrderQty());
            initialValues.put("FreeQty", tblSKUWiseDaySummaryData.getFreeQty());
            initialValues.put("DiscValue", tblSKUWiseDaySummaryData.getDiscValue());

            initialValues.put("ValBeforeTax", tblSKUWiseDaySummaryData.getValBeforeTax());
            initialValues.put("TaxValue", tblSKUWiseDaySummaryData.getTaxValue());
            initialValues.put("ValAfterTax", tblSKUWiseDaySummaryData.getValAfterTax());
            initialValues.put("Lvl", tblSKUWiseDaySummaryData.getLvl());
            initialValues.put("Category", tblSKUWiseDaySummaryData.getCategory());
            initialValues.put("UOM", tblSKUWiseDaySummaryData.getUOM());
            initialValues.put("OrderStr", tblSKUWiseDaySummaryData.getOrderStr());
            db.insert(DBHelper.DATABASE_TABLE_MAIN231, null, initialValues);
            AutoId = AutoId + 1;
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public void truncateSKUDataTable() {
        db.execSQL("DELETE FROM tblSKUWiseDaySummary");

    }

    public void savetblStoreWiseDaySummary(List<TblStoreWiseDaySummary> tblStoreWiseDaySummary) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        int AutoId = 0;
        for (TblStoreWiseDaySummary tblStoreWiseDaySummaryData : tblStoreWiseDaySummary) {
            initialValues.put("AutoId", AutoId);
            initialValues.put("Store", tblStoreWiseDaySummaryData.getStore());
            initialValues.put("LinesperBill", tblStoreWiseDaySummaryData.getLinesperBill());
            initialValues.put("StockValue", tblStoreWiseDaySummaryData.getStockValue());
            initialValues.put("DiscValue", tblStoreWiseDaySummaryData.getDiscValue());
            initialValues.put("ValBeforeTax", tblStoreWiseDaySummaryData.getValBeforeTax());
            initialValues.put("TaxValue", tblStoreWiseDaySummaryData.getTaxValue());
            initialValues.put("ValAfterTax", tblStoreWiseDaySummaryData.getValAfterTax());
            initialValues.put("Lvl", tblStoreWiseDaySummaryData.getLvl());
            db.insert(DBHelper.DATABASE_TABLE_MAIN232, null, initialValues);
            AutoId = AutoId + 1;
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public void truncateStoreWiseDataTable() {
        db.execSQL("DELETE FROM tblStoreWiseDaySummary");

    }

    public void truncateStoreAndSKUWiseDataTable() {
        db.execSQL("DELETE FROM tblStoreSKUWiseDaySummary");

    }

    public void savetblStoreSKUWiseDaySummary(List<TblStoreSKUWiseDaySummary> tblStoreSKUWiseDaySummary) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        int AutoId = 0;
        for (TblStoreSKUWiseDaySummary tblStoreSKUWiseDaySummaryData : tblStoreSKUWiseDaySummary) {
            initialValues.put("AutoId", AutoId);
            initialValues.put("ProductId", tblStoreSKUWiseDaySummaryData.getProductId());
            initialValues.put("Product", tblStoreSKUWiseDaySummaryData.getProduct());
            initialValues.put("MRP", tblStoreSKUWiseDaySummaryData.getMRP());
            initialValues.put("Rate", tblStoreSKUWiseDaySummaryData.getRate());
            initialValues.put("OrderQty", tblStoreSKUWiseDaySummaryData.getOrderQty());
            initialValues.put("FreeQty", tblStoreSKUWiseDaySummaryData.getFreeQty());
            initialValues.put("DiscValue", tblStoreSKUWiseDaySummaryData.getDiscValue());
            initialValues.put("ValBeforeTax", tblStoreSKUWiseDaySummaryData.getValBeforeTax());
            initialValues.put("TaxValue", tblStoreSKUWiseDaySummaryData.getTaxValue());
            initialValues.put("ValAfterTax", tblStoreSKUWiseDaySummaryData.getValAfterTax());
            initialValues.put("Lvl", tblStoreSKUWiseDaySummaryData.getLvl());
            initialValues.put("StoreId", tblStoreSKUWiseDaySummaryData.getStoreId());
            initialValues.put("StockQty", tblStoreSKUWiseDaySummaryData.getStockQty());
            if(tblStoreSKUWiseDaySummaryData.getOrderStr()==null)
            initialValues.put("OrderStr", "NA");
            else
                initialValues.put("OrderStr", tblStoreSKUWiseDaySummaryData.getOrderStr());
            db.insert(DBHelper.DATABASE_TABLE_MAIN233, null, initialValues);
            AutoId = AutoId + 1;
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    public ArrayList<InvoiceList> getDistinctInvoiceNumbersNew() {
        //open();

        Cursor cur = null;
        ArrayList<InvoiceList> arrDistinctInvoiceNumbersNew = new ArrayList<InvoiceList>();

        //tblDistributorOrderPdaId(DistributorNodeIdNodeType text null,OrderPDAID text null,ProductId text null,OrderQntty text null,Sstat integer not null);";
        try {
            if (CommonInfo.flgDrctslsIndrctSls == 1) {
                cur = db.rawQuery("Select DISTINCT ServingDBRId,InvoiceNumber from tblInvoiceDetails", null);
            } else {
                cur = db.rawQuery("Select DISTINCT ServingDBRId,TmpInvoiceCodePDA from tblInvoiceDetails", null);
            }
            if (cur.getCount() > 0) {

                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        InvoiceList invoiceList = new InvoiceList();
                        invoiceList.setCustomer(cur.getString(0));
                        invoiceList.setpDAOrderId(cur.getString(1));
                        arrDistinctInvoiceNumbersNew.add(invoiceList);
                        cur.moveToNext();
                    }
                }

            }
        } catch (Exception e) {

        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
            return arrDistinctInvoiceNumbersNew;
        }

    }

    public void savetblTargetVsAchievedSummary(List<TblActualVsTargetReport> tblActualVsTargetReport) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        int AutoId = 0;
        for (TblActualVsTargetReport tblActualVsTargetReportData : tblActualVsTargetReport) {
            initialValues.put("AutoId", AutoId);
            initialValues.put("Descr", tblActualVsTargetReportData.getDescr());
            initialValues.put("TodayTarget", tblActualVsTargetReportData.getTodayTarget());
            initialValues.put("TodayAchieved", tblActualVsTargetReportData.getTodayAchieved());
            initialValues.put("TodayBal", tblActualVsTargetReportData.getTodayBal());
            initialValues.put("Todayflg", tblActualVsTargetReportData.getTodayflg());
            initialValues.put("MonthTarget", tblActualVsTargetReportData.getMonthTarget());
            initialValues.put("MonthAchieved", tblActualVsTargetReportData.getMonthAchieved());
            initialValues.put("MonthBal", tblActualVsTargetReportData.getMonthBal());
            initialValues.put("Monthflg", tblActualVsTargetReportData.getMonthflg());
            initialValues.put("ValTgtOrPrdctFlg", 1);
            initialValues.put("flgLevel", tblActualVsTargetReportData.getFlgLevel());
            initialValues.put("flgStyleBold", tblActualVsTargetReportData.getFlgStyleBold());
            initialValues.put("IsStoreLevel", tblActualVsTargetReportData.getIsStoreLevel());

            db.insert(DBHelper.DATABASE_TABLE_MAIN235, null, initialValues);
            AutoId = AutoId + 1;
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    public void saveValueVolumeTarget(List<TblValueVolumeTarget> tblValueVolumeTarget) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        int AutoId = 0;
        for (TblValueVolumeTarget tblValueVolumeTargetData : tblValueVolumeTarget) {
            initialValues.put("AutoId", AutoId);
            initialValues.put("Descr", tblValueVolumeTargetData.getDescr());
            initialValues.put("TodayTarget", tblValueVolumeTargetData.getTodayTarget());
            initialValues.put("TodayAchieved", tblValueVolumeTargetData.getTodayAchieved());
            initialValues.put("TodayBal", tblValueVolumeTargetData.getTodayBal());
            initialValues.put("Todayflg", tblValueVolumeTargetData.getTodayflg());
            initialValues.put("MonthTarget", tblValueVolumeTargetData.getMonthTarget());
            initialValues.put("MonthAchieved", tblValueVolumeTargetData.getMonthAchieved());
            initialValues.put("MonthBal", tblValueVolumeTargetData.getMonthBal());
            initialValues.put("Monthflg", tblValueVolumeTargetData.getMonthflg());
            initialValues.put("ValTgtOrPrdctFlg", 0);
            initialValues.put("flgLevel", tblValueVolumeTargetData.getFlgLevel());
            initialValues.put("flgStyleBold", tblValueVolumeTargetData.getFlgStyleBold());
            initialValues.put("IsStoreLevel", tblValueVolumeTargetData.getIsStoreLevel());
            db.insert(DBHelper.DATABASE_TABLE_MAIN235, null, initialValues);
            AutoId = AutoId + 1;
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    //outlet summary
    public void savetblDAGetAddedOutletSummaryReport(List<TblDAGetAddedOutletSummaryReport> tblDAGetAddedOutletSummaryReport) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        int AutoId = 0;
        for (TblDAGetAddedOutletSummaryReport tblDAGetAddedOutletSummaryReportData : tblDAGetAddedOutletSummaryReport) {
            initialValues.put("Header", tblDAGetAddedOutletSummaryReportData.getHeader());
            initialValues.put("Child", tblDAGetAddedOutletSummaryReportData.getChild());
            initialValues.put("TotalStores", tblDAGetAddedOutletSummaryReportData.getTotalStores());
            initialValues.put("Validated", tblDAGetAddedOutletSummaryReportData.getValidated());
            initialValues.put("Pending", tblDAGetAddedOutletSummaryReportData.getPending());
            initialValues.put("FlgNormalOverall", 0);
            db.insert(DBHelper.DATABASE_TABLE_tblDAGetAddedOutletSummaryReport, null, initialValues);
            AutoId = AutoId + 1;
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public void savetblDAGetAddedOutletSummaryOverallReport(List<TblDAGetAddedOutletSummaryOverallReport> tblDAGetAddedOutletSummaryOverallReport) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        int AutoId = 0;
        for (TblDAGetAddedOutletSummaryOverallReport tblDAGetAddedOutletSummaryOverallReportData : tblDAGetAddedOutletSummaryOverallReport) {
            initialValues.put("Header", tblDAGetAddedOutletSummaryOverallReportData.getHeader());
            initialValues.put("Child", tblDAGetAddedOutletSummaryOverallReportData.getChild());
            initialValues.put("TotalStores", tblDAGetAddedOutletSummaryOverallReportData.getTotalStores());
            initialValues.put("Validated", tblDAGetAddedOutletSummaryOverallReportData.getValidated());
            initialValues.put("Pending", tblDAGetAddedOutletSummaryOverallReportData.getPending());
            initialValues.put("FlgNormalOverall", 1);
            db.insert(DBHelper.DATABASE_TABLE_tblDAGetAddedOutletSummaryReport, null, initialValues);
            AutoId = AutoId + 1;
        }
        db.setTransactionSuccessful();
        db.endTransaction();

    }


    public long savetblDsrRegDetails(String IMEI, String ClickedDateTime, String FirstName, String LastName, String ContactNo, String DOB, String Sex, String MaritalStatus, String MarriedDate, String Qualification, String SelfieName, String SelfiePath, String EmailID, String BloodGroup, String SignName, String SignPath, int Sstat, String PhotoName, String PersonNodeId, String PersonNodeType) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("PDACode", IMEI.trim());
        initialValues.put("ClickedDateTime", ClickedDateTime.trim());
        initialValues.put("FirstName", FirstName.trim());
        initialValues.put("LastName", LastName.trim());
        initialValues.put("ContactNo", ContactNo.trim());
        initialValues.put("DOB", DOB.trim());
        initialValues.put("Sex", Sex.trim());
        initialValues.put("MaritalStatus", MaritalStatus.trim());
        initialValues.put("MarriedDate", MarriedDate.trim());
        initialValues.put("Qualification", Qualification.trim());
        initialValues.put("SelfieName", SelfieName.trim());
        initialValues.put("SelfiePath", SelfiePath.trim());
        initialValues.put("EmailID", EmailID.trim());
        initialValues.put("BloodGroup", BloodGroup.trim());
        initialValues.put("SignName", SignName.trim());
        initialValues.put("SignPath", SignPath.trim());
        initialValues.put("Sstat", Sstat);
        initialValues.put("PhotoName", PhotoName.trim());
        initialValues.put("PersonNodeId", PersonNodeId.trim());
        initialValues.put("PersonNodeType", PersonNodeType.trim());

        return db.insert(DBHelper.TABLE_tblDsrRegDetails, null, initialValues);
    }

    public long savetblUserRegistarationStatus(Integer Flag, String MsgToDisplay) {

        ContentValues initialValues = new ContentValues();

        initialValues.put("Flag", Flag);
        initialValues.put("MsgToDisplay", MsgToDisplay.trim());

        // System.out.println("Data Insert in Table MAIN1User");

        return db.insert(DBHelper.TABLE_tblUserRegistarationStatus, null, initialValues);
    }


    public int fnCheckForNewInvoiceOrPreviousValue(String StoreID, String StoreVisitCode, int flgDrctslsIndrctSls) {
        int flginvoiceAnyInPErmanentTable = fnCheckForNewInvoiceOrPreviousValueFromPermanentTable(StoreID, StoreVisitCode);
        Cursor cursorE2 = null;
        if (flgDrctslsIndrctSls == 2) {
            if (flginvoiceAnyInPErmanentTable == 0) {
                cursorE2 = db.rawQuery("SELECT * FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "' AND Sstat=1", null);
            } else {
                cursorE2 = db.rawQuery("SELECT * FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "'", null);
            }
        } else {
            cursorE2 = db.rawQuery("SELECT * FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "' AND Sstat=1", null);
        }

        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = 1;
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }

    public int fnCheckForNewInvoiceOrPreviousValueFromPermanentTable(String StoreID, String StoreVisitCode) {

        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = 1;
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }

    public String fnGetInvoiceCodePDAFromPermanentTable(String StoreID, String StoreVisitCode) {

        Cursor cursorE2 = db.rawQuery("SELECT TmpInvoiceCodePDA FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "' AND StoreVisitCode='" + StoreVisitCode + "'", null);
        String InvoiceCodePDA = "0";
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    InvoiceCodePDA = cursorE2.getString(0).toString();
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return InvoiceCodePDA;
    }


    public LinkedHashMap<String, String> getFileredOrderReviewProductListMap(String StoreId, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated) {
        //tblProductListMaster (CategoryID text  null,ProductID text  null, ProductShortName text  null, DisplayUnit text null, CalculateKilo real  null,ProductMRP real not null, ProductRLP real not null, ProductTaxAmount real not null, KGLiter string null,RetMarginPer real null,VatTax real null,StandardRate real null,StandardRateBeforeTax real null,StandardTax real null,CatOrdr int null,PrdOrdr int null,StoreCatNodeId int null);";

        String searchString = "";
        Cursor cur = null;
        LinkedHashMap<String, String> hmapFilterProductList = new LinkedHashMap<String, String>();
        try {


            if (flgDrctslsIndrctSls == 2) {
                if (chkflgInvoiceAlreadyGenerated == 1) {
                    int we = 0;
                    cur = db.rawQuery("SELECT * FROM tblTmpInvoiceDetailsLocalOrder WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
                    if (cur.getCount() > 0) {
                        we = 1;
                        if (cur != null) {
                            cur.close();
                        }
                    }
                    if (we == 1) {
                        cur = db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetailsLocalOrder on tblProductListMaster.ProductID=tblTmpInvoiceDetailsLocalOrder.ProdID  where tblTmpInvoiceDetailsLocalOrder.StoreID='" + StoreId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
                    } else {
                        cur = db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblInvoiceDetails on tblProductListMaster.ProductID=tblInvoiceDetails.ProdID  where tblInvoiceDetails.StoreID='" + StoreId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
                        //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
                    }
                    // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
                } else {
                    cur = db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblInvoiceDetails on tblProductListMaster.ProductID=tblInvoiceDetails.ProdID  where tblInvoiceDetails.StoreID='" + StoreId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
                }
            } else {
                cur = db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetailsLocalOrder on tblProductListMaster.ProductID=tblTmpInvoiceDetailsLocalOrder.ProdID  where tblTmpInvoiceDetailsLocalOrder.StoreID='" + StoreId + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
            }

            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapFilterProductList.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            System.out.println(e.toString());
            // TODO: handle exception
        } finally {
            if (cur != null) {
                cur.close();
            }
            return hmapFilterProductList;
        }
    }

    public HashMap<String, String> fnGetProductPurchaseList(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                cursor = db.rawQuery("SELECT ProdID,OrderQty FROM tblTmpInvoiceDetailsLocalOrder WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                } else {
                    cursor = db.rawQuery("SELECT ProdID,OrderQty From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                    //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
                }
                // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
            } else {
                cursor = db.rawQuery("SELECT ProdID,OrderQty From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
            }
        } else {
            cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }

    public HashMap<String, String> fnGetProductPurchaseListOrderQtyToShow(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                cursor = db.rawQuery("SELECT ProdID,OrderQtyDataToShow FROM tblTmpInvoiceDetailsLocalOrder WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    cursor = db.rawQuery("SELECT ProdID,OrderQtyDataToShow From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                } else {
                    cursor = db.rawQuery("SELECT ProdID,OrderQtyDataToShow From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                    //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
                }
                // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
            } else {
                cursor = db.rawQuery("SELECT ProdID,OrderQtyDataToShow From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
            }
        } else {
            cursor = db.rawQuery("SELECT ProdID,OrderQtyDataToShow From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public HashMap<String, String> fnGetProductPurchaseListPicOrCases(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                cursor = db.rawQuery("SELECT ProdID,ifnull(flgPicsOrCases,3) FROM tblTmpInvoiceDetailsLocalOrder WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    cursor = db.rawQuery("SELECT ProdID,ifnull(flgPicsOrCases,3) From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                } else {
                    cursor = db.rawQuery("SELECT ProdID,ifnull(flgPicsOrCases,3) From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                    //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
                }
                // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
            } else {
                cursor = db.rawQuery("SELECT ProdID,ifnull(flgPicsOrCases,3) From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
            }
        } else {
            cursor = db.rawQuery("SELECT ProdID,ifnull(flgPicsOrCases,3) From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public int fnCheckIfStoreExistInStoreProdcutPurchaseDetails(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated) {

        Cursor cursorE2 = null;

        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                cursorE2 = db.rawQuery("SELECT * FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
                if (cursorE2.getCount() > 0) {
                    we = 1;
                    if (cursorE2 != null) {
                        cursorE2.close();
                    }
                }
                if (we == 1) {
                    cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
                } else {
                    cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
                }
            } else {
                cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
            }
        } else {
            cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        }
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {

                    if (cursorE2.getInt(0) > 0) {
                        chkI = 1;
                    } else {
                        chkI = 0;
                    }
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }


    //tblSupplierMstrList(NodeID int not null,NodeType int not null,Descr text not null,latCode real null,LongCode real null,flgMapped int not null,Address text null,State text null,City text null,PinCode text null,ContactNumber text null,TaxNumber text null,flgStockManage int not null,EmailID text null,flgDefault int not null);";
    public LinkedHashMap<String, String> getDistLatLng() {
        LinkedHashMap<String, String> hmapDistLatLng = new LinkedHashMap<String, String>();
        Cursor cursor = db.rawQuery("Select NodeID||'^'||NodeType As DistNodeIdNodeType,latCode||'^'||LongCode As LatLong from tblSupplierMstrList", null);
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int i = 0; i < cursor.getCount(); i++) {
                    hmapDistLatLng.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapDistLatLng;
    }


    //tblSupplierMstrList(NodeID int not null,NodeType int not null,Descr text not null,latCode real null,LongCode real null,flgMapped int not null,Address text null,State text null,City text null,PinCode text null,ContactNumber text null,TaxNumber text null,flgStockManage int not null,EmailID text null,flgDefault int not null);";
    public String getDfltDstbtr() {
        String distDescr = "";
        Cursor cursor = db.rawQuery("Select Descr from tblSupplierMstrList where flgDefault=1", null);
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                distDescr = cursor.getString(0);
            }
        }
        return distDescr;
    }


    public void deletePrvsData() {
        db.execSQL("DELETE FROM tblSuplierDetail");
    }

    public void saveSuplierDetail(String distributorId, String distributorNodeType, int Sstat) {
        deletePrvsData();
        ContentValues values = new ContentValues();
        values.put("DistributorNodeId", distributorId);
        values.put("DistributorNodeType", distributorNodeType);
        values.put("Sstat", Sstat);
        //tblSuplierDetail(DistributorNodeId text null,DistributorNodeType text null,Sstat int null)
        db.insert(DBHelper.TABLE_tblSuplierDetail, null, values);

    }


    public HashMap<String, Integer> getDistStockCount(String distId) {
        // tblVanProductStock(PrdctId text null,StockQntty text null,DistributorNodeIdNodeType text null);";
        HashMap<String, Integer> hmapDistPrdctStockCount = new HashMap<>();
        //open();
        try {
            // tblVanProductStock(PrdctId text not null,StockQntty text not null,DistributorNodeIdNodeType text not null,SKUName text not null,OpeningStock text not null,TodaysAddedStock text not null,CycleAddedStock text not null,NetSalesQty text not null,TodaysUnloadStk text not null,CycleUnloadStk text not null,CategoryID text not null);";
            Cursor cur = db.rawQuery("Select PrdctId,OriginalStock from tblVanProductStock where DistributorNodeIdNodeType='" + distId + "'", null);
            // Cursor cur=db.rawQuery("Select PrdctId,OriginalStock from tblVanProductStock",null);// where DistributorNodeIdNodeType='"+distId+"'
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapDistPrdctStockCount.put(cur.getString(0), Integer.parseInt(cur.getString(1)));
                        cur.moveToNext();
                    }
                }


            }


        } catch (Exception e) {

        } finally {
            // close();
            return hmapDistPrdctStockCount;
        }


    }

    public int getLeftProductQantity(int stockCount, String distId, String PrdctId) {
        int netStock = 0;
        //tblTmpInvoiceDetails (IMEIno text not null,RouteID int null,StoreID text not null,CatID text  null,ProdID text not null,TransDate string not null,Stock integer not null,OrderQty integer not null,OrderVal real not null,FreeQty integer not null,DisVal real not null,Sstat integer not null,SampleQuantity int null,ProductShortName text null,ProductPrice real null, TaxRate real null,TaxValue real null,StoreCatNodeId int null,OrderIDPDA text null,flgIsQuoteRateApplied int null,distibutorID text null,flgWholeSellApplicable int null,TmpInvoiceCodePDA text null);";
        try {
            boolean isPrdctFound = false;
            // Cursor cur=db.rawQuery("Select tblTmpInvoiceDetails.ProdID , tblTmpInvoiceDetails.OrderQty from tblTmpInvoiceDetails inner join tblDistributorIDOrderIDLeft ON tblTmpInvoiceDetails.FinalAllotedInvoiceIds=tblDistributorIDOrderIDLeft.OrderId where tblTmpInvoiceDetails.distibutorID='"+distId+"' AND tblTmpInvoiceDetails.FinalAllotedInvoiceIds<>'NA'",null);
            Cursor cur = db.rawQuery("Select tblInvoiceDetails.ProdID , tblInvoiceDetails.OrderQty from tblInvoiceDetails inner join tblDistributorIDOrderIDLeft ON tblInvoiceDetails.InvoiceNumber=tblDistributorIDOrderIDLeft.OrderId where  tblInvoiceDetails.InvoiceNumber<>'NA' AND tblDistributorIDOrderIDLeft.flgProcessedInvoice=0", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        if (PrdctId.equals(cur.getString(0))) {
                            netStock = stockCount - Integer.parseInt(cur.getString(1));
                            stockCount = netStock;
                            isPrdctFound = true;

                        }


                        cur.moveToNext();
                    }
                }
            } else {
                netStock = stockCount;
            }

            if (!isPrdctFound) {
                netStock = stockCount;
            }

        } catch (Exception e) {
            Log.e("Error", e.toString());
        } finally {
            {
                return netStock;
            }
        }


    }

    public void deleteDistStock() {


        db.execSQL("DELETE FROM tblDistributorProductStock");
        db.execSQL("DELETE FROM tblDistributorIDOrderIDLeft");


    }


    public void deleteDistributorStock(String distributorId) {
        db.execSQL("DELETE FROM tblDistributorProductStock where DistributorNodeIdNodeType='" + distributorId + "'");
    }

    public void inserttblDistributorProductStock(List<TblDistributorProductStock> tblDistributorProductStock) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        int AutoId = 0;
        for (TblDistributorProductStock tblDistributorProductStockData : tblDistributorProductStock) {

            initialValues.put("DistributorNodeIdNodeType", tblDistributorProductStockData.getCustomer());
            initialValues.put("ProductNodeID", tblDistributorProductStockData.getProductNodeID());
            initialValues.put("ProductNodeType", tblDistributorProductStockData.getProductNodeType());
            initialValues.put("SKUName", tblDistributorProductStockData.getsKUName());
            initialValues.put("StockDate", tblDistributorProductStockData.getStockDate());
            initialValues.put("StockQty", tblDistributorProductStockData.getStockQty());
            int netStock = getLeftProductQantity(tblDistributorProductStockData.getStockQty(), tblDistributorProductStockData.getCustomer(), "" + tblDistributorProductStockData.getProductNodeID());
            initialValues.put("OriginalStock", netStock);

            db.insert(DBHelper.DATABASE_TABLE_DISTRIBUTOR_PRODUCT_STOCK, null, initialValues);
            AutoId = AutoId + 1;
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public void inserttblDistributorIDOrderIDLeft(String distributorNodeIdNodeType, String orderId) {
        ////open();

        ContentValues values = new ContentValues();

//tblDistributorProductLeft(DistributorNodeIdNodeType text null,OrderId text null,ProductId text null,OrderQntty text null);";
        values.put("DistributorNodeIdNodeType", distributorNodeIdNodeType);
        values.put("OrderId", orderId);
        values.put("flgProcessedInvoice", 1);//flgProcessedInvoice=1 Processed, flgProcessedInvoice=0 UnProcessed (Not Present But will use in future

        db.insert(DBHelper.DATABASE_TABLE_DISTRIBUTOR_ORDERLEFT, null, values);


        //close();
    }

    public LinkedHashMap<String, Integer> getStockFromDistProduct(String distNodeIdNodeType) {
        LinkedHashMap<String, Integer> hmapStock = new LinkedHashMap<String, Integer>();
        Cursor cursor = db.rawQuery("Select ProductNodeID,StockQty from tblDistributorProductStock where DistributorNodeIdNodeType='" + distNodeIdNodeType + "'", null);
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int i = 0; i < cursor.getCount(); i++) {
                    hmapStock.put(cursor.getString(0), cursor.getInt(1));
                    cursor.moveToNext();
                }
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        return hmapStock;
    }

    public LinkedHashMap<String, Integer> getStockAsPerFlg(String distNodeIdNodeType) {
        LinkedHashMap<String, Integer> hmapStock = new LinkedHashMap<String, Integer>();
        Cursor cursor = null;
        if (CommonInfo.hmapAppMasterFlags!=null && CommonInfo.hmapAppMasterFlags.containsKey("flgDBRStockCalculate") &&  CommonInfo.hmapAppMasterFlags.get("flgDBRStockCalculate") == 0) {
            cursor = db.rawQuery("Select ProductNodeID,StockQty from tblDistributorProductStock where DistributorNodeIdNodeType='" + distNodeIdNodeType + "'", null);
        } else {
            //  cursor=db.rawQuery("SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.TmpInvoiceCodePDA=I.TmpInvoiceCodePDA  WHERE I.flgProcessedInvoice=0 GROUP BY ID.ProdID", null);
            cursor = db.rawQuery("SELECT DISTINCT S.ProductNodeID,S.StockQty-ifnull(D.OrderQty,0) AS StockAvailable  from tblDistributorProductStock S left outer join (SELECT ID.ProdID,SUM(ID.OrderQty) OrderQty FROM tblInvoiceHeader AS I INNER JOIN tblInvoiceDetails AS ID ON ID.TmpInvoiceCodePDA=I.TmpInvoiceCodePDA   GROUP BY ID.ProdID) D ON D.ProdID=S.ProductNodeID where S.DistributorNodeIdNodeType='" + distNodeIdNodeType + "'", null);
        }

        System.out.println(" cursor = " + cursor.getCount());
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int i = 0; i < cursor.getCount(); i++) {
                    hmapStock.put(cursor.getString(0), cursor.getInt(1));
                    cursor.moveToNext();
                }
            }
        }

        return hmapStock;
    }

    public ArrayList<Object> FetchStoreCollectionFLag(String storeID) {
        ArrayList<Object> arrayList = new ArrayList<Object>();

        Cursor cursor = db.rawQuery("SELECT flgCollDefControl,CollectionPer FROM tblStoreList WHERE StoreID ='" + storeID + "'", null);
        try {

            String StoreName = "NA";

            if (cursor.moveToFirst()) {


                arrayList.add(cursor.getInt(0));
                arrayList.add(cursor.getDouble(1));


            }

        } catch (Exception e) {
            arrayList.add(0);
            arrayList.add(0.00);
        } finally {
            if (cursor != null) {
                cursor.close();
            }

            return arrayList;
        }


    }


    public void insertReasonCanclOrder(int reasonCodeId, String reasonDescr) {
        ContentValues values = new ContentValues();
        values.put("ReasonCodeID", reasonCodeId);
        values.put("ReasonDescr", reasonDescr);
        db.insert(DBHelper.DATABASE_TABLE_REASON_ORDER_CANCEL, null, values);
    }

    public LinkedHashMap<String, String> getReasonToCancel() {
        LinkedHashMap<String, String> hmapRsnForCncl = new LinkedHashMap<String, String>();
        Cursor cur = null;
        try {
            cur = db.rawQuery("Select * from tblReasonOrderCncl", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        if (i == 0) {
                            hmapRsnForCncl.put("Select Reason", "0");
                        }

                        hmapRsnForCncl.put(cur.getString(1), cur.getString(0));
                        cur.moveToNext();
                    }
                }
            } else {
                hmapRsnForCncl.put("0", "Select Reason");
            }
        } catch (Exception e) {

        } finally {
            if (cur != null) {
                cur.close();
            }
            return hmapRsnForCncl;
        }

    }


    public LinkedHashMap<String, String> fnGetImageDataFrom_tblExecutionImages(String StoreID, String OrderID) {
        LinkedHashMap<String, String> hashMapImages = new LinkedHashMap<String, String>();
        Cursor cursor = null;

        try {
            cursor = db.rawQuery("SELECT  ImageName, ImagePath FROM  tblExecutionImages where StoreID='" + StoreID + "' And OrderID='" + OrderID + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hashMapImages.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println(e);
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return hashMapImages;
        }
    }

    public void deletetblExecutionImages(String StoreID, String OrderID) {
        // db.execSQL("DELETE FROM tblStoreEdit where StoreID='"+StoreID+"'");
        db.execSQL("DELETE FROM tblExecutionImages where StoreID='" + StoreID + "' And OrderID='" + OrderID + "' ");

    }

    public void UpdatetblExecutionImages(int flag2set) {
        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            // int affected2 = db.update("tblExecutionImages", values,"Sstat=? And StoreID='"+StoreID+"' And OrderID='"+OrderID+"'", new String[] { "3" });
            int affected2 = db.update("tblExecutionImages", values, "Sstat=? ", new String[]{"3"});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public void updatetblExecutionImages(String PhotoName) {

        try {
            System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);
            ////tableStoreSctnImage(StoreID text null,imageName text null,imagePath text null,ImageClicktime text null,flgSectionPic text null,Sstat integer null);";
            int affected3 = db.update("tblExecutionImages", values, "ImageName=?", new String[]{PhotoName});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {

        }


    }

    public String[] getAllStoreIdOftblExecutionImages() {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblExecutionImages where Sstat=5 ", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                        cursor.moveToNext();
                    }
                }

            }

            return StoreName;
        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }

    }

    public int getImageCOunt(String StoreID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblExecutionImages where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            if (cursor != null)
                cursor.close();
        }
    }

    public String[] getImgsCount(String StoreID) {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT ImageName FROM tblExecutionImages WHERE StoreID ='" + StoreID + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            if (cursor != null)
                cursor.close();
        }

    }


    public void insertExecutionImagesTable(String StoreID, String OrderID, String ImageName, String ImagePath, int Sstat, String InvNumber, String InvDate) {
        // "create table tblMinDeliverQntty (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
        ContentValues values = new ContentValues();

        values.put("StoreID", StoreID);
        values.put("OrderID", OrderID);
        values.put("ImageName", ImageName);
        values.put("ImagePath", ImagePath);
        values.put("Sstat", Sstat);
        values.put("InvNumber", InvNumber);
        values.put("InvDate", InvDate);


        db.insert(DBHelper.DATABASE_TABLE_tblExecutionImages, null, values);
    }

    public void updateExecutionImageRecordsSyncd() {

        try {


            final ContentValues values = new ContentValues();
            values.put("Sstat", "4");
									/*int affected = db.update("tblUserLoginMstr", values, "Sstat=?",
											new String[] { "3" });*/

            int affected5 = db.update("tblExecutionImages", values, "Sstat=?",
                    new String[]{"5"});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }

    public int fnGetflgDrctslsIndrctSlsForDSR(int CoverageAreaNodeID, int CoverageAreaNodeType) {
//flgDrctslsIndrctSls
        Cursor cursorE2 = db.rawQuery("SELECT flgDrctslsIndrctSls FROM  tblUserAuthenticationMstr  where CoverageNodeID=" + CoverageAreaNodeID + " AND CoverageNodeType=" + CoverageAreaNodeType, null);
        int flgDrctslsIndrctSls = 0;

        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {


                    flgDrctslsIndrctSls = (Integer.parseInt(cursorE2.getString(0).toString()));


                }
            }
            return flgDrctslsIndrctSls;
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }

        }

    }


    public int fnGetCountImageDataFrom_tblExecutionImages(String StoreID, String OrderID) {
        int GetCountImageDataFrom_tblExecutionImages = 0;
        Cursor cursor = null;

        try {
            cursor = db.rawQuery("SELECT  ImageName, ImagePath FROM  tblExecutionImages where StoreID='" + StoreID + "' And OrderID='" + OrderID + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    GetCountImageDataFrom_tblExecutionImages = 1;
                }
            }

        } catch (Exception e) {
            System.out.println(e);
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return GetCountImageDataFrom_tblExecutionImages;
        }
    }

    public void saveAppMasterFlagsRetro(List<TblAppMasterFlags> tblAppMasterFlags) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblAppMasterFlags AppMasterFlags : tblAppMasterFlags) {
            initialValues.put("flgDistributorCheckIn", AppMasterFlags.getFlgDistributorCheckIn());
            initialValues.put("flgDBRStockInApp", AppMasterFlags.getFlgDBRStockInApp());
            initialValues.put("flgDBRStockEdit", AppMasterFlags.getFlgDBRStockEdit());
            initialValues.put("flgDBRStockCalculate", AppMasterFlags.getFlgDBRStockCalculate());
            initialValues.put("flgDBRStockControl", AppMasterFlags.getFlgDBRStockControl());
            initialValues.put("flgCollRequired", AppMasterFlags.getFlgCollRequired());
            initialValues.put("flgCollReqOrdr", AppMasterFlags.getFlgCollReqOrdr());
            initialValues.put("flgCollTab", AppMasterFlags.getFlgCollTab());
            initialValues.put("flgCollDefControl", AppMasterFlags.getFlgCollDefControl());
            initialValues.put("flgCashDiscount", AppMasterFlags.getFlgCashDiscount());

            initialValues.put("flgCollControlRule", AppMasterFlags.getFlgCollControlRule());
            initialValues.put("flgSchemeAvailable", AppMasterFlags.getFlgSchemeAvailable());
            initialValues.put("flgSchemeAllowEntry", AppMasterFlags.getFlgSchemeAllowEntry());
            initialValues.put("flgSchemeAllowEdit", AppMasterFlags.getFlgSchemeAllowEdit());
            initialValues.put("flgQuotationIsAvailable", AppMasterFlags.getFlgQuotationIsAvailable());
            initialValues.put("flgExecutionIsAvailable", AppMasterFlags.getFlgExecutionIsAvailable());
            initialValues.put("flgExecutionPhotoCompulsory", AppMasterFlags.getFlgExecutionPhotoCompulsory());
            initialValues.put("flgTargetShowatStart", AppMasterFlags.getFlgTargetShowatStart());
            initialValues.put("flgIncentiveShowatStart", AppMasterFlags.getFlgIncentiveShowatStart());
            initialValues.put("flgInvoicePrint", AppMasterFlags.getFlgInvoicePrint());

            initialValues.put("flgShowPOSM", AppMasterFlags.getFlgShowPOSM());
            initialValues.put("flgVisitStartOutstandingDetails", AppMasterFlags.getFlgVisitStartOutstandingDetails());
            initialValues.put("flgVisitStartSchemeDetails", AppMasterFlags.getFlgVisitStartSchemeDetails());
            initialValues.put("flgStoreDetailsEdit", AppMasterFlags.getFlgStoreDetailsEdit());
            initialValues.put("flgShowDeliveryAddressButtonOnOrder", AppMasterFlags.getFlgShowDeliveryAddressButtonOnOrder());
            initialValues.put("flgShowManagerOnStoreList", AppMasterFlags.getFlgShowManagerOnStoreList());
            initialValues.put("flgRptTargetVsAchived", AppMasterFlags.getFlgRptTargetVsAchived());

            initialValues.put("SalesNodeID", AppMasterFlags.getSalesNodeID());
            initialValues.put("SalesNodetype", AppMasterFlags.getSalesNodetype());
            initialValues.put("WorkingTypeID", AppMasterFlags.getWorkingTypeID());

            initialValues.put("flgVanStockInApp", AppMasterFlags.getFlgVanStockInApp());
            initialValues.put("flgVanStockEdit", AppMasterFlags.getFlgVanStockEdit());
            initialValues.put("flgVanStockCalculate", AppMasterFlags.getFlgVanStockCalculate());
            initialValues.put("flgVanStockControl", AppMasterFlags.getFlgVanStockControl());
            initialValues.put("flgStockRefillReq", AppMasterFlags.getFlgStockRefillReq());
            initialValues.put("flgDayEnd", AppMasterFlags.getFlgDayEnd());
            initialValues.put("flgStockUnloadAtCycleEnd", AppMasterFlags.getFlgStockUnloadAtCycleEnd());
            initialValues.put("flgStockUnloadAtDayEnd", AppMasterFlags.getFlgStockUnloadAtDayEnd());
            initialValues.put("flgCollReqATCycleEnd", AppMasterFlags.getFlgCollReqATCycleEnd());
            initialValues.put("flgCollReqATDayEnd", AppMasterFlags.getFlgCollReqATDayEnd());
            initialValues.put("flgDayEndSummary", AppMasterFlags.getFlgDayEndSummary());
            initialValues.put("flgStoreCheckInApplicable", AppMasterFlags.getFlgStoreCheckInApplicable());
            initialValues.put("flgStoreCheckInPhotoCompulsory", AppMasterFlags.getFlgStoreCheckInPhotoCompulsory());
            initialValues.put("flgDBRStockCanSkipFillInDayStart", AppMasterFlags.getFlgDBRStockCanSkipFillInDayStart());

            db.insert(DBHelper.TABLE_tblAppMasterFlags, null, initialValues);


        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public void delTblReasonOrderCncl() {
        //open();
        db.execSQL("DELETE FROM tblReasonOrderCncl");
        //close();
    }

    //tblDayStartAttendanceOptions(AutoIdStore int not null,ReasonId text not null,ReasonDescr text not null,FlgToShowTextBox integer null,flgSOApplicable int null,flgDSRApplicable int null,flgNoVisitOption int null,SeqNo int null,flgDelayedReason int null,flgMarketVisit int not null);";
    public String getReasonIdForMarketVisit() {
        String reasonId = "0";
        Cursor cur = db.rawQuery("Select ReasonId from tblDayStartAttendanceOptions where flgMarketVisit=1", null);
        if (cur.getCount() > 0) {
            if (cur.moveToFirst()) {
                reasonId = cur.getString(0);
            }
        }
        return reasonId;
    }

    public void deletetblIsDBRStockSubmitted() {

        db.execSQL("DELETE FROM tblIsDBRStockSubmitted");
    }

    public double fnGetStoretblLastOverDue(String storeID) {
        double LastOutstanding = 0.0;
        // tblLastOutstanding(StoreID text null,Outstanding real null,AmtOverdue real null);";
        Cursor cursor = db.rawQuery("Select AmtOverdue from tblLastOutstanding WHERE StoreID='" + storeID + "'", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                LastOutstanding = Double.parseDouble(cursor.getString(0));
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        return LastOutstanding;
    }

    public LinkedHashMap<String, String> fetch_Store_List(String todayDate) {

        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();


        Cursor cursor = db.rawQuery("SELECT DISTINCT tblStoreList.StoreID, tblStoreList.StoreName, IFNULL(tblInvoiceHeader.InvoiceVal,0) FROM tblStoreList left outer join  tblInvoiceHeader on tblStoreList.StoreID=tblInvoiceHeader.StoreID WHERE tblInvoiceHeader.InvoiceDate ='" + todayDate + "'", null); //order by AutoIdOutlet Desc

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        if (cursor.getCount() == 1) {
                            if (cursor.getString(1) != null && cursor.getString(2) != null)
                                hmapCatgry.put((i + 1) + ")  " + cursor.getString(1).toString() + "   [ Order Value:->" + cursor.getString(2).toString() + " ]", cursor.getString(0).toString());
                            else
                                hmapCatgry.put("No Store", "0");
                        } else {
                            hmapCatgry.put((i + 1) + ")  " + cursor.getString(1).toString() + "   [ Order Value:->" + cursor.getString(2).toString() + " ]", cursor.getString(0).toString());

                        }
                        cursor.moveToNext();

                    }
                }

            } else {
                hmapCatgry.put("No Store", "0");
            }
            return hmapCatgry;
        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }
    }

    public LinkedHashMap<String, String> fetch_Reason_Late() {
        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<>();
        Cursor cursor = db.rawQuery("SELECT ReasonId,ReasonDescr FROM tblDayStartAttendanceOptions where flgDSRApplicable='" + 1 + "' and flgDelayedReason=1", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    hmapCatgry.put("Select Reason", "0");
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapCatgry.put(cursor.getString(1), cursor.getString(0));
                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("No Reason", "0");
            }
            return hmapCatgry;
        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }
    }

    public ArrayList<String> fetch_Text_To_Show() {

        ArrayList<String> listTxtBxToShow = new ArrayList<>();
        Cursor cursor = db.rawQuery("SELECT ReasonId FROM tblDayStartAttendanceOptions where flgDSRApplicable='" + 1 + "' and FlgToShowTextBox='" + 1 + "' order by SeqNo asc", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        listTxtBxToShow.add(cursor.getString(0).toString().trim());
                        cursor.moveToNext();
                    }
                }

            } else {
                // hmapCatgry.put(0, "No Reason");
            }
            return listTxtBxToShow;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
    }

    public int fnflgCheckAnySchemeStoreID(String storeID) {
        int flgCheckAnySchemeStoreID = 0;
        Cursor cursor = db.rawQuery("Select StoreID,SchemeID from tblSchemeStoreMapping where  StoreID ='" + storeID + "'", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                flgCheckAnySchemeStoreID = 1;
            }
        }
        if (cursor != null) {
            cursor.close();
        }

        return flgCheckAnySchemeStoreID;
    }

    public long savetblProductADDONScheme(String ProductID, String PrdString) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("ProductID", ProductID.trim());
        initialValues.put("PrdString", PrdString.trim());

        // System.out.println("Ajay Data Save in table 209");
        return db.insert(DBHelper.DATABASE_TABLE_MAINADDOnScheme, null, initialValues);
    }

    public void fnsavetblStoreProductAddOnSchemeApplied(String StoreID, int ProdID, int schId, int schSlabId, int schSlbBuckId, double schSlabSubBucketValue, int schSubBucketValType,
                                                        int schSlabSubBucketType, int BenifitRowID, int BenSubBucketType,
                                                        int FreeProductID, double BenifitSubBucketValue, double BenifitMaxValue, double BenifitAssignedValue, double BenifitAssignedValueType, int BenifitDiscountApplied, String BenifitCouponCode, double per, double UOM, int WhatFinallyApplied, int schSlbRowId, int SchTypeId, String pdaOrderID, int flgAddOn, int isDiscountOnTotalAmount) {
        //StoreID text not null,ProductID int not null,schId int not null,schSlabId integer not null,schSlbBuckId integer not null,schSlabSubBucketValue real not null,
        //schSubBucketValType integer not null,schSlabSubBucketType int not null,BenifitRowID integer not null,BenSubBucketType int null,FreeProductID int null,
        //BenifitSubBucketValue real null,BenifitMaxValue real null,BenifitAssignedValue real null,BenifitAssignedValueType int null,BenifitDiscountApplied int null,
        //BenifitCouponCode text null

        Cursor cur = db.rawQuery("Select schSlabId from tblStoreProductAddOnSchemeApplied where StoreID='" + StoreID + "' AND ProductID=" + ProdID + " AND schId=" + schId + " AND schSlabId=" + schSlabId, null);
        if (cur != null) {
            if (cur.getCount() > 0) {
                if (cur != null) {
                    cur.close();
                }
            }
        } else {
            ContentValues initialValues = new ContentValues();

            initialValues.put("StoreID", StoreID.trim());
            initialValues.put("ProductID", ProdID);
            initialValues.put("schId", schId);
            initialValues.put("schSlabId", schSlabId);
            initialValues.put("schSlbBuckId", schSlbBuckId);
            initialValues.put("schSlabSubBucketValue", schSlabSubBucketValue);
            initialValues.put("schSubBucketValType", schSubBucketValType);
            initialValues.put("schSlabSubBucketType", schSlabSubBucketType);
            initialValues.put("BenifitRowID", BenifitRowID);

            initialValues.put("BenSubBucketType", BenSubBucketType);

            initialValues.put("FreeProductID", FreeProductID);

            initialValues.put("BenifitSubBucketValue", BenifitSubBucketValue);

            initialValues.put("BenifitMaxValue", BenifitMaxValue);
            initialValues.put("BenifitAssignedValue", BenifitAssignedValue);
            initialValues.put("BenifitAssignedValueType", BenifitAssignedValueType);

            initialValues.put("BenifitDiscountApplied", BenifitDiscountApplied);
            initialValues.put("BenifitCouponCode", BenifitCouponCode);

            initialValues.put("PER", per);
            initialValues.put("UOM", UOM);
            initialValues.put("Sstat", 0);
            initialValues.put("schSlbRowId", schSlbRowId);
            initialValues.put("SchTypeId", SchTypeId);
            initialValues.put("WhatFinallyApplied", WhatFinallyApplied);
            initialValues.put("OrderIDPDA", pdaOrderID);
            initialValues.put("TmpInvoiceCodePDA", pdaOrderID);
            initialValues.put("flgAddOn", flgAddOn);
            initialValues.put("isDiscountOnTotalAmount", isDiscountOnTotalAmount);

            // System.out.println("Save Data Save in Table 211");

            db.insert(DBHelper.DATABASE_TABLE_ADDONSCHEME, null, initialValues);

        }
    }

    public HashMap<String, String> fnProductADDOnScheme() {
        Cursor cursor = db.rawQuery("SELECT Distinct tblProductADDONScheme.ProductID,tblProductADDONScheme.PrdString from tblProductADDONScheme inner join tblProductListMaster ON tblProductADDONScheme.ProductID=tblProductListMaster.ProductID", null);
        try {
            HashMap<String, String> SchemeIDFreePRodQtyDetails = new HashMap<String, String>();
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        SchemeIDFreePRodQtyDetails.put(cursor.getString(0).toString(), cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return SchemeIDFreePRodQtyDetails;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
    }


    public LinkedHashMap<String, ArrayList<String>> fnGetIncentivesMasterListData() {
        LinkedHashMap<String, ArrayList<String>> HmapIncMasterListData = new LinkedHashMap<String, ArrayList<String>>();
        Cursor cursor = null;
        try {
            cursor = db.rawQuery("SELECT tblIncentiveMaster.IncId,tblIncentiveMaster.OutputType,tblIncentiveMaster.IncentiveName,count(tblIncentiveSecondaryMaster.IncSlabId) as ColumnCount,tblIncentiveMaster.flgAcheived,tblIncentiveMaster.Earning FROM tblIncentiveMaster INNER JOIN tblIncentiveSecondaryMaster ON tblIncentiveMaster.IncId = tblIncentiveSecondaryMaster.IncId", null);// group by tblIncentiveSecondaryMaster.IncId

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        ArrayList<String> list_frstTbl = new ArrayList<String>();
                        list_frstTbl.add(0, cursor.getString(1).toString().trim()); //output type
                        list_frstTbl.add(1, cursor.getString(2).toString().trim()); //incentive name
                        list_frstTbl.add(2, cursor.getString(3).toString().trim()); //count of incId frm columndesc tbl
                        list_frstTbl.add(3, cursor.getString(4).toString().trim()); //flgAchieved
                        list_frstTbl.add(4, cursor.getString(5).toString().trim()); //Earning

                        HmapIncMasterListData.put(cursor.getString(0).toString().trim(), list_frstTbl);


                        cursor.moveToNext();
                    }


                }
            }

        } catch (Exception e) {
            System.out.println("EXception.." + e);
        } finally {
            if (cursor != null) {
                cursor.close();

            }

        }
        return HmapIncMasterListData;
    }


    public long savetblIncentiveMsgToDisplay(String MsgToDisplay, int flgBankDetailsToShow) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("MsgToDisplay", MsgToDisplay);
        initialValues.put("flgBankDetailsToShow", flgBankDetailsToShow);
        System.out.println("MSG..." + MsgToDisplay);
        return db.insert(DBHelper.TABLE_tblIncentiveMsgToDisplay_Define, null, initialValues);
    }

    public long savetblIncentiveMaster(int IncId, int OutputType, String IncentiveName, String flgAcheived, String Earning) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("IncId", IncId);
        initialValues.put("OutputType", OutputType);
        initialValues.put("IncentiveName", IncentiveName.trim());
        initialValues.put("flgAcheived", flgAcheived.trim());
        initialValues.put("Earning", Earning.trim());

        return db.insert(DBHelper.TABLE_tblIncentiveMaster, null, initialValues);
    }

    public void CreateDynamicTables(String Table_Name, String TableColumn[]) {
        db.execSQL("DROP TABLE IF EXISTS " + Table_Name);

        for (int i = 0; i < TableColumn.length; i++) {
            if (i == 0) {
                DBHelper.DATABASE_CREATE_TABLE_tblIncentiveDetailsData = "CREATE TABLE " + Table_Name + "(" + TableColumn[0] + " TEXT";
            } else {
                DBHelper.DATABASE_CREATE_TABLE_tblIncentiveDetailsData = DBHelper.DATABASE_CREATE_TABLE_tblIncentiveDetailsData + ", " + TableColumn[i] + " TEXT";
            }
        }
        DBHelper.DATABASE_CREATE_TABLE_tblIncentiveDetailsData = DBHelper.DATABASE_CREATE_TABLE_tblIncentiveDetailsData + " );";
        db.execSQL(DBHelper.DATABASE_CREATE_TABLE_tblIncentiveDetailsData);

        System.out.println("hi");

    }

    public void insertDynamicTables(String Table_Name, String[] TableColumn, String TableColumnValue[]) {
        ContentValues cv = new ContentValues();

        for (int i = 0; i < TableColumn.length; i++) {
            cv.put(TableColumn[i], TableColumnValue[i]);
        }

        db.insert(Table_Name, null, cv);
    }

    public void CreateDynamicTblIncPastDetails(String Table_Name, String TableColumn[]) {
        db.execSQL("DROP TABLE IF EXISTS " + Table_Name);

        for (int i = 0; i < TableColumn.length; i++) {
            if (i == 0) {
                DBHelper.DATABASE_CREATE_TABLE_tblIncentivePastDetailsData = "CREATE TABLE " + Table_Name + "(" + TableColumn[0] + " TEXT";
            } else {
                DBHelper.DATABASE_CREATE_TABLE_tblIncentivePastDetailsData = DBHelper.DATABASE_CREATE_TABLE_tblIncentivePastDetailsData + ", " + TableColumn[i] + " TEXT";
            }
        }
        DBHelper.DATABASE_CREATE_TABLE_tblIncentivePastDetailsData = DBHelper.DATABASE_CREATE_TABLE_tblIncentivePastDetailsData + " );";
        db.execSQL(DBHelper.DATABASE_CREATE_TABLE_tblIncentivePastDetailsData);

        System.out.println("hi");
    }

    public long savetblIncentiveDetailsColumnsDesc(int IncSlabId, String ReportColumnName, String DisplayColumnName) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("IncSlabId", IncSlabId);
        initialValues.put("ReportColumnName", ReportColumnName.trim());
        initialValues.put("DisplayColumnName", DisplayColumnName.trim());

        return db.insert(DBHelper.TABLE_tblIncentiveDetailsColumnsDesc, null, initialValues);
    }

    public long savetblIncentivePastDetailsColumnsDesc(int IncSlabId, String ReportColumnName, String DisplayColumnName, String Ordr) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("IncSlabId", IncSlabId);
        initialValues.put("ReportColumnName", ReportColumnName.trim());
        initialValues.put("DisplayColumnName", DisplayColumnName.trim());
        initialValues.put("Ordr", Ordr.trim());

        return db.insert(DBHelper.TABLE_tblIncentivePastDetailsColumnsDesc, null, initialValues);
    }


    public long savetblTotalEarning(String Total_Earning) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("Total_Earning", Total_Earning.trim());

        return db.insert(DBHelper.TABLE_tblTotalEarning, null, initialValues);
    }

    public long savetblIncentiveBankDetails(String LvlName, String Value) {
        ContentValues initialValues = new ContentValues();

        initialValues.put("LvlName", LvlName);
        initialValues.put("Value", Value);
        System.out.println("MSG..." + LvlName);
        return db.insert(DBHelper.TABLE_tblIncentiveBankDetails, null, initialValues);
    }

    public long savetblIncentiveSeondaryMaster(int IncSlabId, int IncId, int OutputType, String IncSlabName, String flgAcheived, String Earning) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("IncSlabId", IncSlabId);
        initialValues.put("IncId", IncId);
        initialValues.put("OutputType", OutputType);
        initialValues.put("IncSlabName", IncSlabName.trim());
        initialValues.put("flgAcheived", flgAcheived.trim());
        initialValues.put("Earning", Earning.trim());

        return db.insert(DBHelper.TABLE_tblIncentiveSecondaryMaster, null, initialValues);
    }

    public void updateSstat() {

        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", "5");

            int affected1 = db.update("tblRegistrationDetail", values, "Sstat=?", new String[]{"3"});
            //int affected2 = db.update("tblVRSCheckInPhotoDetail", values, "Sstat=?",new String[] { "3" });
        } catch (Exception ex) {
            // Log.e(TAG, ex.toString());
        }
    }

    public ArrayList fnGetStoreInfoFrom_StoreEdit_Table(String StoreID) {
        ArrayList arrayList = new ArrayList();
        Cursor cursor = null;

        try {
            cursor = db.rawQuery("SELECT StoreID, OwnerName, ContactNumber, StoreAddress, SalesPersonName, SalesPersonContact, Sstat,AddImageFlag,ReplaceImageFlag FROM  tblStoreEdit where StoreID='" + StoreID + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    arrayList.add(cursor.getString(0));
                    arrayList.add(cursor.getString(1));
                    arrayList.add(cursor.getString(2));
                    arrayList.add(cursor.getString(3));
                    arrayList.add(cursor.getString(4));
                    arrayList.add(cursor.getString(5));
                    arrayList.add(cursor.getInt(6));
                    arrayList.add(cursor.getInt(7));
                    arrayList.add(cursor.getInt(8));
                }
            }

        } catch (Exception e) {
            System.out.println(e);
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return arrayList;
        }
    }

    public LinkedHashMap<String, String> fnGetImageDataFrom_StoreEditImageTable(String StoreID) {
        LinkedHashMap<String, String> hashMapImages = new LinkedHashMap<String, String>();

        Cursor cursor = null;

        try {
            cursor = db.rawQuery("SELECT  ImageName, ImagePath FROM  tblStoreEditImages where StoreID='" + StoreID + "'", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hashMapImages.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println(e);
        } finally {
            if (cursor != null) {
                cursor.close();
            }

            return hashMapImages;
        }
    }

    public ArrayList fnGetStoreInfoFrom_StoreList_Table(String StoreID) {
        ArrayList arrayList = new ArrayList();


        Cursor cursor2 = null;
        try {
            cursor2 = db.rawQuery("SELECT StoreID, OwnerName, StoreContactNo, StoreAddress, ifnull(SalesPersonName,'NA'), ifnull(SalesPersonContact,'NA'), Sstat FROM  tblStoreList where StoreID ='" + StoreID + "'", null);
            if (cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    arrayList.add(cursor2.getString(0));
                    arrayList.add(cursor2.getString(1));
                    arrayList.add(cursor2.getString(2));
                    arrayList.add(cursor2.getString(3));
                    arrayList.add(cursor2.getString(4));
                    arrayList.add(cursor2.getString(5));
                    arrayList.add(cursor2.getInt(6));
                }
            }
        } catch (Exception e) {
            System.out.println(e);
        } finally {
            if (cursor2 != null) {
                cursor2.close();
            }
            return arrayList;
        }
    }

    public void insertStoreEditTable(String StoreID, String OwnerName, String ContactNumber, String StoreAddress, String SalesPersonName, String SalesPersonContact, int Sstat, int AddImageFlag, int ReplaceImageFlag) {
        // "create table tblMinDeliverQntty (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
        ContentValues values = new ContentValues();
        values.put("StoreID", StoreID);
        values.put("OwnerName", OwnerName);
        values.put("ContactNumber", ContactNumber);
        values.put("StoreAddress", StoreAddress);
        values.put("SalesPersonName", SalesPersonName);
        values.put("SalesPersonContact", SalesPersonContact);
        values.put("Sstat", Sstat);
        values.put("AddImageFlag", AddImageFlag);
        values.put("ReplaceImageFlag", ReplaceImageFlag);
        db.insert(DBHelper.DATABASE_TABLE_tblStoreEdit, null, values);
    }

    public void insertStoreEditImagesTable(String StoreID, String ImageName, String ImagePath, int Sstat) {
        // "create table tblMinDeliverQntty (PrdId text null,StoreID text null,QPBT text null,QPTaxAmount text null,MinDlvrQty int null,UOMID text null,Sstat text null);";
        ContentValues values = new ContentValues();
        values.put("StoreID", StoreID);
        values.put("ImageName", ImageName);
        values.put("ImagePath", ImagePath);
        values.put("Sstat", Sstat);
        db.insert(DBHelper.DATABASE_TABLE_tblStoreEditImages, null, values);
    }

    public void deleteStoreEditTable(String StoreID) {
        db.execSQL("DELETE FROM tblStoreEdit where StoreID='" + StoreID + "'");
        db.execSQL("DELETE FROM tblStoreEditImages where StoreID='" + StoreID + "'");
    }

    public void UpdateTableStoreEdit(int flag2set, String StoreID) {
        try {

            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);
            int affected1 = db.update("tblStoreEdit", values, "Sstat=? And StoreID='" + StoreID + "' ", new String[]{"3"});
            int affected2 = db.update("tblStoreEditImages", values, "Sstat=? And StoreID='" + StoreID + "'", new String[]{"3"});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }




    public String[] getAllStoreIdOfEditStoteImage() {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblStoreEditImages where Sstat=5 ", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                        cursor.moveToNext();
                    }
                }

            }

            return StoreName;
        } finally {
            if (cursor != null)
                cursor.close();
        }

    }


    public int getImageCountForStoreEdit(String StoreID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblStoreEditImages where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public String[] getImgsCountStoreEdit(String StoreID) {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT ImageName FROM tblStoreEditImages WHERE StoreID ='" + StoreID + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public String[] getImgsCountStoretblStoreImageDetail(String StoreID) {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT ImageName FROM tblStoreImageDetail WHERE StoreID ='" + StoreID + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public void updateStoreEditImages(String PhotoName) {

        try {
            System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);
            ////tableStoreSctnImage(StoreID text null,imageName text null,imagePath text null,ImageClicktime text null,flgSectionPic text null,Sstat integer null);";
            int affected3 = db.update("tblStoreEditImages", values, "ImageName=?", new String[]{PhotoName});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {

        }


    }


    public LinkedHashMap<String, String> fngetSubmittedSurvey() {

        Cursor cur = null;
        LinkedHashMap<String, String> hmapDistinctStates = new LinkedHashMap<>();
        try {
            cur = db.rawQuery("Select Distinct StoreID from tblSurveyData where Sstat='" + 4 + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapDistinctStates.put(cur.getString(0), cur.getString(0));
                        cur.moveToNext();
                    }
                }

            }

        } catch (SQLiteException e) {
            // TODO: handle exception
        } finally {
            if (cur != null) {
                cur.close();
            }

            return hmapDistinctStates;
        }
    }


    public String[] FetchStoreListAllRoute() {
        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;
        Cursor cursor = null;
        String StoreName[] = null;


        try {
            cursor = db.rawQuery("SELECT StoreID, StoreName FROM tblStoreList   ORDER BY DistanceNear", null);
            StoreName = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        StoreName[i] = (String) cursor.getString(ScodecolumnIndex) + "_" + (String) cursor.getString(SnamecolumnIndex);
                        cursor.moveToNext();
                    }

                }
            }
        } finally {
            if (cursor != null)
                cursor.close();
            return StoreName;
        }

    }


    public LinkedHashMap<String, String> fngettblOptionSurvey(String QstnID) {
        Cursor cur = null;
        LinkedHashMap<String, String> hmapDistinctStates = new LinkedHashMap<>();
        try {
            cur = db.rawQuery("Select Distinct OptionID,OptionText,flgaActive from tblOptionSurvey where QstnID='" + QstnID + "'", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapDistinctStates.put(cur.getString(0), cur.getString(1) + "^" + cur.getString(2));
                        cur.moveToNext();
                    }
                }

            }

        } catch (SQLiteException e) {
            // TODO: handle exception
        } finally {
            if (cur != null) {
                cur.close();
            }

            return hmapDistinctStates;
        }
    }

    public void deleteSurveyTables() {

        db.execSQL("DELETE FROM tblQuestionsSurvey");
        db.execSQL("DELETE FROM tblOptionSurvey");


    }

    public void fnsavetblOptionSurvey(String OptionID, String OptionText, String QstnID, String flgaActive) {

        ContentValues values = new ContentValues();
        values.put("OptionID", OptionID);
        values.put("OptionText", OptionText);
        values.put("QstnID", QstnID);
        values.put("flgaActive", flgaActive);


        db.insert(DBHelper.DATABASE_TABLE_tblOptionSurvey, null, values);

    }

    public void fnsavetblPDASummary(List<TblGetPDAStoreSummary> tblGetPDAStoreSummaries) {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_tblPDAStoreSummary);

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblPDAStoreSummary + " (StoreID, MonthlyTarget, VisitTarget, Achieved, Balance) VALUES (?, ?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblGetPDAStoreSummary tbl : tblGetPDAStoreSummaries) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindLong(2, tbl.getMonthly_target());
                stmt.bindLong(3, tbl.getVisit_target());
                stmt.bindLong(4, tbl.getAchieved());
                stmt.bindLong(5, tbl.getBalance());

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }

    public void fnSaveTblPDAStoreVisitHistory(List<TblGetPDAStoreVisitHistory> tblGetPDAStoreVisitHistoryList) {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_tblPDAStoreVisitHistory);

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblPDAStoreVisitHistory + " (StoreID, ContactedBy, LastCallVisit, OrderValue, OrderQty, OrderStatus) VALUES (?, ?, ?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblGetPDAStoreVisitHistory tbl : tblGetPDAStoreVisitHistoryList) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindString(2, tbl.getContactedBy());
                stmt.bindString(3, checkNullOrEmpty(tbl.getLastCallVisit(), "", "NA"));
                stmt.bindString(4, checkNullOrEmpty(tbl.getOrderValue(), "", "NA"));
                stmt.bindString(5, checkNullOrEmpty(tbl.getOrderQty(), "", "NA"));
                stmt.bindString(6, checkNullOrEmpty(tbl.getOrderStatus(), "", "NA"));

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException(DBHelper.DATABASE_TABLE_tblPDAStoreVisitHistory + " failed");
        } finally {
            db.endTransaction();
        }
    }

    public void fnSaveTblPDAStoreOrderHistory(List<TblGetPDAStoreOrderHistory> tblGetPDAStoreVisitHistoryList) {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_tblOrderHistory);

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblOrderHistory + " (StoreID, OrderID, flgOrderSource, InvDate, OrderValue, OrderQty) VALUES (?, ?, ?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblGetPDAStoreOrderHistory tbl : tblGetPDAStoreVisitHistoryList) {
                stmt.bindLong(1, tbl.getStoreID());
                stmt.bindLong(2, tbl.getOrderID());
                stmt.bindLong(3, tbl.getFlgOrderSource());
                stmt.bindString(4, checkNullOrEmpty(tbl.getInvDate(), "", "NA"));
                stmt.bindString(5, "" + tbl.getOrderValue());
                stmt.bindDouble(6, tbl.getOrderQty());

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException(DBHelper.DATABASE_TABLE_tblOrderHistory + " failed");
        } finally {
            db.endTransaction();
        }
    }

    public void fnSaveTblStoreTARSSummary(List<TblGetPDAStoreVisitHistory> tblGetPDAStoreVisitHistoryList) {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_tblStoreTARSSummary);

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblStoreTARSSummary + " (StoreID, ContactedBy, LastCallVisit, OrderValue, OrderQty, OrderStatus) VALUES (?, ?, ?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblGetPDAStoreVisitHistory tbl : tblGetPDAStoreVisitHistoryList) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindString(2, tbl.getContactedBy());
                stmt.bindString(3, checkNullOrEmpty(tbl.getLastCallVisit(), "", "NA"));
                stmt.bindString(4, checkNullOrEmpty(tbl.getOrderValue(), "", "NA"));
                stmt.bindString(5, checkNullOrEmpty(tbl.getOrderQty(), "", "NA"));
                stmt.bindString(6, checkNullOrEmpty(tbl.getOrderStatus(), "", "NA"));

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException(DBHelper.DATABASE_TABLE_tblStoreTARSSummary + " failed");
        } finally {
            db.endTransaction();
        }
    }

    public void fnSaveTblProductLevelData(List<TblProductLevelData> tblProductLevelData) {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_tblProductLevelData);

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblProductLevelData + " (StoreID, PrdNodeId, InvDate, OrderValue, OrderID, Qty) VALUES (?, ?, ?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblProductLevelData tbl : tblProductLevelData) {
                stmt.bindLong(1, tbl.getStoreID());
                stmt.bindLong(2, tbl.getPrdNodeId());
                stmt.bindString(3, checkNullOrEmpty(tbl.getInvDate(), "", "NA"));
                stmt.bindString(4, checkNullOrEmpty("" + tbl.getOrderValue(), "", "NA"));
                stmt.bindString(5, checkNullOrEmpty("" + tbl.getOrderID(), "", "NA"));
                stmt.bindString(6, checkNullOrEmpty("" + tbl.getQty(), "", "NA"));

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException(DBHelper.DATABASE_TABLE_tblProductLevelData + " failed");
        } finally {
            db.endTransaction();
        }
    }

    public void fnSaveTblPrdMstrTransactionUOMConfig(List<TblPrdMstrTransactionUOMConfig> tblPrdMstrTransactionUOMConfigList) {
        db.execSQL("DELETE FROM " + DBHelper.TABLE_tblPrdMstrTransactionUOMConfig);

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_tblPrdMstrTransactionUOMConfig
                    + " (NodeID, NodeType, BUOMID, flgDistOrder, flgDistInv, flgStoreCheck, flgRetailUnit, flgTransactionData) VALUES (?, ?, ?, ?, ?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblPrdMstrTransactionUOMConfig tbl : tblPrdMstrTransactionUOMConfigList) {
                stmt.bindLong(1, tbl.getNodeID());
                stmt.bindLong(2, tbl.getNodeType());
                stmt.bindLong(3, tbl.getBUOMID());
                stmt.bindLong(4, tbl.getFlgDistOrder());
                stmt.bindLong(5, tbl.getFlgDistInv());
                stmt.bindLong(6, tbl.getFlgStoreCheck());
                stmt.bindLong(7, tbl.getFlgRetailUnit());
                stmt.bindLong(8, tbl.getFlgTransactionData());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException(DBHelper.TABLE_tblPrdMstrTransactionUOMConfig + " failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }

    public ArrayList<TblProductLevelData> getPrdInvForStore(String storeID, String productID) {
        ArrayList<TblProductLevelData> tblGetPDAStoreVisitHistoryArrayList = new ArrayList<>();
        Cursor cur = null;
        //open();
        try {
            cur = db.rawQuery("Select * from " + DBHelper.DATABASE_TABLE_tblProductLevelData + " where StoreID = '" + storeID + "'" + " AND PrdNodeId = '" + productID + "'", null);//
            if (cur != null && cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i <= (cur.getCount() - 1); i++) {
                        TblProductLevelData productLevelData = new TblProductLevelData();
                        // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                        productLevelData.setStoreID(cur.getInt(cur.getColumnIndex("StoreID")));
                        productLevelData.setPrdNodeId(cur.getInt(cur.getColumnIndex("PrdNodeId")));
                        productLevelData.setInvDate(cur.getString(cur.getColumnIndex("InvDate")));
                        productLevelData.setOrderValue(cur.getDouble(cur.getColumnIndex("OrderValue")));

                        tblGetPDAStoreVisitHistoryArrayList.add(productLevelData);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception ex) {
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
        }
        return tblGetPDAStoreVisitHistoryArrayList;
    }

    public ArrayList<TblProductLevelData> getOrderInvForStore(String storeID, String orderId) {
        ArrayList<TblProductLevelData> tblGetPDAStoreVisitHistoryArrayList = new ArrayList<>();
        Cursor cur = null;
        //open();
        try {
            cur = db.rawQuery("Select *,tblProductListMaster.ProductShortName AS ProductShortName from " + DBHelper.DATABASE_TABLE_tblProductLevelData + " left outer join  tblProductListMaster on tblProductLevelData.PrdNodeId=tblProductListMaster.ProductID  where StoreID = '" + storeID + "'" + " AND OrderID = '" + orderId + "'", null);//
            if (cur != null && cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i <= (cur.getCount() - 1); i++) {
                        TblProductLevelData productLevelData = new TblProductLevelData();
                        // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                        productLevelData.setStoreID(cur.getInt(cur.getColumnIndex("StoreID")));
                        productLevelData.setPrdNodeId(cur.getInt(cur.getColumnIndex("PrdNodeId")));
                        productLevelData.setOrderID(cur.getInt(cur.getColumnIndex("OrderID")));
                        productLevelData.setQty(cur.getDouble(cur.getColumnIndex("Qty")));
                        productLevelData.setInvDate(cur.getString(cur.getColumnIndex("InvDate")));
                        productLevelData.setOrderValue(cur.getDouble(cur.getColumnIndex("OrderValue")));
                        productLevelData.setPrdName(cur.getString(cur.getColumnIndex("ProductShortName")));

                        tblGetPDAStoreVisitHistoryArrayList.add(productLevelData);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception ex) {
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
        }
        return tblGetPDAStoreVisitHistoryArrayList;
    }

    public StoreSummaryModel getStoreSummary(String storeID) {
        StoreSummaryModel storeSummaryModel = new StoreSummaryModel();//=null;
        Cursor cur = null;
        //open();
        try {
//            StoreTypeDesc
            cur = db.rawQuery("Select ifnull(StoreName,'NA'),ifnull(OwnerName,'NA'),ifnull(StoreContactNo,'NA'),ifnull(Distributor,'NA'),ifnull(StoreTypeDesc,'NA'),ifnull(StoreCode,'NA') from tblStoreList where StoreID = '" + storeID + "'", null);//
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                    storeSummaryModel.setStoreID(storeID);
                    storeSummaryModel.setStoreName(cur.getString(0));
                    storeSummaryModel.setOwnerName(cur.getString(1));
                    storeSummaryModel.setCustomerType(cur.getString(4));
                    storeSummaryModel.setStoreCode(cur.getString(5));
                    storeSummaryModel.setDistributor(cur.getString(3));

                    storeSummaryModel.setStoreTargetModel(getStoreTarget(storeID));

                    storeSummaryModel.setStoreVisitHistoryArrayList(getStoreVisitHistory(storeID));
                    storeSummaryModel.setTcOrdersArrayList(getStoreTCOrders(storeID));
                }
            }
        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
        }
        return storeSummaryModel;
    }

    public TblGetPDAStoreSummary getStoreTarget(String storeID) {
        TblGetPDAStoreSummary tblGetPDAStoreSummary = new TblGetPDAStoreSummary();
        Cursor cur = null;
        //open();
        try {
            cur = db.rawQuery("Select * from " + DBHelper.DATABASE_TABLE_tblPDAStoreSummary + " where StoreID = '" + storeID + "'", null);//
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                    tblGetPDAStoreSummary.setStoreID(storeID);
                    tblGetPDAStoreSummary.setMonthly_target(cur.getInt(cur.getColumnIndex("MonthlyTarget")));
                    tblGetPDAStoreSummary.setVisit_target(cur.getInt(cur.getColumnIndex("VisitTarget")));
                    tblGetPDAStoreSummary.setAchieved(cur.getInt(cur.getColumnIndex("Achieved")));
                    tblGetPDAStoreSummary.setBalance(cur.getInt(cur.getColumnIndex("Balance")));
                }
            }
        } catch (Exception ex) {
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
        }
        return tblGetPDAStoreSummary;
    }

    public ArrayList<TblGetPDAStoreVisitHistory> getStoreVisitHistory(String storeID) {
        ArrayList<TblGetPDAStoreVisitHistory> tblGetPDAStoreVisitHistoryArrayList = new ArrayList<>();
        Cursor cur = null;
        //open();
        try {
            cur = db.rawQuery("Select * from " + DBHelper.DATABASE_TABLE_tblPDAStoreVisitHistory + " where StoreID = '" + storeID + "'", null);//
            if (cur != null && cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i <= (cur.getCount() - 1); i++) {
                        TblGetPDAStoreVisitHistory visitHistory = new TblGetPDAStoreVisitHistory();
                        // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                        visitHistory.setStoreID(storeID);
                        visitHistory.setContactedBy(cur.getString(cur.getColumnIndex("ContactedBy")));
                        visitHistory.setLastCallVisit(cur.getString(cur.getColumnIndex("LastCallVisit")));
                        visitHistory.setOrderQty(cur.getString(cur.getColumnIndex("OrderQty")));
                        visitHistory.setOrderValue(cur.getString(cur.getColumnIndex("OrderValue")));
                        visitHistory.setOrderStatus(cur.getString(cur.getColumnIndex("OrderStatus")));
                        visitHistory.setFlgSectinType(1);
                        tblGetPDAStoreVisitHistoryArrayList.add(visitHistory);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception ex) {
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
        }
        return tblGetPDAStoreVisitHistoryArrayList;
    }

    public ArrayList<TblGetPDAStoreOrderHistory> getStoreOrderHistory(String storeID) {
        ArrayList<TblGetPDAStoreOrderHistory> tblGetPDAStoreOrderHistoryArrayList = new ArrayList<>();
        Cursor cur = null;
        //open();
        try {
            cur = db.rawQuery("Select * from " + DBHelper.DATABASE_TABLE_tblOrderHistory + " where StoreID = '" + storeID + "' ORDER BY InvDate DESC", null);//
            if (cur != null && cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        TblGetPDAStoreOrderHistory orderHistory = new TblGetPDAStoreOrderHistory();
                        orderHistory.setStoreID(cur.getInt(cur.getColumnIndex("StoreID")));
                        orderHistory.setOrderID(cur.getInt(cur.getColumnIndex("OrderID")));
                        orderHistory.setInvDate(cur.getString(cur.getColumnIndex("InvDate")));
                        orderHistory.setFlgOrderSource(cur.getInt(cur.getColumnIndex("flgOrderSource")));
                        orderHistory.setOrderQty(cur.getDouble(cur.getColumnIndex("OrderQty")));
                        orderHistory.setOrderValue(cur.getString(cur.getColumnIndex("OrderValue")));

                        tblGetPDAStoreOrderHistoryArrayList.add(orderHistory);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception ex) {
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
        }
        return tblGetPDAStoreOrderHistoryArrayList;
    }

    public ArrayList<TblGetPDAStoreVisitHistory> getStoreTCOrders(String storeID) {
        ArrayList<TblGetPDAStoreVisitHistory> tblGetPDAStoreVisitHistoryArrayList = new ArrayList<>();
        Cursor cur = null;
        //open();
        try {
            cur = db.rawQuery("Select * from " + DBHelper.DATABASE_TABLE_tblStoreTARSSummary + " where StoreID = '" + storeID + "'", null);//
            if (cur != null && cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i <= (cur.getCount() - 1); i++) {
                        TblGetPDAStoreVisitHistory visitHistory = new TblGetPDAStoreVisitHistory();
                        // System.out.println("System Value :"+cur.getString(0)+"="+ cur.getString(1)+"~"+cur.getString(2));
                        visitHistory.setStoreID(storeID);
                        visitHistory.setContactedBy(cur.getString(cur.getColumnIndex("ContactedBy")));
                        visitHistory.setLastCallVisit(cur.getString(cur.getColumnIndex("LastCallVisit")));
                        visitHistory.setOrderValue(cur.getString(cur.getColumnIndex("OrderValue")));
                        visitHistory.setOrderQty(cur.getString(cur.getColumnIndex("OrderQty")));
                        visitHistory.setOrderStatus(cur.getString(cur.getColumnIndex("OrderStatus")));
                        visitHistory.setFlgSectinType(2);
                        tblGetPDAStoreVisitHistoryArrayList.add(visitHistory);
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception ex) {
        } finally {
            if (cur != null) {
                cur.close();
            }
            //close();
        }
        return tblGetPDAStoreVisitHistoryArrayList;
    }

    public void deletetblSurveyData(String StoreID) {
        db.execSQL("DELETE FROM tblSurveyData where StoreID='" + StoreID + "'");
    }

    public void fnsavetblQuestionsSurvey(String QstnID, String QstnText, String flgActive, String flgOrder) {

        ContentValues values = new ContentValues();
        values.put("QstnID", QstnID);
        values.put("QstnText", QstnText);
        values.put("flgActive", flgActive);
        values.put("flgOrder", flgOrder);
        db.insert(DBHelper.DATABASE_TABLE_tblQuestionsSurvey, null, values);

    }

    public LinkedHashMap<String, String> fngettblQuestionsSurvey() {

        Cursor cur = null;
        LinkedHashMap<String, String> hmapDistinctStates = new LinkedHashMap<>();
        try {
            cur = db.rawQuery("Select Distinct QstnID,QstnText,flgActive from tblQuestionsSurvey Order BY flgOrder", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapDistinctStates.put(cur.getString(0), cur.getString(1) + "^" + cur.getString(2));
                        cur.moveToNext();
                    }
                }

            }

        } catch (SQLiteException e) {
            // TODO: handle exception
        } finally {
            if (cur != null) {
                cur.close();
            }
            return hmapDistinctStates;
        }
    }

    public void fnsavetblSurveyData(String StoreID, String QstnID, String OptionID, String OptionText, String DateTime, int Sstat, String Latitude, String Longitude, String Accuracy) {

        ContentValues values = new ContentValues();
        values.put("StoreID", StoreID);
        values.put("QstnID", QstnID);
        values.put("OptionID", OptionID);
        values.put("OptionText", OptionText);
        values.put("DateTime", DateTime);
        values.put("Latitude", Latitude);
        values.put("Longitude", Longitude);
        values.put("Accuracy", Accuracy);
        values.put("Sstat", Sstat);


        db.insert(DBHelper.DATABASE_TABLE_tblSurveyData, null, values);

    }

    public void UpdateSstatSurvey(String StoreID) {

        try {

            db.execSQL("UPDATE tblSurveyData SET Sstat= 4 where StoreID='" + StoreID + "' ");


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {

        }

    }

    public void deletetblNotificationMstrOneRow(int SerialNo) {

        db.execSQL("DELETE FROM tblNotificationMstr WHERE SerialNo =" + SerialNo);
        for (int i = 0; i < 9; i++) {
            final ContentValues values = new ContentValues();
            values.put("SerialNo", i + 1);

            int affected = db.update(DBHelper.TABLE_tblPDANotificationMaster_Define, values, "SerialNo=?", new String[]{"" + (i + 2)});

        }

    }

    public int countNoRowIntblNotificationMstr() {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM tblPDANotificationMaster", null);
        int chkI = 0;
        try {
            // // System.out.println("Sunil LastNitificationrList cursorE2.getCount() SerialNo : "+cursorE2.getCount());

            if (cursorE2.getCount() > 0) {
                cursorE2.moveToFirst();
                // // System.out.println("Sunil LastNitificationrList cursorE2.getCount() SerialNo value : "+cursorE2.getString(0).toString());

                chkI = Integer.parseInt(cursorE2.getString(0).toString());
            }


        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public void inserttblRouteChangeListMstr(String ReasonID, String ReasonDescr) {

        ContentValues values = new ContentValues();
        values.put("ReasonID", ReasonID);
        values.put("ReasonDescr", ReasonDescr);

        db.insert(DBHelper.DATABASE_TABLE_RouteChangeListMstr, null, values);
    }

    public LinkedHashMap<String, String> fnGettblRouteChangeListMstr() {
        LinkedHashMap<String, String> hmapRouteChangeListMstr = new LinkedHashMap<String, String>();

        try {
            Cursor cursor = db.rawQuery("SELECT ReasonID,ReasonDescr from tblRouteChangeListMstr  Order by ReasonDescr Asc ", null);
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapRouteChangeListMstr.put(cursor.getString(1), cursor.getString(0));
                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error fnGettblRouteChangeListMstr= " + e.toString());
        } finally {
            return hmapRouteChangeListMstr;
        }
    }

    public void deletetblRouteChangeListMstr() {

        db.execSQL("DELETE FROM tblRouteChangeListMstr");
    }

    public void fnInsertOrUpdate_tblRouteChangeListDeatils(String RouteID, String ReasonID, String ReasonDescr, String OtherComments, String ForDate, String SelectionDateTime, int Sstat) {
        Cursor cursor = null;
        try {
            cursor = db.rawQuery("SELECT RouteID FROM " + DBHelper.DATABASE_TABLE_RouteChangeListDetails + " where RouteID='" + RouteID + "'", null);
            ContentValues initialValues = new ContentValues();
            initialValues.put("RouteID", RouteID);
            initialValues.put("ReasonID", ReasonID);
            initialValues.put("ReasonDescr", ReasonDescr);
            initialValues.put("OtherComments", OtherComments);
            initialValues.put("Sstat", Sstat);

            if (cursor != null && cursor.getCount() > 0) {
                int affected = db.update(DBHelper.DATABASE_TABLE_RouteChangeListDetails, initialValues, "RouteID=?", new String[]{RouteID});
            } else {
                initialValues.put("ForDate", ForDate);
                initialValues.put("SelectionDateTime", SelectionDateTime);

                db.insert(DBHelper.DATABASE_TABLE_RouteChangeListDetails, null, initialValues);
            }
        } catch (Exception ex) {
            System.out.println("Error fnInsertOrUpdate_tblRouteChangeListDeatils= " + ex.toString());
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
    }

    public int countChangedRouteResonPresentOrNot(String RouteID) {
        Cursor cursorE2 = db.rawQuery("SELECT COUNT(*) FROM " + DBHelper.DATABASE_TABLE_RouteChangeListDetails + " Where RouteID='" + RouteID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.moveToFirst()) {

                if (cursorE2.getInt(0) > 0) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } catch (Exception ex) {
            System.out.println("Error countChangedRouteResonPresentOrNot= " + ex.toString());
        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        return chkI;
    }


    public ArrayList<String> Fetch_tblRouteChangeListDeatilsAgainstRouteID(String RouteID) {
        //open();
        ArrayList<String> arrDetailsChangeRoute = new ArrayList<String>();
        Cursor cursor = null;
        try {
            cursor = db.rawQuery("SELECT ReasonID,ReasonDescr,ifnull(OtherComments,'')  FROM " + DBHelper.DATABASE_TABLE_RouteChangeListDetails + " Where RouteID='" + RouteID + "'", null);

            String RankOutletName = null;//[] = new String[cursor.getCount()];

            if (cursor != null && cursor.getCount() > 0) {
                cursor.moveToFirst();
                arrDetailsChangeRoute.add((String) cursor.getString(0).toString());
                arrDetailsChangeRoute.add((String) cursor.getString(1).toString());
                arrDetailsChangeRoute.add((String) cursor.getString(2).toString());
                /*RankOutletName = (String) cursor.getString(0).toString()+ "_"
                        + (String) cursor.getString(1).toString();*/


            }

        } catch (Exception ex) {
            System.out.println("Error countChangedRouteResonPresentOrNot= " + ex.toString());
        } finally {
            if (cursor != null)
                cursor.close();
            //close();
        }
        return arrDetailsChangeRoute;
    }


    public HashMap<String, String> fnGetProductRateDuringPurchaseList(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                cursor = db.rawQuery("SELECT ProdID,ProductPrice FROM tblTmpInvoiceDetailsLocalOrder WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    cursor = db.rawQuery("SELECT ProdID,ProductPrice From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                } else {
                    cursor = db.rawQuery("SELECT ProdID,ProductPrice From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                    //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
                }
                // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
            } else {
                cursor = db.rawQuery("SELECT ProdID,ProductPrice From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
            }
        } else {
            cursor = db.rawQuery("SELECT ProdID,ProductPrice From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }

    public HashMap<String, String> FetchStoreStatusVisitedOfNewStore(String rID) {

        int ScodecolumnIndex = 0;
        HashMap<String, String> hmapstoreVisitStatus = new HashMap<String, String>();
        //Cursor cursor = db.rawQuery("SELECT Sstat,ISNewStore FROM tblStoreList ORDER BY DistanceNear", null);
        Cursor cursor = db.rawQuery("SELECT tblStoreVisitMstr.StoreID, tblStoreList.ISNewStore FROM tblStoreList inner join tblStoreVisitMstr  On tblStoreVisitMstr.StoreID=tblStoreList.StoreID  where  tblStoreList.ISNewStore=1   ORDER BY DistanceNear", null);//StoreRouteID='"+ rID +"' and

        try {


            if (cursor != null && cursor.getCount() > 0 && cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    hmapstoreVisitStatus.put(cursor.getString(ScodecolumnIndex).toString(), cursor.getString(1).toString());
                    cursor.moveToNext();
                }
            }
            return hmapstoreVisitStatus;
        } finally {
            if (cursor != null)
                cursor.close();
        }
    }

    public LinkedHashMap<String, String> fnGetALLOutletsWithSameNameFromMstr(String StoreNameToBeAdded) {
        Cursor cursor = null;

        LinkedHashMap<String, String> hmapOutletMstr = new LinkedHashMap<String, String>();
        cursor = db.rawQuery("SELECT StoreID,CASE WHEN StoreLatitude  is null THEN '0'  ELSE StoreLatitude END AS Lat,CASE WHEN StoreLongitude  is null THEN '0'  ELSE StoreLongitude END AS Lon,StoreName from tblStoreList", null);// where LOWER("+AESUtils.decrypt(DBHelper.TABLE_STORELISTMASTER+"."+DBHelper.STORENAME)+")='"+StoreNameToBeAdded.toLowerCase().trim()+"'"
        String stName = "";
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    String phoneNum;
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //AESUtils.decrypt(
                        String lat = "0";
                        String lon = "0";
                        stName = "NA";
                        String stID = "0";
                        if (!cursor.getString(3).equals("NA")) {
                            stName = cursor.getString(3);
                            stName = stName.toLowerCase();
                        }
                        if (!cursor.getString(0).equals("0")) {
                            stID = cursor.getString(0);
                        }

                        if (!cursor.getString(1).equals("0")) {
                            lat = cursor.getString(1);
                        }

                        if (!cursor.getString(2).equals("0")) {
                            lon = cursor.getString(2);
                        }

                        if (stName.equals(StoreNameToBeAdded)) {
                            hmapOutletMstr.put(stID, lat + "^" + lon);

                        }


                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception ex) {
            String snameforPrint = stName;
            String exs = ex.getMessage();
            ex.printStackTrace();
        } finally {
            if (cursor != null)
                cursor.close();
        }


        return hmapOutletMstr;
        //  }


        //close();

    }

    public LinkedHashMap<String, String> fnGetALLOutletsWithSameGSTFromMstr(String StoreNameToBeAdded) {
        Cursor cursor = null;

        LinkedHashMap<String, String> hmapOutletMstr = new LinkedHashMap<String, String>();
        cursor = db.rawQuery("SELECT StoreID,CASE WHEN GSTNumber  is null THEN '0'  ELSE GSTNumber END AS GSTNumber,StoreName from tblFarmer", null);// where LOWER("+AESUtils.decrypt(DBHelper.TABLE_STORELISTMASTER+"."+DBHelper.STORENAME)+")='"+StoreNameToBeAdded.toLowerCase().trim()+"'"
        String stName = "";
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    String phoneNum;
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //AESUtils.decrypt(
                        String lat = "0";

                        stName = "NA";
                        String stID = "0";
                        if (!cursor.getString(2).equals("NA")) {
                            stName = cursor.getString(2);
                            stName = stName.toLowerCase();
                        }
                        if (!cursor.getString(0).equals("0")) {
                            stID = cursor.getString(0);
                        }

                        if (!cursor.getString(1).equals("0")) {
                            lat = cursor.getString(1);
                        }


                        if (stName.equals(StoreNameToBeAdded)) {
                            hmapOutletMstr.put(stID, lat);

                        }


                        cursor.moveToNext();
                    }
                }
            }
        } catch (Exception ex) {
            String snameforPrint = stName;
            String exs = ex.getMessage();
            ex.printStackTrace();
        } finally {
            if (cursor != null)
                cursor.close();
        }


        return hmapOutletMstr;
        //  }


        //close();

    }

    public int fnGetExistingOutletIDFromStoreMstr(String ODescr, String ContactNumber) {
        int existOutID = 0;
        //open();
        // Cursor cursor = db.rawQuery("SELECT Count(StoreID)  from tblStoreList where LOWER(StoreName) ='"+ODescr.toLowerCase().trim()+"' AND StoreContactNo='"+ContactNumber+"'", null);
        // Cursor cursor = db.rawQuery("SELECT Count("+DBHelper.STOREID+"),"+DBHelper.STORENAME+"  from "+DBHelper.TABLE_STORELISTMASTER+"", null);// where LOWER("+AESUtils.decrypt(DBHelper.STORENAME)+") ='"+ODescr.toLowerCase().trim()+"'"
        Cursor cursor = db.rawQuery("SELECT StoreID,StoreName  from tblStoreList", null);// where LOWER("+AESUtils.decrypt(DBHelper.STORENAME)+") ='"+ODescr.toLowerCase().trim()+"'"
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //AESUtils.decrypt(
                        String stName = "NA";

                        if (!cursor.getString(1).equals("NA")) {
                            stName = cursor.getString(1);
                            stName = stName.toLowerCase();
                        }

                        if (stName.equals(ODescr.toLowerCase())) {
                            existOutID = 1;

                            break;
                        }


                        cursor.moveToNext();
                    }


                }
            }
            return existOutID;
        } finally {
            if (cursor != null)
                cursor.close();
            // close();
        }
    }

    public String fnGetExistingRouteNameWithSameNameFromStoreMstr(String ODescr, String ContactNumber) {
        String existOutID = "NA";
        //open();
        // Cursor cursor = db.rawQuery("SELECT Count(StoreID)  from tblStoreList where LOWER(StoreName) ='"+ODescr.toLowerCase().trim()+"' AND StoreContactNo='"+ContactNumber+"'", null);
        Cursor cursor = db.rawQuery("SELECT tblRouteListMaster.Descr,tblStoreList.StoreName  from tblRouteListMaster inner join tblStoreList on tblRouteListMaster.ID=tblStoreList.StoreRouteID", null);// where AND StoreContactNo='"+ContactNumber+"'// where LOWER("+AESUtils.decrypt(DBHelper.TABLE_STORELISTMASTER+"."+DBHelper.STORENAME)+") ='"+ODescr.toLowerCase().trim()+"' Limit 1
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    //  existOutID=cursor.getString(0).toString();

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //AESUtils.decrypt(
                        String stName = "NA";

                        if (!cursor.getString(1).equals("NA")) {
                            stName = cursor.getString(1);
                            stName = stName.toLowerCase();
                        }

                        if (stName.equals(ODescr.toLowerCase())) {
                            existOutID = cursor.getString(0);

                            break;
                        }


                        cursor.moveToNext();
                    }


                }
            }
            return existOutID;
        } finally {
            if (cursor != null)
                cursor.close();
            // close();
        }
    }

    public int fnGetExistingMobileNoOutletIDFromStoreMstr(String ContactNumber) {
        int existOutID = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT StoreID,StoreContactNo  from tblStoreList", null);// where "+AESUtils.decrypt(DBHelper.MobileNumber)+" ='"+ContactNumber.trim()+"'
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                  /*  if(cursor.getInt(0)>0)
                    {
                        existOutID=1;
                    }*/

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //AESUtils.decrypt(
                        String stContact = "0";

                        if (cursor.getString(1) != null && cursor.getString(1).length() > 2 && !cursor.getString(1).equals("0")) {
                            stContact = cursor.getString(1);

                        }

                        if (stContact.trim().equals(ContactNumber.trim())) {
                            existOutID = 1;

                            break;
                        }


                        cursor.moveToNext();
                    }

                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null)
                cursor.close();
            // close();
        }
        return existOutID;
    }

    public String fnGetOutletnamewthMobileNo(String ContactNumber) {
        String existOut = "0";
        //open();
        Cursor cursor = db.rawQuery("SELECT StoreName,StoreContactNo  from tblStoreList where ifnull(StoreContactNo,'0') ='" + ContactNumber.trim() + "'", null);// where "+AESUtils.decrypt(DBHelper.MobileNumber)+" ='"+ContactNumber.trim()+"' Limit 1
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    //  existOut=cursor.getString(0);
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //AESUtils.decrypt(
                        String stContact = "0";
                        String stName = "NA";
                        if (cursor.getString(1) != null && !cursor.getString(1).equals("NA")) {
                            stContact = cursor.getString(1);

                        }

                        if (stContact.trim().equals(ContactNumber.trim())) {

                            stName = cursor.getString(0);
                            existOut = stName;


                            break;

                        }


                        cursor.moveToNext();
                    }

                }
            }
            return existOut;
        } finally {
            if (cursor != null)
                cursor.close();
            // close();
        }
    }

    public int fnCheckForAnyPendingData(ArrayList<String> tblNames) {
        //open();
        int chkI = 0;
        Cursor cursorE2 = null;
        for (int i = 0; i < tblNames.size(); i++) {
            try {
                cursorE2 = db.rawQuery("SELECT COUNT(*) FROM " + tblNames.get(i) + " WHERE Sstat ='3'", null);
                if (cursorE2 != null && cursorE2.moveToFirst()) {

                    if (cursorE2.getInt(0) > 0) {
                        chkI = 1;
                        break;
                    } else {
                        chkI = 0;

                    }
                }
            } catch (Exception ex) {

            } finally {
                if (cursorE2 != null)
                    cursorE2.close();


            }
        }

        //close();
        return chkI;
    }

    public void fnupdateTodayAttenDateTime(String TodayAttenDateTime) {

        try {


            final ContentValues values = new ContentValues();
            values.put("AttenDatetime", TodayAttenDateTime);

            int affected = db.update(DBHelper.TABLE_tblUserAuthenticationMstr_Define, values, null,
                    null);


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }


    public HashMap<String, String> FetchStoreStatusClosed(String rID) {

        int ScodecolumnIndex = 0;
        HashMap<String, String> hmapstoreVisitStatus = new HashMap<String, String>();
        //Cursor cursor = db.rawQuery("SELECT Sstat,ISNewStore FROM tblStoreList ORDER BY DistanceNear", null);
        Cursor cursor = db.rawQuery("SELECT tblStoreVisitMstr.StoreID, ifnull(tblStoreVisitMstr.StoreClose,0) AS StoreClose FROM tblStoreVisitMstr", null);

        try {


            if (cursor != null && cursor.getCount() > 0 && cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    hmapstoreVisitStatus.put(cursor.getString(ScodecolumnIndex).toString(), cursor.getString(1).toString());
                    cursor.moveToNext();
                }
            }
            return hmapstoreVisitStatus;
        } finally {
            if (cursor != null)
                cursor.close();
        }
    }

    public void UpdatetblExecutionInvoicesTables(int flag2set) {

        final ContentValues values = new ContentValues();
        values.put("Sstat", flag2set);


        int affected1 = db.update("tblInvoiceButtonTransac", values, "Sstat=?",
                new String[]{"7"});

        int affected2 = db.update("tblPendingInvoices", values, "Sstat=?",
                new String[]{"7"});

        int affected3 = db.update("tblInvoiceButtonTransac", values, "Sstat=?",
                new String[]{"9"});

        int affected4 = db.update("tblPendingInvoices", values, "Sstat=?",
                new String[]{"9"});
        int affected5 = db.update("tblInvoiceButtonTransac", values, "Sstat=?",
                new String[]{"3"});

        int affected6 = db.update("tblPendingInvoices", values, "Sstat=?",
                new String[]{"3"});

    }

    public LinkedHashMap<String, String> fnGeStoreListForAddNewStorePage(int DistanceRange, int value) {
        LinkedHashMap<String, String> hmapStoreListWithNearByDistanceRange = new LinkedHashMap<String, String>();
        String ForDate = fnGetDateTimeString();
        //open();
        Cursor cursor = null;
        try {
            if (value == 0) {
                cursor = db.rawQuery("SELECT StoreID,StoreName,StoreLatitude,StoreLongitude,DistanceNear,tblRouteListMaster.Descr from tblStoreList inner join  tblRouteListMaster on tblStoreList.StoreRouteID=tblRouteListMaster.ID  WHERE (StoreLatitude<>'0' AND StoreLatitude<>'NA')   ORDER BY DistanceNear", null);
            } else {
                cursor = db.rawQuery("SELECT StoreID,StoreName,StoreLatitude,StoreLongitude,DistanceNear,tblRouteListMaster.Descr from tblStoreList inner join  tblRouteListMaster on tblStoreList.StoreRouteID=tblRouteListMaster.ID   WHERE (StoreLatitude<>'0' AND StoreLatitude<>'NA' ) AND DistanceNear<=" + DistanceRange + "   ORDER BY DistanceNear", null);
            }
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        String StoreName = null;
                        String StoreLat = "0.00";
                        String StoreLon = "0.00";
                        if (!cursor.getString(2).equals("NA")) {
                            StoreName = cursor.getString(1);
                            StoreLat = cursor.getString(2);
                            StoreLon = cursor.getString(3);
                        }

                        hmapStoreListWithNearByDistanceRange.put(cursor.getString(0), StoreName + "^" + StoreLat + "^" + StoreLon + "^" + ForDate + "^" + cursor.getString(4) + "^" + cursor.getString(5));

                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            System.out.println("Error fnGettblUOMMstr= " + e.toString());
        } finally {

            // close();
            if (cursor != null) {
                cursor.close();
            }
            // fnGeNewlyAddedStoreList(hmapQuestionMstr);
            return hmapStoreListWithNearByDistanceRange;
        }
    }

    public LinkedHashMap<String, String> fetch_StoreWiseOrderValue() {

        LinkedHashMap<String, String> hmapCatgry = new LinkedHashMap<String, String>();


        Cursor cursor = db.rawQuery("SELECT tblStoreList.StoreID, tblStoreList.StoreName, IFNULL(tblInvoiceHeader.InvoiceVal,0) FROM tblStoreList left outer join tblInvoiceHeader on tblStoreList.StoreID=tblInvoiceHeader.StoreID", null); //order by AutoIdOutlet Desc

        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //hmapCatgry.put(cursor.getString(0).toString(),cursor.getString(1).toString() + "( Order Value:-"+cursor.getString(2).toString()+")");
                        hmapCatgry.put(cursor.getString(0).toString(), cursor.getString(2).toString());

                        cursor.moveToNext();
                    }
                }

            } else {
                hmapCatgry.put("No Store", "0");
            }
            return hmapCatgry;
        } finally {
            if (cursor != null)
                cursor.close();

        }
    }


    public void fnUpdateFlgCloseCallIDComment(int CloseCallID, String closeCallComment, String StoreID, String StoreVisitCode) {
        final ContentValues values = new ContentValues();
        values.put("CloseCallID", CloseCallID);
        values.put("closeCallComment", closeCallComment);

        int affected = db.update(DBHelper.DATABASE_TABLE_STOREVISIT, values, "StoreID=? and StoreVisitCode=?",
                new String[]{StoreID, StoreVisitCode});
        Log.w(TAG, "fnUpdateFlgCloseCallIDComment Updated..");

    }


    public void fnUpdateFlgOrderComment(String OrderComments, String StoreID, String StoreVisitCode) {
        final ContentValues values = new ContentValues();
        values.put("OrderComments", OrderComments);

        int affected = db.update(DBHelper.DATABASE_TABLE_STOREVISIT, values, "StoreID=? and StoreVisitCode=?",
                new String[]{StoreID, StoreVisitCode});
        Log.w(TAG, "fnUpdateFlgOrderComment Updated..");

    }


    public int fnGetFlgCloseCallID(String StoreID, String StoreVisitCode) {
        Cursor cursorE2 = db.rawQuery("SELECT ifnull(CloseCallID,0) from tblStoreVisitMstr where StoreID='" + StoreID + "' and StoreVisitCode='" + StoreVisitCode + "'", null);
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.moveToFirst()) {
                chkI = cursorE2.getInt(0);
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String fnGetOrderComments(String StoreID, String StoreVisitCode) {
        Cursor cursorE2 = db.rawQuery("SELECT ifnull(OrderComments,'NA') from tblStoreVisitMstr where StoreID='" + StoreID + "' and StoreVisitCode='" + StoreVisitCode + "'", null);
        String chkI = "NA";
        try {
            if (cursorE2 != null && cursorE2.moveToFirst()) {
                chkI = cursorE2.getString(0);
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }

    public String fnGetFlgCloseCallComments(String StoreID, String StoreVisitCode) {
        Cursor cursorE2 = db.rawQuery("SELECT ifnull(closeCallComment,'NA') from tblStoreVisitMstr where StoreID='" + StoreID + "' and StoreVisitCode='" + StoreVisitCode + "'", null);
        String chkI = "NA";
        try {
            if (cursorE2 != null && cursorE2.moveToFirst()) {
                chkI = cursorE2.getString(0);
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }


    public String fnGetFlgOrderComments(String StoreID, String StoreVisitCode) {
        Cursor cursorE2 = db.rawQuery("SELECT ifnull(OrderComments,'NA') from tblStoreVisitMstr where StoreID='" + StoreID + "' and StoreVisitCode='" + StoreVisitCode + "'", null);
        String chkI = "NA";
        try {
            if (cursorE2 != null && cursorE2.moveToFirst()) {
                chkI = cursorE2.getString(0);
            }

        } finally {
            cursorE2.close();
        }
        return chkI;
    }


    public Boolean fncheckAnyStoresWithSstat4() {
        //open();
        Boolean isFlg = false;
        Cursor cur = null;
        try {
            cur = db.rawQuery("Select * from tblStoreList where Sstat=4", null);
            if (cur != null && cur.getCount() > 0) {
                isFlg = true;
            }
        } catch (SQLiteException exception) {
            exception.printStackTrace();
        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
            return isFlg;
        }
    }


    public String[] FetchStoreListWithSstat4() {
        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;


        Cursor cursor = db.rawQuery("SELECT StoreID, StoreName  AS StoreName,ifnull(StoreContactNo,'NA') FROM tblStoreList where Sstat=4  ORDER BY DistanceNear", null); //where StoreRouteID='"+ rID +"'//|| '('||OwnerName ||' : '||StoreContactNo||')'

        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    int closedStatus = getStoreClosedStatus(cursor.getString(ScodecolumnIndex));
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString() + "_" + (String) cursor.getString(SnamecolumnIndex).toString() + "_" + closedStatus + "_" + cursor.getString(2);
                    cursor.moveToNext();
                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }
    }


    public String[] FetchStoreRouteIdTypeWithSstat4() {
        int ScodecolumnIndex = 0;
        int SnamecolumnIndex = 1;

        Cursor cursor = db.rawQuery("SELECT StoreRouteID, RouteNodeType FROM tblStoreList where Sstat=4   ORDER BY DistanceNear", null);
        try {
            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString() + "_" + (String) cursor.getString(SnamecolumnIndex).toString();
                    cursor.moveToNext();
                }

            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }

    public String getStateName(int CityID) {
        String stateID = "";
        Cursor cursor = db.rawQuery("SELECT State from tblStateCityMaster WHERE  CityID='" + CityID + "'", null);
        try {
            if (cursor != null && cursor.getCount() > 0) {
                cursor.moveToFirst();
                stateID = cursor.getString(0);

            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
        return stateID;
    }

    public List<TblStoreListMaster> getStoreListDetails(String StoreID) {
        Cursor cursor = db.rawQuery("SELECT  StoreName,StoreLatitude,StoreLongitude, OwnerName, StoreContactNo, ifnull(StoreAddress,''), ifnull(StoreCity,''), ifnull(StorePinCode,''), ifnull(StoreState,'')," +
                "flgLocationEdit, StoreCityID, WhatsappNumber, ifnull(EmailID,'') AS EmailID,Landline,GSTNumber,StoreRouteID,ifnull(flgGSTCapture,0)   from tblStoreList WHERE StoreID ='" + StoreID + "'", null);// where Sstat in(1,3,4,5)
        List<TblStoreListMaster> tblStoreListMasters = new ArrayList<>();
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    TblStoreListMaster tblStoreListMaster = new TblStoreListMaster();
                    tblStoreListMaster.setStoreName(cursor.getString(0));
                    tblStoreListMaster.setStoreLatitude(cursor.getDouble(1));
                    tblStoreListMaster.setStoreLongitude(cursor.getDouble(2));
                    tblStoreListMaster.setOwnerName(cursor.getString(3));
                    tblStoreListMaster.setStoreContactNo(cursor.getString(4));
                    tblStoreListMaster.setStoreAddress(cursor.getString(5));
                    tblStoreListMaster.setStoreCity(cursor.getString(6));
                    tblStoreListMaster.setStorePinCode(cursor.getString(7));
                    tblStoreListMaster.setStoreState(cursor.getString(8));
                    tblStoreListMaster.setFlgLocationEdit(cursor.getInt(9));
                    tblStoreListMaster.setCityID(Integer.parseInt(cursor.getString(10)));
                    tblStoreListMaster.setWhatsappNumber(cursor.getString(11));
                    tblStoreListMaster.setEmailID(cursor.getString(12));
                    tblStoreListMaster.setLandlineNum(cursor.getString(13));
                    tblStoreListMaster.setTaxNumber(cursor.getString(14));
                    tblStoreListMaster.setRouteID(cursor.getInt(15));
                    tblStoreListMaster.setFlgGSTCapture(cursor.getInt(16));
                    tblStoreListMaster.setGSTNumber(cursor.getString(14));
                    tblStoreListMasters.add(tblStoreListMaster);

                    cursor.moveToNext();
                }
            }
        }
        return tblStoreListMasters;
    }

    public List<String> getCityAndStateName(int CityID) {
        List<String> cityandstateList = new ArrayList<>();
        Cursor cursor = db.rawQuery("SELECT City, State from tblStateCityMaster WHERE  CityID='" + CityID + "'", null);
        try {
            if (cursor != null && cursor.getCount() > 0) {
                cursor.moveToFirst();
                cityandstateList.add(cursor.getString(0));
                cityandstateList.add(cursor.getString(1));

            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }
        return cityandstateList;
    }

    public void updateStoreEditData(String StoreID, String StoreName, String OwnerName, String MobileNum, String Address, int cityID,
                                    String State, String Pincode, String TaxNumber, String LandlineNumber, String WhatsApp_Num, String StoreLatitude, String StoreLongitude, String EmailID, int flgLocationUpdated, int selectedBeatID, int flgGST) {
        ContentValues values = new ContentValues();
        values.put("StoreName", StoreName);
        values.put("OwnerName", OwnerName);
        values.put("StoreContactNo", MobileNum);
        if (flgLocationUpdated == 1) {
            values.put("StoreLatitude", StoreLatitude);
            values.put("StoreLongitude", StoreLongitude);
            values.put("StoreAddress", Address);
            values.put("StoreCityID", cityID);
            values.put("StorePinCode", Pincode);
            values.put("StoreState", State);
        }
        values.put("TaxNumber", TaxNumber);
        values.put("GSTNumber", TaxNumber);
        values.put("GSTNumber", TaxNumber);
        values.put("Landline", LandlineNumber);
        values.put("WhatsappNumber", WhatsApp_Num);
        if (!TextUtils.isEmpty(EmailID))
            values.put("EmailID", EmailID);
        values.put("flgLocationUpdated", flgLocationUpdated);
        values.put("StoreRouteID", selectedBeatID);


        values.put("flgGSTCapture", flgGST);


        //values.put("StoreLongitude", StoreLongitude);
        //EmailAdd
        values.put("Sstat", 3);


        int afffected = db.update("tblStoreList", values, "StoreID=?", new String[]{StoreID});

    }

    public void UpdateImagesAgainstStore(String storeId, String ClickedDateTime, String PhotoName,
                                         String PDAPhotoPath, int Sstat, int ImageType, int flgType, String StoreVisitCode) {

        validateAndDelPic(flgType, PhotoName, "0", storeId);
        insertImagesAgainstStore(storeId, ClickedDateTime, PhotoName, PDAPhotoPath, 3, ImageType, flgType, StoreVisitCode);
       /* long inserted = 0;
        ContentValues initialValues = new ContentValues();


        initialValues.put("ImageClicktime", ClickedDateTime.trim());
        initialValues.put("ImageName", PhotoName.trim());
        initialValues.put("ImagePath", PDAPhotoPath.trim());
        initialValues.put("Sstat", Sstat);
        initialValues.put("flgType", ""+flgType);
        initialValues.put("ImageType", ImageType);

        int affected = db.update("tblStoreImageDetail", initialValues,"StoreID=?",new String[] { storeId } );*/

    }

    public void validateAndDelPic(int flgType, String imgName, String SpokeID, String StoreID) {
        db.execSQL("DELETE FROM tblStoreImageDetail where ImageName='" + imgName + "'");
    }

    public long insertImagesAgainstStore(String storeId, String ClickedDateTime, String PhotoName,
                                         String PDAPhotoPath, int Sstat, int ImageType, int flgType, String StoreVisitCode) {

        //open();

        //flgType
          /*  0=Old Store
            1=New Store
            2=Old Spoke
            3=New Spoke*/

        //Image Type
           /* 1. Outlet Photo
            2. Rack Photo
            3. Spoke Godown Photo
            4. Other Photo
            5. Spoke Visit
             6. Competitor Rack
              7. Spoke Before Merchandising
               8. Spoke After Merchandising

               9. Spoke Addition Shelve Photo
               10. Spoke Front and SignBoard Photo

                11. Spoke Front and SignBoard Photo While Adding
                 12. Spoke Shelve  Photo While Adding
                  13. Spoke Other   Photo While Adding
                     14. Spoke Sign Photos
            15. Competitor Photos
                  16. Collection Images
             */
        long inserted = 0;
        ContentValues initialValues = new ContentValues();
        //StoreID text null,ClickedDateTime text null,PhotoName text null,PDAPhotoPath text null,Sstat integer null


        initialValues.put("StoreID", storeId.trim());

        initialValues.put("ImageClicktime", ClickedDateTime.trim());
        initialValues.put("ImageName", PhotoName.trim());
        initialValues.put("ImagePath", PDAPhotoPath.trim());
        initialValues.put("Sstat", Sstat);
        initialValues.put("flgType", "" + flgType);
        initialValues.put("ImageType", ImageType);
        initialValues.put("StoreVisitCode", StoreVisitCode);


        inserted = db.insert(DBHelper.TABLE_tblStoreImageDetail, null, initialValues);

        return inserted;
    }


    public LinkedHashMap<String, String> fngetRouteList() {

        //open();
        Cursor cur = null;
        LinkedHashMap<String, String> hmapRouteList = new LinkedHashMap<String, String>();
        try {
            cur = db.rawQuery("Select ID,Descr from tblRouteListMaster", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        hmapRouteList.put(cur.getString(1).trim(), cur.getString(0));
                        cur.moveToNext();
                    }
                }

            }

        } catch (Exception e) {
            // TODO: handle exception
        } finally {
            if (cur != null) {
                cur.close();
            }
            // close();
            return hmapRouteList;
        }
    }


    public void savetblNoOrderReasonMaser(List<TblNoOrderReasonMaster> tblNoOrderReasonMaster) {
        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblNoOrderReasonMaster tblNoOrderReasonMaserRecord : tblNoOrderReasonMaster) {

            initialValues.put("ReasonID", tblNoOrderReasonMaserRecord.getReasonID());
            initialValues.put("ResonDesc", tblNoOrderReasonMaserRecord.getResonDesc());
            /*initialValues.put("LoginIdIns", BankMaster.getLoginIdIns());
            initialValues.put("TimeStampIns", BankMaster.getTimeStampIns());
            initialValues.put("LoginIdUpd", BankMaster.getLoginIdUpd());
            initialValues.put("TimeStampUpd", BankMaster.getTimeStampUpd());*/
            db.insert(DBHelper.DATABASE_TABLE_tblNoOrderReasonMaster, null, initialValues);
        }
        db.setTransactionSuccessful();
        db.endTransaction();


    }


    public void deletetblNoOrderReasonMaster() {

        db.execSQL("DELETE FROM tblNoOrderReasonMaster");


    }


    public HashMap<String, Integer> fetchHmaptblNoOrderReasonMaster() {

        HashMap<String, Integer> hmapOrderIDandClickStatus = new HashMap<String, Integer>();
        //open();
        Cursor cursor = db.rawQuery("SELECT ReasonID,ResonDesc FROM tblNoOrderReasonMaster", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapOrderIDandClickStatus.put((String) cursor.getString(1).toString(), cursor.getInt(0));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapOrderIDandClickStatus;
        } finally {
            cursor.close();
            // close();
        }

    }


    public HashMap<String, String> FetchStoreflgStoreEdit(String rID) {

        int ScodecolumnIndex = 0;
        HashMap<String, String> hmapstoreVisitStatus = new HashMap<String, String>();
        //Cursor cursor = db.rawQuery("SELECT Sstat,ISNewStore FROM tblStoreList ORDER BY DistanceNear", null);
        Cursor cursor = db.rawQuery("SELECT tblStoreList.StoreID, ifnull(tblStoreList.flgStoreEdit,0) FROM tblStoreList", null);//StoreRouteID='"+ rID +"' and

        try {


            if (cursor != null && cursor.getCount() > 0 && cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    hmapstoreVisitStatus.put(cursor.getString(ScodecolumnIndex).toString(), cursor.getString(1).toString());
                    cursor.moveToNext();
                }
            }
            return hmapstoreVisitStatus;
        } finally {
            if (cursor != null)
                cursor.close();
        }
    }


    public String fnGetStoreNameDistributorName(String StoreID) {
        String flag = "0";
        String distName = "NA";
        String disID = "0";
        Cursor cursor = null;
        try {
            //open();
            cursor = db.rawQuery("SELECT StoreName,ifnull(Distributor,'NA') from tblStoreList where StoreID = '" + StoreID + "'", null);

            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    flag = cursor.getString(0).toString();
                    if (!cursor.getString(1).toString().equals("NA")) {
                        flag = flag + " - " + (cursor.getString(1).toString());
                        //  disID= cursor.getString(0).toString().split(Pattern.quote("-"))[1];
                    }

                }

            }
            return flag;
        } catch (Exception e) {

        } finally {
            if (cursor != null)
                cursor.close();

           /* if(!disID.equals("0"))
            distName=fnGetDistributorName(disID);
            if(!distName.equals("NA"))
                flag=flag +" - " + (distName);*/
            //close();
            return flag;
        }
    }


    public String fnGetDistributorName(String disID) {

        String distName = "NA";
        Cursor cursor = null;
        try {
            //open();
            cursor = db.rawQuery("SELECT ifnull(Descr,'NA') from tblSupplierMstr where NodeID = '" + disID + "'", null);

            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    distName = cursor.getString(0).toString();

                }

            }
            return distName;
        } catch (Exception e) {

        } finally {
            if (cursor != null)
                cursor.close();
            //close();
            return distName;
        }
    }


    public HashMap<String, String> fnGetProductPurchaseRateBeforeTax(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated) {
        //open();
        HashMap<String, String> hmapPrdctOrderValBeforeGST = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                cursor = db.rawQuery("SELECT ProdID,ifnull(LineValBfrTxAftrDscnt,'0.00') FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    cursor = db.rawQuery("SELECT ProdID,ifnull(LineValBfrTxAftrDscnt,'0.00') From tblTmpInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
                } else {
                    cursor = db.rawQuery("SELECT ProdID,ifnull(LineValBfrTxAftrDscnt,'0.00') From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
                    //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
                }
                // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
            } else {
                cursor = db.rawQuery("SELECT ProdID,ifnull(LineValBfrTxAftrDscnt,'0.00') From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
            }
        } else {
            cursor = db.rawQuery("SELECT ProdID,ifnull(LineValBfrTxAftrDscnt,'0.00') From tblTmpInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOrderValBeforeGST.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOrderValBeforeGST;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public HashMap<String, String> fnGetProductOrderValTaxAmount(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated) {
        //open();
        HashMap<String, String> hmapPrdctOrderValTaxAmount = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                cursor = db.rawQuery("SELECT ProdID,ifnull(TaxValue,'0.00') FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    cursor = db.rawQuery("SELECT ProdID,ifnull(TaxValue,'0.00') From tblTmpInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
                } else {
                    cursor = db.rawQuery("SELECT ProdID,ifnull(TaxValue,'0.00') From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
                    //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
                }
                // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
            } else {
                cursor = db.rawQuery("SELECT ProdID,ifnull(TaxValue,'0.00') From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
            }
        } else {
            cursor = db.rawQuery("SELECT ProdID,ifnull(TaxValue,'0.00') From tblTmpInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOrderValTaxAmount.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOrderValTaxAmount;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public int fnChecktblAttandanceDetailsRecord() {
        int LoncolumnIndex = 0;
        int TargetCall = 0;


        Cursor cursor2 = db.rawQuery("SELECT Count(*) FROM tblAttandanceDetails", null);
        try {
            if (cursor2 != null && cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {

                    TargetCall = cursor2.getInt(LoncolumnIndex);

                }
            }

            return TargetCall;
        } finally {
            cursor2.close();
        }
    }

    public ArrayList<TblStoreListMasterDataRetrive> fnGetAllStoreStoreModel() {
        ArrayList<TblStoreListMasterDataRetrive> tblStoreListMasterDataRetriveArrayList = new ArrayList<TblStoreListMasterDataRetrive>();
        Cursor cursor = db.rawQuery("SELECT tblStoreList.StoreID, (StoreName || ' ('|| ifnull(OwnerName,'NA') || ':' || ifnull(StoreContactNo,'NA') || ') ')  AS StoreName,ifnull(StoreContactNo,'NA'), tblStoreList.StoreRouteID, tblStoreList.RouteNodeType, tblStoreList.Sstat, tblStoreList.ISNewStore,ifnull(tblStoreVisitMstr.StoreClose,0),ifnull(StoreLatitude,0.0),ifnull(StoreLongitude,0.0),ifnull(DistanceNear,0),0 AsflgReMap,ifnull(tblStoreList.flgStoreEdit,0),ifnull(StoreAddress,'NA') , IFNULL(tblInvoiceHeader.InvoiceVal,0),ifnull(tblStoreVisitMstr.StoreVisitCode,'NA') ,tblStoreList.StoreName,ifnull(Reasonforupdate,'NA'),ifnull(UpdatedContactnumber,'NA'),ifnull(flgMapped,0),ifnull(OTP,'0'),ifnull(tblRouteListMaster.Descr,'NA') AS RouteDescr,ifnull(tblStoreList.flgStarStore,0),ifnull(tblStoreList.flgUnProductiveStore,0)  FROM tblStoreList left outer join tblStoreVisitMstr  On tblStoreVisitMstr.StoreID=tblStoreList.StoreID  left outer join tblInvoiceHeader on tblStoreList.StoreID=tblInvoiceHeader.StoreID left outer join tblRouteListMaster on tblStoreList.StoreRouteID=tblRouteListMaster.ID ORDER BY DistanceNear", null);// where CoverageAreaNodeID="+CommonInfo.CoverageAreaNodeID+" and CoverageAreaNodeType="+CommonInfo.CoverageAreaNodeType+" // where StoreRouteID='"+ rID +"'  //where StoreRouteID='"+ rID +"'//|| '('||OwnerName ||' : '||StoreContactNo||')'

        try {
            if (cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    TblStoreListMasterDataRetrive tblStoreListMasterDataRetrive = new TblStoreListMasterDataRetrive();
                    tblStoreListMasterDataRetrive.setStoreID(cursor.getString(0));
                    tblStoreListMasterDataRetrive.setStoreName(cursor.getString(1));
                    tblStoreListMasterDataRetrive.setStoreContactNo(cursor.getString(2));
                    tblStoreListMasterDataRetrive.setRouteID(cursor.getInt(3));
                    tblStoreListMasterDataRetrive.setRouteNodeType(cursor.getInt(4));
                    tblStoreListMasterDataRetrive.setSstat(cursor.getString(5));
                    tblStoreListMasterDataRetrive.setISNewStore(cursor.getInt(6));
                    tblStoreListMasterDataRetrive.setStoreClose(cursor.getInt(7));
                    tblStoreListMasterDataRetrive.setStoreLatitude(cursor.getDouble(8));
                    tblStoreListMasterDataRetrive.setStoreLongitude(cursor.getDouble(9));
                    tblStoreListMasterDataRetrive.setDistanceNear(cursor.getInt(10));
                    tblStoreListMasterDataRetrive.setFlgRemap(cursor.getInt(11));
                    tblStoreListMasterDataRetrive.setFlgStoreEdit(cursor.getInt(12));
                    tblStoreListMasterDataRetrive.setStoreAddress(cursor.getString(13));
                    tblStoreListMasterDataRetrive.setInvoiceVal(cursor.getDouble(14));
                    tblStoreListMasterDataRetrive.setVisitCode(cursor.getString(15));
                    tblStoreListMasterDataRetrive.setFlgRadioButtonSelected(0);

                    tblStoreListMasterDataRetrive.setReasonforupdate(cursor.getString(17));
                    tblStoreListMasterDataRetrive.setUpdatedContactnumber(cursor.getString(18));
                    tblStoreListMasterDataRetrive.setFlgMapped(cursor.getInt(19));
                    tblStoreListMasterDataRetrive.setOTP(cursor.getString(20));
                    tblStoreListMasterDataRetrive.setRouteName(cursor.getString(21));
                    tblStoreListMasterDataRetrive.setFlgStarStore(cursor.getInt(22));
                    tblStoreListMasterDataRetrive.setFlgUnProductiveStore(cursor.getInt(23));

                    tblStoreListMasterDataRetrive.setFlgShowHeader(0);
                    tblStoreListMasterDataRetriveArrayList.add(tblStoreListMasterDataRetrive);
                       /* int closedStatus = getStoreClosedStatus(cursor.getString(ScodecolumnIndex));
                        StoreName[i] = (String) cursor.getString(ScodecolumnIndex).toString()+ "_"+ (String) cursor.getString(SnamecolumnIndex).toString()+"_"+closedStatus+"_"+cursor.getString(2);*/
                    cursor.moveToNext();
                }

            }
            return tblStoreListMasterDataRetriveArrayList;
        } finally {
            cursor.close();
        }
    }

    public String fnGetPersonNodeIDAndPersonNodeTypeForSO() {
        String SONodeIdAndNodeType = "0^0";


        Cursor cursor = db.rawQuery("Select PersonNodeID,PersonNodeType from tblUserAuthenticationMstr", null);
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    SONodeIdAndNodeType = cursor.getString(0) + "^" + cursor.getString(1);
                }
            }
        } catch (Exception ex) {

        } finally {
            if (cursor != null)
                cursor.close();
        }
        return SONodeIdAndNodeType;
    }


    public ArrayList<TblAttandanceDetails> fnFilltblAttandanceDetailsRecord() {
        int LoncolumnIndex = 0;
        ArrayList<TblAttandanceDetails> tblAttandanceDetailsRecords = new ArrayList<TblAttandanceDetails>();


        Cursor cursor2 = db.rawQuery("SELECT AttandanceTime ,PersonNodeID , PersonNodeType ,OptionID ,OptionDesc ,ReasonID ,ReasonDesc" +
                " ,Comment , Address ,PinCode , City , State ,fnLati ,fnLongi ,fnAccuracy ,flgLocNotFound ,fnAccurateProvider ,AllProvidersLocation " +
                ",fnAddress ,GpsLat , GpsLong , GpsAccuracy , GpsAddress , NetwLat ,NetwLong , NetwAccuracy , NetwAddress , FusedLat , FusedLong ,FusedAccuracy , " +
                "FusedAddress ,FusedLocationLatitudeWithFirstAttempt ,FusedLocationLongitudeWithFirstAttempt ,FusedLocationAccuracyWithFirstAttempt ,Sstat ," +
                "flgLocationServicesOnOff ,flgGPSOnOff ,flgNetworkOnOff ,flgFusedOnOff ,flgInternetOnOffWhileLocationTracking ,flgRestart ,MapAddress ,MapCity ," +
                "MapPinCode ,MapState ,CityId ,StateId ,DistributorId ,DistributorNodeType ,DistributorName ,AttenDate ,LeaveStartDate ,LeaveEndDate,SelfieName,SelfieURL  FROM tblAttandanceDetails", null);
        TblAttandanceDetails tblAttandanceDetails = new TblAttandanceDetails();
        if (cursor2 != null && cursor2.moveToFirst()) {
            tblAttandanceDetails.setAttandanceTime(cursor2.getString(0));
            tblAttandanceDetails.setPersonNodeID(cursor2.getString(1));
            tblAttandanceDetails.setPersonNodeType(cursor2.getString(2));
            tblAttandanceDetails.setOptionID(cursor2.getString(3));
            tblAttandanceDetails.setOptionDesc(cursor2.getString(4));
            tblAttandanceDetails.setReasonID(cursor2.getString(5));
            tblAttandanceDetails.setReasonDesc(cursor2.getString(6));
            tblAttandanceDetails.setComment(cursor2.getString(7));
            tblAttandanceDetails.setAddress(cursor2.getString(8));
            tblAttandanceDetails.setPinCode(cursor2.getString(9));
            tblAttandanceDetails.setCity(cursor2.getString(10));
            tblAttandanceDetails.setState(cursor2.getString(11));
            tblAttandanceDetails.setFnLati(cursor2.getString(12));
            tblAttandanceDetails.setFnLongi(cursor2.getString(13));
            tblAttandanceDetails.setFnAccuracy(cursor2.getString(14));
            tblAttandanceDetails.setFlgLocNotFound(cursor2.getString(15));
            tblAttandanceDetails.setFnAccurateProvider(cursor2.getString(16));
            tblAttandanceDetails.setAllProvidersLocation(cursor2.getString(17));


       /*     " ,Comment , Address ,PinCode , City , State ,fnLati ,fnLongi ,fnAccuracy ,flgLocNotFound ,fnAccurateProvider ,AllProvidersLocation " +
                    ",fnAddress ,GpsLat , GpsLong , GpsAccuracy , GpsAddress , NetwLat ,NetwLong , NetwAccuracy , NetwAddress , FusedLat , FusedLong ,FusedAccuracy , " +
                    "FusedAddress ,FusedLocationLatitudeWithFirstAttempt ,FusedLocationLongitudeWithFirstAttempt ,FusedLocationAccuracyWithFirstAttempt ,Sstat ," +
                    "flgLocationServicesOnOff ,flgGPSOnOff ,flgNetworkOnOff ,flgFusedOnOff ,flgInternetOnOffWhileLocationTracking ,flgRestart ,MapAddress ,MapCity ," +
                    "MapPinCode ,MapState ,CityId ,StateId ,DistributorId ,DistributorNodeType ,DistributorName ,AttenDate ,LeaveStartDate ,LeaveEndDate*/
            tblAttandanceDetails.setFnAddress(cursor2.getString(18));
            tblAttandanceDetails.setGpsLat(cursor2.getString(19));
            tblAttandanceDetails.setGpsLong(cursor2.getString(20));
            tblAttandanceDetails.setGpsAccuracy(cursor2.getString(21));
            tblAttandanceDetails.setGpsAddress(cursor2.getString(22));
            tblAttandanceDetails.setNetwLat(cursor2.getString(23));
            tblAttandanceDetails.setNetwLong(cursor2.getString(24));
            tblAttandanceDetails.setNetwAccuracy(cursor2.getString(25));
            tblAttandanceDetails.setNetwAddress(cursor2.getString(26));
            tblAttandanceDetails.setFusedLat(cursor2.getString(27));
            tblAttandanceDetails.setFusedLong(cursor2.getString(28));
            tblAttandanceDetails.setFusedAccuracy(cursor2.getString(29));
            tblAttandanceDetails.setFusedAddress(cursor2.getString(30));
            tblAttandanceDetails.setFusedLocationLatitudeWithFirstAttempt(cursor2.getString(31));
            tblAttandanceDetails.setFusedLocationLongitudeWithFirstAttempt(cursor2.getString(32));
            tblAttandanceDetails.setFusedLocationAccuracyWithFirstAttempt(cursor2.getString(33));
            tblAttandanceDetails.setSstat(cursor2.getInt(34));
            tblAttandanceDetails.setFlgLocationServicesOnOff(cursor2.getInt(35));
            tblAttandanceDetails.setFlgGPSOnOff(cursor2.getInt(36));
            tblAttandanceDetails.setFlgNetworkOnOff(cursor2.getInt(37));
            tblAttandanceDetails.setFlgFusedOnOff(cursor2.getInt(38));
            tblAttandanceDetails.setFlgInternetOnOffWhileLocationTracking(cursor2.getInt(39));
            tblAttandanceDetails.setFlgRestart(cursor2.getInt(40));
            tblAttandanceDetails.setMapAddress(cursor2.getString(41));
            tblAttandanceDetails.setMapCity(cursor2.getString(42));
            tblAttandanceDetails.setMapPinCode(cursor2.getString(43));
            tblAttandanceDetails.setMapState(cursor2.getString(44));
            tblAttandanceDetails.setCityId(cursor2.getString(45));
            tblAttandanceDetails.setStateId(cursor2.getString(46));
            tblAttandanceDetails.setDistributorId(cursor2.getString(47));
            tblAttandanceDetails.setDistributorNodeType(cursor2.getString(48));
            tblAttandanceDetails.setDistributorName(cursor2.getString(49));
            tblAttandanceDetails.setAttenDate(cursor2.getString(50));
            tblAttandanceDetails.setLeaveStartDate(cursor2.getString(51));
            tblAttandanceDetails.setLeaveEndDate(cursor2.getString(52));
            tblAttandanceDetails.setSelfieName(cursor2.getString(53));
            tblAttandanceDetails.setSelfieURL(cursor2.getString(54));
            tblAttandanceDetailsRecords.add(tblAttandanceDetails);
        }


        if (cursor2 != null)
            cursor2.close();

        return tblAttandanceDetailsRecords;

    }


    public ArrayList<TblLocationDetails> fnGetTblLocationDetailsForAttendance() {
        ArrayList<TblLocationDetails> tblLocationDetailsRecords = new ArrayList<TblLocationDetails>();
        Cursor cursor2 = db.rawQuery("Select Lattitude,Longitude,Accuracy,Address,City,Pincode,State,fnAccurateProvider,GpsLat,GpsLong,GpsAccuracy," +
                "NetwLat,NetwLong,NetwAccuracy,FusedLat,FusedLong,FusedAccuracy,AllProvidersLocation,GpsAddress,NetwAddress,FusedAddress," +
                "FusedLocationLatitudeWithFirstAttempt,FusedLocationLongitudeWithFirstAttempt,FusedLocationAccuracyWithFirstAttempt from tblLocationDetails", null);
        TblLocationDetails tblLocationDetails = new TblLocationDetails();
        if (cursor2 != null && cursor2.moveToFirst()) {
            tblLocationDetails.setLattitude(cursor2.getString(0));
            tblLocationDetails.setLongitude(cursor2.getString(1));
            tblLocationDetails.setAccuracy(cursor2.getString(2));
            tblLocationDetails.setAddress(cursor2.getString(3));
            tblLocationDetails.setCity(cursor2.getString(4));
            tblLocationDetails.setPincode(cursor2.getString(5));
            tblLocationDetails.setState(cursor2.getString(6));
            tblLocationDetails.setFnAccurateProvider(cursor2.getString(7));
            tblLocationDetails.setGpsLat(cursor2.getString(8));
            tblLocationDetails.setGpsLong(cursor2.getString(9));
            tblLocationDetails.setGpsAccuracy(cursor2.getString(10));

            tblLocationDetails.setNetwLat(cursor2.getString(11));
            tblLocationDetails.setNetwLong(cursor2.getString(12));
            tblLocationDetails.setNetwAccuracy(cursor2.getString(13));
            tblLocationDetails.setFusedLat(cursor2.getString(14));
            tblLocationDetails.setFusedLong(cursor2.getString(15));
            tblLocationDetails.setFusedAccuracy(cursor2.getString(16));
            tblLocationDetails.setAllProvidersLocation(cursor2.getString(17));

            tblLocationDetails.setGpsAddress(cursor2.getString(18));
            tblLocationDetails.setNetwAddress(cursor2.getString(19));
            tblLocationDetails.setFusedAddress(cursor2.getString(20));
            tblLocationDetails.setFusedLocationLatitudeWithFirstAttempt(cursor2.getString(21));
            tblLocationDetails.setFusedLocationLongitudeWithFirstAttempt(cursor2.getString(22));
            tblLocationDetails.setFusedLocationAccuracyWithFirstAttempt(cursor2.getString(23));
            tblLocationDetailsRecords.add(tblLocationDetails);
        }

        if (cursor2 != null)
            cursor2.close();
        return tblLocationDetailsRecords;
    }


    public HashMap<Integer, List<TblUOMMapping>> fetch_ProductWiseGetAllMeasureUnitAgainstProduct(String storeID) {
        HashMap<Integer, List<TblUOMMapping>> hmapProductTblUOMMapping = new HashMap<Integer, List<TblUOMMapping>>();
        Cursor cursor = null;
        cursor = db.rawQuery("SELECT tblProductListMaster.productID,ifnull(tblProductListMaster.RptUnitID,'3')  FROM tblProductListMaster order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr ASC", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        List<TblUOMMapping> tblUOMMappingList = fnGetAllMeasureUnitAgainstProduct(Integer.parseInt(cursor.getString(0)), Integer.parseInt(cursor.getString(1)));
                        hmapProductTblUOMMapping.put(cursor.getInt(0), tblUOMMappingList);
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            if(cursor!=null)
            cursor.close();
        }
        return hmapProductTblUOMMapping;
    }

    public HashMap<Integer, List<TblUOMMapping>> fetch_ProductWiseGetAllMeasureUnitAgainstProductCarton(String storeID) {
        HashMap<Integer, List<TblUOMMapping>> hmapProductTblUOMMapping = new HashMap<Integer, List<TblUOMMapping>>();
        Cursor cursor = null;
        cursor = db.rawQuery("SELECT tblProductListMaster.productID,3 AS RptUnitID  FROM tblProductListMaster order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr ASC", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        List<TblUOMMapping> tblUOMMappingList = fnGetAllMeasureUnitAgainstProduct(Integer.parseInt(cursor.getString(0)), Integer.parseInt(cursor.getString(1)));
                        hmapProductTblUOMMapping.put(cursor.getInt(0), tblUOMMappingList);
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            cursor.close();
        }
        return hmapProductTblUOMMapping;
    }

    public List<TblUOMMapping> fnGetAllMeasureUnitAgainstProduct(int PrdID, int defaultUnitID) {
        List<TblUOMMapping> lstTblUOMMapping = new ArrayList<TblUOMMapping>();
        String sql = "SELECT tblUOMMapping.RowID,tblUOMMapping.NodeId,tblUOMMapping.NodeType,tblUOMMapping.BaseUnitID,tblUOMMapping.PackUnitId, tblUOMMapping.BaseValue,0 AS flgRetailUnit,0 AS SNo,0 AS flgVanLoading,tblUOMMaster.UOM AS bUOMName,3 AS flgIsDefaultUOM  from tblUOMMapping  inner join tblUOMMaster on tblUOMMapping.PackUnitId=tblUOMMaster.UOMId where tblUOMMapping.NodeId=" + PrdID + "";
        Cursor cursornew = db.rawQuery(sql, null);


        try {
            if (cursornew != null && cursornew.getCount() > 0) {
                while (cursornew.moveToNext()) {

                    TblUOMMapping tblUOMMappingRecord = new TblUOMMapping();
                    tblUOMMappingRecord.setRowID(cursornew.getInt(0));
                    tblUOMMappingRecord.setNodeID(cursornew.getInt(1));
                    tblUOMMappingRecord.setNodeType(cursornew.getInt(2));
                    tblUOMMappingRecord.setBaseUOMID(cursornew.getInt(3));
                    tblUOMMappingRecord.setPackUOMID(cursornew.getInt(4));
                    tblUOMMappingRecord.setRelConversionUnits(cursornew.getDouble(5));
                    tblUOMMappingRecord.setFlgRetailUnit(cursornew.getInt(6));
                    tblUOMMappingRecord.setSNo(cursornew.getInt(7));
                    tblUOMMappingRecord.setFlgVanLoading(cursornew.getInt(8));
                    tblUOMMappingRecord.setUOMName(cursornew.getString(9));
                    if (defaultUnitID == cursornew.getInt(4)) {
                        tblUOMMappingRecord.setFlgIsDefaultUOM(1);
                    } else {
                        tblUOMMappingRecord.setFlgIsDefaultUOM(0);
                    }
                    lstTblUOMMapping.add(tblUOMMappingRecord);
                }


            }

        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            if (cursornew != null)
                cursornew.close();

        }
        return lstTblUOMMapping;
    }

    public void Delete_tblPDAIsSchemeApplicable() {
        db.execSQL("DELETE FROM tblPDAIsSchemeApplicable");

    }

    public void savetblSchemeStoreMapping(List<TblSchemeStoreMapping> tblSchemeStoreMappingList) {

       /* db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblSchemeStoreMapping tblSchemeStoreMapping : tblSchemeStoreMappingList) {

            initialValues.put("StoreID", tblSchemeStoreMapping.getStoreID());
            initialValues.put("SchemeID", tblSchemeStoreMapping.getSchemeID());

            //   initialValues.put(DBHelper.CustomerNodeType, tblSchemeStoreMapping.getStoreNodeType());

            long insert = db.insert("tblSchemeStoreMapping", null, initialValues);
            Log.d("tblSchemeStoreMapping", "" + insert);
        }
        db.setTransactionSuccessful();
        db.endTransaction();*/

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO tblSchemeStoreMapping (StoreID,SchemeID,IsNewStore) VALUES (?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblSchemeStoreMapping tbl : tblSchemeStoreMappingList) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindLong(2, tbl.getSchemeID());
                stmt.bindLong(3, tbl.getIsNewStore());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }

    public void savetblSchemeMstr(List<TblSchemeMstr> tblSchemeMstrList) {
        for (TblSchemeMstr tblSchemeMstr : tblSchemeMstrList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("SchemeID", tblSchemeMstr.getSchemeID());
            initialValues.put("SchemeName", tblSchemeMstr.getSchemeName());
            initialValues.put("SchemeApplicationID", tblSchemeMstr.getSchemeApplicationID());
            initialValues.put("SchemeAppliedRule", tblSchemeMstr.getSchemeAppliedRule());
            // initialValues.put("SchemeTypeId", tblSchemeMstr.getSchemeTypeId());
            // initialValues.put("SchemeCalculationTypeID", tblSchemeMstr.getSchemeCalculationTypeID());
            // "create table tblSchemeMstr (SchemeID text null,SchemeName text null,SchemeApplicationID text null,SchemeAppliedRule text null);";

            Log.d("tblSchemeMstr", "" + db.insert("tblSchemeMstr", null, initialValues));
        }
    }

    public void savetblSchemeSlabDetail(List<TblSchemeSlabDetail> tblSchemeSlabDetailList) {

        for (TblSchemeSlabDetail tblSchemeSlabDetail : tblSchemeSlabDetailList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("SchemeID", tblSchemeSlabDetail.getSchemeID());
            initialValues.put("SchemeSlabID", tblSchemeSlabDetail.getSchemeSlabID());
            initialValues.put("SchemeSlabDesc", tblSchemeSlabDetail.getSchemeSlabDesc());
            initialValues.put("BenifitDescr", tblSchemeSlabDetail.getBenifitDescr());

            Log.d("tblSchemeSlabDetail", "" + db.insert(DATABASE_TABLE_MAIN203, null, initialValues));
        }
    }

    public void savetblSchemeSlabBucketDetails(List<TblSchemeSlabBucketDetails> tblSchemeSlabBucketDetailsList) {

        for (TblSchemeSlabBucketDetails tblSchemeSlabBucketDetails : tblSchemeSlabBucketDetailsList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("RowID", tblSchemeSlabBucketDetails.getRowID());
            initialValues.put("SchemeID", tblSchemeSlabBucketDetails.getSchemeID());
            initialValues.put("SchemeSlabID", tblSchemeSlabBucketDetails.getSchemeSlabID());
            initialValues.put("BucketID", tblSchemeSlabBucketDetails.getBucketID());
            initialValues.put("SubBucketID", tblSchemeSlabBucketDetails.getSubBucketID());
            initialValues.put("SlabSubBucketType", tblSchemeSlabBucketDetails.getSlabSubBucketType());
            initialValues.put("SlabSubBucketValue", tblSchemeSlabBucketDetails.getSlabSubBucketValue());
            initialValues.put("SubBucketValType", tblSchemeSlabBucketDetails.getSubBucketValType());


            Log.d("tblSchemeSlabBucketDetails", "" + db.insert(DATABASE_TABLE_MAIN204, null, initialValues));
        }

    }


    public void savetblSchemeSlabBenefitsBucketDetails(List<TblSchemeSlabBenefitsBucketDetails> tblSchemeSlabBenefitsBucketDetailsList) {
        for (TblSchemeSlabBenefitsBucketDetails tblSchemeSlabBenefitsBucketDetails : tblSchemeSlabBenefitsBucketDetailsList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("RowID", tblSchemeSlabBenefitsBucketDetails.getRowID());
            initialValues.put("SchemeID", tblSchemeSlabBenefitsBucketDetails.getSchemeID());
            initialValues.put("SchemeSlabID", tblSchemeSlabBenefitsBucketDetails.getSchemeSlabID());
            initialValues.put("BucketID", tblSchemeSlabBenefitsBucketDetails.getBucketID());
            initialValues.put("SubBucketID", tblSchemeSlabBenefitsBucketDetails.getSubBucketID());
            initialValues.put("BenSubBucketType", tblSchemeSlabBenefitsBucketDetails.getBenSubBucketType());
            initialValues.put("BenDiscApplied", tblSchemeSlabBenefitsBucketDetails.getBenDiscApplied());
            initialValues.put("CouponCode", tblSchemeSlabBenefitsBucketDetails.getCouponCode());
            initialValues.put("BenSubBucketValue", tblSchemeSlabBenefitsBucketDetails.getBenSubBucketValue());
            initialValues.put("Per", tblSchemeSlabBenefitsBucketDetails.getPer());

            initialValues.put("UOM", tblSchemeSlabBenefitsBucketDetails.getUOM());
            initialValues.put("ProRata", tblSchemeSlabBenefitsBucketDetails.getProRata());
            // initialValues.put("IsDiscountOnTotalAmount", tblSchemeSlabBenefitsBucketDetails.getIsDiscountOnTotalAmount());
            Log.d("tblSchemeSlabBenefitsBucketDetails", "" + db.insert(DATABASE_TABLE_MAIN206, null, initialValues));
        }
        // System.out.println("Ajay Data Save in table 206");

    }

    public void savetblSchemeSlabBenefitsProductMappingDetail(List<TblSchemeSlabBenefitsProductMappingDetail> tblSchemeSlabBenefitsProductMappingDetailList) {
        for (TblSchemeSlabBenefitsProductMappingDetail tblSchemeSlabBenefitsProductMappingDetail : tblSchemeSlabBenefitsProductMappingDetailList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("RowID", tblSchemeSlabBenefitsProductMappingDetail.getRowID());
            initialValues.put("ProductID", "" + tblSchemeSlabBenefitsProductMappingDetail.getProductID());

            // System.out.println("Ajay Data Save in table 207");
            Log.d("tblSchemeSlabBenefitsBucketDetails", "" + db.insert(DATABASE_TABLE_MAIN207, null, initialValues));
        }
    }

    public void savetblSchemeSlabBenefitsValueDetail(List<TblSchemeSlabBenefitsValueDetail> tblSchemeSlabBenefitsValueDetailList) {
        for (TblSchemeSlabBenefitsValueDetail tblSchemeSlabBenefitsValueDetail : tblSchemeSlabBenefitsValueDetailList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("RowID", tblSchemeSlabBenefitsValueDetail.getRowID());
            initialValues.put("BenValue", tblSchemeSlabBenefitsValueDetail.getBenValue());
            initialValues.put("Remarks", tblSchemeSlabBenefitsValueDetail.getRemarks());
            initialValues.put("Type", tblSchemeSlabBenefitsValueDetail.getType());

            // System.out.println("Ajay Data Save in table 208");
            //"create table tblSchemeSlabBenefitsValueDetail (RowID text null,BenValue text null,Remarks text null,Type text null);";
            Log.d("tblSchemeSlabBenefitsValueDetail", "" + db.insert(DATABASE_TABLE_MAIN208, null, initialValues));
        }
    }

    public void savetblProductRelatedScheme(List<TblProductRelatedScheme> tblProductRelatedSchemeList) {
        for (TblProductRelatedScheme tblProductRelatedScheme : tblProductRelatedSchemeList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("ProductID", tblProductRelatedScheme.getProductID());
            initialValues.put("PrdString", tblProductRelatedScheme.getPrdString());

            // System.out.println("Ajay Data Save in table 209");
            Log.d("tblProductRelatedScheme", "" + db.insert(DATABASE_TABLE_MAIN209, null, initialValues));
        }
    }


    public HashMap<String, String> fnGetProductPurchaseFreeOrderQtyCarton(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);

        if (chkflgInvoiceAlreadyGenerated == 1) {
            int we = 0;
            cursor = db.rawQuery("SELECT ProdID,FreeQty FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
            if (cursor.getCount() > 0) {
                we = 1;
                if (cursor != null) {
                    cursor.close();
                }
            }

            if (we == 1) {
                cursor = db.rawQuery("SELECT ProdID,FreeQty From tblTmpInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                    /*if(cursor!=null)
                    {
                        cursor.close();
                    }*/
            } else {
                cursor = db.rawQuery("SELECT ProdID,FreeQty From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                  /*  if(cursor!=null)
                    {
                        cursor.close();
                    }*/
                //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
            }
            // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
        } else {
            cursor = db.rawQuery("SELECT ProdID,FreeQty From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
               /* if(cursor!=null)
                {
                    cursor.close();
                }*/
        }


        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return hmapPrdctOdrQty;

            // close();
        }
    }

    public HashMap<String, String> fnGetProductPurchaseFreeOrderQty(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);

        if (chkflgInvoiceAlreadyGenerated == 1) {
            int we = 0;
            cursor = db.rawQuery("SELECT ProdID,FreeQty FROM tblTmpInvoiceDetailsLocalOrder WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
            if (cursor.getCount() > 0) {
                we = 1;
                if (cursor != null) {
                    cursor.close();
                }
            }

            if (we == 1) {
                cursor = db.rawQuery("SELECT ProdID,FreeQty From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                    /*if(cursor!=null)
                    {
                        cursor.close();
                    }*/
            } else {
                cursor = db.rawQuery("SELECT ProdID,FreeQty From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                  /*  if(cursor!=null)
                    {
                        cursor.close();
                    }*/
                //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
            }
            // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
        } else {
            cursor = db.rawQuery("SELECT ProdID,FreeQty From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
               /* if(cursor!=null)
                {
                    cursor.close();
                }*/
        }


        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return hmapPrdctOdrQty;

            // close();
        }
    }

    public HashMap<String, String> fnGetProductSkuPriceList(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                cursor = db.rawQuery("SELECT ProdID,ifnull(LineValAftrTxAftrDscnt,0.0) FROM tblTmpInvoiceDetailsLocalOrder WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    cursor = db.rawQuery("SELECT ProdID,ifnull(LineValAftrTxAftrDscnt,0.0) From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                } else {
                    cursor = db.rawQuery("SELECT ProdID,ifnull(LineValAftrTxAftrDscnt,0.0) From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                    //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
                }
                // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
            } else {
                cursor = db.rawQuery("SELECT ProdID,ifnull(LineValAftrTxAftrDscnt,0.0) From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
            }
        } else {
            cursor = db.rawQuery("SELECT ProdID,ifnull(LineValAftrTxAftrDscnt,0.0) From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }

    public HashMap<String, String> fnGetProductPurchaseDiscountAmountAgainst(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);

        if (chkflgInvoiceAlreadyGenerated == 1) {
            int we = 0;
            cursor = db.rawQuery("SELECT ProdID,Cast(ifnull(DiscountPerUOM,0.0) AS text) AS DisValue FROM tblTmpInvoiceDetailsLocalOrder WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
            if (cursor.getCount() > 0) {
                we = 1;
                if (cursor != null) {
                    cursor.close();
                }
            }

            if (we == 1) {
                cursor = db.rawQuery("SELECT ProdID,Cast(ifnull(DiscountPerUOM,0.0) AS text) AS DisValue From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                    /*if(cursor!=null)
                    {
                        cursor.close();
                    }*/
            } else {
                cursor = db.rawQuery("SELECT ProdID,Cast(ifnull(DiscountPerUOM,0.0) AS text) AS DisValue From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                  /*  if(cursor!=null)
                    {
                        cursor.close();
                    }*/
                //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
            }
            // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
        } else {
            cursor = db.rawQuery("SELECT ProdID,Cast(ifnull(DiscountPerUOM,0.0) AS text) AS DisValue From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
               /* if(cursor!=null)
                {
                    cursor.close();
                }*/
        }


        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return hmapPrdctOdrQty;

            // close();
        }
    }
    public HashMap<String, String> fnGetProductPurchaseDiscountAmountAgainstCarton(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);

        if (chkflgInvoiceAlreadyGenerated == 1) {
            int we = 0;
            cursor = db.rawQuery("SELECT ProdID,ifnull(DiscountPerUOM,0.0) AS DisVal FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
            if (cursor.getCount() > 0) {
                we = 1;
                if (cursor != null) {
                    cursor.close();
                }
            }

            if (we == 1) {
                cursor = db.rawQuery("SELECT ProdID,ifnull(DiscountPerUOM,0.0) AS DisVal From tblTmpInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                    /*if(cursor!=null)
                    {
                        cursor.close();
                    }*/
            } else {
                cursor = db.rawQuery("SELECT ProdID,ifnull(DiscountPerUOM,0.0) AS DisVal From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                  /*  if(cursor!=null)
                    {
                        cursor.close();
                    }*/
                //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
            }
            // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
        } else {
            cursor = db.rawQuery("SELECT ProdID,ifnull(DiscountPerUOM,0.0) AS DisVal From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
               /* if(cursor!=null)
                {
                    cursor.close();
                }*/
        }


        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return hmapPrdctOdrQty;

            // close();
        }
    }

    public LinkedHashMap<String, ArrayList<String>> getProductMinMax() {
        Cursor cur = null;
        LinkedHashMap<String, ArrayList<String>> hmapProductMinMax = new LinkedHashMap<String, ArrayList<String>>();
        ArrayList<String> listMinMax = new ArrayList<String>();
        try {
            cur = db.rawQuery("Select ProductID,SlabSubBucketMin||'~'||SlabSubBucketMax As SlabMinMax,SlabSubBucketType,SchemeID||'$'||SchemeSlabID As SchmIdSabId from tblProductAlertNearestSchmApld Order By ProductID", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    String prodctId, prvsPrdctId = null;
                    for (int i = 0; i < cur.getCount(); i++) {
                        prodctId = cur.getString(0);
                        if (i == 0) {
                            prvsPrdctId = cur.getString(0);
                            listMinMax.add(cur.getString(1) + "^" + cur.getString(2) + "#" + cur.getString(3));
                            //hmapProductMinMax.put()
                        } else {
                            if (prvsPrdctId.equals(prodctId)) {
                                listMinMax.add(cur.getString(1) + "^" + cur.getString(2) + "#" + cur.getString(3));
                            } else {
                                hmapProductMinMax.put(prvsPrdctId, listMinMax);
                                listMinMax = new ArrayList<String>();
                                listMinMax.add(cur.getString(1) + "^" + cur.getString(2) + "#" + cur.getString(3));
                                prvsPrdctId = prodctId;
                            }
                        }
                        if (i == (cur.getCount() - 1)) {
                            hmapProductMinMax.put(prvsPrdctId, listMinMax);
                        }
                        cur.moveToNext();
                    }
                }
            }
        } catch (SQLiteException exception) {
            System.out.println("Error = " + exception.toString());
        } finally {
            if (cur != null) {
                cur.close();

            }
            return hmapProductMinMax;
        }

    }


    public LinkedHashMap<String, String> getSchmDscrptnAndBenfit() {

        Cursor cur = null;
        LinkedHashMap<String, String> hmapSchmDscrptnAndBenfit = new LinkedHashMap<String, String>();
        ArrayList<String> listMinMax = new ArrayList<String>();
        try {
            //||'^'||tblProductSegementMap.ProductTaxAmount AS ProductVolumeRateTax
            // tblSchemeSlabDetail (SchemeID text null,SchemeSlabID text null,SchemeSlabDesc text null,BenifitDescr text null);";
            cur = db.rawQuery("Select tblProductAlertNearestSchmApld.SchemeID||'$'||tblProductAlertNearestSchmApld.SchemeSlabID AS SchmIdSlabId,tblSchemeSlabDetail.SchemeSlabDesc||'^'||tblSchemeSlabDetail.BenifitDescr As SchemeDescrption from tblProductAlertNearestSchmApld inner join tblSchemeSlabDetail ON tblProductAlertNearestSchmApld.SchemeID=tblSchemeSlabDetail.SchemeID AND tblProductAlertNearestSchmApld.SchemeSlabID=tblSchemeSlabDetail.SchemeSlabID", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {

                    for (int i = 0; i < cur.getCount(); i++) {

                        hmapSchmDscrptnAndBenfit.put(cur.getString(0), cur.getString(1));
                        cur.moveToNext();
                    }
                }
            }
        } catch (SQLiteException exception) {

        } finally {
            if (cur != null) {
                cur.close();

            }

            return hmapSchmDscrptnAndBenfit;
        }
    }

    public List<TblStoreProductAppliedSchemesBenifitsRecords> fnGetDetailsFromtblStoreProductAppliedSchemesBenifitsRecordsList(String StoreID, String pdaOrderID) {
        //Cursor cursor = db.rawQuery("SELECT  StoreID,ProductID,schId,schSlabId,schSlbBuckId,schSlabSubBucketValue,schSubBucketValType,schSlabSubBucketType,BenifitRowID,ifnull(BenSubBucketType,0) AS BenSubBucketType,ifnull(FreeProductID,0) AS FreeProductID,ifnull(BenifitSubBucketValue,0.0) AS BenifitSubBucketValue,ifnull(BenifitMaxValue,0.0) AS BenifitMaxValue,ifnull(BenifitAssignedValue,0.0) AS BenifitAssignedValue,ifnull(BenifitAssignedValueType,0) AS BenifitAssignedValueType,ifnull(BenifitDiscountApplied,0) AS BenifitDiscountApplied,ifnull(BenifitCouponCode,'NA') AS BenifitCouponCode,ifnull(Sstat,0) AS Sstat,ifnull(Per,0.0) AS Per,ifnull(UOM,0.0) AS UOM,ifnull(WhatFinallyApplied,0) AS WhatFinallyApplied,ifnull(schSlbRowId,0) AS schSlbRowId,ifnull(SchTypeId,0) AS SchTypeId,ifnull(DiscountPercentage,0.0) AS DiscountPercentage,OrderIDPDA,TmpInvoiceCodePDA FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='"+ StoreID + "' and  TmpInvoiceCodePDA='"+pdaOrderID+"'", null);
        Cursor cursor = db.rawQuery("SELECT  StoreID,ProductID,schId,schSlabId,schSlbBuckId,schSlabSubBucketValue,schSubBucketValType,schSlabSubBucketType,BenifitRowID,ifnull(BenSubBucketType,0) AS BenSubBucketType,ifnull(FreeProductID,0) AS FreeProductID,ifnull(BenifitSubBucketValue,0.0) AS BenifitAssignedValue,ifnull(BenifitMaxValue,0.0) AS BenifitMaxValue,ifnull(BenifitAssignedValue,0.0) AS BenifitSubBucketValue,ifnull(BenifitAssignedValueType,0) AS BenifitAssignedValueType,ifnull(BenifitDiscountApplied,0) AS BenifitDiscountApplied,ifnull(BenifitCouponCode,'NA') AS BenifitCouponCode,ifnull(Sstat,0) AS Sstat,ifnull(Per,0.0) AS Per,ifnull(UOM,0.0) AS UOM,ifnull(WhatFinallyApplied,0) AS WhatFinallyApplied,ifnull(schSlbRowId,0) AS schSlbRowId,ifnull(SchTypeId,0) AS SchTypeId,ifnull(DiscountPercentage,0.0) AS DiscountPercentage,OrderIDPDA,TmpInvoiceCodePDA FROM tblStoreProductAppliedSchemesBenifitsRecords WHERE StoreID ='" + StoreID + "' and  TmpInvoiceCodePDA='" + pdaOrderID + "'", null);
        List<TblStoreProductAppliedSchemesBenifitsRecords> tblStoreProductAppliedSchemesBenifitsRecordsList = new ArrayList<TblStoreProductAppliedSchemesBenifitsRecords>();
        try {
            if (cursor != null && cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        TblStoreProductAppliedSchemesBenifitsRecords tblStoreProductAppliedSchemesBenifitsRecords = new TblStoreProductAppliedSchemesBenifitsRecords();
                        tblStoreProductAppliedSchemesBenifitsRecords.setStoreID(cursor.getString(0));
                        tblStoreProductAppliedSchemesBenifitsRecords.setProductID(cursor.getInt(1));
                        tblStoreProductAppliedSchemesBenifitsRecords.setSchId(cursor.getInt(2));
                        tblStoreProductAppliedSchemesBenifitsRecords.setSchSlabId(cursor.getInt(3));
                        tblStoreProductAppliedSchemesBenifitsRecords.setSchSlbBuckId(cursor.getInt(4));
                        tblStoreProductAppliedSchemesBenifitsRecords.setSchSlabSubBucketValue(cursor.getDouble(5));
                        tblStoreProductAppliedSchemesBenifitsRecords.setSchSubBucketValType(cursor.getInt(6));
                        tblStoreProductAppliedSchemesBenifitsRecords.setSchSlabSubBucketType(cursor.getInt(7));
                        tblStoreProductAppliedSchemesBenifitsRecords.setBenifitRowID(cursor.getInt(8));
                        tblStoreProductAppliedSchemesBenifitsRecords.setBenSubBucketType(cursor.getInt(9));
                        tblStoreProductAppliedSchemesBenifitsRecords.setFreeProductID(cursor.getInt(10));
                        tblStoreProductAppliedSchemesBenifitsRecords.setBenifitSubBucketValue(cursor.getDouble(11));
                        tblStoreProductAppliedSchemesBenifitsRecords.setBenifitMaxValue(cursor.getDouble(12));
                        tblStoreProductAppliedSchemesBenifitsRecords.setBenifitAssignedValue(cursor.getDouble(13));
                        tblStoreProductAppliedSchemesBenifitsRecords.setBenifitAssignedValueType(cursor.getInt(14));
                        tblStoreProductAppliedSchemesBenifitsRecords.setBenifitDiscountApplied(cursor.getInt(15));
                        tblStoreProductAppliedSchemesBenifitsRecords.setBenifitCouponCode(cursor.getString(16));
                        tblStoreProductAppliedSchemesBenifitsRecords.setSstat(cursor.getInt(17));
                        tblStoreProductAppliedSchemesBenifitsRecords.setPer(cursor.getDouble(18));
                        tblStoreProductAppliedSchemesBenifitsRecords.setUOM(cursor.getDouble(19));
                        tblStoreProductAppliedSchemesBenifitsRecords.setWhatFinallyApplied(cursor.getInt(20));
                        tblStoreProductAppliedSchemesBenifitsRecords.setSchSlbRowId(cursor.getInt(21));
                        tblStoreProductAppliedSchemesBenifitsRecords.setSchTypeId(cursor.getInt(22));
                        tblStoreProductAppliedSchemesBenifitsRecords.setDiscountPercentage(cursor.getDouble(23));
                        tblStoreProductAppliedSchemesBenifitsRecords.setOrderIDPDA(cursor.getString(24));
                        tblStoreProductAppliedSchemesBenifitsRecords.setTmpInvoiceCodePDA(cursor.getString(25));
                        tblStoreProductAppliedSchemesBenifitsRecordsList.add(tblStoreProductAppliedSchemesBenifitsRecords);
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }
        return tblStoreProductAppliedSchemesBenifitsRecordsList;
    }


    public List<TblProductMappedWithSchemeSlabApplied> fnGetDetailsFromTblProductMappedWithSchemeSlabAppliedRecordsList(String StoreID, String TmpInvoiceCodePDA) {
        Cursor cursor = db.rawQuery("SELECT  StoreId,ProductID,schSlabId,schmIdMapped,Sstat,OrderIDPDA,TmpInvoiceCodePDA FROM tblProductMappedWithSchemeSlabApplied WHERE StoreId ='" + StoreID + "' and  TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        List<TblProductMappedWithSchemeSlabApplied> tblProductMappedWithSchemeSlabAppliedList = new ArrayList<TblProductMappedWithSchemeSlabApplied>();
        try {
            if (cursor != null && cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        TblProductMappedWithSchemeSlabApplied tblProductMappedWithSchemeSlabAppliedRecords = new TblProductMappedWithSchemeSlabApplied();
                        tblProductMappedWithSchemeSlabAppliedRecords.setStoreId(cursor.getString(0));
                        tblProductMappedWithSchemeSlabAppliedRecords.setProductID(cursor.getInt(1));
                        tblProductMappedWithSchemeSlabAppliedRecords.setSchSlabId(cursor.getInt(2));
                        tblProductMappedWithSchemeSlabAppliedRecords.setSchmIdMapped(cursor.getInt(3));
                        tblProductMappedWithSchemeSlabAppliedRecords.setSstat(cursor.getInt(4));
                        tblProductMappedWithSchemeSlabAppliedRecords.setOrderIDPDA(cursor.getString(5));
                        tblProductMappedWithSchemeSlabAppliedRecords.setTmpInvoiceCodePDA(cursor.getString(6));
                        tblProductMappedWithSchemeSlabAppliedList.add(tblProductMappedWithSchemeSlabAppliedRecords);
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }
        return tblProductMappedWithSchemeSlabAppliedList;
    }

    public List<TblStoreProductAddOnSchemeApplied> fnGetDetailsFromTblStoreProductAddOnSchemeAppliedArrayList(String StoreID, String TmpInvoiceCodePDA) {
        Cursor cursor = db.rawQuery("SELECT  StoreID,ProductID,schId,schSlabId,schSlbBuckId,schSlabSubBucketValue,schSubBucketValType,schSlabSubBucketType,BenifitRowID," +
                "ifnull(BenSubBucketType,0),ifnull(FreeProductID,0) AS FreeProductID,ifnull(BenifitSubBucketValue,0.0) AS BenifitSubBucketValue,ifnull(BenifitMaxValue,0.0) AS BenifitMaxValue," +
                "ifnull(BenifitAssignedValue,0.0) AS BenifitAssignedValue,ifnull(BenifitAssignedValueType,0) AS BenifitAssignedValueType," +
                "ifnull(BenifitDiscountApplied,0) AS BenifitDiscountApplied,ifnull(BenifitCouponCode,'NA') AS BenifitCouponCode,ifnull(Sstat,0),ifnull(Per,0.0) AS Per,ifnull(UOM,0.0) AS UOM,ifnull(WhatFinallyApplied,0) AS WhatFinallyApplied,ifnull(schSlbRowId,0) AS schSlbRowId,ifnull(SchTypeId,0) AS SchTypeId,ifnull(DiscountPercentage,0.0) AS DiscountPercentage,ifnull(OrderIDPDA,'NA') AS OrderIDPDA,ifnull(flgAddOn,0) AS flgAddOn,ifnull(isDiscountOnTotalAmount,0) AS isDiscountOnTotalAmount,ifnull(TmpInvoiceCodePDA,'NA') AS TmpInvoiceCodePDA  FROM tblStoreProductAddOnSchemeApplied WHERE StoreID ='" + StoreID + "' and  TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "'", null);
        List<TblStoreProductAddOnSchemeApplied> tblStoreProductAddOnSchemeAppliedArrayList = new ArrayList<TblStoreProductAddOnSchemeApplied>();
        try {
            if (cursor != null && cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        TblStoreProductAddOnSchemeApplied tblStoreProductAddOnSchemeAppliedRecords = new TblStoreProductAddOnSchemeApplied();
                        tblStoreProductAddOnSchemeAppliedRecords.setStoreID(cursor.getString(0));
                        tblStoreProductAddOnSchemeAppliedRecords.setProductID(cursor.getInt(1));
                        tblStoreProductAddOnSchemeAppliedRecords.setSchId(cursor.getInt(2));
                        tblStoreProductAddOnSchemeAppliedRecords.setSchSlabId(cursor.getInt(3));
                        tblStoreProductAddOnSchemeAppliedRecords.setSchSlbBuckId(cursor.getInt(4));
                        tblStoreProductAddOnSchemeAppliedRecords.setSchSlabSubBucketValue(cursor.getDouble(5));
                        tblStoreProductAddOnSchemeAppliedRecords.setSchSubBucketValType(cursor.getInt(6));
                        tblStoreProductAddOnSchemeAppliedRecords.setSchSlabSubBucketType(cursor.getInt(7));
                        tblStoreProductAddOnSchemeAppliedRecords.setBenifitRowID(cursor.getInt(8));
                        tblStoreProductAddOnSchemeAppliedRecords.setBenSubBucketType(cursor.getInt(9));
                        tblStoreProductAddOnSchemeAppliedRecords.setFreeProductID(cursor.getInt(10));
                        tblStoreProductAddOnSchemeAppliedRecords.setBenifitSubBucketValue(cursor.getDouble(11));
                        tblStoreProductAddOnSchemeAppliedRecords.setBenifitMaxValue(cursor.getDouble(12));
                        tblStoreProductAddOnSchemeAppliedRecords.setBenifitAssignedValue(cursor.getDouble(13));
                        tblStoreProductAddOnSchemeAppliedRecords.setBenifitAssignedValueType(cursor.getInt(14));
                        tblStoreProductAddOnSchemeAppliedRecords.setBenifitDiscountApplied(cursor.getInt(15));
                        tblStoreProductAddOnSchemeAppliedRecords.setBenifitCouponCode(cursor.getString(16));
                        tblStoreProductAddOnSchemeAppliedRecords.setPer(cursor.getDouble(17));
                        tblStoreProductAddOnSchemeAppliedRecords.setUOM(cursor.getDouble(18));
                        tblStoreProductAddOnSchemeAppliedRecords.setWhatFinallyApplied(cursor.getInt(19));
                        tblStoreProductAddOnSchemeAppliedRecords.setSchSlbRowId(cursor.getInt(20));
                        tblStoreProductAddOnSchemeAppliedRecords.setSchTypeId(cursor.getInt(21));
                        tblStoreProductAddOnSchemeAppliedRecords.setDiscountPercentage(cursor.getDouble(21));
                        tblStoreProductAddOnSchemeAppliedRecords.setOrderIDPDA(cursor.getString(22));
                        tblStoreProductAddOnSchemeAppliedRecords.setFlgAddOn(cursor.getInt(23));
                        tblStoreProductAddOnSchemeAppliedRecords.setIsDiscountOnTotalAmount(cursor.getInt(24));
                        tblStoreProductAddOnSchemeAppliedRecords.setTmpInvoiceCodePDA(cursor.getString(25));

                        tblStoreProductAddOnSchemeAppliedArrayList.add(tblStoreProductAddOnSchemeAppliedRecords);
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }
        return tblStoreProductAddOnSchemeAppliedArrayList;
    }

    public List<TblSchemeSlabBucketProductMapping> fnGetDetailsFromTblSchemeSlabBucketProductMapping() {
        Cursor cursor = db.rawQuery("SELECT  RowID,ProductID,flgCombine,QtyPerLine  FROM tblSchemeSlabBucketProductMapping", null);
        List<TblSchemeSlabBucketProductMapping> tblSchemeSlabBucketProductMappingArrayList = new ArrayList<TblSchemeSlabBucketProductMapping>();
        try {
            if (cursor != null && cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        TblSchemeSlabBucketProductMapping tblSchemeSlabBucketProductMappingRecords = new TblSchemeSlabBucketProductMapping();
                        tblSchemeSlabBucketProductMappingRecords.setRowID(cursor.getInt(0));
                        tblSchemeSlabBucketProductMappingRecords.setProductID(cursor.getInt(1));
                        tblSchemeSlabBucketProductMappingRecords.setFlgCombine(cursor.getInt(2));
                        tblSchemeSlabBucketProductMappingRecords.setQtyPerLine(cursor.getInt(3));
                        tblSchemeSlabBucketProductMappingArrayList.add(tblSchemeSlabBucketProductMappingRecords);
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }
        return tblSchemeSlabBucketProductMappingArrayList;
    }


    public List<TblSchemeSlabBenefitsBucketDetails> fnGetDetailsFromTblSchemeSlabBenefitsBucketDetails() {
        Cursor cursor = db.rawQuery("SELECT RowID,SchemeID,SchemeSlabID,BucketID,SubBucketID,BenSubBucketType,ifnull(BenDiscApplied,'0') AS BenDiscApplied,ifnull(CouponCode,'NA') AS CouponCode,ifnull(BenSubBucketValue,'0.0') AS BenSubBucketValue,ifnull(Per,0.0) AS Per,ifnull(UOM,0.0) AS UOM,ifnull(ProRata,0) AS ProRata,IsDiscountOnTotalAmount  FROM tblSchemeSlabBenefitsBucketDetails", null);
        List<TblSchemeSlabBenefitsBucketDetails> tblSchemeSlabBenefitsBucketDetailsList = new ArrayList<TblSchemeSlabBenefitsBucketDetails>();
        try {
            if (cursor != null && cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        TblSchemeSlabBenefitsBucketDetails tblSchemeSlabBenefitsBucketDetailsRecord = new TblSchemeSlabBenefitsBucketDetails();
                        tblSchemeSlabBenefitsBucketDetailsRecord.setRowID(cursor.getInt(0));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setSchemeID(cursor.getInt(1));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setSchemeSlabID(cursor.getInt(2));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setBucketID(cursor.getInt(3));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setSubBucketID(cursor.getInt(4));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setBenSubBucketType(cursor.getInt(5));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setBenDiscApplied(cursor.getString(6));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setCouponCode(cursor.getString(7));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setBenSubBucketValue(cursor.getString(8));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setPer(cursor.getDouble(9));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setUOM(cursor.getDouble(10));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setProRata(cursor.getInt(11));
                        tblSchemeSlabBenefitsBucketDetailsRecord.setIsDiscountOnTotalAmount(cursor.getInt(12));
                        tblSchemeSlabBenefitsBucketDetailsList.add(tblSchemeSlabBenefitsBucketDetailsRecord);
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }
        return tblSchemeSlabBenefitsBucketDetailsList;
    }

    public List<TblSchemeSlabBenefitsValueDetail> fnGetDetailsFromTblSchemeSlabBenefitsValueDetail() {
        Cursor cursor = db.rawQuery("SELECT RowID,ifnull(BenValue,0.0) AS BenValue,ifnull(Remarks,'NA') AS Remarks,ifnull(Type,0) AS Type  FROM tblSchemeSlabBenefitsValueDetail", null);
        List<TblSchemeSlabBenefitsValueDetail> tblSchemeSlabBenefitsValueDetailList = new ArrayList<TblSchemeSlabBenefitsValueDetail>();
        try {
            if (cursor != null && cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        TblSchemeSlabBenefitsValueDetail tblSchemeSlabBenefitsValueDetailRecord = new TblSchemeSlabBenefitsValueDetail();
                        tblSchemeSlabBenefitsValueDetailRecord.setRowID(cursor.getInt(0));
                        tblSchemeSlabBenefitsValueDetailRecord.setBenValue(cursor.getDouble(1));
                        tblSchemeSlabBenefitsValueDetailRecord.setRemarks(cursor.getString(2));
                        tblSchemeSlabBenefitsValueDetailRecord.setType(cursor.getInt(3));
                        tblSchemeSlabBenefitsValueDetailList.add(tblSchemeSlabBenefitsValueDetailRecord);
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }
        return tblSchemeSlabBenefitsValueDetailList;
    }

    public List<TblSchemeSlabBenefitsProductMappingDetail> fnGetDetailsFromTblSchemeSlabBenefitsProductMappingDetail() {
        Cursor cursor = db.rawQuery("SELECT RowID,ProductID  FROM tblSchemeSlabBenefitsProductMappingDetail", null);
        List<TblSchemeSlabBenefitsProductMappingDetail> tblSchemeSlabBenefitsProductMappingDetailList = new ArrayList<TblSchemeSlabBenefitsProductMappingDetail>();
        try {
            if (cursor != null && cursor.getCount() > 0) {

                if (cursor.moveToFirst()) {

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        TblSchemeSlabBenefitsProductMappingDetail tblSchemeSlabBenefitsProductMappingDetailListRecord = new TblSchemeSlabBenefitsProductMappingDetail();
                        tblSchemeSlabBenefitsProductMappingDetailListRecord.setRowID(cursor.getInt(0));
                        tblSchemeSlabBenefitsProductMappingDetailListRecord.setProductID(cursor.getInt(1));

                        tblSchemeSlabBenefitsProductMappingDetailList.add(tblSchemeSlabBenefitsProductMappingDetailListRecord);
                        cursor.moveToNext();
                    }
                }
            }

        } finally {
            if (cursor != null) {
                cursor.close();
            }

        }
        return tblSchemeSlabBenefitsProductMappingDetailList;
    }


    public HashMap<String, ArrayList<TblSchemePerProduct>> fnSchemeDescAndSlabDetails(String savProductIdOnClicked, String SchemeID, int sladID, int prdOrdQty) {
        HashMap<String, ArrayList<TblSchemePerProduct>> hmapSlabIDArrRowID = new HashMap<String, ArrayList<TblSchemePerProduct>>();
        Cursor cursor = db.rawQuery("SELECT SchemeName from tblSchemeMstr Where SchemeID='" + SchemeID + "'", null);
        String SchDescr = "NA";
        if (cursor != null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                SchDescr = cursor.getString(0);
                ArrayList<TblSchemePerProduct> hmap = new ArrayList<TblSchemePerProduct>();
                hmap = fnSchemeSlabDetails(SchemeID, sladID, prdOrdQty);
                hmapSlabIDArrRowID.put(savProductIdOnClicked, hmap);
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        return hmapSlabIDArrRowID;
    }

    public ArrayList<TblSchemePerProduct> fnSchemeSlabDetails(String SchemeID, int sladID, int prdOrdQty) {
        ArrayList<TblSchemePerProduct> hmapSlabDetails = new ArrayList<TblSchemePerProduct>();
        Cursor cursorSlab = db.rawQuery("SELECT DISTINCT tblSchemeSlabDetail.SchemeSlabID,tblSchemeSlabDetail.SchemeSlabDesc,tblSchemeSlabDetail.BenifitDescr,ifnull(tblSchemeSlabBucketDetails.SlabSubBucketValue,0) from tblSchemeSlabDetail  inner join tblSchemeSlabBucketDetails on tblSchemeSlabDetail.SchemeID=tblSchemeSlabBucketDetails.SchemeID and tblSchemeSlabDetail.SchemeSlabID=tblSchemeSlabBucketDetails.SchemeSlabID Where tblSchemeSlabDetail.SchemeID='" + SchemeID + "'", null);
        int crntRow = 0;
        if (cursorSlab != null && cursorSlab.getCount() > 0) {
            if (cursorSlab.moveToFirst()) {
                for (int i = 0; i <= (cursorSlab.getCount() - 1); i++) {

                        TblSchemePerProduct tblSchemePerProduct = new TblSchemePerProduct();
                        tblSchemePerProduct.setSlabId("" + sladID);
                        tblSchemePerProduct.setFlgColor(0);
                        tblSchemePerProduct.setAmtToAchieve(cursorSlab.getString(1));
                        tblSchemePerProduct.setDiscount(cursorSlab.getString(2));
                        int benVal = cursorSlab.getInt(3);
                        if (prdOrdQty >= benVal) {
                            tblSchemePerProduct.setGap(0);
                            tblSchemePerProduct.setFlgColor(1);
                        }else if (prdOrdQty < benVal) {
                            tblSchemePerProduct.setGap((benVal - prdOrdQty));
                            tblSchemePerProduct.setFlgColor(2);
                        }  else
                            {
                            tblSchemePerProduct.setGap((benVal - prdOrdQty));
                        }


                        hmapSlabDetails.add(tblSchemePerProduct);
                        crntRow = 0;


                    cursorSlab.moveToNext();
                }

            }
        }
        if (cursorSlab != null) {
            cursorSlab.close();
        }
        return hmapSlabDetails;
    }


    public int fetchStoreRegionID(String storeID) {
//tblActualVisitStock (ProductID text null,Stock text null);";
        Cursor cursor = null;
        int RegionID = 0;

        try {
            cursor = db.rawQuery("SELECT ifnull(RegionID,0) from tblStoreList  where storeID='" + storeID + "'", null);
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    RegionID = cursor.getInt(0);
                }
            }
        } finally {
            if (cursor != null)
                cursor.close();
            return RegionID;
        }
    }


    public HashMap<String, String> fnGetHmapOrderIDPDAStoreIDs() {
        Cursor cursor = db.rawQuery("Select DISTINCT  TmpInvoiceCodePDA,StoreID from tblTmpInvoiceHeader", null);
        HashMap<String, String> hmapOrderIDPDAStoreIDs = new HashMap<String, String>();
        if (cursor != null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapOrderIDPDAStoreIDs.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        if (cursor != null)
            cursor.close();

        return hmapOrderIDPDAStoreIDs;
    }

    public HashMap<String, String> fnGetHmapOrderIDPDAProductIDs() {
        Cursor cursor = db.rawQuery("Select DISTINCT  ProdID,TmpInvoiceCodePDA from tblTmpInvoiceDetails", null);
        HashMap<String, String> hmapOrderIDPDAProductIDs = new HashMap<String, String>();
        if (cursor != null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapOrderIDPDAProductIDs.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }

        if (cursor != null)
            cursor.close();

        return hmapOrderIDPDAProductIDs;
    }

    public LinkedHashMap<String, Integer> fnStoreProductSuggestedQty(String StoreID) {
        LinkedHashMap<String, Integer> hmapSuggestedQty = new LinkedHashMap<String, Integer>();
        //open();
        Cursor cursor = db.rawQuery("SELECT PrdNodeId,SuggestedQty FROM tblStoreSuggestedQtyMstr where StoreID= '" + StoreID + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapSuggestedQty.put(cursor.getString(0), cursor.getInt(1));

                        cursor.moveToNext();
                    }
                }
            }
            return hmapSuggestedQty;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }

    }


    public int fnGetCIfInvoiceTableHasVisitcode(String StoreID) {

        int StoreVisitCodecnt = 0;
        Cursor cursor = db.rawQuery("Select Count(*) from tblTmpInvoiceHeader Where StoreID='" + StoreID + "'", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                StoreVisitCodecnt = Integer.parseInt(cursor.getString(0));
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        return StoreVisitCodecnt;
    }

    public String fnGetStoreVisitcode(String StoreID) {


        int flginvoiceAnyInPErmanentTable = fnCheckForNewInvoiceOrPreviousValueFromPermanentTableAgainstStore(StoreID);
        Cursor cursorE2 = null;
        String InvoiceCodePDA = "0";
        if (CommonInfo.flgDrctslsIndrctSls == 2) {
            if (flginvoiceAnyInPErmanentTable == 0) {
                cursorE2 = db.rawQuery("SELECT StoreVisitCode FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND Sstat=1", null);
            } else {
                cursorE2 = db.rawQuery("SELECT StoreVisitCode FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "'", null);
            }
        } else {
            cursorE2 = db.rawQuery("SELECT StoreVisitCode FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "' AND Sstat=1", null);
        }

        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    InvoiceCodePDA = cursorE2.getString(0).toString();
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }

        return InvoiceCodePDA;
    }


    public int fnCheckForNewInvoiceOrPreviousValueFromPermanentTableAgainstStore(String StoreID) {

        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = 1;
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }


    public HashMap<String, String> fnGethmapflgTeleCallerProduct(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        cursor = db.rawQuery("SELECT ProdID,flgTeleCallerProduct From tblTmpInvoiceDetailsTCOrder where StoreID='" + StoreID + "'", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public HashMap<String, String> fnGethmapProductTeleCallerID(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                cursor = db.rawQuery("SELECT ProdID,flgTeleCallerProduct FROM tblTmpInvoiceDetailsLocalOrder WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    cursor = db.rawQuery("SELECT ProdID,flgTeleCallerProduct From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                } else {
                    cursor = db.rawQuery("SELECT ProdID,flgTeleCallerProduct From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                    //cur = db.rawQuery("SELECT COUNT(*) FROM tblInvoiceDetails WHERE StoreID ='" + StoreId + "' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'", null);
                }
                // cur=db.rawQuery("Select tblProductListMaster.ProductID,tblProductListMaster.ProductShortName from tblProductListMaster inner join tblTmpInvoiceDetails on tblProductListMaster.ProductID=tblTmpInvoiceDetails.ProdID  where tblTmpInvoiceDetails.StoreID='"+StoreId+"' AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"' order by tblProductListMaster.CategoryID Asc,tblProductListMaster.PrdOrdr Asc", null);
            } else {
                cursor = db.rawQuery("SELECT ProdID,flgTeleCallerProduct From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
            }
        } else {
            cursor = db.rawQuery("SELECT ProdID,flgTeleCallerProduct From tblTmpInvoiceDetailsLocalOrder where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }

    public HashMap<String, String> fnGethmapflgTeleCallerProductQty(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);

                int we = 0;
                cursor = db.rawQuery("SELECT ProdID,ifnull(OrderQty,0) FROM tblTmpInvoiceDetailsTCOrder WHERE StoreID ='" + StoreID + "'", null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    cursor = db.rawQuery("SELECT ProdID,ifnull(OrderQty,0) From tblTmpInvoiceDetailsTCOrder where StoreID='" + StoreID + "'", null);
                }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public List<TblStoreProductMappingForDisplay> fnGetTblStoreProductMappingForSearch(String StoreID, String OrderID, int BusinessSegmentId, int RegionID) {

        //  List<TblStoreProductMappingForDisplay> AllDistinctCateGoryApplicableToStore=new ArrayList<TblStoreProductMappingForDisplay>();//fnGetAllCateGoryApplicableToStore(StoreID,OrderID,BusinessSegmentId,RegionID);
       /* for(TblStoreProductMappingForDisplay tblCategoryProduct:AllDistinctCateGoryApplicableToStore)
        {*/
        int SectorID=fnGetSectorID();
        List<TblStoreProductMappingForDisplay> tblStoreProductMappingForDisplay = new ArrayList<TblStoreProductMappingForDisplay>();
        Cursor cursorE2=null;
        if(SectorID==1)
        {
            cursorE2 = db.rawQuery("Select Distinct  '" + StoreID + "' AS StoreID,tPLM.CategoryID,tPLM.ProductID AS PrdNodeID,0 AS PrdNodeType" +
                    ",0 AS SuggestedQty,'" + OrderID + "' AS OrderID,tPLM.ProductShortName AS PrdName,tPSM.standardRate AS PrdPrice,tPLM.DisplayUnit AS DisplayUnit,tPLM.SearchField As SearchField" +
                    ",1 AS flgVisible,0 AS flgShowCategoryHeader,tblCM.CategoryDescr AS CategoryDesc,0 AS ShowAsChild" +
                    ",'#FFFFFF' As ColorCode,tPLM.UOMType from tblProductListMaster tPLM   inner join tblProductSegementMap tPSM on tPLM.ProductID=tPSM.ProductID inner join tblCategoryMaster tblCM on tPLM.CategoryID=tblCM.CategoryID inner join tblPrdMstrTransactionUOMConfig on  tPSM.ProductID=tblPrdMstrTransactionUOMConfig.NodeID and tPSM.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID  Where tPSM.RegionID=" + RegionID + " and (tblPrdMstrTransactionUOMConfig.flgDistInv=1) and flgActive=1  Order by tPLM.CategoryID", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"  
        }
        else
        {
            cursorE2 = db.rawQuery("Select Distinct  '" + StoreID + "' AS StoreID,tPLM.CategoryID,tPLM.ProductID AS PrdNodeID,0 AS PrdNodeType" +
                    ",0 AS SuggestedQty,'" + OrderID + "' AS OrderID,tPLM.ProductShortName AS PrdName,tPSM.standardRate AS PrdPrice,tPLM.DisplayUnit AS DisplayUnit,tPLM.SearchField As SearchField" +
                    ",1 AS flgVisible,0 AS flgShowCategoryHeader,tblCM.CategoryDescr AS CategoryDesc,0 AS ShowAsChild" +
                    ",'#FFFFFF' As ColorCode,tPLM.UOMType from tblProductListMaster tPLM  inner join tblProductSectorMapping on tPLM.ProductID= tblProductSectorMapping.PrdNodeID inner join tblProductSegementMap tPSM on tPLM.ProductID=tPSM.ProductID inner join tblCategoryMaster tblCM on tPLM.CategoryID=tblCM.CategoryID inner join tblPrdMstrTransactionUOMConfig on  tPSM.ProductID=tblPrdMstrTransactionUOMConfig.NodeID and tPSM.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID  Where tPSM.RegionID=" + RegionID + " and (tblPrdMstrTransactionUOMConfig.flgDistInv=1) and flgActive=1 and tblProductSectorMapping.SectorID="+SectorID+" Order by tPLM.CategoryID", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        }
        
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    for (int i = 0; i < cursorE2.getCount(); i++) {
                        if(cursorE2.getInt(2)==11)
                        {
                            String rewe="dsferw";
                        }
                        TblStoreProductMappingForDisplay tblStoreProductMappingForDisplayReord = new TblStoreProductMappingForDisplay();
                        tblStoreProductMappingForDisplayReord.setStoreID(cursorE2.getString(0));
                        tblStoreProductMappingForDisplayReord.setCatID(cursorE2.getInt(1));
                        tblStoreProductMappingForDisplayReord.setPrdNodeID(cursorE2.getInt(2));
                        tblStoreProductMappingForDisplayReord.setPrdNodeType(cursorE2.getInt(3));

                        tblStoreProductMappingForDisplayReord.setSuggestedQty(cursorE2.getInt(4));
                        tblStoreProductMappingForDisplayReord.setOrderID(cursorE2.getString(5));

                        tblStoreProductMappingForDisplayReord.setPrdName(cursorE2.getString(6));
                        tblStoreProductMappingForDisplayReord.setPrdPrice(cursorE2.getString(7));
                        tblStoreProductMappingForDisplayReord.setDisplayUnit(cursorE2.getString(8));
                        tblStoreProductMappingForDisplayReord.setSearchField(cursorE2.getString(9));

                        tblStoreProductMappingForDisplayReord.setFlgVisible(cursorE2.getInt(10));
                        tblStoreProductMappingForDisplayReord.setFlgShowCategoryHeader(cursorE2.getInt(11));
                        tblStoreProductMappingForDisplayReord.setCategoryDesc(cursorE2.getString(12));
                        // tblStoreProductMappingForDisplayReord.setShowAsChild(cursorE2.getInt(13));
                        tblStoreProductMappingForDisplayReord.setColorCode(cursorE2.getString(14));
                        tblStoreProductMappingForDisplayReord.setUOMType(cursorE2.getString(15));
                        tblStoreProductMappingForDisplayReord.setTblUOMMasterList(fnGetUOMAgainstProduct(cursorE2.getInt(2), cursorE2.getString(6), RegionID));
                        tblStoreProductMappingForDisplayReord.setNoOfCartons(fnGetNoOfCartons(StoreID,cursorE2.getInt(1)));
                        tblStoreProductMappingForDisplayReord.setTblProductCategoryUOMTypeLists(fnGetProductCategoryUOMTypeList(StoreID,cursorE2.getInt(1)));
                        tblStoreProductMappingForDisplayReord.setTblProductCategoryUOMTypeListsOverAllSummary(fnGetProductCategoryUOMTypeListOverAllSummary(StoreID,cursorE2.getInt(1)));
                        tblStoreProductMappingForDisplay.add(tblStoreProductMappingForDisplayReord);
                        cursorE2.moveToNext();
                    }
                }

                //  tblCategoryProduct.setmChildTblStoreProductMappings(tblStoreProductMappingForDisplay);
            }


        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        //}

        return tblStoreProductMappingForDisplay;//AllDistinctCateGoryApplicableToStore;
    }

    public List<TblUOMMaster> fnGetUOMAgainstProductCartonPage(int ProductID, String BaseUOMEName, int RegionID) {
        List<TblUOMMaster> tblUOMListMasterList = new ArrayList<TblUOMMaster>();
//        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT tblPrdMstrTransactionUOMConfig.BUOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistInv,ifnull(BaseValue,1) AS RelConversionUnit,ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax  from tblPrdMstrTransactionUOMConfig inner join tblUOMMaster on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMaster.UOMID inner join tblProductSegementMap on tblPrdMstrTransactionUOMConfig.NodeId=tblProductSegementMap.ProductID  inner  join tblUOMMapping on (tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMapping.PackUnitId and tblPrdMstrTransactionUOMConfig.NodeID=tblUOMMapping.NodeId )    where tblProductSegementMap.ProductID=" + ProductID + " and tblProductSegementMap.RegionID=" + RegionID + " and (tblPrdMstrTransactionUOMConfig.flgDistInv=1 or tblPrdMstrTransactionUOMConfig.flgDistInv=2)", null);
        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT tblPrdMstrTransactionUOMConfig.BUOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistInv,ifnull(BaseValue,1) AS RelConversionUnit,ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax  from tblPrdMstrTransactionUOMConfig inner join tblUOMMaster on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMaster.UOMID inner join tblProductSegementMap on (tblPrdMstrTransactionUOMConfig.NodeId=tblProductSegementMap.ProductID and tblPrdMstrTransactionUOMConfig.BUOMID=tblProductSegementMap.UOMID )  inner  join tblUOMMapping on (tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMapping.PackUnitId and tblPrdMstrTransactionUOMConfig.NodeID=tblUOMMapping.NodeId )    where tblProductSegementMap.ProductID=" + ProductID + " and tblProductSegementMap.RegionID=" + RegionID + " and (tblPrdMstrTransactionUOMConfig.flgDistInv=1 or tblPrdMstrTransactionUOMConfig.flgDistInv=2)", null);
//        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT UOMID,UOM from tblUOMMaster inner join tblPrdMstrTransactionUOMConfig on tblUOMMaster.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID where tblPrdMstrTransactionUOMConfig.NodeID=" + ProductID + " order by  UOMID", null);
        int chkI = 0;
        try {
            if (cursorE2UOMAtPrdLevel != null && cursorE2UOMAtPrdLevel.getCount() > 0) {
                if (cursorE2UOMAtPrdLevel.moveToFirst()) {
                    for (int i = 0; i < cursorE2UOMAtPrdLevel.getCount(); i++) {
                        TblUOMMaster tblUOMMaster = new TblUOMMaster();

                        tblUOMMaster.setBUOMID(cursorE2UOMAtPrdLevel.getInt(0));
                        tblUOMMaster.setBUOMName(cursorE2UOMAtPrdLevel.getString(1));
                        tblUOMMaster.setFlgSelected(0);
                        /*if(cursorE2UOMAtPrdLevel.getInt(2)==1)
                        {
                            //if (cursorE2UOMAtPrdLevel.getString(1).toLowerCase().equals(BaseUOMEName.toLowerCase())) {
                            tblUOMMaster.setFlgSelected(1);
                        }*/
                        if(cursorE2UOMAtPrdLevel.getInt(0)==3){
                            tblUOMMaster.setFlgSelected(1);
                        }
                        tblUOMMaster.setRelConversionUnit(cursorE2UOMAtPrdLevel.getDouble(3));
                        tblUOMMaster.setProductMRP(cursorE2UOMAtPrdLevel.getDouble(4));
                        tblUOMMaster.setProductRLP(cursorE2UOMAtPrdLevel.getDouble(5));
                        tblUOMMaster.setProductTaxAmount(cursorE2UOMAtPrdLevel.getDouble(6));
                        tblUOMMaster.setRetMarginPer(cursorE2UOMAtPrdLevel.getDouble(7));
                        tblUOMMaster.setVatTax(cursorE2UOMAtPrdLevel.getDouble(8));
                        tblUOMMaster.setStandardRate(cursorE2UOMAtPrdLevel.getDouble(9));
                        tblUOMMaster.setStandardRateBeforeTax(cursorE2UOMAtPrdLevel.getDouble(10));
                        tblUOMMaster.setStandardTax(cursorE2UOMAtPrdLevel.getDouble(11));
// UOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistInv,BaseValue AS RelConversionUnit,
// ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax

                        tblUOMListMasterList.add(tblUOMMaster);
                        cursorE2UOMAtPrdLevel.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorE2UOMAtPrdLevel != null)
                cursorE2UOMAtPrdLevel.close();
        }
        return tblUOMListMasterList;
    }



    public List<TblUOMMaster> fnGetUOMAgainstProduct(int ProductID, String BaseUOMEName, int RegionID) {
        List<TblUOMMaster> tblUOMListMasterList = new ArrayList<TblUOMMaster>();
//        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT tblPrdMstrTransactionUOMConfig.BUOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistInv,ifnull(BaseValue,1) AS RelConversionUnit,ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax  from tblPrdMstrTransactionUOMConfig inner join tblUOMMaster on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMaster.UOMID inner join tblProductSegementMap on tblPrdMstrTransactionUOMConfig.NodeId=tblProductSegementMap.ProductID  inner  join tblUOMMapping on (tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMapping.PackUnitId and tblPrdMstrTransactionUOMConfig.NodeID=tblUOMMapping.NodeId )    where tblProductSegementMap.ProductID=" + ProductID + " and tblProductSegementMap.RegionID=" + RegionID + " and (tblPrdMstrTransactionUOMConfig.flgDistInv=1 or tblPrdMstrTransactionUOMConfig.flgDistInv=2)", null);
        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT tblPrdMstrTransactionUOMConfig.BUOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistInv,ifnull(BaseValue,1) AS RelConversionUnit,ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax  from tblPrdMstrTransactionUOMConfig inner join tblUOMMaster on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMaster.UOMID inner join tblProductSegementMap on (tblPrdMstrTransactionUOMConfig.NodeId=tblProductSegementMap.ProductID and tblPrdMstrTransactionUOMConfig.BUOMID=tblProductSegementMap.UOMID )  inner  join tblUOMMapping on (tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMapping.PackUnitId and tblPrdMstrTransactionUOMConfig.NodeID=tblUOMMapping.NodeId )    where tblProductSegementMap.ProductID=" + ProductID + " and tblProductSegementMap.RegionID=" + RegionID + " and (tblPrdMstrTransactionUOMConfig.flgDistInv=1 or tblPrdMstrTransactionUOMConfig.flgDistInv=2)", null);
//        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT UOMID,UOM from tblUOMMaster inner join tblPrdMstrTransactionUOMConfig on tblUOMMaster.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID where tblPrdMstrTransactionUOMConfig.NodeID=" + ProductID + " order by  UOMID", null);
        int chkI = 0;
        try {
            if (cursorE2UOMAtPrdLevel != null && cursorE2UOMAtPrdLevel.getCount() > 0) {
                if (cursorE2UOMAtPrdLevel.moveToFirst()) {
                    for (int i = 0; i < cursorE2UOMAtPrdLevel.getCount(); i++) {
                        TblUOMMaster tblUOMMaster = new TblUOMMaster();

                        tblUOMMaster.setBUOMID(cursorE2UOMAtPrdLevel.getInt(0));
                        tblUOMMaster.setBUOMName(cursorE2UOMAtPrdLevel.getString(1));
                        tblUOMMaster.setFlgSelected(0);
                       if(cursorE2UOMAtPrdLevel.getInt(2)==1)
                        {
                        //if (cursorE2UOMAtPrdLevel.getString(1).toLowerCase().equals(BaseUOMEName.toLowerCase())) {
                            tblUOMMaster.setFlgSelected(1);
                        }
                        tblUOMMaster.setRelConversionUnit(cursorE2UOMAtPrdLevel.getDouble(3));
                        tblUOMMaster.setProductMRP(cursorE2UOMAtPrdLevel.getDouble(4));
                        tblUOMMaster.setProductRLP(cursorE2UOMAtPrdLevel.getDouble(5));
                        tblUOMMaster.setProductTaxAmount(cursorE2UOMAtPrdLevel.getDouble(6));
                        tblUOMMaster.setRetMarginPer(cursorE2UOMAtPrdLevel.getDouble(7));
                        tblUOMMaster.setVatTax(cursorE2UOMAtPrdLevel.getDouble(8));
                        tblUOMMaster.setStandardRate(cursorE2UOMAtPrdLevel.getDouble(9));
                        tblUOMMaster.setStandardRateBeforeTax(cursorE2UOMAtPrdLevel.getDouble(10));
                        tblUOMMaster.setStandardTax(cursorE2UOMAtPrdLevel.getDouble(11));
// UOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistInv,BaseValue AS RelConversionUnit,
// ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax

                        tblUOMListMasterList.add(tblUOMMaster);
                        cursorE2UOMAtPrdLevel.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorE2UOMAtPrdLevel != null)
                cursorE2UOMAtPrdLevel.close();
        }
        return tblUOMListMasterList;
    }


    public List<TblStoreProductMappingForDisplay> fnGetAllCateGoryApplicableToStore(String StoreID, String OrderID, int BusinessSegmentId, int RegionID) {
        List<TblStoreProductMappingForDisplay> tblStoreProductMappingForDisplay = new ArrayList<TblStoreProductMappingForDisplay>();
        Cursor cursorE2AtPrdLevel = db.rawQuery("Select  DISTINCT tblCM.CategoryID,tblCM.CategoryDescr AS CategoryDesc from  tblCategoryMaster tblCM   Order by tblCM.CategoryID", null);
        int chkI = 0;
        try {
            if (cursorE2AtPrdLevel != null && cursorE2AtPrdLevel.getCount() > 0) {
                if (cursorE2AtPrdLevel.moveToFirst()) {
                    for (int i = 0; i < cursorE2AtPrdLevel.getCount(); i++) {
                        TblStoreProductMappingForDisplay tblStoreProductMappingForDisplayReord = new TblStoreProductMappingForDisplay();

                        tblStoreProductMappingForDisplayReord.setCatID(cursorE2AtPrdLevel.getInt(0));
                        tblStoreProductMappingForDisplayReord.setCategoryDesc(cursorE2AtPrdLevel.getString(1));
                        tblStoreProductMappingForDisplay.add(tblStoreProductMappingForDisplayReord);
                        cursorE2AtPrdLevel.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorE2AtPrdLevel != null)
                cursorE2AtPrdLevel.close();
        }
        return tblStoreProductMappingForDisplay;
    }


    public void saveTblStoreSuggestedQtyMstrList(List<TblStoreSuggestedQtyMstr> tblStoreSuggestedQtyMstrList) {
        /*for (TblStoreSuggestedQtyMstr tblStoreSuggestedQtyMstr : tblStoreSuggestedQtyMstrList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("StoreID", tblStoreSuggestedQtyMstr.getStoreID());
            initialValues.put("PrdNodeId", tblStoreSuggestedQtyMstr.getPrdNodeId());
            initialValues.put("SuggestedQty", tblStoreSuggestedQtyMstr.getSuggestedQty());
            long insert = db.insert(DATABASE_TblStoreSuggestedQtyMstr, null, initialValues);
            Log.d("tblStoreSuggestedQtyMstr", "" + insert);
        }
*/


        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DATABASE_TblStoreSuggestedQtyMstr + " (StoreID,PrdNodeId,SuggestedQty) VALUES (?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblStoreSuggestedQtyMstr tbl : tblStoreSuggestedQtyMstrList) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindLong(2, tbl.getPrdNodeId());
                stmt.bindLong(3, tbl.getSuggestedQty());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }

    public void saveTblFocusbrandSKUMstrListt(List<TblFocusbrandSKU> tblFocusbrandSKUMstrList) {
       /* for (TblFocusbrandSKU tblFocusbrandSKU : tblFocusbrandSKUMstrList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("StoreID", tblFocusbrandSKU.getStoreID());
            initialValues.put("PrdNodeId", tblFocusbrandSKU.getPrdNodeId());
            long insert = db.insert(DATABASE_tblFocusbrandSKU, null, initialValues);
            Log.d("tblFocusbrandSKU", "" + insert);
        }*/

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DATABASE_tblFocusbrandSKU + " (StoreID,PrdNodeId) VALUES (?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblFocusbrandSKU tbl : tblFocusbrandSKUMstrList) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindLong(2, tbl.getPrdNodeId());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }


    public void saveTblReplenishmentSKUMstrListt(List<TblReplenishmentSKU> tblReplenishmentSKUList) {
      /*  for (TblReplenishmentSKU tblReplenishmentSKU : tblReplenishmentSKUList) {
            ContentValues initialValues = new ContentValues();
            initialValues.put("StoreID", tblReplenishmentSKU.getStoreID());
            initialValues.put("PrdNodeId", tblReplenishmentSKU.getPrdNodeId());

            Log.d("tblReplenishmentSKU", "" + db.insert(DATABASE_tblReplenishmentSKU, null, initialValues));
        }*/


        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DATABASE_tblReplenishmentSKU + " (StoreID,PrdNodeId) VALUES (?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblReplenishmentSKU tbl : tblReplenishmentSKUList) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindLong(2, tbl.getPrdNodeId());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }

    public LinkedHashMap<String, Integer> fnStoreProductFocusedProduct(String StoreID) {
        LinkedHashMap<String, Integer> hmapSuggestedQty = new LinkedHashMap<String, Integer>();
        //open();
        Cursor cursor = db.rawQuery("SELECT PrdNodeId,1 As foucsed FROM tblFocusbrandSKU where StoreID= '" + StoreID + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapSuggestedQty.put(cursor.getString(0), cursor.getInt(1));

                        cursor.moveToNext();
                    }
                }
            }
            return hmapSuggestedQty;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }

    }


    public LinkedHashMap<String, Integer> fnStoreProductReplenishmentSKU(String StoreID) {
        LinkedHashMap<String, Integer> hmapSuggestedQty = new LinkedHashMap<String, Integer>();
        //open();
        Cursor cursor = db.rawQuery("SELECT PrdNodeId,1 As foucsed FROM tblReplenishmentSKU where StoreID= '" + StoreID + "'", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapSuggestedQty.put(cursor.getString(0), cursor.getInt(1));

                        cursor.moveToNext();
                    }
                }
            }
            return hmapSuggestedQty;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }

    }


    public HashMap<String, String> fnGethmapflgTeleCallerStoresList(int flgDrctslsIndrctSls) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblTmpInvoiceDetails where StoreID='"+StoreID+"'  AND TmpInvoiceCodePDA='"+TmpInvoiceCodePDA+"'" , null);
        if (flgDrctslsIndrctSls == 2) {
            int we = 0;
            try {
                cursor = db.rawQuery("SELECT DISTINCT StoreID,flgTeleCallerProduct FROM tblTmpInvoiceDetailsTCOrder where flgTeleCallerProduct=1", null);
                if (cursor.getCount() > 0) {
                    we = 1;

                }
            } catch (Exception ex) {
                if (cursor != null) {
                    cursor.close();
                }
            }

            if (we == 1) {
                cursor = db.rawQuery("SELECT DISTINCT StoreID,flgTeleCallerProduct From tblTmpInvoiceDetailsTCOrder where flgTeleCallerProduct=1", null);
            } else {
                cursor = db.rawQuery("SELECT DISTINCT StoreID,flgTeleCallerProduct From tblInvoiceDetails where flgTeleCallerProduct=1", null);
            }

        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }

    public HashMap<String, String> fetchHmapStoreListForUpdateMstrList() {

        HashMap<String, String> hmapStoreListForUpdateMstrList = new HashMap<String, String>();
        //open();
        Cursor cursor = db.rawQuery("SELECT StoreID,StoreName FROM tblStoreListForUpdateMstr", null);
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        hmapStoreListForUpdateMstrList.put((String) cursor.getString(0).toString(), (String) cursor.getString(1).toString());
                        cursor.moveToNext();
                    }
                }
            }
            return hmapStoreListForUpdateMstrList;
        } finally {
            if (cursor != null)
                cursor.close();
            // close();
        }

    }

    public void fnInsertOrUpdate_tblStoreListForUpdateMstr(List<TblStoreListForUpdateMstr> tblStoreListForUpdateMstrList, HashMap<String, String> hmapStoreListForUpdateMstrList) {

        db.beginTransaction();
        ContentValues initialValues = new ContentValues();
        for (TblStoreListForUpdateMstr tblStoreListForUpdateMstr : tblStoreListForUpdateMstrList) {
            if (!hmapStoreListForUpdateMstrList.containsKey(tblStoreListForUpdateMstr.getStoreID())) {
                initialValues.put("StoreID", tblStoreListForUpdateMstr.getStoreID());
                initialValues.put("StoreName", tblStoreListForUpdateMstr.getStoreName());
                if (tblStoreListForUpdateMstr.getStoreLat() == null) {
                    initialValues.put("StoreLat", "0.0");
                } else {
                    initialValues.put("StoreLat", tblStoreListForUpdateMstr.getStoreLat());
                }
                if (tblStoreListForUpdateMstr.getStoreLong() == null) {
                    initialValues.put("StoreLong", "0.0");
                } else {
                    initialValues.put("StoreLong", tblStoreListForUpdateMstr.getStoreLong());
                }

                initialValues.put("Ownername", tblStoreListForUpdateMstr.getOwnername());
                if (tblStoreListForUpdateMstr.getContactnumber() == null) {
                    initialValues.put("Contactnumber", "");
                } else {
                    initialValues.put("Contactnumber", tblStoreListForUpdateMstr.getContactnumber());
                }

                if (tblStoreListForUpdateMstr.getAddress() == null) {
                    initialValues.put("Address", "NA");
                } else {
                    initialValues.put("Address", tblStoreListForUpdateMstr.getAddress().toString().replaceAll("&", "-").replaceAll("\n", " "));
                }

                initialValues.put("Reasonforupdate", tblStoreListForUpdateMstr.getReasonforupdate());
                initialValues.put("RouteNodeID", tblStoreListForUpdateMstr.getRouteNodeID());
                initialValues.put("RouteNodeType", tblStoreListForUpdateMstr.getRouteNodeType());
                initialValues.put("UpdatedContactnumber", tblStoreListForUpdateMstr.getContactnumber());
                initialValues.put("flgMapped", tblStoreListForUpdateMstr.getFlgMapped());
                initialValues.put("OTP", tblStoreListForUpdateMstr.getOTP());
                initialValues.put("Sstat", tblStoreListForUpdateMstr.getSstat());

                db.insert(DBHelper.TABLE_tblStoreListForUpdateMstr, null, initialValues);

                //   fnUpdatetblStoreListMasterContactInfoDetails(tblStoreListForUpdateMstr.getStoreID(),tblStoreListForUpdateMstr.getReasonforupdate(),tblStoreListForUpdateMstr.getContactnumber(),tblStoreListForUpdateMstr.getFlgMapped(),tblStoreListForUpdateMstr.getOTP());
            }
        }
        db.setTransactionSuccessful();
        db.endTransaction();
        for (TblStoreListForUpdateMstr tblStoreListForUpdateMstr : tblStoreListForUpdateMstrList) {
            final ContentValues initialValuesForStoreMaster = new ContentValues();
            initialValuesForStoreMaster.put("Reasonforupdate", tblStoreListForUpdateMstr.getReasonforupdate());
            initialValuesForStoreMaster.put("UpdatedContactnumber", tblStoreListForUpdateMstr.getContactnumber());
            initialValuesForStoreMaster.put("flgMapped", tblStoreListForUpdateMstr.getFlgMapped());
            initialValuesForStoreMaster.put("OTP", tblStoreListForUpdateMstr.getOTP());


            int affected = db.update("tblStoreList", initialValuesForStoreMaster, "StoreID=?", new String[]{tblStoreListForUpdateMstr.getStoreID()});
        }

    }


    public TblStoreListForUpdateMstr fnGetStoretblStoreListForUpdateMstr(String StoreID) {
        TblStoreListForUpdateMstr tblStoreListForUpdateMstr = new TblStoreListForUpdateMstr();
        Cursor cursor = db.rawQuery("SELECT StoreID, StoreName,ifnull(StoreLatitude,'0.0'), ifnull(StoreLongitude,'0.0'), ifnull(OwnerName,'NA'), ifnull(StoreContactNo,'NA'), ifnull(StoreAddress,'NA'),ifnull(Reasonforupdate,'NA'),ifnull(StoreRouteID,0),ifnull(RouteNodeType,0),ifnull(UpdatedContactnumber,'NA'),ifnull(flgMapped,0),ifnull(OTP,'0'),ifnull(Sstat,0),ifnull(DistanceNear,0.0)  FROM tblStoreList where StoreID='" + StoreID + "' ORDER BY StoreName", null);

        try {
            if (cursor.moveToFirst()) {
                tblStoreListForUpdateMstr.setStoreID(cursor.getString(0));
                tblStoreListForUpdateMstr.setStoreName(cursor.getString(1));
                tblStoreListForUpdateMstr.setStoreLat(cursor.getString(2));
                tblStoreListForUpdateMstr.setStoreLong(cursor.getString(3));
                tblStoreListForUpdateMstr.setOwnername(cursor.getString(4));
                tblStoreListForUpdateMstr.setContactnumber(cursor.getString(5));
                tblStoreListForUpdateMstr.setAddress(cursor.getString(6));
                tblStoreListForUpdateMstr.setReasonforupdate(cursor.getString(7));
                tblStoreListForUpdateMstr.setRouteNodeID(cursor.getInt(8));
                tblStoreListForUpdateMstr.setRouteNodeType(cursor.getInt(9));
                tblStoreListForUpdateMstr.setUpdatedContactnumber(cursor.getString(10));
                tblStoreListForUpdateMstr.setFlgMapped(cursor.getInt(11));
                tblStoreListForUpdateMstr.setOTP(cursor.getString(12));
                tblStoreListForUpdateMstr.setSstat(cursor.getInt(13));
                tblStoreListForUpdateMstr.setDistance(cursor.getDouble(14));
            }
            return tblStoreListForUpdateMstr;
        } finally {
            cursor.close();
        }
    }


    public void fnUpdatetblStoreListForUpdateMstrFlgMappedUpdatedContactnumber(String StoreID, String ContactNumber) {

        try {

            final ContentValues values = new ContentValues();
            values.put("flgMapped", 0);
            values.put("UpdatedContactnumber", ContactNumber);

            int affected = db.update("tblStoreListForUpdateMstr", values, "StoreID=?",
                    new String[]{StoreID});

            int affected1 = db.update("tblStoreList", values, "StoreID=?",
                    new String[]{StoreID});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {

        }

    }


    public void fnUpdatetblStoreListForUpdateMstrFlgMappedOTPContactNumber(String StoreID, String ContactNumber, String OTP) {

        try {
            int i = 0;
            final ContentValues values = new ContentValues();
            values.put("flgMapped", 1);
            values.put("Contactnumber", ContactNumber);
            values.put("UpdatedContactnumber", ContactNumber);
            values.put("OTP", OTP);
            // values.put("Reasonforupdate", "");
            if (i == 0) {
                values.put("Sstat", 3);
                int affected = db.update("tblStoreListForUpdateMstr", values, "StoreID=?",
                        new String[]{StoreID});
                i = 1;
            }
            int affected1 = db.update("tblStoreList", values, "StoreID=?",
                    new String[]{StoreID});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {

        }

    }

    public int fnCheckForAnyInvoiceAgainstStore(String StoreID, int flgDrctslsIndrctSls) {
        int flginvoiceAnyInPErmanentTable = fnCheckForInvoiceDataTableAgainstStoreInPermanentTable(StoreID);
        Cursor cursorE2 = null;
        if (flgDrctslsIndrctSls == 2) {
            if (flginvoiceAnyInPErmanentTable == 0) {
                cursorE2 = db.rawQuery("SELECT * FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "'", null);
            } else {
                cursorE2 = db.rawQuery("SELECT * FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "'", null);
            }
        } else {
            cursorE2 = db.rawQuery("SELECT * FROM tblTmpInvoiceHeader WHERE StoreID='" + StoreID + "'", null);
        }

        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = 1;
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }


    public int fnCheckForAnyInvoiceAgainstStoreTCOrder(String StoreID, int flgDrctslsIndrctSls) {
        int flginvoiceAnyInPErmanentTable = fnCheckForInvoiceDataTableAgainstStoreInPermanentTable(StoreID);
        Cursor cursorE2 = null;
        if (flgDrctslsIndrctSls == 2) {
            if (flginvoiceAnyInPErmanentTable == 0) {
                cursorE2 = db.rawQuery("SELECT * FROM tblTmpInvoiceHeaderTCOrder WHERE StoreID='" + StoreID + "'", null);
            } else {
                cursorE2 = db.rawQuery("SELECT * FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "'", null);
            }
        } else {
            cursorE2 = db.rawQuery("SELECT * FROM tblTmpInvoiceHeaderTCOrder WHERE StoreID='" + StoreID + "'", null);
        }

        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = 1;
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }


    public int fnCheckForInvoiceDataTableAgainstStoreInPermanentTable(String StoreID) {

        Cursor cursorE2 = db.rawQuery("SELECT * FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    chkI = 1;
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }
        return chkI;
    }


    public HashMap<String, String> fnGethmapflgTeleCallerProductQtyStoreSelection(String StoreID, int flgDrctslsIndrctSls) {
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        int chkflgInvoiceAlreadyGenerated = fnCheckForAnyInvoiceAgainstStore(StoreID, flgDrctslsIndrctSls);
        Cursor cursor = null;
        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                cursor = db.rawQuery("SELECT ProductShortName,OriginalTeleCallerProductQty FROM tblTmpInvoiceDetails WHERE StoreID ='" + StoreID + "'", null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    cursor = db.rawQuery("SELECT ProductShortName,OriginalTeleCallerProductQty From tblTmpInvoiceDetails where StoreID='" + StoreID + "'", null);
                } else {
                    cursor = db.rawQuery("SELECT ProductShortName,OriginalTeleCallerProductQty From tblInvoiceDetails where StoreID='" + StoreID + "'", null);
                }
            } else {
                cursor = db.rawQuery("SELECT ProductShortName,OriginalTeleCallerProductQty From tblInvoiceDetails where StoreID='" + StoreID + "'", null);
            }
        } else {
            cursor = db.rawQuery("SELECT ProductShortName,OriginalTeleCallerProductQty From tblTmpInvoiceDetails where StoreID='" + StoreID + "'", null);
        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }

    public HashMap<String, String> checkForStoreIdFlgMapped() {
        Cursor cursor = db.rawQuery("Select StoreID,flgMapped from tblStoreList", null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapStoreIdFlgMapped = new HashMap<String, String>();
        if (cursor != null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapStoreIdFlgMapped.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapStoreIdFlgMapped;
    }


    public HashMap<String, String> checkForStoreIdUpdatedContactNumber() {
        Cursor cursor = db.rawQuery("Select StoreID,ifnull(UpdatedContactnumber,'NA') AS UpdatedContactnumber from tblStoreList", null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapStoreIdUpdatedContactNumber = new HashMap<String, String>();
        if (cursor != null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapStoreIdUpdatedContactNumber.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapStoreIdUpdatedContactNumber;
    }


    public ArrayList<String> getImagesAgainstStore(String StoreID, int flgType, int ImageType) {
        //open();
        Cursor cur = null;
        ArrayList<String> list = new ArrayList<>();
        try {
//flgType
          /*  0=Old Store
            1=New Store
            2=Old Spoke
            3=New Spoke*/

            //Image Type
           /* 1. Outlet Photo
            2. Rack Photo
            3. Spoke Godown Photo
            4. Other Photo

            7. Spoke Before Merchandising
            8. Spoke After Merchandising

            11. Spoke Front/Shop Photo
            12. Spoke Shelevs Photos
            13. Spoke Other Photos
            14. Spoke Sign Photos
            15. Competitor Photos


            */

            cur = db.rawQuery("Select ImageName from " + DBHelper.TABLE_tblStoreImageDetail + " where StoreID='" + StoreID + "' AND ImageType=" + ImageType + "", null);

            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        list.add(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error getStoreClosedImgNameByStoreId = " + e.toString());
        } finally {
            //close();
            if (cur != null) {
                cur.close();
            }
            return list;
        }
    }


    public String fnGetStoreNoPicsFlag(String StoreVisitCode) {
        //open();
        String str = "1^NA";
        Cursor cursor = db.rawQuery("Select ifnull(flgIsPicsAllowed,'1'), ifnull(NoPicsReason,'NA') from tblStoreVisitMstr Where StoreVisitCode='" + StoreVisitCode + "'", null);

        try {
            if(cursor!=null && cursor.getCount()>0) {
                while (cursor.moveToNext()) {
                    str = "" + cursor.getString(0);
                    if (TextUtils.isEmpty(cursor.getString(1)))
                        str = str + "^NA";
                    else
                        str = str + "^" + cursor.getString(1);

                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
        }

        return str;
    }

    public void fnUpdate_tblStoreVisitMaster(String StoreVisitCode, String noPicsReason, int flgIsPicsAllowed) {

        ContentValues initialValues = new ContentValues();
        initialValues.put("flgIsPicsAllowed", flgIsPicsAllowed);
        initialValues.put("NoPicsReason", noPicsReason);

        db.update("tblStoreVisitMstr", initialValues, "StoreVisitCode" + "=?", new String[]{StoreVisitCode});
    }


    public int fnCheckStoreIntblStoreListForUpdateMstr(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT StoreID FROM tblStoreListForUpdateMstr where StoreID='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.moveToFirst()) {

                if (!cursorE2.isNull(0)) {
                    chkI = 1;
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;

    }


    public int fnCheckStoreMappedInStoreListForUpdateMstr(String StoreID) {
        Cursor cursorE2 = db.rawQuery("SELECT flgMapped FROM tblStoreListForUpdateMstr where StoreID='" + StoreID + "'", null);
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.moveToFirst()) {

                if (!cursorE2.isNull(0)) {
                    chkI = Integer.parseInt(cursorE2.getString(0));
                } else {
                    chkI = 0;
                }
            }

        } finally {
            cursorE2.close();
        }
        return chkI;

    }


    public void fnsavetblStoreSummaryDetails(List<TblStoreSummaryDetails> tblGetPDAStoreDetailsList) {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_tblStoreSummaryDetails);

        try {
            //(StoreID text null,OrderID text,VisitID integer,InvDate text,ProductID integer,OrderQty int null, NetLiveOrderVal text null,NetOrderValue text null);";
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblStoreSummaryDetails + " (StoreID, OrderID, InvDate,VisitID, ProductID, OrderQty,NetLineOrderVal,NetOrderValue) VALUES (?, ?, ?, ?, ?, ?, ?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblStoreSummaryDetails tbl : tblGetPDAStoreDetailsList) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindString(2, tbl.getOrderID());
                stmt.bindString(3, tbl.getInvDate());
                stmt.bindLong(4, tbl.getVisitID());
                stmt.bindLong(5, tbl.getProductID());
                stmt.bindDouble(6, tbl.getOrderQty());
                stmt.bindString(7, tbl.getNetLineOrderVal());
                stmt.bindString(8, tbl.getNetOrderValue());

                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }


    public ArrayList<TblProductLevelData> fnGettblStoreSumuuaryDetailsAgainstOrderID(String StoreID, String OrderID, String OrderDate) {
        ArrayList<TblProductLevelData> tblProductLevelDataArrayList = new ArrayList<TblProductLevelData>();
        int SectorID=fnGetSectorID();
        Cursor cursor=null;
        if(SectorID==1)
        {
            cursor = db.rawQuery("SELECT tblStoreSummaryDetails.ProductID,OrderQty,NetLineOrderVal,NetOrderValue,tblProductListMaster.ProductShortName  FROM tblStoreSummaryDetails left outer join tblProductListMaster on tblStoreSummaryDetails.ProductID =tblProductListMaster.ProductID on  where StoreID='" + StoreID + "' and InvDate=='" + OrderDate + "'", null);
        }
        else {
            cursor = db.rawQuery("SELECT tblStoreSummaryDetails.ProductID,OrderQty,NetLineOrderVal,NetOrderValue,tblProductListMaster.ProductShortName  FROM tblStoreSummaryDetails left outer join tblProductListMaster on tblStoreSummaryDetails.ProductID =tblProductListMaster.ProductID inner join tblProductSectorMapping on tblProductListMaster.ProductID=tblProductSectorMapping.PrdNodeID   where StoreID='" + StoreID + "' and InvDate=='" + OrderDate + "' and tblProductSectorMapping.SectorID=" + SectorID + "", null);
        }
        try {
            if (cursor!=null && cursor.getCount()>0 && cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    TblProductLevelData tblProductLevelData = new TblProductLevelData();
                    tblProductLevelData.setPrdNodeId(cursor.getInt(0));
                    tblProductLevelData.setStoreID(Integer.parseInt(StoreID));
                    tblProductLevelData.setQty(cursor.getDouble(1));
                    tblProductLevelData.setPrdName(cursor.getString(4));
                    tblProductLevelData.setOrderValue(cursor.getDouble(2));
                    tblProductLevelDataArrayList.add(tblProductLevelData);
                    cursor.moveToNext();
                }
            }
            return tblProductLevelDataArrayList;
        } finally {
            if(cursor!=null)
            cursor.close();
        }
    }


    public ArrayList<TblProductLevelData> fnGettblStoreTARSSummary(String StoreID, String OrderID, String OrderDate) {
        ArrayList<TblProductLevelData> tblProductLevelDataArrayList = new ArrayList<TblProductLevelData>();
        Cursor cursor = db.rawQuery("SELECT tblStoreSummaryDetails.ProductID,OrderQty,NetLineOrderVal,NetOrderValue,tblProductListMaster.ProductShortName  FROM tblStoreTARSSummary left outer join tblProductListMaster on tblStoreSummaryDetails.ProductID =tblProductListMaster.ProductID where StoreID='" + StoreID + "' and InvDate=='" + OrderDate + "' ORDER BY ProductShortName", null);

        try {
            if (cursor.moveToFirst()) {
                TblProductLevelData tblProductLevelData = new TblProductLevelData();
                tblProductLevelData.setStoreID(Integer.parseInt(StoreID));
                tblProductLevelData.setQty(cursor.getDouble(1));
                tblProductLevelData.setPrdName(cursor.getString(4));
                tblProductLevelData.setOrderValue(cursor.getDouble(2));
                tblProductLevelDataArrayList.add(tblProductLevelData);
            }
            return tblProductLevelDataArrayList;
        } finally {
            cursor.close();
        }
    }


    public HashMap<String, String> fnGethmapflgTeleCallerProductQtyStoreLastVisitTarsOrder(String StoreID, int flgDrctslsIndrctSls) {
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        int chkflgInvoiceAlreadyGenerated = fnCheckForAnyInvoiceAgainstStoreTCOrder(StoreID, flgDrctslsIndrctSls);
        Cursor cursor = null;
        int SectorID=fnGetSectorID();
        if (flgDrctslsIndrctSls == 2) {
            if (chkflgInvoiceAlreadyGenerated == 1) {
                int we = 0;
                if(SectorID==1)
                cursor = db.rawQuery("SELECT ifnull(tblProductListMaster.ProductShortName,'NA'),OriginalTeleCallerProductQty,LineValAftrTxAftrDscnt AS OrderVal,ProdID FROM tblTmpInvoiceDetailsTCOrder  left outer join tblProductListMaster  on tblTmpInvoiceDetailsTCOrder.ProdID =tblProductListMaster.ProductID WHERE StoreID ='" + StoreID + "'", null);
                else
                    cursor = db.rawQuery("SELECT ifnull(tblProductListMaster.ProductShortName,'NA'),OriginalTeleCallerProductQty,LineValAftrTxAftrDscnt AS OrderVal,ProdID FROM tblTmpInvoiceDetailsTCOrder  left outer join tblProductListMaster  on tblTmpInvoiceDetailsTCOrder.ProdID =tblProductListMaster.ProductID inner join tblProductSectorMapping on tblProductListMaster.ProductID=tblProductSectorMapping.PrdNodeID WHERE StoreID ='" + StoreID + "' and tblProductSectorMapping.SectorID="+SectorID, null);
                if (cursor.getCount() > 0) {
                    we = 1;
                    if (cursor != null) {
                        cursor.close();
                    }
                }
                if (we == 1) {
                    if(SectorID==1)
                        cursor = db.rawQuery("SELECT ifnull(tblProductListMaster.ProductShortName,'NA'),OriginalTeleCallerProductQty,LineValAftrTxAftrDscnt AS OrderVal,ProdID From tblTmpInvoiceDetailsTCOrder   left outer join tblProductListMaster on tblTmpInvoiceDetailsTCOrder.ProdID =tblProductListMaster.ProductID where StoreID='" + StoreID + "'", null);
                    else
                    cursor = db.rawQuery("SELECT ifnull(tblProductListMaster.ProductShortName,'NA'),OriginalTeleCallerProductQty,LineValAftrTxAftrDscnt AS OrderVal,ProdID From tblTmpInvoiceDetailsTCOrder   left outer join tblProductListMaster on tblTmpInvoiceDetailsTCOrder.ProdID =tblProductListMaster.ProductID  inner join tblProductSectorMapping on tblProductListMaster.ProductID=tblProductSectorMapping.PrdNodeID  where StoreID='" + StoreID + "' and tblProductSectorMapping.SectorID="+SectorID, null);

                } else {
                    if(SectorID==1)
                    cursor = db.rawQuery("SELECT ifnull(tblProductListMaster.ProductShortName,'NA'),OriginalTeleCallerProductQty,LineValAftrTxAftrDscnt AS OrderVal,ProdID From tblTmpInvoiceDetails   left outer join tblProductListMaster on tblTmpInvoiceDetails.ProdID =tblProductListMaster.ProductID where StoreID='" + StoreID + "'", null);
                    else
                        cursor = db.rawQuery("SELECT ifnull(tblProductListMaster.ProductShortName,'NA'),OriginalTeleCallerProductQty,LineValAftrTxAftrDscnt AS OrderVal,ProdID From tblTmpInvoiceDetails   left outer join tblProductListMaster on tblTmpInvoiceDetails.ProdID =tblProductListMaster.ProductID  inner join tblProductSectorMapping on tblProductListMaster.ProductID=tblProductSectorMapping.PrdNodeID  where StoreID='" + StoreID + "' and tblProductSectorMapping.SectorID="+SectorID, null);
                }
            } else {
                if(SectorID==1)
                cursor = db.rawQuery("SELECT ifnull(tblProductListMaster.ProductShortName,'NA'),OriginalTeleCallerProductQty,LineValAftrTxAftrDscnt AS OrderVal,ProdID From tblInvoiceDetails   left outer join tblProductListMaster on tblInvoiceDetails.ProdID =tblProductListMaster.ProductID where StoreID='" + StoreID + "'", null);
                else
                    cursor = db.rawQuery("SELECT ifnull(tblProductListMaster.ProductShortName,'NA'),OriginalTeleCallerProductQty,LineValAftrTxAftrDscnt AS OrderVal,ProdID From tblInvoiceDetails   left outer join tblProductListMaster on tblInvoiceDetails.ProdID =tblProductListMaster.ProductID  inner join tblProductSectorMapping on tblProductListMaster.ProductID=tblProductSectorMapping.PrdNodeID where StoreID='" + StoreID + "' and tblProductSectorMapping.SectorID="+SectorID, null);
            }
        } else {
            if(SectorID==1)
            cursor = db.rawQuery("SELECT tblProductListMaster.ProductShortName,OriginalTeleCallerProductQty,LineValAftrTxAftrDscnt AS OrderVal,ProdID From tblTmpInvoiceDetailsTCOrder   left outer join tblProductListMaster on tblTmpInvoiceDetailsTCOrder.ProdID =tblProductListMaster.ProductID where StoreID='" + StoreID + "'", null);
            else
                cursor = db.rawQuery("SELECT tblProductListMaster.ProductShortName,OriginalTeleCallerProductQty,LineValAftrTxAftrDscnt AS OrderVal,ProdID From tblTmpInvoiceDetailsTCOrder   left outer join tblProductListMaster on tblTmpInvoiceDetailsTCOrder.ProdID =tblProductListMaster.ProductID inner join tblProductSectorMapping on tblProductListMaster.ProductID=tblProductSectorMapping.PrdNodeID where StoreID='" + StoreID + "' and tblProductSectorMapping.SectorID="+SectorID, null);
        }

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1) + "^" + cursor.getString(2)+ "^" + cursor.getString(3));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }


    public int fnChkRouteApprovedOrNot(int RouteNodeID,int RouteNodeType) {
        int LoncolumnIndex = 0;
        int FchkFlgOnRoute = 0;
        int crtnSeletedRouteID=RouteNodeID;//getRouteId();
        Cursor cursor2 = db.rawQuery("SELECT ifnull(flgApproved,0) FROM tblRouteListMaster where ID='" + crtnSeletedRouteID + "'", null);
        try {
            if (cursor2 != null && cursor2.getCount() > 0) {
                if (cursor2.moveToFirst()) {
                    if (!cursor2.isNull(LoncolumnIndex)) {
                        FchkFlgOnRoute = Integer.parseInt(cursor2.getString(LoncolumnIndex).toString());
                        cursor2.moveToNext();
                    }
                }
            }


        } catch (Exception ex) {

        } finally {
            if (cursor2 != null)
                cursor2.close();
        }
        return FchkFlgOnRoute;
    }


    public int getRouteNodeType() {
        int LoncolumnIndex = 0;

        int strRouteIdMstr = 0;
        Cursor cursor2 = db.rawQuery("SELECT RouteType FROM  tblRouteListMaster where flgTodayRoute=1", null);
        try {
            if (cursor2.moveToFirst()) {

                for (int i = 0; i < cursor2.getCount(); i++) {
                    strRouteIdMstr = Integer.parseInt(cursor2
                            .getString(LoncolumnIndex));
                    cursor2.moveToNext();
                    // cursor.close();
                }

            }

            return strRouteIdMstr;
        } finally {
            cursor2.close();
        }
    }





    public void fnUpdateTblRouteListMasterForApproved(int flgApproved) {

        try {
            int i = 0;
            final ContentValues values = new ContentValues();
            values.put("flgApproved", flgApproved);
            int affected = db.update("tblRouteListMaster", values, "ID=?",
                    new String[]{""+getRouteId()});

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {

        }

    }
    public List<TblUOMMaster> fnGetUOMAgainstProductActualVisitOnly(int ProductID, String BaseUOMEName, int RegionID) {
        List<TblUOMMaster> tblUOMListMasterList = new ArrayList<TblUOMMaster>();
        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT tblUOMMaster.UOMId,UOM,tblPrdMstrTransactionUOMConfig.flgStoreCheck,ifnull(BaseValue,1) AS RelConversionUnit from tblPrdMstrTransactionUOMConfig inner join tblUOMMaster on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMaster.UOMID inner join tblProductSegementMap on tblPrdMstrTransactionUOMConfig.BUOMID=tblProductSegementMap.UOMID  inner  join tblUOMMapping on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMapping.PackUnitId    where tblProductSegementMap.ProductID=" + ProductID + " and tblProductSegementMap.RegionID=" + RegionID + " and (tblPrdMstrTransactionUOMConfig.flgStoreCheck=1 or tblPrdMstrTransactionUOMConfig.flgStoreCheck=2) order by  tblProductSegementMap.UOMID", null);
//        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT UOMID,UOM from tblUOMMaster inner join tblPrdMstrTransactionUOMConfig on tblUOMMaster.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID where tblPrdMstrTransactionUOMConfig.NodeID=" + ProductID + " order by  UOMID", null);
        int chkI = 0;
        try {
            if (cursorE2UOMAtPrdLevel != null && cursorE2UOMAtPrdLevel.getCount() > 0) {
                if (cursorE2UOMAtPrdLevel.moveToFirst()) {
                    for (int i = 0; i < cursorE2UOMAtPrdLevel.getCount(); i++) {
                        TblUOMMaster tblUOMMaster = new TblUOMMaster();

                        tblUOMMaster.setBUOMID(cursorE2UOMAtPrdLevel.getInt(0));
                        tblUOMMaster.setBUOMName(cursorE2UOMAtPrdLevel.getString(1));
                        tblUOMMaster.setFlgSelected(0);
//                        if(cursorE2UOMAtPrdLevel.getInt(2)==1)
//                        {
                        if (cursorE2UOMAtPrdLevel.getString(2).toLowerCase().equals("1")) {
                            tblUOMMaster.setFlgSelected(1);
                        }
                       tblUOMMaster.setRelConversionUnit(cursorE2UOMAtPrdLevel.getDouble(3));
                        /* tblUOMMaster.setProductMRP(cursorE2UOMAtPrdLevel.getDouble(4));
                        tblUOMMaster.setProductRLP(cursorE2UOMAtPrdLevel.getDouble(5));
                        tblUOMMaster.setProductTaxAmount(cursorE2UOMAtPrdLevel.getDouble(6));
                        tblUOMMaster.setRetMarginPer(cursorE2UOMAtPrdLevel.getDouble(7));
                        tblUOMMaster.setVatTax(cursorE2UOMAtPrdLevel.getDouble(8));
                        tblUOMMaster.setStandardRate(cursorE2UOMAtPrdLevel.getDouble(9));
                        tblUOMMaster.setStandardRateBeforeTax(cursorE2UOMAtPrdLevel.getDouble(10));
                        tblUOMMaster.setStandardTax(cursorE2UOMAtPrdLevel.getDouble(11));*/
// UOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistInv,BaseValue AS RelConversionUnit,
// ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax

                        tblUOMListMasterList.add(tblUOMMaster);
                        cursorE2UOMAtPrdLevel.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorE2UOMAtPrdLevel != null)
                cursorE2UOMAtPrdLevel.close();
        }
        return tblUOMListMasterList;
    }

    public List<TblUOMMaster> fnGetUOMAgainstProductActualVisit(int ProductID, String BaseUOMEName, int RegionID) {
        List<TblUOMMaster> tblUOMListMasterList = new ArrayList<TblUOMMaster>();
        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT tblPrdMstrTransactionUOMConfig.BUOMID,UOM,tblPrdMstrTransactionUOMConfig.flgStoreCheck,ifnull(BaseValue,1) AS RelConversionUnit,ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax  from tblPrdMstrTransactionUOMConfig inner join tblUOMMaster on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMaster.UOMID inner join tblProductSegementMap on tblPrdMstrTransactionUOMConfig.BUOMID=tblProductSegementMap.UOMID  left outer  join tblUOMMapping on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMapping.PackUnitId    where tblProductSegementMap.ProductID=" + ProductID + " and tblProductSegementMap.RegionID=" + RegionID + " and (tblPrdMstrTransactionUOMConfig.flgStoreCheck=1 or tblPrdMstrTransactionUOMConfig.flgStoreCheck=2) order by  tblProductSegementMap.UOMID", null);
//        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT UOMID,UOM from tblUOMMaster inner join tblPrdMstrTransactionUOMConfig on tblUOMMaster.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID where tblPrdMstrTransactionUOMConfig.NodeID=" + ProductID + " order by  UOMID", null);
        int chkI = 0;
        try {
            if (cursorE2UOMAtPrdLevel != null && cursorE2UOMAtPrdLevel.getCount() > 0) {
                if (cursorE2UOMAtPrdLevel.moveToFirst()) {
                    for (int i = 0; i < cursorE2UOMAtPrdLevel.getCount(); i++) {
                        TblUOMMaster tblUOMMaster = new TblUOMMaster();

                        tblUOMMaster.setBUOMID(cursorE2UOMAtPrdLevel.getInt(0));
                        tblUOMMaster.setBUOMName(cursorE2UOMAtPrdLevel.getString(1));
                        tblUOMMaster.setFlgSelected(0);
//                        if(cursorE2UOMAtPrdLevel.getInt(2)==1)
//                        {
                        if (cursorE2UOMAtPrdLevel.getString(2).toLowerCase().equals("1")) {
                            tblUOMMaster.setFlgSelected(1);
                        }
                        tblUOMMaster.setRelConversionUnit(cursorE2UOMAtPrdLevel.getDouble(3));
                        tblUOMMaster.setProductMRP(cursorE2UOMAtPrdLevel.getDouble(4));
                        tblUOMMaster.setProductRLP(cursorE2UOMAtPrdLevel.getDouble(5));
                        tblUOMMaster.setProductTaxAmount(cursorE2UOMAtPrdLevel.getDouble(6));
                        tblUOMMaster.setRetMarginPer(cursorE2UOMAtPrdLevel.getDouble(7));
                        tblUOMMaster.setVatTax(cursorE2UOMAtPrdLevel.getDouble(8));
                        tblUOMMaster.setStandardRate(cursorE2UOMAtPrdLevel.getDouble(9));
                        tblUOMMaster.setStandardRateBeforeTax(cursorE2UOMAtPrdLevel.getDouble(10));
                        tblUOMMaster.setStandardTax(cursorE2UOMAtPrdLevel.getDouble(11));
// UOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistInv,BaseValue AS RelConversionUnit,
// ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax

                        tblUOMListMasterList.add(tblUOMMaster);
                        cursorE2UOMAtPrdLevel.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorE2UOMAtPrdLevel != null)
                cursorE2UOMAtPrdLevel.close();
        }
        return tblUOMListMasterList;
    }


    public LinkedHashMap<String, String> fnGetHmapProductsQtyInCarton(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated) {
        //open();
        LinkedHashMap<String, String> hmapPrdctOdrQty = new LinkedHashMap<String, String>();
        Cursor cursor = null;
        cursor = db.rawQuery("SELECT PrdID,PrdQty FROM tblStoreCartonDetails WHERE StoreID ='" + StoreID + "'", null);
        try {
            if (cursor!=null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return hmapPrdctOdrQty;

            // close();
        }
    }
    public int fnGetNoOfCartons(String StoreID,int CatID) {
       int NoOfCartons=0;
        Cursor cursorNoOfCartons = db.rawQuery("Select DISTINCT ifnull(SUM(NoOfCarton),0) AS NoOfCarton,UOMType  from tblStoreCartonDetails where  tblStoreCartonDetails.CatID=" + CatID + " and StoreID='"+StoreID+"' group by UOMType", null);
        int chkI = 0;
        try {
            if (cursorNoOfCartons != null && cursorNoOfCartons.getCount() > 0) {
                if (cursorNoOfCartons.moveToFirst()) {
                    NoOfCartons=cursorNoOfCartons.getInt(0);
                }
            }


        } finally {
            if (cursorNoOfCartons != null)
                cursorNoOfCartons.close();
        }
        return NoOfCartons;
    }

    public List<TblProductCategoryUOMTypeList> fnGetProductCategoryUOMTypeList(String StoreID,int CatID) {
        List<TblProductCategoryUOMTypeList> tblProductCategoryUOMTypeList = new ArrayList<TblProductCategoryUOMTypeList>();
        Cursor cursorProductCategoryUOMTypeList = db.rawQuery("Select  DISTINCT tblStoreCartonDetails.UOMType,tblStoreCartonDetails.NoOfCarton,tblStoreCartonDetails.CartonID,tblCategoryMaster.CategoryDescr,ifnull(LineValBfrTxAftrDscnt,0.0) AS LineValBfrTxAftrDscnt,ifnull(LineValAftrTxAftrDscnt,0.0) AS LineValAftrTxAftrDscnt,tblStoreCartonDetails.CatID,tblStoreCartonDetails.PrdID,tblStoreCartonDetails.PrdQty from tblStoreCartonDetails inner join tblCategoryMaster on tblCategoryMaster.CategoryID=tblStoreCartonDetails.CatID inner join tblTmpInvoiceDetails on  tblStoreCartonDetails.CartonID=tblTmpInvoiceDetails.CartonID and tblStoreCartonDetails.PrdID=tblTmpInvoiceDetails.ProdID where tblStoreCartonDetails.CatID=" + CatID + " and  tblStoreCartonDetails.StoreID='" + StoreID + "' and tblTmpInvoiceDetails.flgInCarton=1 ", null);//group by tblTmpInvoiceDetails.CartonID,tblStoreCartonDetails.UOMType

        int chkI = 0;
        try {
            if (cursorProductCategoryUOMTypeList != null && cursorProductCategoryUOMTypeList.getCount() > 0) {
                if (cursorProductCategoryUOMTypeList.moveToFirst()) {
                    for (int i = 0; i < cursorProductCategoryUOMTypeList.getCount(); i++) {
                        TblProductCategoryUOMTypeList tblProductCategoryUOMTypeList1=new TblProductCategoryUOMTypeList();
                        tblProductCategoryUOMTypeList1.setStoreID(StoreID);
                        tblProductCategoryUOMTypeList1.setCatID(CatID);
                        tblProductCategoryUOMTypeList1.setUOMType(cursorProductCategoryUOMTypeList.getString(0));
                        tblProductCategoryUOMTypeList1.setNoOfCarton(cursorProductCategoryUOMTypeList.getInt(1));
                        tblProductCategoryUOMTypeList1.setCartonID(cursorProductCategoryUOMTypeList.getString(2));
                        tblProductCategoryUOMTypeList1.setCategoryDesc(cursorProductCategoryUOMTypeList.getString(3));
                        tblProductCategoryUOMTypeList1.setStdLineVal(cursorProductCategoryUOMTypeList.getDouble(4));
                        tblProductCategoryUOMTypeList1.setNetLineVal(cursorProductCategoryUOMTypeList.getDouble(5));
                        tblProductCategoryUOMTypeList1.setPrdID(cursorProductCategoryUOMTypeList.getInt(7));
                        tblProductCategoryUOMTypeList1.setQty(cursorProductCategoryUOMTypeList.getInt(8));
                        tblProductCategoryUOMTypeList.add(tblProductCategoryUOMTypeList1);
                        cursorProductCategoryUOMTypeList.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorProductCategoryUOMTypeList != null)
                cursorProductCategoryUOMTypeList.close();
        }
        return tblProductCategoryUOMTypeList;
    }


    public List<TblStoreProductMappingForDisplay> fnGetTblStoreProductMappingForSearchForCarton(String StoreID, String OrderID, int BusinessSegmentId, int RegionID,int CatID,String UOMType) {

        //  List<TblStoreProductMappingForDisplay> AllDistinctCateGoryApplicableToStore=new ArrayList<TblStoreProductMappingForDisplay>();//fnGetAllCateGoryApplicableToStore(StoreID,OrderID,BusinessSegmentId,RegionID);
       /* for(TblStoreProductMappingForDisplay tblCategoryProduct:AllDistinctCateGoryApplicableToStore)
        {*/
        int SectorID=fnGetSectorID();
        List<TblStoreProductMappingForDisplay> tblStoreProductMappingForDisplay = new ArrayList<TblStoreProductMappingForDisplay>();
      /*  Cursor cursorE2 = db.rawQuery("Select  '" + StoreID + "' AS StoreID,tPLM.CategoryID,tPLM.ProductID AS PrdNodeID,0 AS PrdNodeType" +
                ",0 AS SuggestedQty,'" + OrderID + "' AS OrderID,tPLM.ProductShortName AS PrdName,tPSM.standardRate AS PrdPrice,tPLM.DisplayUnit AS DisplayUnit,tPLM.SearchField As SearchField" +
                ",1 AS flgVisible,0 AS flgShowCategoryHeader,tblCM.CategoryDescr AS CategoryDesc,0 AS ShowAsChild" +
                ",'#FFFFFF' As ColorCode from tblProductListMaster tPLM  inner join tblProductSegementMap tPSM on tPLM.ProductID=tPSM.ProductID inner join tblCategoryMaster tblCM on " +
                "tPLM.CategoryID=tblCM.CategoryID inner join tblPrdMstrTransactionUOMConfig on  tPSM.ProductID=tblPrdMstrTransactionUOMConfig.NodeID and " +
                "tPSM.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID  Where tPSM.RegionID=" + RegionID + " " +
                "and (tblPrdMstrTransactionUOMConfig.flgDistInv=1 or tblPrdMstrTransactionUOMConfig.flgDistInv=2) Order by tPLM.CategoryID", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
*/
                Cursor cursorE2=null;
                if(SectorID==1)
                {
                    cursorE2 = db.rawQuery("Select  '" + StoreID + "' AS StoreID,tPLM.CategoryID,tPLM.ProductID AS PrdNodeID,0 AS PrdNodeType" +
                            ",0 AS SuggestedQty,'" + OrderID + "' AS OrderID,tPLM.ProductShortName AS PrdName,tPSM.standardRate AS PrdPrice,tPLM.DisplayUnit AS DisplayUnit,tPLM.SearchField As SearchField" +
                            ",1 AS flgVisible,0 AS flgShowCategoryHeader,tblCM.CategoryDescr AS CategoryDesc,0 AS ShowAsChild" +
                            ",'#FFFFFF' As ColorCode from tblProductListMaster tPLM   inner join tblProductSegementMap tPSM on tPLM.ProductID=tPSM.ProductID inner join tblCategoryMaster tblCM on " +
                            "tPLM.CategoryID=tblCM.CategoryID inner join tblPrdMstrTransactionUOMConfig on  tPSM.ProductID=tblPrdMstrTransactionUOMConfig.NodeID and " +
                            "tPSM.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID  Where tPSM.RegionID=" + RegionID + " " +
                            " and (tblPrdMstrTransactionUOMConfig.flgDistInv=1) and tPLM.CategoryID="+CatID+" and tPLM.UOMType='"+UOMType+"'  and flgActive=1 Order by tPLM.CategoryID", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
                }
                else
                {
                    cursorE2 = db.rawQuery("Select  '" + StoreID + "' AS StoreID,tPLM.CategoryID,tPLM.ProductID AS PrdNodeID,0 AS PrdNodeType" +
                            ",0 AS SuggestedQty,'" + OrderID + "' AS OrderID,tPLM.ProductShortName AS PrdName,tPSM.standardRate AS PrdPrice,tPLM.DisplayUnit AS DisplayUnit,tPLM.SearchField As SearchField" +
                            ",1 AS flgVisible,0 AS flgShowCategoryHeader,tblCM.CategoryDescr AS CategoryDesc,0 AS ShowAsChild" +
                            ",'#FFFFFF' As ColorCode from tblProductListMaster tPLM inner join tblProductSectorMapping on tPLM.ProductID= tblProductSectorMapping.PrdNodeID  inner join tblProductSegementMap tPSM on tPLM.ProductID=tPSM.ProductID inner join tblCategoryMaster tblCM on " +
                            "tPLM.CategoryID=tblCM.CategoryID inner join tblPrdMstrTransactionUOMConfig on  tPSM.ProductID=tblPrdMstrTransactionUOMConfig.NodeID and " +
                            "tPSM.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID  Where tPSM.RegionID=" + RegionID + " " +
                            "and tblProductSectorMapping.SectorID="+SectorID+" and (tblPrdMstrTransactionUOMConfig.flgDistInv=1) and tPLM.CategoryID="+CatID+" and tPLM.UOMType='"+UOMType+"'  and flgActive=1 Order by tPLM.CategoryID", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
                }

        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    for (int i = 0; i < cursorE2.getCount(); i++) {
                        TblStoreProductMappingForDisplay tblStoreProductMappingForDisplayReord = new TblStoreProductMappingForDisplay();
                        tblStoreProductMappingForDisplayReord.setStoreID(cursorE2.getString(0));
                        tblStoreProductMappingForDisplayReord.setCatID(cursorE2.getInt(1));
                        tblStoreProductMappingForDisplayReord.setPrdNodeID(cursorE2.getInt(2));
                        tblStoreProductMappingForDisplayReord.setPrdNodeType(cursorE2.getInt(3));

                        tblStoreProductMappingForDisplayReord.setSuggestedQty(cursorE2.getInt(4));
                        tblStoreProductMappingForDisplayReord.setOrderID(cursorE2.getString(5));

                        tblStoreProductMappingForDisplayReord.setPrdName(cursorE2.getString(6));
                        tblStoreProductMappingForDisplayReord.setPrdPrice(cursorE2.getString(7));
                        tblStoreProductMappingForDisplayReord.setDisplayUnit(cursorE2.getString(8));
                        tblStoreProductMappingForDisplayReord.setSearchField(cursorE2.getString(9));

                        tblStoreProductMappingForDisplayReord.setFlgVisible(cursorE2.getInt(10));
                        tblStoreProductMappingForDisplayReord.setFlgShowCategoryHeader(cursorE2.getInt(11));
                        tblStoreProductMappingForDisplayReord.setCategoryDesc(cursorE2.getString(12));
                        // tblStoreProductMappingForDisplayReord.setShowAsChild(cursorE2.getInt(13));
                        tblStoreProductMappingForDisplayReord.setColorCode(cursorE2.getString(14));
                        tblStoreProductMappingForDisplayReord.setTblUOMMasterList(fnGetUOMAgainstProductCartonPage(cursorE2.getInt(2), cursorE2.getString(6), RegionID));
                        tblStoreProductMappingForDisplayReord.setNoOfCartons(fnGetNoOfCartons(StoreID,cursorE2.getInt(1)));
                        tblStoreProductMappingForDisplayReord.setTblProductCategoryUOMTypeLists(fnGetProductCategoryUOMTypeList(StoreID,cursorE2.getInt(1)));
                        tblStoreProductMappingForDisplayReord.setTblProductCategoryUOMTypeListsOverAllSummary(fnGetProductCategoryUOMTypeListOverAllSummary(StoreID,cursorE2.getInt(1)));
                        tblStoreProductMappingForDisplayReord.setUOMType(UOMType);
                        tblStoreProductMappingForDisplay.add(tblStoreProductMappingForDisplayReord);
                        cursorE2.moveToNext();
                    }
                }

                //  tblCategoryProduct.setmChildTblStoreProductMappings(tblStoreProductMappingForDisplay);
            }


        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        //}

        return tblStoreProductMappingForDisplay;//AllDistinctCateGoryApplicableToStore;
    }
    public LinkedHashMap<String, String> fnGetHmapProductsWithCarton(String StoreID, String TmpInvoiceCodePDA,int CatIDForFilter) {
        //open();
        LinkedHashMap<String, String> hmapPrdctOdrQty = new LinkedHashMap<String, String>();
        Cursor cursor = null;
        cursor = db.rawQuery("SELECT PrdID,ifnull(CartonID,'0') FROM tblStoreCartonDetails WHERE StoreID ='" + StoreID + "' AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and CatID="+CatIDForFilter+"", null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            return hmapPrdctOdrQty;

            // close();
        }
    }




    public void fnSaveTblUOMTypeConverstionList(List<TblUOMTypeConverstion> tblGetPDAStoreVisitHistoryList) {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_UOMTypeConverstion);

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_UOMTypeConverstion + " (UOMType, RelConversionUnits) VALUES (?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblUOMTypeConverstion tbl : tblGetPDAStoreVisitHistoryList) {
                stmt.bindString(1, tbl.getUOMType());
                stmt.bindDouble(2, tbl.getRelConversionUnits());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException(DBHelper.DATABASE_TABLE_UOMTypeConverstion + " failed");
        } finally {
            db.endTransaction();
        }
    }


    public List<TblUOMTypeConverstion> fnGetTblUOMTypeConverstion(int CatIDForFilter) {

        List<TblUOMTypeConverstion> tblUOMTypeConverstionList = new ArrayList<TblUOMTypeConverstion>();
        Cursor cursorE2 = db.rawQuery("Select DISTINCT UOMType,PcsInBox AS RelConversionUnits from  tblProductListMaster where CategoryID="+CatIDForFilter+"", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    for (int i = 0; i < cursorE2.getCount(); i++) {
                        TblUOMTypeConverstion tblUOMTypeConverstion = new TblUOMTypeConverstion();
                        tblUOMTypeConverstion.setUOMType(cursorE2.getString(0));
                        tblUOMTypeConverstion.setRelConversionUnits(cursorE2.getDouble(1));
                        tblUOMTypeConverstionList.add(tblUOMTypeConverstion);
                        cursorE2.moveToNext();
                    }
                }
            }
        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        return tblUOMTypeConverstionList;//AllDistinctCateGoryApplicableToStore;
    }


    public void fnsaveTblStoreCartonDetails(List<TblStoreCartonDetails> tblStoreCartonDetailsList,String CartonID,String StoreID) {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_tblStoreCartonDetails +" where CartonID='"+CartonID+"' and StoreID='"+StoreID+"'");

        try {
            //(StoreID text null,OrderID text,VisitID integer,InvDate text,ProductID integer,OrderQty int null, NetLiveOrderVal text null,NetOrderValue text null);";
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblStoreCartonDetails + " (StoreID, OrderID, TmpInvoiceCodePDA,CartonID, PrdID, CatID,UOMType," +
                    "NoOfCarton,PrdQty,TotalExpectedQty,TotalActualQty,Sstat,CartonProductDiscount) VALUES (?, ?, ?, ?, ?, ?, ?,?, ?, ?, ?,?,?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblStoreCartonDetails tbl : tblStoreCartonDetailsList) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindString(2, tbl.getOrderID());
                stmt.bindString(3, tbl.getTmpInvoiceCodePDA());
                stmt.bindString(4, tbl.getCartonID());
                stmt.bindLong(5, tbl.getPrdID());
                stmt.bindLong(6, tbl.getCatID());
                stmt.bindString(7, tbl.getUOMType());
                stmt.bindLong(8, tbl.getNoOfCarton());
                stmt.bindLong(9, tbl.getPrdQty());
                stmt.bindLong(10, tbl.getTotalExpectedQty());
                stmt.bindLong(11, tbl.getTotalActualQty());
                stmt.bindLong(12, tbl.getSstat());
                stmt.bindDouble(13, tbl.getCartonProductDiscount());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }


    public HashMap<String, String> fnGetProductPurchaseListForCarton(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,String CartonID) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;
        cursor = db.rawQuery("SELECT PrdID,PrdQty FROM tblStoreCartonDetails WHERE StoreID ='" + StoreID + "' AND CartonID='" + CartonID + "'", null);
        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }



    public ArrayList<TblProductTypeMasterForRetriving> fetch_Category_List_Carton(int CatID,String StoreID,String UOMType) {
        //open();
        ArrayList<TblProductTypeMasterForRetriving> tblProductTypeMasterForRetrivings = new ArrayList<TblProductTypeMasterForRetriving>();
        Cursor cursor = db.rawQuery("SELECT DISTINCT CategoryID,CategoryDescr  FROM tblCategoryMaster where CategoryID='"+CatID+"' Order BY CategoryDescr ASC", null);

        if (cursor!=null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                        TblProductTypeMasterForRetriving tblProductTypeMasterForRetriving = new TblProductTypeMasterForRetriving();
                        tblProductTypeMasterForRetriving.setProductType(cursor.getString(1).toString());
                        tblProductTypeMasterForRetriving.setProductTypeNodeID(cursor.getInt(0));
                        tblProductTypeMasterForRetriving.setTblOnlyCategoryMasterForRetrivingList(fetch_Category_ListSubListCarton(cursor.getInt(0),StoreID,UOMType));
                        tblProductTypeMasterForRetrivings.add(tblProductTypeMasterForRetriving);
            }
        }

        if (cursor != null)
            cursor.close();
        //close();
        return tblProductTypeMasterForRetrivings;

    }


    public ArrayList<TblOnlyCategoryMasterForRetriving> fetch_Category_ListSubListCarton(int CategoryID,String StoreID,String UOMType) {
        //open();
        ArrayList<TblOnlyCategoryMasterForRetriving> tblOnlyCategoryMasterForRetrivings = new ArrayList<TblOnlyCategoryMasterForRetriving>();
        Cursor cursornew=null;
        if(UOMType.equals("NA"))
        cursornew = db.rawQuery("SELECT  Distinct 0 UOMID,tblProductListMaster.UOMType FROM tblProductListMaster where tblProductListMaster.UOMType not in (SELECT UOMType FROM tblStoreCartonDetails AS ID Where CategoryID=" + CategoryID + " and StoreID='"+StoreID+"') and CategoryID=" + CategoryID + " order by UOMValue", null);
        else
            cursornew = db.rawQuery("SELECT  Distinct 0 UOMID,tblProductListMaster.UOMType FROM tblProductListMaster where tblProductListMaster.UOMType='"+UOMType+"' and CategoryID=" + CategoryID + " order by UOMValue", null);

        try {
                if (cursornew.getCount() > 0) {
                    if (cursornew.moveToFirst()) {

                        for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                            if(!cursornew.getString(1).equals("NA")) {
                                TblOnlyCategoryMasterForRetriving tblOnlyCategoryMasterForRetriving = new TblOnlyCategoryMasterForRetriving();

                                tblOnlyCategoryMasterForRetriving.setCategoryNodeID(cursornew.getInt(0));
                                tblOnlyCategoryMasterForRetriving.setCategory(cursornew.getString(1));
                                tblOnlyCategoryMasterForRetriving.setParentID(CategoryID);
                                tblOnlyCategoryMasterForRetriving.setSelected(false);
                                tblOnlyCategoryMasterForRetrivings.add(tblOnlyCategoryMasterForRetriving);
                            }
                            //  hmapCatgry.put(cursor.getString(1).toString(),cursor.getString(0).toString());
                            cursornew.moveToNext();
                        }
                    }

                }


            } finally {
                if (cursornew != null)
                    cursornew.close();
                //close();
            }

        return tblOnlyCategoryMasterForRetrivings;
    }



    public int fnGetNoOfCartonsUOMTypeBased(String StoreID,int CatID,String UOMType) {
        int NoOfCartons=0;
        Cursor cursorNoOfCartons = db.rawQuery("Select DISTINCT ifnull(NoOfCarton,0) AS NoOfCarton,UOMType  from tblStoreCartonDetails where  tblStoreCartonDetails.CatID=" + CatID + " and StoreID='"+StoreID+"' and UOMType='"+UOMType+"' group by UOMType", null);
        int chkI = 0;
        try {
            if (cursorNoOfCartons != null && cursorNoOfCartons.getCount() > 0) {
                if (cursorNoOfCartons.moveToFirst()) {
                    NoOfCartons=cursorNoOfCartons.getInt(0);
                }
            }


        } finally {
            if (cursorNoOfCartons != null)
                cursorNoOfCartons.close();
        }
        return NoOfCartons;
    }



    public List<TblProductCategoryUOMTypeList> fnGetProductCategoryUOMTypeListAllLevel(String StoreID) {
        List<TblProductCategoryUOMTypeList> tblProductCategoryUOMTypeList = new ArrayList<TblProductCategoryUOMTypeList>();
        Cursor cursorProductCategoryUOMTypeList = db.rawQuery("Select  DISTINCT UOMType,NoOfCarton,CartonID,tblCategoryMaster.CategoryDescr,tblStoreCartonDetails.CatID from tblStoreCartonDetails left outer join tblCategoryMaster on tblStoreCartonDetails.CategoryID=tblStoreCartonDetails.CatID where  tblStoreCartonDetails.StoreID='" + StoreID + "' group by tblStoreCartonDetails.CatID,UOMType,CartonID", null);

        int chkI = 0;
        try {
            if (cursorProductCategoryUOMTypeList != null && cursorProductCategoryUOMTypeList.getCount() > 0) {
                if (cursorProductCategoryUOMTypeList.moveToFirst()) {
                    for (int i = 0; i < cursorProductCategoryUOMTypeList.getCount(); i++) {
                        TblProductCategoryUOMTypeList tblProductCategoryUOMTypeList1=new TblProductCategoryUOMTypeList();
                        tblProductCategoryUOMTypeList1.setStoreID(StoreID);
                        tblProductCategoryUOMTypeList1.setCatID(cursorProductCategoryUOMTypeList.getInt(4));
                        tblProductCategoryUOMTypeList1.setUOMType(cursorProductCategoryUOMTypeList.getString(3) +"-"+cursorProductCategoryUOMTypeList.getString(0));
                        tblProductCategoryUOMTypeList1.setNoOfCarton(cursorProductCategoryUOMTypeList.getInt(1));
                        tblProductCategoryUOMTypeList1.setCartonID(cursorProductCategoryUOMTypeList.getString(2));
                        tblProductCategoryUOMTypeList1.setCategoryDesc(cursorProductCategoryUOMTypeList.getString(3));
                        tblProductCategoryUOMTypeList.add(tblProductCategoryUOMTypeList1);
                        cursorProductCategoryUOMTypeList.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorProductCategoryUOMTypeList != null)
                cursorProductCategoryUOMTypeList.close();
        }
        return tblProductCategoryUOMTypeList;
    }



    public TbltmpInvoiceHeaderCartonPlusOrder fnGetTbltmpInvoiceHeaderCartonPlusOrder(String StoreID,String StoreVisitCode) {
        TbltmpInvoiceHeaderCartonPlusOrder tbltmpInvoiceHeaderCartonPlusOrder = new TbltmpInvoiceHeaderCartonPlusOrder();
        Cursor cursor2 = db.rawQuery("Select DISTINCT '0' AS StoreVisitCode,TmpInvoiceCodePDA,StoreID,Sum(LineValBfrTxAftrDscnt),Sum(ifnull(TaxValue,0)),(Sum(OverAllDiscount)),Sum(OrderVal)," +
                "Sum(FreeQty),Sstat,Sum(LineValAftrTxAftrDscnt),Sum(OverAllDiscount) from tblTmpInvoiceDetails where StoreID='"+StoreID+"'", null);

        if (cursor2 != null && cursor2.moveToFirst()) {
            tbltmpInvoiceHeaderCartonPlusOrder.setStoreID(StoreID);
            tbltmpInvoiceHeaderCartonPlusOrder.setStoreVisitCode(StoreVisitCode);
            tbltmpInvoiceHeaderCartonPlusOrder.setTmpInvoiceCodePDA(cursor2.getString(1));
            tbltmpInvoiceHeaderCartonPlusOrder.setTotalBeforeTaxDis(cursor2.getDouble(3));
            tbltmpInvoiceHeaderCartonPlusOrder.setTaxAmt(cursor2.getDouble(4));

            tbltmpInvoiceHeaderCartonPlusOrder.setAddDis(cursor2.getDouble(5));
            tbltmpInvoiceHeaderCartonPlusOrder.setInvoiceVal(cursor2.getDouble(6));
            tbltmpInvoiceHeaderCartonPlusOrder.setFreeTotal(cursor2.getInt(7));
            tbltmpInvoiceHeaderCartonPlusOrder.setInvAfterDis(cursor2.getDouble(9));
            tbltmpInvoiceHeaderCartonPlusOrder.setTotalDis(cursor2.getDouble(10));
        }

        if (cursor2 != null)
            cursor2.close();
        return tbltmpInvoiceHeaderCartonPlusOrder;
    }

    public List<TblProductCategoryUOMTypeList> fnGetProductCategoryUOMTypeListOverAllSummary(String StoreID,int CatID) {
        List<TblProductCategoryUOMTypeList> tblProductCategoryUOMTypeList = new ArrayList<TblProductCategoryUOMTypeList>();
        Cursor cursorProductCategoryUOMTypeListSummary = db.rawQuery("Select  DISTINCT tc1.UOMType,tc1.NoOfCarton,tc1.CartonID,tblCategoryMaster.CategoryDescr,ifnull(X.L1,0.0) AS LineValBfrTxAftrDscnt,ifnull(X.L2,0.0) AS LineValAftrTxAftrDscnt,tc1.CatID,ifnull(X.L3,0) AS FreeQty from tblStoreCartonDetails tc1 inner join tblCategoryMaster on tblCategoryMaster.CategoryID=tc1.CatID inner join (SELECT ID.CartonID,SUM(LineValBfrTxAftrDscnt) L1 ,SUM(LineValAftrTxAftrDscnt) L2,flgInCarton,SUM(FreeQty) L3 FROM tblTmpInvoiceDetails AS ID  where flgInCarton=1 Group By ID.CartonID) X on  tc1.CartonID=X.CartonID where tc1.CatID=" + CatID + " and  tc1.StoreID='" + StoreID + "' and X.flgInCarton=1 group by tc1.CartonID,tc1.UOMType", null);//group by tblStoreCartonDetails.CartonID,tblStoreCartonDetails.UOMType
        try {
            if (cursorProductCategoryUOMTypeListSummary != null && cursorProductCategoryUOMTypeListSummary.getCount() > 0) {
                if (cursorProductCategoryUOMTypeListSummary.moveToFirst()) {
                    for (int i = 0; i < cursorProductCategoryUOMTypeListSummary.getCount(); i++) {
                        TblProductCategoryUOMTypeList tblProductCategoryUOMTypeList1=new TblProductCategoryUOMTypeList();
                        tblProductCategoryUOMTypeList1.setStoreID(StoreID);
                        tblProductCategoryUOMTypeList1.setCatID(CatID);
                        tblProductCategoryUOMTypeList1.setUOMType(cursorProductCategoryUOMTypeListSummary.getString(0));
                        tblProductCategoryUOMTypeList1.setNoOfCarton(cursorProductCategoryUOMTypeListSummary.getInt(1));
                        tblProductCategoryUOMTypeList1.setCartonID(cursorProductCategoryUOMTypeListSummary.getString(2));
                        tblProductCategoryUOMTypeList1.setCategoryDesc(cursorProductCategoryUOMTypeListSummary.getString(3));
                        tblProductCategoryUOMTypeList1.setStdLineVal(cursorProductCategoryUOMTypeListSummary.getDouble(4));
                        tblProductCategoryUOMTypeList1.setFreeQty(cursorProductCategoryUOMTypeListSummary.getInt(cursorProductCategoryUOMTypeListSummary.getColumnIndex("FreeQty")));
                        tblProductCategoryUOMTypeList1.setNetLineVal(cursorProductCategoryUOMTypeListSummary.getDouble(5));

                        tblProductCategoryUOMTypeList.add(tblProductCategoryUOMTypeList1);
                        cursorProductCategoryUOMTypeListSummary.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorProductCategoryUOMTypeListSummary != null)
                cursorProductCategoryUOMTypeListSummary.close();
        }
        return tblProductCategoryUOMTypeList;
    }



    public long saveStoreTempInvoiceTCOrder(String StoreVisitCode, String TmpInvoiceCodePDA, String storeID, String pickerDate, Double TBtaxDis, Double TAmt, Double Dis, Double INval,
                                     int Ftotal, Double InvAfterDis, Double AddDis, int NoOfCouponValue, Double TotalCoupunAmount, String pickerDateWithTime, int flgTransType,
                                     int flgWholeSellApplicable, int flgRuleTaxVal, int Outstat, int flgTransferStatus, String routeID, String routetype, String TeleCallingID)// , Double CreditAmt, Double

    {

        ContentValues initialValues = new ContentValues();

        initialValues.put("StoreVisitCode", StoreVisitCode);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("InvoiceDate", pickerDate);
        initialValues.put("TotalBeforeTaxDis", TBtaxDis);
        initialValues.put("TaxAmt", TAmt);
        initialValues.put("TotalDis", Dis);
        initialValues.put("InvoiceVal", INval);
        initialValues.put("FreeTotal", Ftotal);
        initialValues.put("InvAfterDis", InvAfterDis);
        initialValues.put("AddDis", AddDis);
        initialValues.put("NoCoupon", NoOfCouponValue);
        initialValues.put("TotalCoupunAmount", TotalCoupunAmount);
        initialValues.put("TransDate", pickerDateWithTime);
        initialValues.put("FlgInvoiceType", flgTransType);
        initialValues.put("flgWholeSellApplicable", flgWholeSellApplicable);
        initialValues.put("flgTransferStatus", flgTransferStatus);
        initialValues.put("RouteNodeID", routeID);
        initialValues.put("RouteNodetype", routetype);
        initialValues.put("TeleCallingID", TeleCallingID);
        //  initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        //flgTransferStatus
        initialValues.put("Sstat", Outstat);

        return db.insert(DBHelper.DATABASE_TABLE_MAINtblTmpInvoiceHeaderTCOrder, null, initialValues);
    }


    public long fnsaveStoreTempOrderEntryDetailsTCOrder(String TmpInvoiceCodePDA, String storeID, String PCateId, String ProductID, Double PRate, Double TaxRate, int flgRuleTaxVal, int OrderQTY, int SelectedUOMId, Double LineValBfrTxAftrDscnt, Double LineValAftrTxAftrDscnt,
                                                 int OrderFreeQty, Double OrderDisVal, int SampleQTY, String PName, Double TaxValue, String strGlobalOrderID, int flgIsQuoteRateApplied, int PriceApplyDiscountLevelType, String distID, int Outstat, int ProductExtraOrder, String OrderValue, int SuggestedQty, int OrderQTYToShow, int UOMSeleted, int flgTeleCallerProduct, int flgUserEditedProduct, int OriginalTeleCallerProductQty, String TeleCallingID,String CartonID,int flgInCarton,double Discperpcs) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("CatID", PCateId);
        initialValues.put("ProdID", ProductID);
        initialValues.put("ProductPrice", PRate);
        initialValues.put("TaxRate", TaxRate);
        initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        initialValues.put("OrderQty", OrderQTY);
        initialValues.put("UOMId", SelectedUOMId);

        initialValues.put("LineValBfrTxAftrDscnt", LineValBfrTxAftrDscnt);

        initialValues.put("LineValAftrTxAftrDscnt", LineValAftrTxAftrDscnt);
        initialValues.put("FreeQty", OrderFreeQty);
        initialValues.put("DisVal", OrderDisVal);
        initialValues.put("SampleQuantity", SampleQTY);
        initialValues.put("ProductShortName", PName);

        initialValues.put("TaxValue", TaxValue);
        initialValues.put("OrderIDPDA", strGlobalOrderID);
        initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
        initialValues.put("ServingDBRId", distID);
        initialValues.put("flgWholeSellApplicable", PriceApplyDiscountLevelType);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("ProductExtraOrder", ProductExtraOrder);
        initialValues.put("Sstat", Outstat);
        initialValues.put("OrderVal", OrderValue);
        initialValues.put("SuggestedQty", SuggestedQty);
        initialValues.put("OrderQtyDataToShow", OrderQTYToShow);
        initialValues.put("flgPicsOrCases", UOMSeleted);
        initialValues.put("flgTeleCallerProduct", flgTeleCallerProduct);
        initialValues.put("flgUserEditedProduct", flgUserEditedProduct);
        initialValues.put("OriginalTeleCallerProductQty", OriginalTeleCallerProductQty);
        initialValues.put("CartonID", CartonID);
        initialValues.put("flgInCarton", flgInCarton);
        initialValues.put("DiscountPerUOM",Discperpcs);
        // initialValues.put("TeleCallingID", TeleCallingID);


        //SuggestedQty int null


        return db.insert(DBHelper.DATABASE_TABLE_tblTmpInvoiceDetailsTCOrder, null, initialValues);
    }



    public List<TblStoreProductMappingForDisplay> fnGetTblStoreProductMappingForSearchTCOrder(String StoreID, String OrderID, int BusinessSegmentId, int RegionID) {

        //  List<TblStoreProductMappingForDisplay> AllDistinctCateGoryApplicableToStore=new ArrayList<TblStoreProductMappingForDisplay>();//fnGetAllCateGoryApplicableToStore(StoreID,OrderID,BusinessSegmentId,RegionID);
       /* for(TblStoreProductMappingForDisplay tblCategoryProduct:AllDistinctCateGoryApplicableToStore)
        {*/
        List<TblStoreProductMappingForDisplay> tblStoreProductMappingForDisplay = new ArrayList<TblStoreProductMappingForDisplay>();
        Cursor cursorE2 = db.rawQuery("Select  '" + StoreID + "' AS StoreID,tPLM.CategoryID,tPLM.ProductID AS PrdNodeID,0 AS PrdNodeType" +
                ",0 AS SuggestedQty,'" + OrderID + "' AS OrderID,tPLM.ProductShortName AS PrdName,tPSM.standardRate AS PrdPrice,tPLM.DisplayUnit AS DisplayUnit,tPLM.SearchField As SearchField" +
                ",1 AS flgVisible,0 AS flgShowCategoryHeader,tblCM.CategoryDescr AS CategoryDesc,0 AS ShowAsChild" +
                ",'#FFFFFF' As ColorCode from tblProductListMaster tPLM  inner join tblProductSegementMap tPSM on tPLM.ProductID=tPSM.ProductID inner join tblCategoryMaster tblCM on tPLM.CategoryID=tblCM.CategoryID inner join tblPrdMstrTransactionUOMConfig on  tPSM.ProductID=tblPrdMstrTransactionUOMConfig.NodeID and tPSM.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID  Where tPSM.RegionID=" + RegionID + " and (tblPrdMstrTransactionUOMConfig.flgDistInv=1) Order by tPLM.CategoryID", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    for (int i = 0; i < cursorE2.getCount(); i++) {
                        TblStoreProductMappingForDisplay tblStoreProductMappingForDisplayReord = new TblStoreProductMappingForDisplay();
                        tblStoreProductMappingForDisplayReord.setStoreID(cursorE2.getString(0));
                        tblStoreProductMappingForDisplayReord.setCatID(cursorE2.getInt(1));
                        tblStoreProductMappingForDisplayReord.setPrdNodeID(cursorE2.getInt(2));
                        tblStoreProductMappingForDisplayReord.setPrdNodeType(cursorE2.getInt(3));

                        tblStoreProductMappingForDisplayReord.setSuggestedQty(cursorE2.getInt(4));
                        tblStoreProductMappingForDisplayReord.setOrderID(cursorE2.getString(5));

                        tblStoreProductMappingForDisplayReord.setPrdName(cursorE2.getString(6));
                        tblStoreProductMappingForDisplayReord.setPrdPrice(cursorE2.getString(7));
                        tblStoreProductMappingForDisplayReord.setDisplayUnit(cursorE2.getString(8));
                        tblStoreProductMappingForDisplayReord.setSearchField(cursorE2.getString(9));

                        tblStoreProductMappingForDisplayReord.setFlgVisible(cursorE2.getInt(10));
                        tblStoreProductMappingForDisplayReord.setFlgShowCategoryHeader(cursorE2.getInt(11));
                        tblStoreProductMappingForDisplayReord.setCategoryDesc(cursorE2.getString(12));
                        // tblStoreProductMappingForDisplayReord.setShowAsChild(cursorE2.getInt(13));
                        tblStoreProductMappingForDisplayReord.setColorCode(cursorE2.getString(14));
                        tblStoreProductMappingForDisplayReord.setTblUOMMasterList(fnGetUOMAgainstProduct(cursorE2.getInt(2), cursorE2.getString(6), RegionID));
                        tblStoreProductMappingForDisplayReord.setNoOfCartons(fnGetNoOfCartons(StoreID,cursorE2.getInt(1)));
                        tblStoreProductMappingForDisplayReord.setTblProductCategoryUOMTypeLists(fnGetProductCategoryUOMTypeList(StoreID,cursorE2.getInt(1)));
                        tblStoreProductMappingForDisplayReord.setTblProductCategoryUOMTypeListsOverAllSummary(fnGetProductCategoryUOMTypeListOverAllSummary(StoreID,cursorE2.getInt(1)));
                        tblStoreProductMappingForDisplay.add(tblStoreProductMappingForDisplayReord);
                        cursorE2.moveToNext();
                    }
                }

                //  tblCategoryProduct.setmChildTblStoreProductMappings(tblStoreProductMappingForDisplay);
            }


        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        //}

        return tblStoreProductMappingForDisplay;//AllDistinctCateGoryApplicableToStore;
    }


    public int fnGetCIfInvoiceTableHasVisitcodeTCOrder(String StoreID) {

        int StoreVisitCodecnt = 0;
        Cursor cursor = db.rawQuery("Select Count(*) from tblTmpInvoiceHeaderTCOrder Where StoreID='" + StoreID + "'", null);

        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                StoreVisitCodecnt = Integer.parseInt(cursor.getString(0));
            }
        }
        if (cursor != null) {
            cursor.close();
        }
        return StoreVisitCodecnt;
    }


    public String fnGetStoreVisitcodeTCOrder(String StoreID) {


        int flginvoiceAnyInPErmanentTable = fnCheckForNewInvoiceOrPreviousValueFromPermanentTableAgainstStore(StoreID);
        Cursor cursorE2 = null;
        String InvoiceCodePDA = "0";
        if (CommonInfo.flgDrctslsIndrctSls == 2) {
            if (flginvoiceAnyInPErmanentTable == 0) {
                cursorE2 = db.rawQuery("SELECT StoreVisitCode FROM tblTmpInvoiceHeaderTCOrder WHERE StoreID='" + StoreID + "' AND Sstat=1", null);
            } else {
                cursorE2 = db.rawQuery("SELECT StoreVisitCode FROM tblInvoiceHeader WHERE StoreID='" + StoreID + "' ", null);
            }
        } else {
            cursorE2 = db.rawQuery("SELECT StoreVisitCode FROM tblTmpInvoiceHeaderTCOrder WHERE StoreID='" + StoreID + "' AND Sstat=1", null);
        }

        int chkI = 0;
        try {
            if (cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    InvoiceCodePDA = cursorE2.getString(0).toString();
                }
            }
        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
        }

        return InvoiceCodePDA;
    }


    public long fnsaveStoreTempOrderEntryDetailsMainSyncTable(String TmpInvoiceCodePDA, String storeID, String PCateId, String ProductID, Double PRate, Double TaxRate, int flgRuleTaxVal, int OrderQTY, int SelectedUOMId, Double LineValBfrTxAftrDscnt, Double LineValAftrTxAftrDscnt,
                                                 int OrderFreeQty, Double OrderDisVal, int SampleQTY, String PName, Double TaxValue, String strGlobalOrderID, int flgIsQuoteRateApplied, int PriceApplyDiscountLevelType, String distID, int Outstat, int ProductExtraOrder, String OrderValue, int SuggestedQty, int OrderQTYToShow, int UOMSeleted, int flgTeleCallerProduct, int flgUserEditedProduct, int OriginalTeleCallerProductQty, String TeleCallingID,String CartonID,int flgInCarton,double DiscountPerUOM,double OverAllDiscount) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("CatID", PCateId);
        initialValues.put("ProdID", ProductID);
        initialValues.put("ProductPrice", PRate);
        initialValues.put("TaxRate", TaxRate);
        initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        initialValues.put("OrderQty", OrderQTY);
        initialValues.put("UOMId", SelectedUOMId);

        initialValues.put("LineValBfrTxAftrDscnt", LineValBfrTxAftrDscnt);

        initialValues.put("LineValAftrTxAftrDscnt", LineValAftrTxAftrDscnt);
        initialValues.put("FreeQty", OrderFreeQty);
        initialValues.put("DisVal", OrderDisVal);
        initialValues.put("SampleQuantity", SampleQTY);
        initialValues.put("ProductShortName", PName);

        initialValues.put("TaxValue", TaxValue);
        initialValues.put("OrderIDPDA", strGlobalOrderID);
        initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
        initialValues.put("ServingDBRId", distID);
        initialValues.put("flgWholeSellApplicable", PriceApplyDiscountLevelType);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("ProductExtraOrder", ProductExtraOrder);
        initialValues.put("Sstat", Outstat);
        initialValues.put("OrderVal", OrderValue);
        initialValues.put("SuggestedQty", SuggestedQty);
        initialValues.put("OrderQtyDataToShow", OrderQTYToShow);
        initialValues.put("flgPicsOrCases", UOMSeleted);
        initialValues.put("flgTeleCallerProduct", flgTeleCallerProduct);
        initialValues.put("flgUserEditedProduct", flgUserEditedProduct);
        initialValues.put("OriginalTeleCallerProductQty", OriginalTeleCallerProductQty);
        initialValues.put("CartonID", CartonID);
        initialValues.put("flgInCarton", flgInCarton);
        initialValues.put("DiscountPerUOM", DiscountPerUOM);
        initialValues.put("OverAllDiscount", OverAllDiscount);
        // initialValues.put("TeleCallingID", TeleCallingID);


        //SuggestedQty int null


        return db.insert(DBHelper.DATABASE_TABLE_MAIN210, null, initialValues);

    }
    public long fnsaveStoreTempOrderEntryDetailsCartonEntry(String TmpInvoiceCodePDA, String storeID, String PCateId, String ProductID, Double PRate, Double TaxRate, int flgRuleTaxVal, int OrderQTY, int SelectedUOMId, Double LineValBfrTxAftrDscnt, Double LineValAftrTxAftrDscnt,
                                                 int OrderFreeQty, Double OrderDisVal, int SampleQTY, String PName, Double TaxValue, String strGlobalOrderID, int flgIsQuoteRateApplied, int PriceApplyDiscountLevelType, String distID, int Outstat, int ProductExtraOrder, String OrderValue, int SuggestedQty, int OrderQTYToShow, int UOMSeleted, int flgTeleCallerProduct, int flgUserEditedProduct, int OriginalTeleCallerProductQty, String TeleCallingID,String CartonID,int flgInCarton,double DiscountPerUOM,double OverAllDiscount) {
        ContentValues initialValues = new ContentValues();
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("StoreID", storeID);
        initialValues.put("CatID", PCateId);
        initialValues.put("ProdID", ProductID);
        initialValues.put("ProductPrice", PRate);
        initialValues.put("TaxRate", TaxRate);
        initialValues.put("flgRuleTaxVal", flgRuleTaxVal);
        initialValues.put("OrderQty", OrderQTY);
        initialValues.put("UOMId", SelectedUOMId);

        initialValues.put("LineValBfrTxAftrDscnt", LineValBfrTxAftrDscnt);

        initialValues.put("LineValAftrTxAftrDscnt", LineValAftrTxAftrDscnt);
        initialValues.put("FreeQty", OrderFreeQty);
        initialValues.put("DisVal", OrderDisVal);
        initialValues.put("SampleQuantity", SampleQTY);
        initialValues.put("ProductShortName", PName);

        initialValues.put("TaxValue", TaxValue);
        initialValues.put("OrderIDPDA", strGlobalOrderID);
        initialValues.put("flgIsQuoteRateApplied", flgIsQuoteRateApplied);
        initialValues.put("ServingDBRId", distID);
        initialValues.put("flgWholeSellApplicable", PriceApplyDiscountLevelType);
        initialValues.put("TmpInvoiceCodePDA", TmpInvoiceCodePDA);
        initialValues.put("ProductExtraOrder", ProductExtraOrder);
        initialValues.put("Sstat", Outstat);
        initialValues.put("OrderVal", OrderValue);
        initialValues.put("SuggestedQty", SuggestedQty);
        initialValues.put("OrderQtyDataToShow", OrderQTYToShow);
        initialValues.put("flgPicsOrCases", UOMSeleted);
        initialValues.put("flgTeleCallerProduct", flgTeleCallerProduct);
        initialValues.put("flgUserEditedProduct", flgUserEditedProduct);
        initialValues.put("OriginalTeleCallerProductQty", OriginalTeleCallerProductQty);
        initialValues.put("CartonID", CartonID);
        initialValues.put("flgInCarton", flgInCarton);
        initialValues.put("DiscountPerUOM", DiscountPerUOM);
        initialValues.put("OverAllDiscount", OverAllDiscount);
        // initialValues.put("TeleCallingID", TeleCallingID);


        //SuggestedQty int null


        return db.insert(DBHelper.DATABASE_TABLE_MAIN210, null, initialValues);
       // return db.insert(DBHelper.DATABASE_TABLE_tblTmpInvoiceDetailsLocalOrder, null, initialValues);
    }



    public void fnsaveTblStoreCartonMaster(List<TblStoreCartonMaster> tblStoreCartonMasterList, String CartonID, String StoreID) {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_tblStoreCartonMaster +" where CartonID='"+CartonID+"' and StoreID='"+StoreID+"'");

        try {
            //(StoreID text null,OrderID text,VisitID integer,InvDate text,ProductID integer,OrderQty int null, NetLiveOrderVal text null,NetOrderValue text null);";
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblStoreCartonMaster + " (StoreID, OrderID, TmpInvoiceCodePDA,CartonID, CatID,UOMType," +
                    "NoOfCarton,TotalExpectedQty,TotalActualQty,Sstat,CartonDiscount) VALUES (?, ?, ?, ?, ?, ?, ?,?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblStoreCartonMaster tbl : tblStoreCartonMasterList) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindString(2, tbl.getOrderID());
                stmt.bindString(3, tbl.getTmpInvoiceCodePDA());
                stmt.bindString(4, tbl.getCartonID());

                stmt.bindLong(5, tbl.getCatID());
                stmt.bindString(6, tbl.getUOMType());
                stmt.bindLong(7, tbl.getNoOfCarton());

                stmt.bindLong(8, tbl.getTotalExpectedQty());
                stmt.bindLong(9, tbl.getTotalActualQty());
                stmt.bindLong(10, tbl.getSstat());
                stmt.bindDouble(11, tbl.getCartonDiscount());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }



    public List<TblProductCategoryUOMTypeList> fnGetProductCategoryUOMTypeListOverAllSummaryWithDistinctCategoryOfStore(String StoreID) {
        List<TblProductCategoryUOMTypeList> tblProductCategoryUOMTypeList = new ArrayList<TblProductCategoryUOMTypeList>();
        Cursor cursorProductCategoryUOMTypeReport = db.rawQuery("Select  DISTINCT tblCategoryMaster.CategoryID,tblCategoryMaster.CategoryDescr from tblStoreCartonDetails tc1 inner join tblCategoryMaster on tblCategoryMaster.CategoryID=tc1.CatID inner join (SELECT ID.CartonID,SUM(LineValBfrTxAftrDscnt) L1 ,SUM(LineValAftrTxAftrDscnt) L2,flgInCarton,SUM(FreeQty) L3 FROM tblTmpInvoiceDetails AS ID  where flgInCarton=1 Group By ID.CartonID) X on  tc1.CartonID=X.CartonID where  tc1.StoreID='" + StoreID + "' and X.flgInCarton=1 group by tc1.CartonID,tc1.UOMType", null);//group by tblStoreCartonDetails.CartonID,tblStoreCartonDetails.UOMType
        try {
            if (cursorProductCategoryUOMTypeReport != null && cursorProductCategoryUOMTypeReport.getCount() > 0) {
                if (cursorProductCategoryUOMTypeReport.moveToFirst()) {
                    for (int i = 0; i < cursorProductCategoryUOMTypeReport.getCount(); i++) {
                        TblProductCategoryUOMTypeList tblProductCategoryUOMTypeList1=new TblProductCategoryUOMTypeList();
                        tblProductCategoryUOMTypeList1.setStoreID(StoreID);
                        tblProductCategoryUOMTypeList1.setCatID(cursorProductCategoryUOMTypeReport.getInt(0));
                        tblProductCategoryUOMTypeList1.setCategoryDesc(cursorProductCategoryUOMTypeReport.getString(1));
                        tblProductCategoryUOMTypeList1.setTblProductCategoryUOMTypeListsSubCategor(fnGetProductCategoryUOMTypeListOverAllSummary(StoreID,cursorProductCategoryUOMTypeReport.getInt(0)));
                        tblProductCategoryUOMTypeList.add(tblProductCategoryUOMTypeList1);
                        cursorProductCategoryUOMTypeReport.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorProductCategoryUOMTypeReport != null)
                cursorProductCategoryUOMTypeReport.close();
        }
        return tblProductCategoryUOMTypeList;
    }







    public List<TblStoreCartonMaster> fnGetTblStoreCartonMaster(String StoreID,String UOMType) {

        //  List<TblStoreProductMappingForDisplay> AllDistinctCateGoryApplicableToStore=new ArrayList<TblStoreProductMappingForDisplay>();//fnGetAllCateGoryApplicableToStore(StoreID,OrderID,BusinessSegmentId,RegionID);
       /* for(TblStoreProductMappingForDisplay tblCategoryProduct:AllDistinctCateGoryApplicableToStore)
        {*/
        List<TblStoreCartonMaster> tblStoreCartonMasterList = new ArrayList<TblStoreCartonMaster>();
        Cursor cursorE2 = db.rawQuery("Select  StoreID, OrderID, TmpInvoiceCodePDA,CartonID, CatID,UOMType,NoOfCarton,TotalExpectedQty,TotalActualQty,Sstat,CartonDiscount from tblStoreCartonMaster where StoreID='"+StoreID+"' and UOMType='"+UOMType+"'", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    for (int i = 0; i < cursorE2.getCount(); i++) {
                        TblStoreCartonMaster tblStoreCartonMaster = new TblStoreCartonMaster();

                        tblStoreCartonMaster.setStoreID(StoreID);
                        tblStoreCartonMaster.setCartonID(cursorE2.getString(3));
                        tblStoreCartonMaster.setCatID(cursorE2.getInt(4));
                        tblStoreCartonMaster.setNoOfCarton(cursorE2.getInt(6));
                        tblStoreCartonMaster.setOrderID(cursorE2.getString(1));
                        tblStoreCartonMaster.setTmpInvoiceCodePDA(cursorE2.getString(2));

                        tblStoreCartonMaster.setTotalActualQty(cursorE2.getInt(8));
                        tblStoreCartonMaster.setTotalExpectedQty(cursorE2.getInt(7));
                        tblStoreCartonMaster.setUOMType(cursorE2.getString(5));

                        tblStoreCartonMaster.setCartonDiscount(cursorE2.getDouble(10));
                        tblStoreCartonMasterList.add(tblStoreCartonMaster);

                        cursorE2.moveToNext();
                    }
                }

                //  tblCategoryProduct.setmChildTblStoreProductMappings(tblStoreProductMappingForDisplay);
            }


        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        //}

        return tblStoreCartonMasterList;//AllDistinctCateGoryApplicableToStore;
    }


    public double fnGetOverAllInviceForReviewSummary(String StoreID)
    {
        double ovInvSummary=0.0;
        Cursor cursorE2 = db.rawQuery("Select ((Sum(LineValAftrTxAftrDscnt)/Sum(OrderQty) )*Sum(OrderQtyDataToShow)) AS LineValAftrTxAftrDscnt from tblTmpInvoiceDetails where StoreID='"+StoreID+"' and flgTeleCallerProduct=0", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    ovInvSummary=cursorE2.getDouble(0);
                }
            }
        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        ovInvSummary= Double.parseDouble(new DecimalFormat("##.##").format(ovInvSummary));
        return ovInvSummary;
    }
    public int fnGetFreeQtyForReview(String StoreID)
    {
        int ovInvSummary=0;
        Cursor cursorE2 = db.rawQuery("Select Sum(FreeQty) AS FreeQty from tblTmpInvoiceDetails where StoreID='"+StoreID+"' and flgTeleCallerProduct=0", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    ovInvSummary=cursorE2.getInt(0);
                }
            }
        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        return ovInvSummary;
    }


    public double fnGetOverAllDiscountForReviewSummary(String StoreID)
    {
        double ovInvSummary=0.0;
        Cursor cursorE2 = db.rawQuery("Select Sum(OrderQty*ifnull(DiscountPerUOM,0)) AS OrdDis from tblTmpInvoiceDetails where StoreID='"+StoreID+"' and flgTeleCallerProduct=0", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    ovInvSummary=cursorE2.getDouble(0);
                }
            }
        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        ovInvSummary= Double.parseDouble(new DecimalFormat("##.##").format(ovInvSummary));
        return ovInvSummary;
    }

    public double fnGetOverAllFreeValueForReviewSummary(String StoreID)
    {
        double ovInvSummary=0.0;
       // Cursor cursorE2 = db.rawQuery("Select Sum(FreeQty*ifnull(ProductPrice,0)) AS OrdDis from tblTmpInvoiceDetails where StoreID='"+StoreID+"' and flgTeleCallerProduct=0", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        Cursor cursorE2 = db.rawQuery("Select Sum(((ifnull(LineValAftrTxAftrDscnt,0)+ifnull(DisVal,0))/OrderQty)*ifnull(FreeQty,0)) AS OrdDis from tblTmpInvoiceDetails where StoreID='"+StoreID+"' and flgTeleCallerProduct=0", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    ovInvSummary=cursorE2.getDouble(0);
                }
            }
        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        ovInvSummary= Double.parseDouble(new DecimalFormat("##.##").format(ovInvSummary));
        return ovInvSummary;
    }
    public double fnGetActualOrderValueBasedOnOrdQtyAndProductPriceeForReviewSummary(String StoreID)
    {
        double ovInvSummary=0.0;
        Cursor cursorE2 = db.rawQuery("Select Sum(LineValAftrTxAftrDscnt) AS OrdDis from tblTmpInvoiceDetails where StoreID='"+StoreID+"' and flgTeleCallerProduct=0", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"

        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    ovInvSummary=cursorE2.getDouble(0);
                }
            }
        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        ovInvSummary= Double.parseDouble(new DecimalFormat("##.##").format(ovInvSummary));
        return ovInvSummary;
    }
    public double fnGetOverAllNetMarginForReviewSummary(String StoreID)
    {
        //TotInvMRP=(((tblInvoiceDetailsServer.getOrderQty()* tblInvoiceDetailsServer.getProductPrice())-(tblInvoiceDetailsServer.getDisVal()
        // *tblInvoiceDetailsServer.getOrderQty()))/((tblInvoiceDetailsServer.getOrderQty()*tblInvoiceDetailsServer.getUOMConverstionUnitQty())+
        // tblInvoiceDetailsServer.getFreeQty()))*tblInvoiceDetailsServer.getUOMConverstionUnitQty();
        //(((B3*F3)-(H3*B3))/((B3*C3)+G3))*C3
       // double TotInvMRP = (fnGetActualOrderValueBasedOnOrdQtyAndProductPriceeForReviewSummary(StoreID)-(fnGetOverAllDiscountForReviewSummary(StoreID))/((fetchtblAllOrderQtyAgainstStore(StoreID))+fnGetFreeQtyForReview(StoreID)))*1;
        double TotInvMRP = (fnGetActualOrderValueBasedOnOrdQtyAndProductPriceeForReviewSummary(StoreID)+(fnGetOverAllFreeValueForReviewSummary(StoreID))+fnGetOverAllDiscountForReviewSummary(StoreID));
        double BranMargin =TotInvMRP- (fnGetActualOrderValueBasedOnOrdQtyAndProductPriceeForReviewSummary(StoreID));
        if (BranMargin < 0.0) {
            BranMargin = 0.0;
        }
        BranMargin=BranMargin;//-TotInvMRP;
        double   NetMargin = Double.parseDouble(new DecimalFormat("##.##").format(BranMargin));

        return NetMargin;
    }

    public double fnGetOverAllNetMarginPercentageForReviewSummary(String StoreID)
    {
      //  double TotInvMRP = fnGetOverAllInviceForReviewSummary(StoreID) + fnGetOverAllFreeValueForReviewSummary(StoreID);
        double TotInvMRP =((fnGetActualOrderValueBasedOnOrdQtyAndProductPriceeForReviewSummary(StoreID)+(fnGetOverAllFreeValueForReviewSummary(StoreID)))+fnGetOverAllDiscountForReviewSummary(StoreID));//(fetchtblAllOrderQtyAgainstStore(StoreID))+(fnGetFreeQtyForReview(StoreID))
        double BranMargin = TotInvMRP- (fnGetActualOrderValueBasedOnOrdQtyAndProductPriceeForReviewSummary(StoreID));
        if (BranMargin < 0.0) {
            BranMargin = 0.0;
        }
        double   NetMargin = Double.parseDouble(new DecimalFormat("##.##").format(BranMargin));
        double NetMarginPercentage=0.0;
        if (TotInvMRP > 0) {
            NetMarginPercentage = (((BranMargin )*100) / TotInvMRP);
        }
        NetMarginPercentage = Double.parseDouble(new DecimalFormat("##.##").format(NetMarginPercentage));
        return NetMarginPercentage;
    }


    public int fetchtblAllOrderQtyAgainstStore(String sID) {
        //open();
        int retVal = 0;
        Cursor cur = null;
        try {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null);";
            cur = db.rawQuery("Select ifnull(SUM(OrderQty),0) from tblTmpInvoiceDetails Where StoreID='" + sID + "' and flgTeleCallerProduct=0", null);
            if (cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                    for (int i = 0; i < cur.getCount(); i++) {
                        retVal = Integer.parseInt(cur.getString(0));
                        cur.moveToNext();
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("Error fetchtblInvoiceReviewCount = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }
            //  close();
            return retVal;
        }
    }


    public int fnCheckIsDiscountLevelApplicableOnStore(String sID) {
        //open();
        int retVal = 0;
        Cursor cur = null;
        try {
            //tblCycleID(CycleID int null,Sstat int null,CycStartTime text null);";
            cur = db.rawQuery("Select ifnull(IsDiscountApplicable,0) from tblStoreList Where StoreID='" + sID + "'", null);
            if (cur!=null && cur.getCount() > 0) {
                if (cur.moveToFirst()) {
                        retVal = Integer.parseInt(cur.getString(0));
                }
            }
        } catch (Exception e) {
            System.out.println("Error fetchtblInvoiceReviewCount = " + e.toString());
        } finally {
            if (cur != null) {
                cur.close();
            }
            //  close();
            return retVal;
        }
    }



    public List<TblProductCategoryUOMTypeList> fnGetProductCategoryUOMTypeListOverAllSummaryInvoiceReview(String StoreID, String TmpInvoiceCodePDA, int flgDrctslsIndrctSls, int chkflgInvoiceAlreadyGenerated,int flgInCarton) {
        List<TblProductCategoryUOMTypeList> tblProductCategoryUOMTypeList = new ArrayList<TblProductCategoryUOMTypeList>();
        Cursor cursorProductCategoryUOMTypeListSummary=null;


        //cursorProductCategoryUOMTypeListSummary= db.rawQuery("Select  DISTINCT tc1.UOMType,tc1.NoOfCarton,tc1.CartonID,tblCategoryMaster.CategoryDescr,ifnull(X.L1,0.0) AS LineValBfrTxAftrDscnt,ifnull(X.L2,0.0) AS LineValAftrTxAftrDscnt,tc1.CatID,ifnull(X.L3,0) AS FreeQty from tblStoreCartonDetails tc1 inner join tblCategoryMaster on tblCategoryMaster.CategoryID=tc1.CatID inner join (SELECT ID.CartonID,SUM(LineValBfrTxAftrDscnt) L1 ,SUM(LineValAftrTxAftrDscnt) L2,flgInCarton,SUM(FreeQty) L3 FROM tblTmpInvoiceDetails AS ID  where flgInCarton=1 Group By ID.CartonID) X on  tc1.CartonID=X.CartonID where   tc1.StoreID='" + StoreID + "' and X.flgInCarton=1 group by tc1.CatID, tc1.CartonID,tc1.UOMType", null);//group by tblStoreCartonDetails.CartonID,tblStoreCartonDetails.UOMType


                if (flgDrctslsIndrctSls == 2) {
                    if (chkflgInvoiceAlreadyGenerated == 1) {
                        int we = 0;
                        cursorProductCategoryUOMTypeListSummary = db.rawQuery("SELECT DISTINCT CartonID FROM tblStoreCartonDetails WHERE StoreID ='" + StoreID + "'", null);
                        if (cursorProductCategoryUOMTypeListSummary.getCount() > 0) {
                            we = 1;
                            if (cursorProductCategoryUOMTypeListSummary != null) {
                                cursorProductCategoryUOMTypeListSummary.close();
                            }
                        }
                        if (we == 1) {
                            cursorProductCategoryUOMTypeListSummary= db.rawQuery("Select  DISTINCT tc1.UOMType,tc1.NoOfCarton,tc1.CartonID,tblCategoryMaster.CategoryDescr,ifnull(X.L1,0.0) AS LineValBfrTxAftrDscnt,ifnull(X.L2,0.0) AS LineValAftrTxAftrDscnt,tc1.CatID,ifnull(X.L3,0) AS FreeQty,ifnull(X.L4,0) AS DsicountVal,ifnull(X.L5,0) AS FreeVal from tblStoreCartonDetails tc1 inner join tblCategoryMaster on tblCategoryMaster.CategoryID=tc1.CatID inner join (SELECT ID.CartonID,SUM(LineValBfrTxAftrDscnt) L1 ,SUM(LineValAftrTxAftrDscnt) L2,flgInCarton,SUM(FreeQty) L3, SUM(DiscountPerUOM*OrderQty) L4, SUM(ProductPrice*FreeQty) L5 FROM tblTmpInvoiceDetails AS ID  where flgInCarton=1 Group By ID.CartonID) X on  tc1.CartonID=X.CartonID where   tc1.StoreID='" + StoreID + "' and X.flgInCarton=1 group by tc1.CatID, tc1.CartonID,tc1.UOMType", null);//group by tblStoreCartonDetails.CartonID,tblStoreCartonDetails.UOMType
                        } else {
                           // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                            cursorProductCategoryUOMTypeListSummary= db.rawQuery("Select  DISTINCT tc1.UOMType,tc1.NoOfCarton,tc1.CartonID,tblCategoryMaster.CategoryDescr,ifnull(X.L1,0.0) AS LineValBfrTxAftrDscnt,ifnull(X.L2,0.0) AS LineValAftrTxAftrDscnt,tc1.CatID,ifnull(X.L3,0) AS FreeQty,ifnull(X.L4,0) AS DsicountVal,ifnull(X.L5,0) AS FreeVal from tblStoreCartonDetails tc1 inner join tblCategoryMaster on tblCategoryMaster.CategoryID=tc1.CatID inner join (SELECT ID.CartonID,SUM(LineValBfrTxAftrDscnt) L1 ,SUM(LineValAftrTxAftrDscnt) L2,flgInCarton,SUM(FreeQty) L3, SUM(DiscountPerUOM*OrderQty) L4, SUM(ProductPrice*FreeQty) L5 FROM tblInvoiceDetails AS ID  where flgInCarton=1 Group By ID.CartonID) X on  tc1.CartonID=X.CartonID where   tc1.StoreID='" + StoreID + "' and X.flgInCarton=1 group by tc1.CatID, tc1.CartonID,tc1.UOMType", null);//group by tblStoreCartonDetails.CartonID,tblStoreCartonDetails.UOMType
                        }

                    } else {
                       // cursor = db.rawQuery("SELECT ProdID,OrderQty From tblInvoiceDetails where StoreID='" + StoreID + "'  AND TmpInvoiceCodePDA='" + TmpInvoiceCodePDA + "' and flgInCarton="+flgInCarton+"", null);
                        cursorProductCategoryUOMTypeListSummary= db.rawQuery("Select  DISTINCT tc1.UOMType,tc1.NoOfCarton,tc1.CartonID,tblCategoryMaster.CategoryDescr,ifnull(X.L1,0.0) AS LineValBfrTxAftrDscnt,ifnull(X.L2,0.0) AS LineValAftrTxAftrDscnt,tc1.CatID,ifnull(X.L3,0) AS FreeQty,ifnull(X.L4,0) AS DsicountVal,ifnull(X.L5,0) AS FreeVal from tblStoreCartonDetails tc1 inner join tblCategoryMaster on tblCategoryMaster.CategoryID=tc1.CatID inner join (SELECT ID.CartonID,SUM(LineValBfrTxAftrDscnt) L1 ,SUM(LineValAftrTxAftrDscnt) L2,flgInCarton,SUM(FreeQty) L3, SUM(DiscountPerUOM*OrderQty) L4, SUM(ProductPrice*FreeQty) L5 FROM tblInvoiceDetails AS ID  where flgInCarton=1 Group By ID.CartonID) X on  tc1.CartonID=X.CartonID where   tc1.StoreID='" + StoreID + "' and X.flgInCarton=1 group by tc1.CatID, tc1.CartonID,tc1.UOMType", null);//group by tblStoreCartonDetails.CartonID,tblStoreCartonDetails.UOMType
                    }
        } else {
                    cursorProductCategoryUOMTypeListSummary= db.rawQuery("Select  DISTINCT tc1.UOMType,tc1.NoOfCarton,tc1.CartonID,tblCategoryMaster.CategoryDescr,ifnull(X.L1,0.0) AS LineValBfrTxAftrDscnt,ifnull(X.L2,0.0) AS LineValAftrTxAftrDscnt,tc1.CatID,ifnull(X.L3,0) AS FreeQty,ifnull(X.L4,0) AS DsicountVal,ifnull(X.L5,0) AS FreeVal from tblStoreCartonDetails tc1 inner join tblCategoryMaster on tblCategoryMaster.CategoryID=tc1.CatID inner join (SELECT ID.CartonID,SUM(LineValBfrTxAftrDscnt) L1 ,SUM(LineValAftrTxAftrDscnt) L2,flgInCarton,SUM(FreeQty) L3, SUM(DiscountPerUOM*OrderQty) L4, SUM(ProductPrice*FreeQty) L5 FROM tblTmpInvoiceDetails AS ID  where flgInCarton=1 Group By ID.CartonID) X on  tc1.CartonID=X.CartonID where   tc1.StoreID='" + StoreID + "' and X.flgInCarton=1 group by tc1.CatID, tc1.CartonID,tc1.UOMType", null);//group by tblStoreCartonDetails.CartonID,tblStoreCartonDetails.UOMType
        }

        try {
            if (cursorProductCategoryUOMTypeListSummary != null && cursorProductCategoryUOMTypeListSummary.getCount() > 0) {
                if (cursorProductCategoryUOMTypeListSummary.moveToFirst()) {
                    for (int i = 0; i < cursorProductCategoryUOMTypeListSummary.getCount(); i++) {
                        TblProductCategoryUOMTypeList tblProductCategoryUOMTypeList1=new TblProductCategoryUOMTypeList();
                        tblProductCategoryUOMTypeList1.setStoreID(StoreID);
                        tblProductCategoryUOMTypeList1.setCatID(cursorProductCategoryUOMTypeListSummary.getInt(6));
                        tblProductCategoryUOMTypeList1.setUOMType(cursorProductCategoryUOMTypeListSummary.getString(0));
                        tblProductCategoryUOMTypeList1.setNoOfCarton(cursorProductCategoryUOMTypeListSummary.getInt(1));
                        tblProductCategoryUOMTypeList1.setCartonID(cursorProductCategoryUOMTypeListSummary.getString(2));
                        tblProductCategoryUOMTypeList1.setCategoryDesc(cursorProductCategoryUOMTypeListSummary.getString(3));
                        tblProductCategoryUOMTypeList1.setStdLineVal(cursorProductCategoryUOMTypeListSummary.getDouble(4));
                        tblProductCategoryUOMTypeList1.setFreeQty(cursorProductCategoryUOMTypeListSummary.getInt(cursorProductCategoryUOMTypeListSummary.getColumnIndex("FreeQty")));
                        tblProductCategoryUOMTypeList1.setTotalDiscountVal(cursorProductCategoryUOMTypeListSummary.getString(cursorProductCategoryUOMTypeListSummary.getColumnIndex("DsicountVal")));
                        tblProductCategoryUOMTypeList1.setTotalFreeVal(cursorProductCategoryUOMTypeListSummary.getString(cursorProductCategoryUOMTypeListSummary.getColumnIndex("FreeVal")));
                        //,ifnull(X.L5,0) AS FreeVal
                        //,ifnull(X.L4,0) AS DsicountVal
                        tblProductCategoryUOMTypeList1.setNetLineVal(cursorProductCategoryUOMTypeListSummary.getDouble(5));

                        tblProductCategoryUOMTypeList.add(tblProductCategoryUOMTypeList1);
                        cursorProductCategoryUOMTypeListSummary.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorProductCategoryUOMTypeListSummary != null)
                cursorProductCategoryUOMTypeListSummary.close();
        }
        return tblProductCategoryUOMTypeList;
    }




    public void fnSaveTblAppliedOrderDiscount(List<TblAppliedOrderDiscount> tblAppliedOrderDiscountList) {
        db.execSQL("DELETE FROM " + DBHelper.DATABASE_TABLE_tblAppliedOrderDiscount);

        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.DATABASE_TABLE_tblAppliedOrderDiscount
                    + " (StoreID, InvoiceNumber, PrdID, UOMID, RelConversionUnits, TotalDisc, DiscountperUOM) VALUES (?, ?, ?, ?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblAppliedOrderDiscount tbl : tblAppliedOrderDiscountList) {
                stmt.bindString(1, tbl.getStoreID());
                stmt.bindString(2, tbl.getInvoiceNumber());
                stmt.bindLong(3, tbl.getPrdID());
                stmt.bindLong(4, tbl.getUOMID());
                stmt.bindDouble(5, tbl.getRelConversionUnits());
                stmt.bindDouble(6, tbl.getTotalDisc());
                stmt.bindDouble(7, tbl.getDiscountperUOM());
                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException(DBHelper.DATABASE_TABLE_tblAppliedOrderDiscount + " failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }
    }



    public List<TblStoreProductMappingForDisplay> fnGetTblStoreProductMappingUOMTCOrder(String StoreID, String OrderID, int BusinessSegmentId, int RegionID) {

        //  List<TblStoreProductMappingForDisplay> AllDistinctCateGoryApplicableToStore=new ArrayList<TblStoreProductMappingForDisplay>();//fnGetAllCateGoryApplicableToStore(StoreID,OrderID,BusinessSegmentId,RegionID);
       /* for(TblStoreProductMappingForDisplay tblCategoryProduct:AllDistinctCateGoryApplicableToStore)
        {*/
        List<TblStoreProductMappingForDisplay> tblStoreProductMappingForDisplay = new ArrayList<TblStoreProductMappingForDisplay>();
        Cursor cursorE2 = db.rawQuery("Select  '" + StoreID + "' AS StoreID,CatID,ProdID AS PrdNodeID,Case when tblTmpInvoiceDetailsTCOrder.UOMId=2  then 3 else 1 end As UOMIdTC,DisVal,ProductShortName,DiscountPerUOM,UOM from tblTmpInvoiceDetailsTCOrder left outer join tblUOMMaster Where StoreID='" + StoreID + "' and UOMIdTC=tblUOMMaster.UOMId", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    for (int i = 0; i < cursorE2.getCount(); i++) {
                        if(cursorE2.getInt(2)==11)
                        {
                            String rewe="dsferw";
                        }
                        TblStoreProductMappingForDisplay tblStoreProductMappingForDisplayReord = new TblStoreProductMappingForDisplay();
                        tblStoreProductMappingForDisplayReord.setStoreID(cursorE2.getString(0));
                        tblStoreProductMappingForDisplayReord.setCatID(cursorE2.getInt(1));
                        tblStoreProductMappingForDisplayReord.setPrdNodeID(cursorE2.getInt(2));
                        tblStoreProductMappingForDisplayReord.setUOMIDTC(cursorE2.getInt(3));
                        tblStoreProductMappingForDisplayReord.setPrdName(cursorE2.getString(5));
                        tblStoreProductMappingForDisplayReord.setDiscountPerUOM(cursorE2.getDouble(6));
                        tblStoreProductMappingForDisplayReord.setUOMType(cursorE2.getString(7));
                        tblStoreProductMappingForDisplayReord.setTblUOMMasterList(fnGetUOMAgainstProductTCOrders(cursorE2.getInt(2), cursorE2.getInt(3), RegionID,StoreID));
                        tblStoreProductMappingForDisplay.add(tblStoreProductMappingForDisplayReord);
                        cursorE2.moveToNext();
                    }
                }

                //  tblCategoryProduct.setmChildTblStoreProductMappings(tblStoreProductMappingForDisplay);
            }


        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        //}

        return tblStoreProductMappingForDisplay;//AllDistinctCateGoryApplicableToStore;
    }
    public List<TblUOMMaster> fnGetUOMAgainstProductTCOrders(int ProductID, int UOMID, int RegionID,String StoreID) {
        List<TblUOMMaster> tblUOMListMasterList = new ArrayList<TblUOMMaster>();
        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT tblAppliedOrderDiscount.UOMID,RelConversionUnits,DiscountperUOM,tblUOMMaster.UOM  from tblAppliedOrderDiscount  inner join  tblUOMMaster on tblAppliedOrderDiscount.UOMID=tblUOMMaster.UOMId where StoreID='" + StoreID + "'", null);
//        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT UOMID,UOM from tblUOMMaster inner join tblPrdMstrTransactionUOMConfig on tblUOMMaster.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID where tblPrdMstrTransactionUOMConfig.NodeID=" + ProductID + " order by  UOMID", null);
        int chkI = 0;
        try {
            if (cursorE2UOMAtPrdLevel != null && cursorE2UOMAtPrdLevel.getCount() > 0) {
                if (cursorE2UOMAtPrdLevel.moveToFirst()) {
                    for (int i = 0; i < cursorE2UOMAtPrdLevel.getCount(); i++) {
                        TblUOMMaster tblUOMMaster = new TblUOMMaster();

                        tblUOMMaster.setBUOMID(cursorE2UOMAtPrdLevel.getInt(0));

                        tblUOMMaster.setFlgSelected(0);
                        if(cursorE2UOMAtPrdLevel.getInt(0)==UOMID)
                        {
                            //if (cursorE2UOMAtPrdLevel.getString(1).toLowerCase().equals(BaseUOMEName.toLowerCase())) {
                            tblUOMMaster.setFlgSelected(1);
                        }
                        tblUOMMaster.setRelConversionUnit(cursorE2UOMAtPrdLevel.getDouble(1));
                        tblUOMMaster.setDiscountPerUOMTC(cursorE2UOMAtPrdLevel.getDouble(2));
                        tblUOMMaster.setBUOMName(cursorE2UOMAtPrdLevel.getString(3));
// UOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistInv,BaseValue AS RelConversionUnit,
// ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax

                        tblUOMListMasterList.add(tblUOMMaster);
                        cursorE2UOMAtPrdLevel.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorE2UOMAtPrdLevel != null)
                cursorE2UOMAtPrdLevel.close();
        }
        return tblUOMListMasterList;
    }



    public List<TblProductCategoryUOMTypeList> fnGetTCOrderSummray(String StoreID) {
        List<TblProductCategoryUOMTypeList> tblProductCategoryUOMTypeList = new ArrayList<TblProductCategoryUOMTypeList>();
        Cursor cursorProductCategoryUOMTypeListSummary = db.rawQuery("Select  DISTINCT tblUOMMaster.UOM,Sum(OrderQty,0),tblCategoryMaster.CategoryDescr,ifnull(LineValBfrTxAftrDscnt,0.0) AS LineValBfrTxAftrDscnt,ifnull(LineValAftrTxAftrDscnt,0.0) AS LineValAftrTxAftrDscnt,tc1.CatID,ifnull(FreeQty,0) AS FreeQty from tblTmpInvoiceDetailsTCOrder tc1  left outer join tblUOMMaster on tblTmpInvoiceDetailsTCOrder.UOMId=tblUOMMaster.UOMId where   tc1.StoreID='" + StoreID + "' group by tc1.CatID, tblUOMMaster.UOM", null);//group by tblStoreCartonDetails.CartonID,tblStoreCartonDetails.UOMType
        try {
            if (cursorProductCategoryUOMTypeListSummary != null && cursorProductCategoryUOMTypeListSummary.getCount() > 0) {
                if (cursorProductCategoryUOMTypeListSummary.moveToFirst()) {
                    for (int i = 0; i < cursorProductCategoryUOMTypeListSummary.getCount(); i++) {
                        TblProductCategoryUOMTypeList tblProductCategoryUOMTypeList1=new TblProductCategoryUOMTypeList();
                        tblProductCategoryUOMTypeList1.setStoreID(StoreID);
                        tblProductCategoryUOMTypeList1.setCatID(cursorProductCategoryUOMTypeListSummary.getInt(6));
                        tblProductCategoryUOMTypeList1.setUOMType(cursorProductCategoryUOMTypeListSummary.getString(0));
                        tblProductCategoryUOMTypeList1.setNoOfCarton(cursorProductCategoryUOMTypeListSummary.getInt(1));
                        tblProductCategoryUOMTypeList1.setCartonID(cursorProductCategoryUOMTypeListSummary.getString(2));
                        tblProductCategoryUOMTypeList1.setCategoryDesc(cursorProductCategoryUOMTypeListSummary.getString(3));
                        tblProductCategoryUOMTypeList1.setStdLineVal(cursorProductCategoryUOMTypeListSummary.getDouble(4));
                        tblProductCategoryUOMTypeList1.setFreeQty(cursorProductCategoryUOMTypeListSummary.getInt(cursorProductCategoryUOMTypeListSummary.getColumnIndex("FreeQty")));
                        tblProductCategoryUOMTypeList1.setNetLineVal(cursorProductCategoryUOMTypeListSummary.getDouble(5));

                        tblProductCategoryUOMTypeList.add(tblProductCategoryUOMTypeList1);
                        cursorProductCategoryUOMTypeListSummary.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorProductCategoryUOMTypeListSummary != null)
                cursorProductCategoryUOMTypeListSummary.close();
        }
        return tblProductCategoryUOMTypeList;
    }


    public HashMap<Integer, List<TblUOMMapping>> fetch_ProductWiseGetAllMeasureUnitAgainstProductForLastVisitPage(String storeID) {
        HashMap<Integer, List<TblUOMMapping>> hmapProductTblUOMMapping = new HashMap<Integer, List<TblUOMMapping>>();
        Cursor cursor = null;
        cursor = db.rawQuery("SELECT tblProductListMaster.productID,ifnull(tblProductListMaster.RptUnitID,'1')  FROM tblProductListMaster order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr ASC", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        List<TblUOMMapping> tblUOMMappingList = fnGetAllMeasureUnitAgainstProduct(Integer.parseInt(cursor.getString(0)), 1);
                        hmapProductTblUOMMapping.put(cursor.getInt(0), tblUOMMappingList);
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            cursor.close();
        }
        return hmapProductTblUOMMapping;
    }

    public HashMap<Integer, List<TblUOMMapping>> fetch_ProductWiseGetAllMeasureUnitAgainstProductForDistributorStockEntryPage(String storeID) {
        HashMap<Integer, List<TblUOMMapping>> hmapProductTblUOMMapping = new HashMap<Integer, List<TblUOMMapping>>();
        Cursor cursor = null;
        cursor = db.rawQuery("SELECT tblProductListMaster.productID,ifnull(tblProductListMaster.RptUnitID,'3')  FROM tblProductListMaster order by tblProductListMaster.CategoryID,tblProductListMaster.PrdOrdr ASC", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        List<TblUOMMapping> tblUOMMappingList = fnGetAllMeasureUnitAgainstProduct(Integer.parseInt(cursor.getString(0)), 3);
                        hmapProductTblUOMMapping.put(cursor.getInt(0), tblUOMMappingList);
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            cursor.close();
        }
        return hmapProductTblUOMMapping;
    }

    public long fnSavetblStoreDSROverAllDiscountApplied(String storeID, Double Dis)// , Double CreditAmt, Double
    {
        Delete_tblStoreDSROverAllDiscountApplied(storeID);
        ContentValues initialValues = new ContentValues();
        initialValues.put("StoreID", storeID);
        initialValues.put("AddtionalDiscountApplied", Dis);
        initialValues.put("Sstat", 1);
        return db.insert(DBHelper.DATABASE_TABLE_tblStoreDSROverAllDiscountApplied, null, initialValues);
    }

    public void Delete_tblStoreDSROverAllDiscountApplied(String StoreID) {
        db.execSQL("DELETE FROM tblStoreDSROverAllDiscountApplied where StoreID='"+StoreID+"'");
    }


    public double fngettblStoreDSROverAllDiscountApplied(String StoreID) {
        double AddtionalDiscountApplied =0.0;
        Cursor cursorE2 = db.rawQuery("SELECT ifnull(AddtionalDiscountApplied,0.0) FROM tblStoreDSROverAllDiscountApplied where StoreID='"+StoreID+"'", null);
        try {
            if (cursorE2 != null && cursorE2.moveToFirst()) {
                AddtionalDiscountApplied = cursorE2.getDouble(0);
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }

        return AddtionalDiscountApplied;
    }


    public ArrayList<Integer> fnSelectDistinctSchemeIDsForNewStore(int RegionID) {

        int chkI = 0;
        Cursor cursorE2 = null;
        String StoID="0";
        ////open();
        ArrayList<Integer> arrDistinctSchemeID=new ArrayList<Integer>();
        try {
            cursorE2 = db.rawQuery("SELECT DISTINCT StoreID from tblStoreList  where RegionID="+RegionID+" limit 1", null);
            if (cursorE2!=null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    StoID=cursorE2.getString(0);
                }
            }

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }

            if(!StoID.equals("0"))
            {
                cursorE2 = db.rawQuery("SELECT DISTINCT SchemeID from tblSchemeStoreMapping  where StoreID='"+StoID+"'", null);
                if (cursorE2!=null && cursorE2.getCount() > 0) {
                    if (cursorE2.moveToFirst()) {
                        for (int i = 0; i < cursorE2.getCount(); i++) {
                            arrDistinctSchemeID.add(cursorE2.getInt(0));
                            cursorE2.moveToNext();
                        }
                    }
                }
            }

            //close();
        }
        return arrDistinctSchemeID;
    }



    public HashMap<Integer,List<TblUOMMaster>> fnGetProductDistributor(int DistributorNodeID,int DistributorNodeType) {
        HashMap<Integer,List<TblUOMMaster>> hmaptblDistributorProductMasterList = new HashMap<Integer,List<TblUOMMaster>>();
        Cursor cursorE2UOMDistributor = db.rawQuery("Select  DISTINCT ProductNodeID from tblDistributorDayReport    where tblDistributorDayReport.DistributorNodeID=" + DistributorNodeID + " and tblDistributorDayReport.DistributorNodeType=" + DistributorNodeType + "", null);
        int chkI = 0;
        try {
            if (cursorE2UOMDistributor != null && cursorE2UOMDistributor.getCount() > 0) {
                if (cursorE2UOMDistributor.moveToFirst()) {
                    for (int i = 0; i < cursorE2UOMDistributor.getCount(); i++) {
                        hmaptblDistributorProductMasterList.put(cursorE2UOMDistributor.getInt(0),fnGetUOMAgainstProductDistributor(cursorE2UOMDistributor.getInt(0)));

                        cursorE2UOMDistributor.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorE2UOMDistributor != null)
                cursorE2UOMDistributor.close();
        }
        return hmaptblDistributorProductMasterList;
    }
    public List<TblUOMMaster> fnGetUOMAgainstProductDistributor(int ProductID) {
        List<TblUOMMaster> tblUOMListMasterList = new ArrayList<TblUOMMaster>();
        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT tblPrdMstrTransactionUOMConfig.BUOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistOrder  from tblPrdMstrTransactionUOMConfig inner join tblUOMMaster on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMaster.UOMID   left outer  join tblUOMMapping on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMapping.NodeId    where tblPrdMstrTransactionUOMConfig.NodeID=" + ProductID + " and (tblPrdMstrTransactionUOMConfig.flgDistOrder=1 or tblPrdMstrTransactionUOMConfig.flgDistOrder=2)", null);
//        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT UOMID,UOM from tblUOMMaster inner join tblPrdMstrTransactionUOMConfig on tblUOMMaster.UOMID=tblPrdMstrTransactionUOMConfig.BUOMID where tblPrdMstrTransactionUOMConfig.NodeID=" + ProductID + " order by  UOMID", null);
        int chkI = 0;
        try {
            if (cursorE2UOMAtPrdLevel != null && cursorE2UOMAtPrdLevel.getCount() > 0) {
                if (cursorE2UOMAtPrdLevel.moveToFirst()) {
                    for (int i = 0; i < cursorE2UOMAtPrdLevel.getCount(); i++) {
                        TblUOMMaster tblUOMMaster = new TblUOMMaster();

                        tblUOMMaster.setBUOMID(cursorE2UOMAtPrdLevel.getInt(0));
                        tblUOMMaster.setBUOMName(cursorE2UOMAtPrdLevel.getString(1));
                        tblUOMMaster.setFlgSelected(0);
//                        if(cursorE2UOMAtPrdLevel.getInt(2)==1)
//                        {
                        if (cursorE2UOMAtPrdLevel.getString(2).toLowerCase().equals("1")) {
                            tblUOMMaster.setFlgSelected(1);
                        }

                        tblUOMListMasterList.add(tblUOMMaster);
                        cursorE2UOMAtPrdLevel.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorE2UOMAtPrdLevel != null)
                cursorE2UOMAtPrdLevel.close();
        }
        return tblUOMListMasterList;
    }

    public List<TblStoreProductMappingForDisplay> fnGetTblStoreProductMappingForSearchDistributor(int DistributorNodeID,int DistributorNodeType) {
        int SectorID=fnGetSectorID();
        List<TblStoreProductMappingForDisplay> tblStoreProductMappingForDisplay = new ArrayList<TblStoreProductMappingForDisplay>();
        Cursor cursorE2=null;
        if(SectorID==1)
        {
            cursorE2 = db.rawQuery("Select  DistributorNodeID AS DistributorNodeID,tblCM.CategoryID,tPLM.ProductNodeID AS PrdNodeID,0 AS PrdNodeType" +
                    ",tPLM.FlvShortName AS PrdName,tPLM.FlvShortName ||','|| tblCM.CategoryDescr As SearchField" +
                    ",1 AS flgVisible,0 AS flgShowCategoryHeader,tblCM.CategoryDescr AS CategoryDesc,0 AS ShowAsChild" +
                    ",'#FFFFFF' As ColorCode from tblDistributorDayReport tPLM inner join tblProductListMaster on tPLM.ProductNodeID=tblProductListMaster.ProductID  inner join tblCategoryMaster tblCM on tPLM.SKUName=tblCM.CategoryDescr inner join tblPrdMstrTransactionUOMConfig on  tPLM.ProductNodeID=tblPrdMstrTransactionUOMConfig.NodeID  " +
                    "Where (tblPrdMstrTransactionUOMConfig.flgDistOrder=1 AND tPLM.DistributorNodeID='"+DistributorNodeID+"' AND tPLM.DistributorNodeType='"+DistributorNodeType+"')  Order by tblCM.CategoryID", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        }
        else
        {
            cursorE2 = db.rawQuery("Select  DistributorNodeID AS DistributorNodeID,tblCM.CategoryID,tPLM.ProductNodeID AS PrdNodeID,0 AS PrdNodeType" +
                    ",tPLM.FlvShortName AS PrdName,tPLM.FlvShortName ||','|| tblCM.CategoryDescr As SearchField" +
                    ",1 AS flgVisible,0 AS flgShowCategoryHeader,tblCM.CategoryDescr AS CategoryDesc,0 AS ShowAsChild" +
                    ",'#FFFFFF' As ColorCode from tblDistributorDayReport tPLM inner join tblProductListMaster on tPLM.ProductNodeID=tblProductListMaster.ProductID inner join tblProductSectorMapping on tblProductListMaster.ProductID= tblProductSectorMapping.PrdNodeID inner join tblCategoryMaster tblCM on tPLM.SKUName=tblCM.CategoryDescr inner join tblPrdMstrTransactionUOMConfig on  tPLM.ProductNodeID=tblPrdMstrTransactionUOMConfig.NodeID  " +
                    "Where (tblPrdMstrTransactionUOMConfig.flgDistOrder=1 AND tPLM.DistributorNodeID='"+DistributorNodeID+"' AND tPLM.DistributorNodeType='"+DistributorNodeType+"') and tblProductSectorMapping.SectorID="+SectorID+" Order by tblCM.CategoryID", null);// and tblCM.CategoryID="+tblCategoryProduct.getCatID()+"
        }

        int chkI = 0;
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0) {
                if (cursorE2.moveToFirst()) {
                    for (int i = 0; i < cursorE2.getCount(); i++) {
                        if(cursorE2.getInt(2)==11)
                        {
                            String rewe="dsferw";
                        }
                        TblStoreProductMappingForDisplay tblStoreProductMappingForDisplayReord = new TblStoreProductMappingForDisplay();
                        tblStoreProductMappingForDisplayReord.setStoreID(cursorE2.getString(0));
                        tblStoreProductMappingForDisplayReord.setCatID(cursorE2.getInt(1));
                        tblStoreProductMappingForDisplayReord.setPrdNodeID(cursorE2.getInt(2));
                        tblStoreProductMappingForDisplayReord.setPrdName(cursorE2.getString(4));
//                        tblStoreProductMappingForDisplayReord.setPrdNodeType(cursorE2.getInt(3));

                        tblStoreProductMappingForDisplayReord.setSearchField(cursorE2.getString(5));

                        tblStoreProductMappingForDisplayReord.setFlgVisible(cursorE2.getInt(6));
                        tblStoreProductMappingForDisplayReord.setFlgShowCategoryHeader(cursorE2.getInt(7));
                        tblStoreProductMappingForDisplayReord.setCategoryDesc(cursorE2.getString(8));

                        tblStoreProductMappingForDisplayReord.setColorCode(cursorE2.getString(10));
                        tblStoreProductMappingForDisplayReord.setTblUOMMasterList(fnGetUOMAgainstProductDistributor(cursorE2.getInt(2), cursorE2.getString(6)));
                        tblStoreProductMappingForDisplay.add(tblStoreProductMappingForDisplayReord);
                        cursorE2.moveToNext();
                    }
                }

                //  tblCategoryProduct.setmChildTblStoreProductMappings(tblStoreProductMappingForDisplay);
            }


        } finally {
            if (cursorE2 != null)
                cursorE2.close();
        }
        //}

        return tblStoreProductMappingForDisplay;//AllDistinctCateGoryApplicableToStore;
    }

    public HashMap<String, String> fnGetProductPurchaseListPicOrCasesDistributorEntry(int DistributorNodeID, int DistributorNodeType) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;

        cursor = db.rawQuery("SELECT ProductID,ifnull(UOMTypeID,1) From tblDistributorSavedData where DistribtrId=" + DistributorNodeID + "", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }
    public HashMap<String, String> fnGetProductPurchaseListStockEntryDistributorEntry(int DistributorNodeID, int DistributorNodeType) {
        //open();
        HashMap<String, String> hmapPrdctOdrQty = new HashMap<String, String>();
        Cursor cursor = null;

        cursor = db.rawQuery("SELECT ProductID,EnteredValue From tblDistributorSavedData where DistribtrId=" + DistributorNodeID + "", null);

        try {
            String CompleteResult[] = new String[cursor.getCount()];
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        hmapPrdctOdrQty.put(cursor.getString(0), cursor.getString(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapPrdctOdrQty;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            // close();
        }
    }
    public HashMap<Integer, List<TblUOMMapping>> fetch_ProductWiseGetAllMeasureUnitAgainstProductDistributorEntry(int DistributorNodeID) {
        HashMap<Integer, List<TblUOMMapping>> hmapProductTblUOMMapping = new HashMap<Integer, List<TblUOMMapping>>();
        Cursor cursor = null;
        cursor = db.rawQuery("SELECT tblDistributorDayReport.ProductNodeID,3 AS RPTUnit  FROM tblDistributorDayReport where DistributorNodeID="+DistributorNodeID+" order by tblDistributorDayReport.SKUName ASC", null);//Where tblProductSegementMap.BusinessSegmentId="+BusinessSegmentId+"
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        List<TblUOMMapping> tblUOMMappingList = fnGetAllMeasureUnitAgainstProduct(Integer.parseInt(cursor.getString(0)), Integer.parseInt(cursor.getString(1)));
                        hmapProductTblUOMMapping.put(cursor.getInt(0), tblUOMMappingList);
                        cursor.moveToNext();
                    }
                }
            }
        } finally {
            cursor.close();
        }
        return hmapProductTblUOMMapping;
    }


    public void deleteTblBeatPlan() {
        db.execSQL("delete from " + Table_tblBeatPlan + "");
    }

    public void insertIntoTblBeatPlan(List<TblBeatPlans> tblBeatPlans) {

        ContentValues values = new ContentValues();
        db.beginTransaction();

        for (TblBeatPlans tblBeatPlan : tblBeatPlans) {


            values.put(DayName, tblBeatPlan.getmDayName());
            values.put(Week1, tblBeatPlan.getmWeek1());
            values.put(Week2, tblBeatPlan.getmWeek2());
            values.put(Week3, tblBeatPlan.getmWeek3());
            values.put(Week4, tblBeatPlan.getmWeek4());
            values.put(Week5, tblBeatPlan.getmWWeek5());
            values.put(Week6, tblBeatPlan.getmWWeek6());
            values.put(MonthValue, tblBeatPlan.getmMonthValue());
            values.put(DateValue, tblBeatPlan.getMonthYear());


            Log.d(TAG, "" + db.insert(Table_tblBeatPlan, null, values));
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    public void deleteTblBeatWiseSpokeStoreVisitSchedule() {
        db.execSQL("delete from " + Table_TblBeatWiseSpokeStoreVisitSchedule + "");
    }

    public void insertIntoTblBeatWiseSpokeStoreVisitSchedule(List<TblBeatWiseSpokeStoreVisitSchedule> tblBeatWiseSpokeStoreVisitSchedules) {
            try {
                db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
                String sql = "INSERT INTO " + DBHelper.Table_TblBeatWiseSpokeStoreVisitSchedule + " (Date, StoreID,flgStoreVisited,flgStorePlanned) VALUES (?, ?, ?, ?)";
                SQLiteStatement stmt = db.compileStatement(sql);

                for (TblBeatWiseSpokeStoreVisitSchedule tblBeatWiseSpokeStoreVisitSchedule : tblBeatWiseSpokeStoreVisitSchedules) {
                    stmt.bindString(1, tblBeatWiseSpokeStoreVisitSchedule.getmDate());
                    stmt.bindString(2, tblBeatWiseSpokeStoreVisitSchedule.getmStoreID());
                    stmt.bindLong(3, tblBeatWiseSpokeStoreVisitSchedule.getMflgStoreVisited());
                    stmt.bindLong(4, tblBeatWiseSpokeStoreVisitSchedule.getMflgStorePlanned());
                    stmt.execute();
                }

                stmt.close();
                db.setTransactionSuccessful();
            } catch (Exception e) {
                e.printStackTrace();
                throw new RuntimeException(DBHelper.Table_TblBeatWiseSpokeStoreVisitSchedule + " failed");
            } finally {
                db.endTransaction();
            }
    }
    public String[] fnGettblBeatPlanDayWiseDetailsNewFunction() {
        //List<TblBeatPlans> tblBeatPlans = new ArrayList<>();

        String[] values = new String[2];
        Cursor cursor = db.rawQuery("Select DISTINCT " + DateValue + " from " + Table_tblBeatPlan, null);
        try {
            if (cursor != null && cursor.getCount() > 0) {
                int i = 0;
                while (cursor.moveToNext()) {
                    values[i] = cursor.getString(0);
                    i++;
                }
            }
        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {

            if (cursor != null)
                cursor.close();

        }
        return values;
    }

    public int fnCountSixWeekData(int MonthValue) {

        int chkI = 0;
        Cursor cursorE2 = db.rawQuery("SELECT " + Week6 + " FROM " + Table_tblBeatPlan + " where " + MonthValue + "=" + MonthValue + " AND " + Week6 + " is not null", null);
        try {
            if (cursorE2 != null && cursorE2.getCount() > 0 && cursorE2.moveToFirst()) {
                chkI = 1;

            }

        } catch (Exception ex) {
            ex.printStackTrace();
        }

        //////////// System.out.println("fnCheckflgToShowStrachRowOrNot : " +chkI);
        return chkI;

    }
    public String[] fnGettblBeatPlanDayWiseDetailsNewFunction(int MonthValue) {
        //List<TblBeatPlans> tblBeatPlans = new ArrayList<>();

        StringBuilder sb = new StringBuilder();
        int flgHasSixWeek = fnCountSixWeekData(MonthValue);

        Cursor cursor = db.rawQuery("Select " + DayName + ",ifnull(" + Week1 + ",'') Week1,ifnull(" + Week2 + ",'') Week2,ifnull(" + Week3 + ",'') Week3,ifnull(" + Week4 + ",'') Week4,ifnull(" + Week5 + ",'') Week5, ifnull(" + Week6 + ",'') Week6 from " + Table_tblBeatPlan + " where MonthValue=" + MonthValue, null);
        try {
            if (cursor != null && cursor.getCount() > 0) {
                cursor.moveToFirst();
                for (int i = 0; i < cursor.getCount(); i++) {
                    /*if (i == 0) {
                        for (int j = 0; j < cursor.getColumnCount(); j++) {

                            if (cursor.getColumnName(j).toString().equals("DayName")) {
                                sb.append("" + ",");
                            } else {
                                if(flgHasSixWeek==0)
                                {
                                    if (cursor.getColumnName(j).toString().equals("Week6")) {

                                    }
                                    else {
                                        sb.append("0~" + cursor.getColumnName(j).toString() + ",");
                                    }
                                }
                                else {
                                    sb.append("0~" + cursor.getColumnName(j).toString() + ",");
                                }
                            }
                        }
                    }*/

                    for (int j = 0; j < cursor.getColumnCount(); j++) {
                        if (j == 0) {
                            if (cursor.getString(j).equals("")) {
                                sb.append("" + ",");
                            } else if (!cursor.getString(0).equals("")) {
                                sb.append("1~" + cursor.getString(j) + "$");

                            }
                        } else {
                            if (cursor.getString(j).equals("")) {
                                if (i == (cursor.getCount() - 1)) {
                                    if (j == (cursor.getColumnCount() - 1)) {
                                        if (flgHasSixWeek == 0) {
                                            if (cursor.getColumnName(j).equals("Week6")) {

                                            } else {
                                                sb.append("");
                                            }
                                        } else
                                            sb.append("");
                                    } else {
                                        if (flgHasSixWeek == 0) {
                                            if (cursor.getColumnName(j).equals("Week6")) {

                                            } else {
                                                sb.append("" + "$");
                                            }
                                        } else {
                                            sb.append("" + "$");
                                        }
                                    }
                                } else {
                                    if (flgHasSixWeek == 0) {
                                        if (cursor.getColumnName(j).equals("Week6")) {

                                        } else {
                                            sb.append("" + "$");
                                        }
                                    } else
                                        sb.append("" + "$");
                                }
                            } else if (!cursor.getString(0).equals("")) {
                                if (i == (cursor.getCount() - 1)) {

                                    if (j == (cursor.getColumnCount() - 1)) {
                                        sb.append("2~" + cursor.getString(j));
                                    } else {
                                        sb.append("2~" + cursor.getString(j) + "$");
                                    }
                                } else {
                                    sb.append("2~" + cursor.getString(j) + "$");
                                }

                            }
                        }
                    }

                    cursor.moveToNext();
                }

            }
              /*  while (cursor.moveToNext()) {
                    TblBeatPlans tblBeatPlan = new TblBeatPlans();
                    tblBeatPlan.setmDate(cursor.getString(0));
                    tblBeatPlan.setmDayname(cursor.getString(1));
                    tblBeatPlan.setmflgAttendance(cursor.getInt(2));
                    tblBeatPlan.setmPlannedSpoke(cursor.getString(3));
                    tblBeatPlan.setmActualVisitedSpokes(cursor.getString(4));
                    tblBeatPlan.setmPlannedStores(cursor.getString(5));
                    tblBeatPlan.setmActualVisitedStores(cursor.getString(6));
                    tblBeatPlan.setmColor(cursor.getString(7));
                    tblBeatPlan.setMonthAndYear(cursor.getString(0).split(Pattern.quote("-"))[1] + "-" + cursor.getString(0).split(Pattern.quote("-"))[2]);
                    tblBeatPlan.setDayOfMonth(cursor.getString(0).split(Pattern.quote("-"))[0]);
                    tblBeatPlan.setWeekID(cursor.getString(10));

                    tblBeatPlans.add(tblBeatPlan);
                }*/


        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {

            if (cursor != null)
                cursor.close();

        }
        String[] sbArray = sb.toString().split(Pattern.quote("$"));
        return sbArray;
    }


    public LinkedHashMap<String, List<String>> fnGetBeatWiseSpokeVisitPlanListview(String DateToFilter) {
        LinkedHashMap<String, List<String>> hampBeatWiseSpokeVisitPlanList = new LinkedHashMap<>();
        String sql = "select DISTINCT ID,Descr from tblRouteListMaster inner join tblStoreList on tblStoreList.StoreRouteID=tblRouteListMaster.ID left outer join " + Table_TblBeatWiseSpokeStoreVisitSchedule + " on " + Table_TblBeatWiseSpokeStoreVisitSchedule + ".StoreID=tblStoreList.StoreID where " + Table_TblBeatWiseSpokeStoreVisitSchedule + "." + DBHelper.Date + "='" + DateToFilter + "'";

        Cursor cursor = db.rawQuery(sql, null);


        try {
            while (cursor.moveToNext()) {

                //  LinkedHashMap<String,String> hmapStoreDetailsAndOrderValue=new  LinkedHashMap<String,String>();
                // hmapStoreDetailsAndOrderValue=fnGetStoreOrderWiseList(Integer.parseInt(cursor.getString(0)));
                //  hampSpokeStoreAllSalesDateCapturedToday.put(cursor.getString(0)+"^"+AESUtils.decrypt(cursor.getString(1)),hmapStoreDetailsAndOrderValue);
                hampBeatWiseSpokeVisitPlanList.put(cursor.getString(0) + "^" + cursor.getString(1), fnGetSpokeVisitedInParticularDateList(Integer.parseInt(cursor.getString(0)), DateToFilter));
/*
                fnGetStoreOrderWiseListview(Integer.parseInt(cursor.getString(0)), hampSpokeStoreAllSalesDateCapturedToday);
*/

            }
        } finally {
            if (cursor != null)
                cursor.close();

            return hampBeatWiseSpokeVisitPlanList;
        }
    }
    public List<String> fnGetSpokeVisitedInParticularDateList(int BeatNodeID, String filterDate) {
        /*LinkedHashMap<String,String> hampStoreOrderWiseList = new LinkedHashMap<String,String>();*/
        List<String> storeName = new ArrayList<>();
        //String sql = "select DISTINCT ifnull(tblStoreList.StoreName,'NA'),tblBeatWiseSpokeStoreVisitSchedule.flgStoreVisited from " + Table_TblBeatWiseSpokeStoreVisitSchedule + " left outer join tblStoreList on (" + Table_TblBeatWiseSpokeStoreVisitSchedule + ".StoreID=tblStoreList.StoreID) where " + Table_TblBeatWiseSpokeStoreVisitSchedule + "." + DBHelper.Date + "='" + filterDate + "' order by tblBeatWiseSpokeStoreVisitSchedule.flgStoreVisited desc";
        String sql = "select ifnull(tblStoreList.StoreName,'NA'),tblBeatWiseSpokeStoreVisitSchedule.flgStoreVisited from " + Table_TblBeatWiseSpokeStoreVisitSchedule + " inner join tblStoreList on (" + Table_TblBeatWiseSpokeStoreVisitSchedule + ".StoreID=tblStoreList.StoreID) where " + Table_TblBeatWiseSpokeStoreVisitSchedule + "." + DBHelper.Date + "='" + filterDate + "'  and  tblStoreList.StoreRouteID=" + BeatNodeID +" order by tblBeatWiseSpokeStoreVisitSchedule.flgStoreVisited desc";
        Cursor cursorStoreOrder = db.rawQuery(sql, null);


        try {
            while (cursorStoreOrder.moveToNext()) {
/*
                hampStoreOrderWiseList.put(AESUtils.decrypt(cursorStoreOrder.getString(0)),AESUtils.decrypt(cursorStoreOrder.getString(1)));
*/
                storeName.add(cursorStoreOrder.getString(0) +"~"+cursorStoreOrder.getString(1));

            }
        } finally {
            if (cursorStoreOrder != null)
                cursorStoreOrder.close();
            return storeName;
        }
    }

    public int fnCheckBeatRecords()
    {

        Cursor cursor = db.rawQuery("SELECT Count(*) FROM "+Table_tblBeatPlan+"", null);
        try {
            int check=0;
            if (cursor!=null && cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    check=cursor.getInt(0);
                }
            }
            return check;
        } finally {
            if(cursor!=null) {
                cursor.close();
            }

        }
    }

    public List<TblUOMMaster> fnGetUOMAgainstProductDistributor(int ProductID, String BaseUOMEName) {
        List<TblUOMMaster> tblUOMListMasterList = new ArrayList<TblUOMMaster>();
        Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT tblPrdMstrTransactionUOMConfig.BUOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistOrder,ifnull(BaseValue,1) AS RelConversionUnit  from tblPrdMstrTransactionUOMConfig inner join tblUOMMaster on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMaster.UOMID inner join tblDistributorDayReport on (tblPrdMstrTransactionUOMConfig.NodeId=tblDistributorDayReport.ProductNodeID)  inner  join tblUOMMapping on (tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMapping.PackUnitId and tblPrdMstrTransactionUOMConfig.NodeID=tblUOMMapping.NodeId )    where tblDistributorDayReport.ProductNodeID=" + ProductID + "  and (tblPrdMstrTransactionUOMConfig.flgDistOrder=1 or tblPrdMstrTransactionUOMConfig.flgDistOrder=2)", null);
//         Cursor cursorE2UOMAtPrdLevel = db.rawQuery("Select  DISTINCT tblPrdMstrTransactionUOMConfig.BUOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistOrder,ifnull(BaseValue,1) AS RelConversionUnit  from tblPrdMstrTransactionUOMConfig inner join tblUOMMaster on tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMaster.UOMID  inner  join tblUOMMapping on (tblPrdMstrTransactionUOMConfig.BUOMID=tblUOMMapping.PackUnitId and tblPrdMstrTransactionUOMConfig.NodeID=tblUOMMapping.NodeId )    where tblProductSegementMap.ProductID=" + ProductID + "  and (tblPrdMstrTransactionUOMConfig.flgDistOrder=1 or tblPrdMstrTransactionUOMConfig.flgDistOrder=2)", null);
        int chkI = 0;
        try {
            if (cursorE2UOMAtPrdLevel != null && cursorE2UOMAtPrdLevel.getCount() > 0) {
                if (cursorE2UOMAtPrdLevel.moveToFirst()) {
                    for (int i = 0; i < cursorE2UOMAtPrdLevel.getCount(); i++) {
                        TblUOMMaster tblUOMMaster = new TblUOMMaster();

                        tblUOMMaster.setBUOMID(cursorE2UOMAtPrdLevel.getInt(0));
                        tblUOMMaster.setBUOMName(cursorE2UOMAtPrdLevel.getString(1));
                        tblUOMMaster.setFlgSelected(0);
                        if(cursorE2UOMAtPrdLevel.getInt(2)==1)
                        {
                            //if (cursorE2UOMAtPrdLevel.getString(1).toLowerCase().equals(BaseUOMEName.toLowerCase())) {
                            tblUOMMaster.setFlgSelected(1);
                        }
                        tblUOMMaster.setRelConversionUnit(cursorE2UOMAtPrdLevel.getDouble(3));

// UOMID,UOM,tblPrdMstrTransactionUOMConfig.flgDistInv,BaseValue AS RelConversionUnit,
// ProductMRP,ProductRLP,ProductTaxAmount,RetMarginPer,VatTax,StandardRate,StandardRateBeforeTax,StandardTax

                        tblUOMListMasterList.add(tblUOMMaster);
                        cursorE2UOMAtPrdLevel.moveToNext();
                    }
                }
            }


        } finally {
            if (cursorE2UOMAtPrdLevel != null)
                cursorE2UOMAtPrdLevel.close();
        }
        return tblUOMListMasterList;
    }


    public int fnCheckflgDiscountApplicableAgainstDistributor( int DistributorNodeID)
    {
        int check=0;
        Cursor cursor = db.rawQuery("SELECT ifnull(IsDiscountApplicable,0) FROM "+TABLE_tblSupplierMstrList+" where NodeID="+DistributorNodeID+"", null);
        try {

            if (cursor!=null && cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    check=cursor.getInt(0);
                }
            }
            return check;
        } finally {
            if(cursor!=null) {
                cursor.close();
            }

        }
    }
    public String fnCheckflgDiscountAllowedAgainstDistributor( int DistributorNodeID)
    {
        String check="No";
        Cursor cursor = db.rawQuery("SELECT ifnull(IsDiscountAllow,'No') FROM "+TABLE_tblSupplierMstrList+" where NodeID="+DistributorNodeID+"", null);
        try {

            if (cursor!=null && cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    check=cursor.getString(0);
                }
            }
            return check;
        } finally {
            if(cursor!=null) {
                cursor.close();
            }

        }
    }

    public String fnCheckflgDiscountAllowedAgainstDistributorDescr( int DistributorNodeID)
    {
        String check="NA";
        Cursor cursor = db.rawQuery("SELECT ifnull(Descr,'NA') FROM "+TABLE_tblSupplierMstrList+" where NodeID="+DistributorNodeID+"", null);
        try {

            if (cursor!=null && cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    check=cursor.getString(0);
                }
            }
            return check;
        } finally {
            if(cursor!=null) {
                cursor.close();
            }

        }
    }

    public HashMap<String, String> checkForStoreIdIsDiscountApplicable() {
        Cursor cursor = db.rawQuery("Select StoreID,ifnull(IsDiscountApplicable,0) from tblStoreList", null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapStoreIdFlgMapped = new HashMap<String, String>();
        if (cursor != null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapStoreIdFlgMapped.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        if(cursor!=null)
            cursor.close();
        return hmapStoreIdFlgMapped;
    }


    public String fnCheckflgDiscountAllowedAgainstStore( String StoreID)
    {
        String check="No";
        Cursor cursor = db.rawQuery("SELECT ifnull(IsDiscountAllow,'No') FROM tblStoreList where StoreID='"+StoreID+"'", null);
        try {

            if (cursor!=null && cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    check=cursor.getString(0);
                }
            }
            return check;
        } finally {
            if(cursor!=null) {
                cursor.close();
            }

        }
    }
    public HashMap<String, String> checkForStoreIdIsDiscountAllowed() {
        Cursor cursor = db.rawQuery("Select StoreID,ifnull(IsDiscountAllow,'No') from tblStoreList", null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapStoreIdFlgMapped = new HashMap<String, String>();
        if (cursor != null && cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapStoreIdFlgMapped.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        if(cursor!=null)
            cursor.close();
        return hmapStoreIdFlgMapped;
    }


    public String fnGetDefaultDBNodeIDAgainstRouteMaster( String RouteID)
    {
        String check="No";
        Cursor cursor = db.rawQuery("SELECT ifnull(DBNodeID,0) FROM tblRouteListMaster where ID='"+RouteID+"'", null);
        try {

            if (cursor!=null && cursor.getCount() > 0)
            {
                if (cursor.moveToFirst())
                {
                    check=cursor.getString(0);
                }
            }
            return check;
        } finally {
            if(cursor!=null) {
                cursor.close();
            }

        }
    }


    public String[] getAllStoreIdtblStoreImageDetail() {

        int SnamecolumnIndex1 = 0;


        Cursor cursor = db.rawQuery("SELECT DISTINCT(StoreID) FROM tblStoreImageDetail where Sstat=5 ", null);
        //Cursor cursor = db.rawQuery("SELECT StoreID FROM tblStoreMaterialPhotoDetail", null);
        try {
            String StoreName[] = new String[cursor.getCount()];
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        StoreName[i] = (String) cursor.getString(SnamecolumnIndex1).toString();
                        cursor.moveToNext();
                    }
                }

            }

            return StoreName;
        } finally {
            if (cursor != null)
                cursor.close();
        }

    }


    public int getImageCountFortblStoreImageDetail(String StoreID) {

        int ScodecolumnIndex = 0;

        Cursor cursor = db.rawQuery("SELECT Count(StoreID) FROM tblStoreImageDetail where StoreID='" + StoreID + "'", null);
        try {
            int strProdStockQty = 0;
            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                    if (!cursor.isNull(ScodecolumnIndex)) {
                        strProdStockQty = Integer.parseInt(cursor.getString(ScodecolumnIndex).toString());
                        cursor.moveToNext();
                    }

                }
            }
            return strProdStockQty;
        } finally {
            cursor.close();
        }
    }

    public String[] getImgsCounttblStoreImageDetail(String StoreID) {

        int SnamecolumnIndex1 = 0;

        Cursor cursor = db.rawQuery("SELECT ImageName FROM tblStoreImageDetail WHERE StoreID ='" + StoreID + "'", null);
        try {

            String StoreName[] = new String[cursor.getCount()];

            if (cursor.moveToFirst()) {

                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    StoreName[i] = (String) cursor.getString(SnamecolumnIndex1)
                            .toString();

                    cursor.moveToNext();
                }
            }
            return StoreName;
        } finally {
            cursor.close();
        }

    }


    public void updateImageRecordsSyncdFortblStoreImageDetail(String PhotoName) {

        try {
            //open();
            System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tblStoreImageDetail", values, "ImageName=?", new String[]{PhotoName});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            // close();
        }


    }


    public void updateImageRecordsSyncdFortableImage(String PhotoName) {

        try {
            //open();
            System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tableImage", values, "imageName=?", new String[]{PhotoName});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            // close();
        }


    }

    public void updateImageRecordsSyncdFortblStoreClosedPhotoDetail(String PhotoName) {

        try {
            //open();
            System.out.println("Sunil Doing Testing Response after sending Image inside BD" + PhotoName);
            final ContentValues values = new ContentValues();
            values.put("Sstat", 4);

            int affected3 = db.update("tblStoreClosedPhotoDetail", values, "PhotoName=?", new String[]{PhotoName});
        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        } finally {
            // close();
        }


    }

    public void fnDeleteTCOrderTable() {
        try {
            db.execSQL("DELETE FROM tblTmpInvoiceDetailsTCOrder");// and sectionID="+sectionID
            db.execSQL("DELETE FROM tblTmpInvoiceHeaderTCOrder");
        } catch (Exception e) {

        }


    }
    public String[] deletFromSDcCardPhototblStoreImageDetailValidationBasedSstat(String Sstat) {

        String[] imageNameToBeDeleted = null;
        //open();

        Cursor cursor = db.rawQuery("SELECT  ImageName from tblStoreImageDetail where Sstat='" + Sstat + "'", null);
        try {
            if (cursor.getCount() > 0) {
                imageNameToBeDeleted = new String[cursor.getCount()];
                if (cursor.moveToFirst()) {
                    for (int i = 0; i < cursor.getCount(); i++) {
                        imageNameToBeDeleted[i] = cursor.getString(0);
                        cursor.moveToNext();
                    }
                }
            } else {
                imageNameToBeDeleted = new String[1];
                imageNameToBeDeleted[0] = "No Data";
            }
        } finally {
            cursor.close();
            // close();
        }


        return imageNameToBeDeleted;
    }

    public void fnUpdateIsNewStoreDataCompleteSavedStoreVisitMaster(String StoreID, int IsNewStoreDataCompleteSaved) {

        try {

            final ContentValues values = new ContentValues();
            values.put("IsNewStoreDataCompleteSaved", IsNewStoreDataCompleteSaved);


            int affected = db.update("tblStoreVisitMstr", values, "StoreID=?", new String[]{StoreID});


        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }

    }


    public int fnflgCheckAnyStoreHasVisitAndSstatNotSubmitted(String selStoreID) {
        //open();
        Cursor cursor = db.rawQuery("SELECT Sstat FROM tblStoreVisitMstr WHERE Sstat=1 and IsNewStoreDataCompleteSaved=0 and StoreID<>'"+selStoreID+"'", null);
        try {
            int flgCheckAnyStoreHasVisitAndSstatNotSubmitted = 0;
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    flgCheckAnyStoreHasVisitAndSstatNotSubmitted = Integer.parseInt(cursor.getString(0).toString());

                }
            }
            return flgCheckAnyStoreHasVisitAndSstatNotSubmitted;

        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }

    }


    public ArrayList<String> fnStoreNameRouteNameStoreIDUnSubmiitedData(String selStoreID) {
        //open();
        ArrayList<String>arrStoreNameRouteNameStoreIDUnSubmiitedData=new ArrayList<String>();
        Cursor cursor = db.rawQuery("SELECT tblStoreVisitMstr.StoreID,StoreName,StoreRouteID,Descr FROM tblStoreVisitMstr inner join tblStoreList on tblStoreVisitMstr.StoreID=tblStoreList.StoreID inner join tblRouteListMaster on tblRouteListMaster.ID=tblStoreList.StoreRouteID  WHERE tblStoreVisitMstr.Sstat=1 and tblStoreVisitMstr.IsNewStoreDataCompleteSaved=0 and tblStoreList.StoreID<>'"+selStoreID+"'", null);
        try {

            if (cursor!=null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    arrStoreNameRouteNameStoreIDUnSubmiitedData.add(cursor.getString(0).toString()) ;
                    arrStoreNameRouteNameStoreIDUnSubmiitedData.add(cursor.getString(1).toString()) ;
                    arrStoreNameRouteNameStoreIDUnSubmiitedData.add(cursor.getString(2).toString()) ;
                    arrStoreNameRouteNameStoreIDUnSubmiitedData.add(cursor.getString(3).toString()) ;

                }
            }


        }
        catch (Exception ex)
        {
            ex.printStackTrace();
        }
        finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }
        return arrStoreNameRouteNameStoreIDUnSubmiitedData;
    }


    public String fncheckStoreContactNo(String StoreID) {
        //open();
        String stContactNo = "NA";
        Cursor cursor = db.rawQuery("SELECT ifnull(StoreContactNo,'NA') FROM tblStoreList WHERE StoreID='" + StoreID + "'", null);
        try {

            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    stContactNo = cursor.getString(0).toString();
                }
            }
            return stContactNo;
        } finally {
            if (cursor != null) {
                cursor.close();
            }
            //close();
        }

    }

    public void delete_tblDayWiseActualVsTargetReportSalesMan() {
        db.delete(DBHelper.TABLE_tblDayWiseActualVsTargetReportSalesMan, null, null);
    }

    public void insert_tblDayWiseActualVsTargetReportSalesMan(List<TblDayWiseActualVsTargetReportSalesMan> tblDayWiseActualVsTargetReportSalesManList) {
        db.beginTransaction();
        for (TblDayWiseActualVsTargetReportSalesMan tblDayWiseActualVsTargetReportSalesMan : tblDayWiseActualVsTargetReportSalesManList) {
            ContentValues values = new ContentValues();
            values.put("LevelNo", tblDayWiseActualVsTargetReportSalesMan.getLevelNo());
            values.put("MeasureID", tblDayWiseActualVsTargetReportSalesMan.getMeasureID());
            values.put("Measure", tblDayWiseActualVsTargetReportSalesMan.getMeasure());
            values.put("MonthTgt", tblDayWiseActualVsTargetReportSalesMan.getMonthTgt());
            values.put("MTD_Ach", tblDayWiseActualVsTargetReportSalesMan.getMTD_Ach());
            values.put("CurrentDayRate", tblDayWiseActualVsTargetReportSalesMan.getCurrentDayRate());
            values.put("RequiredDayRate", tblDayWiseActualVsTargetReportSalesMan.getRequiredDayRate());

            db.insert(DBHelper.TABLE_tblDayWiseActualVsTargetReportSalesMan, null, values);
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    public ArrayList<TblDayWiseActualVsTargetReportSalesMan> fnGetAlltblDayWiseActualVsTargetReportSalesMan() {
        ArrayList<TblDayWiseActualVsTargetReportSalesMan> tblStoreListMasterDataRetriveArrayList = new ArrayList<TblDayWiseActualVsTargetReportSalesMan>();
        Cursor cursor = db.rawQuery("SELECT LevelNo,MeasureID,Measure,MonthTgt,MTD_Ach,CurrentDayRate,RequiredDayRate from tblDayWiseActualVsTargetReportSalesMan", null);

        try {
            if (cursor!=null && cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    TblDayWiseActualVsTargetReportSalesMan tblStoreListMasterDataRetrive = new TblDayWiseActualVsTargetReportSalesMan();
                    tblStoreListMasterDataRetrive.setLevelNo(cursor.getInt(0));
                    tblStoreListMasterDataRetrive.setMeasureID(cursor.getInt(1));
                    tblStoreListMasterDataRetrive.setMeasure(cursor.getString(2));
                    tblStoreListMasterDataRetrive.setMonthTgt(cursor.getString(3));
                    tblStoreListMasterDataRetrive.setMTD_Ach(cursor.getString(4));
                    tblStoreListMasterDataRetrive.setCurrentDayRate(cursor.getString(5));
                    tblStoreListMasterDataRetrive.setRequiredDayRate(cursor.getString(6));

                    tblStoreListMasterDataRetriveArrayList.add(tblStoreListMasterDataRetrive);
                    cursor.moveToNext();
                }

            }
            return tblStoreListMasterDataRetriveArrayList;
        } finally {
            if(cursor!=null)
                cursor.close();
        }
    }


    public void delete_tblDailyDateWiseSalesManTargetVsAch() {
        db.delete(DBHelper.TABLE_tblDailyDateWiseSalesManTargetVsAch, null, null);
    }

    public void insert_tblDailyDateWiseSalesManTargetVsAch(List<TblDailyDateWiseSalesManTargetVsAch> tblDailyDateWiseSalesManTargetVsAchList) {
        db.beginTransaction();
        for (TblDailyDateWiseSalesManTargetVsAch tblDailyDateWiseSalesManTargetVsAch : tblDailyDateWiseSalesManTargetVsAchList) {
            ContentValues values = new ContentValues();
            values.put("LevelNo", tblDailyDateWiseSalesManTargetVsAch.getLevelNo());
            values.put("RptDate", tblDailyDateWiseSalesManTargetVsAch.getRptDate());
            values.put("MeasureID", tblDailyDateWiseSalesManTargetVsAch.getMeasureID());
            values.put("Measure", tblDailyDateWiseSalesManTargetVsAch.getMeasure());
            values.put("Target", tblDailyDateWiseSalesManTargetVsAch.getTarget());
            values.put("Achievement", tblDailyDateWiseSalesManTargetVsAch.getAchievement());

            db.insert(DBHelper.TABLE_tblDailyDateWiseSalesManTargetVsAch, null, values);
        }
        db.setTransactionSuccessful();
        db.endTransaction();
    }

    public ArrayList<TblDailyDateWiseSalesManTargetVsAch> fnGetAlltblDailyDateWiseSalesManTargetVsAch(int Level) {
        ArrayList<TblDailyDateWiseSalesManTargetVsAch> tblStoreListMasterDataRetriveArrayList = new ArrayList<TblDailyDateWiseSalesManTargetVsAch>();
        Cursor cursor = db.rawQuery("SELECT LevelNo,ifnull(RptDate,'NA') AS RptDate,MeasureID,Measure,Target,Achievement from tblDailyDateWiseSalesManTargetVsAch where LevelNo="+Level, null);

        try {
            if (cursor!=null && cursor.moveToFirst()) {
                for (int i = 0; i <= (cursor.getCount() - 1); i++) {

                    TblDailyDateWiseSalesManTargetVsAch tblStoreListMasterDataRetrive = new TblDailyDateWiseSalesManTargetVsAch();
                    tblStoreListMasterDataRetrive.setLevelNo(cursor.getInt(0));
                    tblStoreListMasterDataRetrive.setRptDate(cursor.getString(1));
                    tblStoreListMasterDataRetrive.setMeasureID(cursor.getInt(2));
                    tblStoreListMasterDataRetrive.setMeasure(cursor.getString(3));
                    tblStoreListMasterDataRetrive.setTarget(cursor.getString(4));
                    tblStoreListMasterDataRetrive.setAchievement(cursor.getString(5));

                    tblStoreListMasterDataRetriveArrayList.add(tblStoreListMasterDataRetrive);
                    cursor.moveToNext();
                }

            }
            return tblStoreListMasterDataRetriveArrayList;
        } finally {
            if(cursor!=null)
                cursor.close();
        }
    }


    public String fnGetPersonNameFromtblUserAuthenticationMstr() {
        String PersonName = "NA";


        Cursor cursor = db.rawQuery("Select PersonName from tblUserAuthenticationMstr", null);
        try {
            if (cursor != null && cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    PersonName = cursor.getString(0);
                }
            }
        } catch (Exception ex) {

        } finally {
            if (cursor != null)
                cursor.close();
        }
        return PersonName;
    }






    public void delete_tblPotentialDistributorList() {
        db.delete(TABLE_tblPotentialDistributorList, null, null);
    }

    public void insert_tblPotentialDistributorList(List<TblPotentialDistributor> tblPotentialDistributorList) {

        db.beginTransaction();
        String sql = "INSERT INTO " + TABLE_tblPotentialDistributorList + " (NodeID, NodeType, LatCode, LongCode,Descr,ContactPersonName,ContactPersonMobileNumber,ContactPersonEMailID,TelephoneNo,GSTNumber,AreaCovered,NoOfRetailersCovered,GodownAreaSqFt,MonthlyTurnOver,OrderTATinDays,CompanyProductInvestmentLacs,RetailerCreditLimit,BusinessSince,DistributorReady,NextFollowupDate,DBREmployee_Dispatch,DBREmployee_Billing,DBREmployee_SalesStaff,Address,Pincode,City,District,State,EntryPersonNodeID,EntryPersonNodeType,CreatedDate,flgGSTTaken,VehicleTypeID,NoOfVehicles,Sstat,flgViewOrEdit,flgDelete,IsOldDistributorReplaced,IsOldDistributorDFinalPaymentDone,flgDistributorSS,IsNewLocation,flgTownDistributorSubD,Address_Godown,Pincode_Godown,City_Godown,District_Godown,State_Godown,flgProprietorPartner,BankAccountNumber,IFSCCode,BankAddress,ExpectedBusiness,ReqGodownSpace,AgreedGodownSpace,AgreedInvestment,IdealROI,ExpectedROI,IsCheckGiven,ChequeNumber,IsGSTDetailsSubmitted,GSTNumber,IsProprietorPanSubmited,ProprietorPanNumber,IsPartnerDeedSubmitted,IsPartner1PanSubmitted,PanNumber_Partner1,IsPartner2PanSubmitted,PanNumber_Partner2,flgAppointed,OldDistributorID,CurrentLocationIsOf,PartnerDeedNumber,IsPANOfFirmSubmitted,PANNoOfFirm) VALUES (?, ?, ?, ?,?,?, ?, ?, ?,?,?, ?, ?, ?,?,?, ?, ?, ?,?,?, ?, ?, ?,?,?, ?, ?, ?,?,?, ?, ?, ?,?,?,?, ?,?,?,?, ?,?,?,?, ?,?,?,?, ?,?,?,?, ?,?,?,?, ?,?,?,?, ?,?,?,?, ?,?,?,?,?,?,?,?,?)";
        SQLiteStatement stmt = db.compileStatement(sql);
        for (TblPotentialDistributor tbl : tblPotentialDistributorList) {

            if(tbl.getNodeID().equals("25"))
            {
                int ntid=25;
                ntid=00;
                stmt.bindString(1, tbl.getNodeID());
            }
            else {
                stmt.bindString(1, tbl.getNodeID());
            }
            stmt.bindLong(2, tbl.getNodeType());
            stmt.bindDouble(3, tbl.getLatCode());
            stmt.bindDouble(4, tbl.getLongCode());
            stmt.bindString(5, tbl.getDescr());

            if(tbl.getContactPersonName()!=null)
                stmt.bindString(6, tbl.getContactPersonName());
            else
                stmt.bindString(6, "");

            if(tbl.getContactPersonMobileNumber()!=null)
                stmt.bindString(7, tbl.getContactPersonMobileNumber());
            else
                stmt.bindString(7, "");
            if(tbl.getContactPersonEMailID()!=null)
                stmt.bindString(8, tbl.getContactPersonEMailID());
            else
                stmt.bindString(8, "");
            if(tbl.getTelephoneNo()!=null)
                stmt.bindString(9, tbl.getTelephoneNo());
            else
                stmt.bindString(9, "");
            if(tbl.getGSTNumber()!=null)
                stmt.bindString(10, tbl.getGSTNumber());
            else
                stmt.bindString(10, "");
            if(tbl.getAreaCovered()!=null)
                stmt.bindString(11, tbl.getAreaCovered());
            else
                stmt.bindString(11, "");

            if(tbl.getNoOfRetailersCovered()!=null)
                stmt.bindString(12, tbl.getNoOfRetailersCovered());
            else
                stmt.bindString(12, "");
            if(tbl.getGodownAreaSqFt()!=null)
                stmt.bindString(13, tbl.getGodownAreaSqFt());
            else
                stmt.bindString(13, "");
            if(tbl.getMonthlyTurnOver()!=null)
                stmt.bindString(14, tbl.getMonthlyTurnOver());
            else
                stmt.bindString(14, "");

            stmt.bindLong(15, tbl.getOrderTATinDays());

            stmt.bindLong(16, tbl.getCompanyProductInvestmentLacs());
            stmt.bindLong(17, tbl.getRetailerCreditLimit());

            if(tbl.getBusinessSince()!=null)
                stmt.bindString(18, tbl.getBusinessSince());
            else
                stmt.bindString(18, "");

            stmt.bindLong(19, tbl.getDistributorReady());

            if(tbl.getNextFollowupDate()!=null)
                stmt.bindString(20, tbl.getNextFollowupDate());
            else
                stmt.bindString(20, "");


            stmt.bindLong(21, tbl.getDBREmployee_Dispatch());
            stmt.bindLong(22, tbl.getDBREmployee_Billing());

            stmt.bindLong(23, tbl.getDBREmployee_SalesStaff());

            if(tbl.getAddress()!=null)
                stmt.bindString(24, tbl.getAddress());
            else
                stmt.bindString(24, "");
            if(tbl.getPincode()!=null)
                stmt.bindString(25, tbl.getPincode());
            else
                stmt.bindString(25, "");
            if(tbl.getCity()!=null)
                stmt.bindString(26, tbl.getCity());
            else
                stmt.bindString(26, "");

            if(tbl.getDistrict()!=null)
                stmt.bindString(27, tbl.getDistrict());
            else
                stmt.bindString(27, "");
            if(tbl.getState()!=null)
                stmt.bindString(28, tbl.getState());
            else
                stmt.bindString(28, "");

            stmt.bindLong(29, tbl.getEntryPersonNodeID());
            stmt.bindLong(30, tbl.getEntryPersonNodeType());

            if(tbl.getCreatedDate()!=null)
                stmt.bindString(31, tbl.getCreatedDate());
            else
                stmt.bindString(31, "");

            stmt.bindLong(32, tbl.getFlgGSTTaken());

            if(tbl.getVehicleTypeID()!=null)
                stmt.bindString(33, tbl.getVehicleTypeID());
            else
                stmt.bindString(33, "0");

            stmt.bindLong(34, tbl.getNoOfVehicles());
            stmt.bindLong(35, tbl.getSstat());
            stmt.bindLong(36, tbl.getFlgViewOrEdit());
            stmt.bindLong(37, tbl.getFlgDelete());



            stmt.bindLong(38, tbl.getIsOldDistributorReplaced());
            stmt.bindLong(39, tbl.getIsOldDistributorDFinalPaymentDone());
            stmt.bindLong(40, tbl.getFlgDistributorSS());

            stmt.bindLong(41, tbl.getIsNewLocation());
            stmt.bindLong(42, tbl.getFlgTownDistributorSubD());
            if(tbl.getAddress_Godown()!=null)
                stmt.bindString(43, tbl.getAddress_Godown());
            else
                stmt.bindString(43, "");

            if(tbl.getPincode_Godown()!=null)
                stmt.bindString(44, tbl.getPincode_Godown());
            else
                stmt.bindString(44, "");
            if(tbl.getCity_Godown()!=null)
                stmt.bindString(45, tbl.getCity_Godown());
            else
                stmt.bindString(45, "");
            if(tbl.getDistrict_Godown()!=null)
                stmt.bindString(46, tbl.getDistrict_Godown());
            else
                stmt.bindString(46, "");


            if(tbl.getState_Godown()!=null)
                stmt.bindString(47, tbl.getState_Godown());
            else
                stmt.bindString(47, "");

            stmt.bindLong(48, tbl.getFlgProprietorPartner());

            if(tbl.getBankAccountNumber()!=null)
                stmt.bindString(49, tbl.getBankAccountNumber());
            else
                stmt.bindString(49, "");


            if(tbl.getIFSCCode()!=null)
                stmt.bindString(50, tbl.getIFSCCode());
            else
                stmt.bindString(50, "");
            if(tbl.getBankAddress()!=null)
                stmt.bindString(51, tbl.getBankAddress());
            else
                stmt.bindString(51, "");
            if(tbl.getExpectedBusiness()!=null)
                stmt.bindString(52, tbl.getExpectedBusiness());
            else
                stmt.bindString(52, "");


            if(tbl.getReqGodownSpace()!=null)
                stmt.bindString(53, tbl.getReqGodownSpace());
            else
                stmt.bindString(53, "");
            if(tbl.getAgreedGodownSpace()!=null)
                stmt.bindString(54, tbl.getAgreedGodownSpace());
            else
                stmt.bindString(54, "");
            if(tbl.getAgreedInvestment()!=null)
                stmt.bindString(55, tbl.getAgreedInvestment());
            else
                stmt.bindString(55, "");


            if(tbl.getIdealROI()!=null)
                stmt.bindString(56, tbl.getIdealROI());
            else
                stmt.bindString(56, "");
            if(tbl.getExpectedROI()!=null)
                stmt.bindString(57, tbl.getExpectedROI());
            else
                stmt.bindString(57, "");
            stmt.bindLong(58, tbl.getIsCheckGiven());


            if(tbl.getChequeNumber()!=null)
                stmt.bindString(59, tbl.getChequeNumber());
            else
                stmt.bindString(59, "");
            stmt.bindLong(60, tbl.getIsGSTDetailsSubmitted());
            if(tbl.getGSTNumber()!=null)
                stmt.bindString(61, tbl.getGSTNumber());
            else
                stmt.bindString(61, "");


            stmt.bindLong(62, tbl.getIsProprietorPanSubmited());
            if(tbl.getProprietorPanNumber()!=null)
                stmt.bindString(63, tbl.getProprietorPanNumber());
            else
                stmt.bindString(63, "");
            stmt.bindLong(64, tbl.getIsPartnerDeedSubmitted());


            stmt.bindLong(65, tbl.getIsPartner1PANSubmitted());
            if(tbl.getPanNumber_Partner1()!=null)
                stmt.bindString(66, tbl.getPanNumber_Partner1());
            else
                stmt.bindString(66, "");
            stmt.bindLong(67, tbl.getIsPartner2PANSubmitted());


            if(tbl.getPanNumber_Partner2()!=null)
                stmt.bindString(68, tbl.getPanNumber_Partner2());
            else
                stmt.bindString(68, "");
            stmt.bindLong(69, tbl.getFlgAppointed());

            stmt.bindLong(70, tbl.getOldDistriutorID());
            stmt.bindLong(71, tbl.getLocationCapturedFrom());
            if(tbl.getPartnerDeedNumber()!=null)
                stmt.bindString(72, tbl.getPartnerDeedNumber());
            else
                stmt.bindString(72, "");


            stmt.bindLong(73, tbl.getIsPANOfFirmSubmitted());
            if(tbl.getPANNoOfFirm()!=null)
                stmt.bindString(74, tbl.getPANNoOfFirm());
            else
                stmt.bindString(74, "");


            stmt.execute();
        }

        stmt.close();
        db.setTransactionSuccessful();
        db.endTransaction();
    }



    public void delete_tblCompetitorCompany() {
        db.delete(TABLE_tblCompetitorCompany, null, null);
    }

    public void insert_tblCompetitorCompany( List<TblPotentialDistributorCompetitorCompanyMstr> tblCompetitorCompanyList) {

        db.beginTransaction();
        String sql = "INSERT INTO " + TABLE_tblCompetitorCompany + " (NodeID, NodeType, CompetitorCompanyID, OtherCompany,flgOther,OtherCompanyCode,SalesValue_Lacs) VALUES (?, ?, ?, ?,?,?,?)";
        SQLiteStatement stmt = db.compileStatement(sql);
        for (TblPotentialDistributorCompetitorCompanyMstr tbl : tblCompetitorCompanyList) {

            stmt.bindString(1, tbl.getNodeID());
            stmt.bindLong(2, tbl.getNodeType());
            stmt.bindLong(3, tbl.getCompetitorCompanyID());
            stmt.bindString(4, tbl.getOtherCompany());
            stmt.bindLong(5, tbl.getFlgOther());
            stmt.bindLong(6, tbl.getOtherCompanyCode());
            if(tbl.getSalesQty()!=null)
                stmt.bindString(7, tbl.getSalesQty());
            else
                stmt.bindString(7, "");

            stmt.execute();
        }

        stmt.close();
        db.setTransactionSuccessful();
        db.endTransaction();
    }



    public void delete_tblCompetitorBrand() {
        db.delete(TABLE_tblCompetitorBrand, null, null);
    }

    public void insert_tblCompetitorBrand( List<TblPotentialDistributorCompetitorBrandMstr> tblCompetitorBrandList) {

        db.beginTransaction();
        String sql = "INSERT INTO " + TABLE_tblCompetitorBrand + " (NodeID, NodeType, CompetitorBrandID, OtherBrand,flgOther,OtherBrandCode) VALUES (?, ?, ?, ?,?,?)";
        SQLiteStatement stmt = db.compileStatement(sql);
        for (TblPotentialDistributorCompetitorBrandMstr tbl : tblCompetitorBrandList) {

            stmt.bindString(1, tbl.getNodeID());
            stmt.bindLong(2, tbl.getNodeType());
            stmt.bindLong(3, tbl.getCompetitorBrandID());
            stmt.bindString(4, tbl.getOtherBrand());
            stmt.bindLong(5, tbl.getFlgOther());
            stmt.bindLong(6, tbl.getOtherBrandCode());

            stmt.execute();
        }

        stmt.close();
        db.setTransactionSuccessful();
        db.endTransaction();
    }



    public void delete_tblCompetitorCompanyMstr() {
        db.delete(TABLE_tblCompetitorCompanyMstr, null, null);
    }

    public void insert_tblCompetitorCompanyMstr( List<TblPotentialDistributorCompetitorCompanyMstr> tblCompetitorCompanyMstrList) {

        db.beginTransaction();
        String sql = "INSERT INTO " + TABLE_tblCompetitorCompanyMstr + " (CompetitorCompanyID, CompetitorCompany,flgOther) VALUES (?, ?,?)";
        SQLiteStatement stmt = db.compileStatement(sql);
        for (TblPotentialDistributorCompetitorCompanyMstr tbl : tblCompetitorCompanyMstrList) {
            stmt.bindLong(1, tbl.getCompetitorCompanyID());
            stmt.bindString(2, tbl.getCompetitorCompany());
            stmt.bindLong(3, 0);//tbl.getFlgOther()

            stmt.execute();
        }

        stmt.close();
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    public void delete_tblCompetitorBrandMstr() {
        db.delete(TABLE_tblCompetitorBrandMstr, null, null);
    }

    public void insert_tblCompetitorBrandMstr( List<TblPotentialDistributorCompetitorBrandMstr> tblCompetitorBrandMstrList) {

        db.beginTransaction();
        String sql = "INSERT INTO " + TABLE_tblCompetitorBrandMstr + " (CompetitorBrandID, CompetitorBrand,flgOther) VALUES (?, ?,?)";
        SQLiteStatement stmt = db.compileStatement(sql);
        for (TblPotentialDistributorCompetitorBrandMstr tbl : tblCompetitorBrandMstrList) {
            stmt.bindLong(1, tbl.getCompetitorBrandID());
            stmt.bindString(2, tbl.getCompetitorBrand());
            stmt.bindLong(3, 0);//tbl.getFlgOther()

            stmt.execute();
        }

        stmt.close();
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    public void delete_tblVehicalType() {
        db.delete(TABLE_tblVehicalType, null, null);
    }

    public void insert_tblVehicalType( List<TblPotentialDistributorVehicleMasterList> tblPotentialDistributorVehicleMasterList) {

        db.beginTransaction();
        String sql = "INSERT INTO " + TABLE_tblVehicalType + " (VehicleTypeID, VehicleType) VALUES (?, ?)";
        SQLiteStatement stmt = db.compileStatement(sql);
        for (TblPotentialDistributorVehicleMasterList tbl : tblPotentialDistributorVehicleMasterList) {


            stmt.bindLong(1, tbl.getVehicleTypeID());
            stmt.bindString(2, tbl.getVehicleType());

            stmt.execute();
        }

        stmt.close();
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    public List<TblPotentialDistributor> fnGetPotentialDetailsList(int NodeType)
    {
        List<TblPotentialDistributor> tblPotentialDistributorList=new ArrayList<TblPotentialDistributor>();
        Cursor cursornew =db.rawQuery("SELECT NodeID,NodeType,LatCode,LongCode,Descr,ContactPersonName,ContactPersonMobileNumber,ContactPersonEMailID,TelephoneNo," +
                "GSTNumber,AreaCovered,NoOfRetailersCovered," +
                "GodownAreaSqFt,MonthlyTurnOver,OrderTATinDays,CompanyProductInvestmentLacs,RetailerCreditLimit,BusinessSince,DistributorReady,NextFollowupDate," +
                "DBREmployee_Dispatch,DBREmployee_Billing,DBREmployee_SalesStaff,Address,Pincode,City,District,State,EntryPersonNodeID,EntryPersonNodeType," +
                "CreatedDate,flgGSTTaken,VehicleTypeID,NoOfVehicles,NoOfRetilersSection,flgViewOrEdit,flgDelete,IsOldDistributorReplaced,IsOldDistributorDFinalPaymentDone,flgDistributorSS,IsNewLocation,flgTownDistributorSubD,Address_Godown,Pincode_Godown,City_Godown,District_Godown,State_Godown,flgProprietorPartner,BankAccountNumber,IFSCCode,BankAddress,ExpectedBusiness,ReqGodownSpace,AgreedGodownSpace,AgreedInvestment,IdealROI,ExpectedROI,IsCheckGiven,ChequeNumber,IsGSTDetailsSubmitted,GSTNumber,IsProprietorPanSubmited,ProprietorPanNumber,IsPartnerDeedSubmitted,IsPartner1PanSubmitted,PanNumber_Partner1,IsPartner2PanSubmitted,PanNumber_Partner2,flgAppointed,OldDistributorID,CurrentLocationIsOf,PartnerDeedNumber,IsPANOfFirmSubmitted,PANNoOfFirm from "+ TABLE_tblPotentialDistributorList+" where NodeType="+NodeType, null);
        try {
            if (cursornew!=null && cursornew.getCount()>0 && cursornew.moveToFirst()) {
                for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                    TblPotentialDistributor tblPotentialDistributor = new TblPotentialDistributor();
                    tblPotentialDistributor.setNodeID(cursornew.getString(0));
                    tblPotentialDistributor.setNodeType(cursornew.getInt(1));
                    tblPotentialDistributor.setLatCode(cursornew.getDouble(2));

                    tblPotentialDistributor.setLongCode(cursornew.getDouble(3));
                    tblPotentialDistributor.setDescr(cursornew.getString(4));
                    tblPotentialDistributor.setContactPersonName(cursornew.getString(5));

                    tblPotentialDistributor.setContactPersonMobileNumber(cursornew.getString(6));
                    tblPotentialDistributor.setContactPersonEMailID(cursornew.getString(7));
                    tblPotentialDistributor.setTelephoneNo(cursornew.getString(8));

                    tblPotentialDistributor.setGSTNumber(cursornew.getString(9));
                    tblPotentialDistributor.setAreaCovered(cursornew.getString(10));
                    tblPotentialDistributor.setNoOfRetailersCovered(cursornew.getString(11));

                    tblPotentialDistributor.setGodownAreaSqFt(cursornew.getString(12));
                    tblPotentialDistributor.setMonthlyTurnOver(cursornew.getString(13));
                    tblPotentialDistributor.setOrderTATinDays(cursornew.getInt(14));

                    tblPotentialDistributor.setCompanyProductInvestmentLacs(cursornew.getInt(15));
                    tblPotentialDistributor.setRetailerCreditLimit(cursornew.getInt(16));
                    tblPotentialDistributor.setBusinessSince(cursornew.getString(17));

                    tblPotentialDistributor.setDistributorReady(cursornew.getInt(18));
                    tblPotentialDistributor.setNextFollowupDate(cursornew.getString(19));

                    //"DBREmployee_Dispatch,DBREmployee_Billing,DBREmployee_SalesStaff,Address,Pincode,City,District,State,EntryPersonNodeID,EntryPersonNodeType," +
                    //                "CreatedDate,flgGSTTaken,VehicleType,NoOfVehicles"
                    tblPotentialDistributor.setDBREmployee_Dispatch(cursornew.getInt(20));

                    tblPotentialDistributor.setDBREmployee_Billing(cursornew.getInt(21));
                    tblPotentialDistributor.setDBREmployee_SalesStaff(cursornew.getInt(22));
                    tblPotentialDistributor.setAddress(cursornew.getString(23));


                    tblPotentialDistributor.setPincode(cursornew.getString(24));
                    tblPotentialDistributor.setCity(cursornew.getString(25));
                    tblPotentialDistributor.setDistrict(cursornew.getString(26));

                    tblPotentialDistributor.setState(cursornew.getString(27));
                    tblPotentialDistributor.setEntryPersonNodeID(cursornew.getInt(28));
                    tblPotentialDistributor.setEntryPersonNodeType(cursornew.getInt(29));

                    tblPotentialDistributor.setCreatedDate(cursornew.getString(30));
                    tblPotentialDistributor.setFlgGSTTaken(cursornew.getInt(31));
                    tblPotentialDistributor.setVehicleTypeID(cursornew.getString(32));

                    tblPotentialDistributor.setNoOfVehicles(cursornew.getInt(33));
                    tblPotentialDistributor.setNoOfRetilersSection(cursornew.getInt(34));
                    tblPotentialDistributor.setFlgViewOrEdit(cursornew.getInt(35));
                    tblPotentialDistributor.setSstat(0);
                    tblPotentialDistributor.setFlgDelete(cursornew.getInt(36));
                    tblPotentialDistributor.setIsOldDistributorReplaced(cursornew.getInt(37));
                    tblPotentialDistributor.setIsOldDistributorDFinalPaymentDone(cursornew.getInt(38));
                    tblPotentialDistributor.setFlgDistributorSS(cursornew.getInt(39));
                    tblPotentialDistributor.setIsNewLocation(cursornew.getInt(40));
                    tblPotentialDistributor.setFlgTownDistributorSubD(cursornew.getInt(41));
                    tblPotentialDistributor.setAddress_Godown(cursornew.getString(42));
                    tblPotentialDistributor.setPincode_Godown(cursornew.getString(43));
                    tblPotentialDistributor.setCity_Godown(cursornew.getString(44));
                    tblPotentialDistributor.setDistrict_Godown(cursornew.getString(45));
                    tblPotentialDistributor.setState_Godown(cursornew.getString(46));
                    tblPotentialDistributor.setFlgProprietorPartner(cursornew.getInt(47));
                    tblPotentialDistributor.setBankAccountNumber(cursornew.getString(48));
                    tblPotentialDistributor.setBankAccountNumber(cursornew.getString(48));
                    tblPotentialDistributor.setIFSCCode(cursornew.getString(49));
                    tblPotentialDistributor.setBankAddress(cursornew.getString(50));
                    tblPotentialDistributor.setExpectedBusiness(cursornew.getString(51));
                    tblPotentialDistributor.setReqGodownSpace(cursornew.getString(52));
                    tblPotentialDistributor.setAgreedGodownSpace(cursornew.getString(53));
                    tblPotentialDistributor.setAgreedInvestment(cursornew.getString(54));
                    tblPotentialDistributor.setIdealROI(cursornew.getString(55));
                    tblPotentialDistributor.setExpectedROI(cursornew.getString(56));
                    tblPotentialDistributor.setIsCheckGiven(cursornew.getInt(57));
                    tblPotentialDistributor.setChequeNumber(cursornew.getString(58));
                    tblPotentialDistributor.setIsGSTDetailsSubmitted(cursornew.getInt(59));
                    tblPotentialDistributor.setGSTNumber(cursornew.getString(60));
                    tblPotentialDistributor.setIsProprietorPanSubmited(cursornew.getInt(61));
                    tblPotentialDistributor.setProprietorPanNumber(cursornew.getString(62));
                    tblPotentialDistributor.setIsPartnerDeedSubmitted(cursornew.getInt(63));
                    tblPotentialDistributor.setIsPartner1PANSubmitted(cursornew.getInt(64));
                    tblPotentialDistributor.setPanNumber_Partner1(cursornew.getString(65));
                    tblPotentialDistributor.setIsPartner2PANSubmitted(cursornew.getInt(66));
                    tblPotentialDistributor.setPanNumber_Partner2(cursornew.getString(67));
                    tblPotentialDistributor.setFlgAppointed(cursornew.getInt(68));
                    tblPotentialDistributor.setOldDistriutorID(cursornew.getInt(69));

                    tblPotentialDistributor.setLocationCapturedFrom(cursornew.getInt(70));
                    tblPotentialDistributor.setPartnerDeedNumber(cursornew.getString(71));
                    tblPotentialDistributor.setIsPANOfFirmSubmitted(cursornew.getInt(72));
                    tblPotentialDistributor.setPANNoOfFirm(cursornew.getString(73));
//PartnerDeedNumber
                    tblPotentialDistributorList.add(tblPotentialDistributor);
                    cursornew.moveToNext();
                }

            }

        } finally {
            if(cursornew!=null)
                cursornew.close();
        }
        return tblPotentialDistributorList;
    }


    public TblPotentialDistributor fnGetSelectedPotentialDetails(String SocutingDealerID)
    {
        TblPotentialDistributor tblPotentialDistributor = new TblPotentialDistributor();
        Cursor cursornew =db.rawQuery("SELECT NodeID,NodeType,LatCode,LongCode,Descr,ContactPersonName,ContactPersonMobileNumber,ContactPersonEMailID,TelephoneNo," +
                "GSTNumber,AreaCovered,NoOfRetailersCovered," +
                "GodownAreaSqFt,MonthlyTurnOver,OrderTATinDays,CompanyProductInvestmentLacs,RetailerCreditLimit,BusinessSince,DistributorReady,NextFollowupDate," +
                "DBREmployee_Dispatch,DBREmployee_Billing,DBREmployee_SalesStaff,Address,Pincode,City,District,State,EntryPersonNodeID,EntryPersonNodeType," +
                "CreatedDate,flgGSTTaken,VehicleTypeID,NoOfVehicles,NoOfRetilersSection,flgViewOrEdit,flgDelete,IsOldDistributorReplaced,IsOldDistributorDFinalPaymentDone,flgDistributorSS,IsNewLocation,flgTownDistributorSubD,Address_Godown,Pincode_Godown,City_Godown,District_Godown,State_Godown,flgProprietorPartner,BankAccountNumber,IFSCCode,BankAddress,ExpectedBusiness,ReqGodownSpace,AgreedGodownSpace,AgreedInvestment,IdealROI,ExpectedROI,IsCheckGiven,ChequeNumber,IsGSTDetailsSubmitted,GSTNumber,IsProprietorPanSubmited,ProprietorPanNumber,IsPartnerDeedSubmitted,IsPartner1PanSubmitted,PanNumber_Partner1,IsPartner2PanSubmitted,PanNumber_Partner2,flgAppointed,OldDistributorID,CurrentLocationIsOf,PartnerDeedNumber,IsPANOfFirmSubmitted,PANNoOfFirm from "+ TABLE_tblPotentialDistributorList+" where NodeID='"+SocutingDealerID+"'", null);
        try {
            if (cursornew!=null && cursornew.getCount()>0 && cursornew.moveToFirst()) {

                tblPotentialDistributor.setNodeID(cursornew.getString(0));
                tblPotentialDistributor.setNodeType(cursornew.getInt(1));
                tblPotentialDistributor.setLatCode(cursornew.getDouble(2));

                tblPotentialDistributor.setLongCode(cursornew.getDouble(3));
                tblPotentialDistributor.setDescr(cursornew.getString(4));
                tblPotentialDistributor.setContactPersonName(cursornew.getString(5));

                tblPotentialDistributor.setContactPersonMobileNumber(cursornew.getString(6));
                tblPotentialDistributor.setContactPersonEMailID(cursornew.getString(7));
                tblPotentialDistributor.setTelephoneNo(cursornew.getString(8));

                tblPotentialDistributor.setGSTNumber(cursornew.getString(9));
                tblPotentialDistributor.setAreaCovered(cursornew.getString(10));
                tblPotentialDistributor.setNoOfRetailersCovered(cursornew.getString(11));

                tblPotentialDistributor.setGodownAreaSqFt(cursornew.getString(12));
                tblPotentialDistributor.setMonthlyTurnOver(cursornew.getString(13));
                tblPotentialDistributor.setOrderTATinDays(cursornew.getInt(14));

                tblPotentialDistributor.setCompanyProductInvestmentLacs(cursornew.getInt(15));
                tblPotentialDistributor.setRetailerCreditLimit(cursornew.getInt(16));
                tblPotentialDistributor.setBusinessSince(cursornew.getString(17));

                tblPotentialDistributor.setDistributorReady(cursornew.getInt(18));
                tblPotentialDistributor.setNextFollowupDate(cursornew.getString(19));

                //"DBREmployee_Dispatch,DBREmployee_Billing,DBREmployee_SalesStaff,Address,Pincode,City,District,State,EntryPersonNodeID,EntryPersonNodeType," +
                //                "CreatedDate,flgGSTTaken,VehicleType,NoOfVehicles"
                tblPotentialDistributor.setDBREmployee_Dispatch(cursornew.getInt(20));

                tblPotentialDistributor.setDBREmployee_Billing(cursornew.getInt(21));
                tblPotentialDistributor.setDBREmployee_SalesStaff(cursornew.getInt(22));
                tblPotentialDistributor.setAddress(cursornew.getString(23));


                tblPotentialDistributor.setPincode(cursornew.getString(24));
                tblPotentialDistributor.setCity(cursornew.getString(25));
                tblPotentialDistributor.setDistrict(cursornew.getString(26));

                tblPotentialDistributor.setState(cursornew.getString(27));
                tblPotentialDistributor.setEntryPersonNodeID(cursornew.getInt(28));
                tblPotentialDistributor.setEntryPersonNodeType(cursornew.getInt(29));

                tblPotentialDistributor.setCreatedDate(cursornew.getString(30));
                tblPotentialDistributor.setFlgGSTTaken(cursornew.getInt(31));
                tblPotentialDistributor.setVehicleTypeID(cursornew.getString(32));

                tblPotentialDistributor.setNoOfVehicles(cursornew.getInt(33));
                tblPotentialDistributor.setNoOfRetilersSection(cursornew.getInt(34));
                tblPotentialDistributor.setFlgViewOrEdit(cursornew.getInt(35));
                tblPotentialDistributor.setFlgDelete(cursornew.getInt(36));
                tblPotentialDistributor.setSstat(0);


                tblPotentialDistributor.setIsOldDistributorReplaced(cursornew.getInt(37));
                tblPotentialDistributor.setIsOldDistributorDFinalPaymentDone(cursornew.getInt(38));
                tblPotentialDistributor.setFlgDistributorSS(cursornew.getInt(39));
                tblPotentialDistributor.setIsNewLocation(cursornew.getInt(40));
                tblPotentialDistributor.setFlgTownDistributorSubD(cursornew.getInt(41));
                tblPotentialDistributor.setAddress_Godown(cursornew.getString(42));
                tblPotentialDistributor.setPincode_Godown(cursornew.getString(43));
                tblPotentialDistributor.setCity_Godown(cursornew.getString(44));
                tblPotentialDistributor.setDistrict_Godown(cursornew.getString(45));
                tblPotentialDistributor.setState_Godown(cursornew.getString(46));
                tblPotentialDistributor.setFlgProprietorPartner(cursornew.getInt(47));
                tblPotentialDistributor.setBankAccountNumber(cursornew.getString(48));
                tblPotentialDistributor.setBankAccountNumber(cursornew.getString(48));
                tblPotentialDistributor.setIFSCCode(cursornew.getString(49));
                tblPotentialDistributor.setBankAddress(cursornew.getString(50));
                tblPotentialDistributor.setExpectedBusiness(cursornew.getString(51));
                tblPotentialDistributor.setReqGodownSpace(cursornew.getString(52));
                tblPotentialDistributor.setAgreedGodownSpace(cursornew.getString(53));
                tblPotentialDistributor.setAgreedInvestment(cursornew.getString(54));
                tblPotentialDistributor.setIdealROI(cursornew.getString(55));
                tblPotentialDistributor.setExpectedROI(cursornew.getString(56));
                tblPotentialDistributor.setIsCheckGiven(cursornew.getInt(57));
                tblPotentialDistributor.setChequeNumber(cursornew.getString(58));
                tblPotentialDistributor.setIsGSTDetailsSubmitted(cursornew.getInt(59));
                tblPotentialDistributor.setGSTNumber(cursornew.getString(60));
                tblPotentialDistributor.setIsProprietorPanSubmited(cursornew.getInt(61));
                tblPotentialDistributor.setProprietorPanNumber(cursornew.getString(62));
                tblPotentialDistributor.setIsPartnerDeedSubmitted(cursornew.getInt(63));
                tblPotentialDistributor.setIsPartner1PANSubmitted(cursornew.getInt(64));
                tblPotentialDistributor.setPanNumber_Partner1(cursornew.getString(65));
                tblPotentialDistributor.setIsPartner2PANSubmitted(cursornew.getInt(66));
                tblPotentialDistributor.setPanNumber_Partner2(cursornew.getString(67));
                tblPotentialDistributor.setFlgAppointed(cursornew.getInt(68));
                tblPotentialDistributor.setOldDistriutorID(cursornew.getInt(69));
                tblPotentialDistributor.setLocationCapturedFrom(cursornew.getInt(70));
                tblPotentialDistributor.setPartnerDeedNumber(cursornew.getString(71));
                tblPotentialDistributor.setIsPANOfFirmSubmitted(cursornew.getInt(72));
                tblPotentialDistributor.setPANNoOfFirm(cursornew.getString(73));

            }

        }
        catch(Exception ex)
        {
            String sdsd=ex.getMessage().toString();
        }
        finally {
            if(cursornew!=null)
                cursornew.close();
        }
        return tblPotentialDistributor;
    }


    public List<TblPotentialDistributorCompetitorCompanyMstr> fnGetPotentialDistributorCompetitorCompanyMstr()
    {
        List<TblPotentialDistributorCompetitorCompanyMstr> tblPotentialDistributorCompetitorCompanyMstrList = new ArrayList<TblPotentialDistributorCompetitorCompanyMstr>();
        Cursor cursornew =db.rawQuery("SELECT CompetitorCompanyID,CompetitorCompany,flgOther from "+ TABLE_tblCompetitorCompanyMstr+"", null);
        try {
            if (cursornew!=null && cursornew.getCount()>0 && cursornew.moveToFirst()) {
                for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                    TblPotentialDistributorCompetitorCompanyMstr tblPotentialDistributorCompetitorCompanyMstr=new TblPotentialDistributorCompetitorCompanyMstr();
                    tblPotentialDistributorCompetitorCompanyMstr.setCompetitorCompanyID(cursornew.getInt(0));
                    tblPotentialDistributorCompetitorCompanyMstr.setCompetitorCompany(cursornew.getString(1));
                    tblPotentialDistributorCompetitorCompanyMstr.setFlgOther(cursornew.getInt(2));

                    tblPotentialDistributorCompetitorCompanyMstrList.add(tblPotentialDistributorCompetitorCompanyMstr);
                    cursornew.moveToNext();
                }
            }

        } finally {
            if(cursornew!=null)
                cursornew.close();
        }
        return tblPotentialDistributorCompetitorCompanyMstrList;
    }

    public List<TblPotentialDistributorCompetitorCompanyMstr> fnGetPotentialDistributorCompetitorCompanyDetails(String ScoutingDistributorID)
    {
        List<TblPotentialDistributorCompetitorCompanyMstr> tblPotentialDistributorCompetitorCompanyMstrList = new ArrayList<TblPotentialDistributorCompetitorCompanyMstr>();
        Cursor cursornew =db.rawQuery("SELECT NodeID,NodeType,CompetitorCompanyID,OtherCompany,flgOther,OtherCompanyCode,ifnull(SalesValue_Lacs,'0') from "+ TABLE_tblCompetitorCompany+" where NodeID='"+ScoutingDistributorID+"'", null);
        try {
            if (cursornew!=null && cursornew.getCount()>0 && cursornew.moveToFirst()) {
                for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                    TblPotentialDistributorCompetitorCompanyMstr tblPotentialDistributorCompetitorCompanyMstr=new TblPotentialDistributorCompetitorCompanyMstr();
                    tblPotentialDistributorCompetitorCompanyMstr.setNodeID(cursornew.getString(0));
                    tblPotentialDistributorCompetitorCompanyMstr.setNodeType(cursornew.getInt(1));
                    tblPotentialDistributorCompetitorCompanyMstr.setCompetitorCompanyID(cursornew.getInt(2));
                    tblPotentialDistributorCompetitorCompanyMstr.setOtherCompany(cursornew.getString(3));
                    tblPotentialDistributorCompetitorCompanyMstr.setFlgOther(cursornew.getInt(4));
                    tblPotentialDistributorCompetitorCompanyMstr.setOtherCompanyCode(cursornew.getInt(5));
                    tblPotentialDistributorCompetitorCompanyMstr.setSalesQty(cursornew.getString(6));
                    tblPotentialDistributorCompetitorCompanyMstrList.add(tblPotentialDistributorCompetitorCompanyMstr);
                    cursornew.moveToNext();
                }
            }

        } finally {
            if(cursornew!=null)
                cursornew.close();
        }
        return tblPotentialDistributorCompetitorCompanyMstrList;
    }


    public List<TblPotentialDistributorCompetitorBrandMstr> fnGetPotentialDistributorCompetitorBrandMstr()
    {
        List<TblPotentialDistributorCompetitorBrandMstr> tblPotentialDistributorCompetitorBrandMstrList = new ArrayList<TblPotentialDistributorCompetitorBrandMstr>();
        Cursor cursornew =db.rawQuery("SELECT CompetitorBrandID,CompetitorBrand,flgOther from "+ TABLE_tblCompetitorBrandMstr+"", null);
        try {
            if (cursornew!=null && cursornew.getCount()>0 && cursornew.moveToFirst()) {
                for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                    TblPotentialDistributorCompetitorBrandMstr tblPotentialDistributorCompetitorBrandMstr=new TblPotentialDistributorCompetitorBrandMstr();
                    tblPotentialDistributorCompetitorBrandMstr.setCompetitorBrandID(cursornew.getInt(0));
                    tblPotentialDistributorCompetitorBrandMstr.setCompetitorBrand(cursornew.getString(1));
                    tblPotentialDistributorCompetitorBrandMstr.setFlgOther(cursornew.getInt(2));
                    tblPotentialDistributorCompetitorBrandMstrList.add(tblPotentialDistributorCompetitorBrandMstr);
                    cursornew.moveToNext();
                }
            }

        } finally {
            if(cursornew!=null)
                cursornew.close();
        }
        return tblPotentialDistributorCompetitorBrandMstrList;
    }

    public List<TblPotentialDistributorCompetitorBrandMstr> fnGetPotentialDistributorCompetitorBrandDetails(String ScoutingDistributorID)
    {
        List<TblPotentialDistributorCompetitorBrandMstr> tblPotentialDistributorCompetitorBrandMstrList = new ArrayList<TblPotentialDistributorCompetitorBrandMstr>();
        Cursor cursornew =db.rawQuery("SELECT NodeID,NodeType,CompetitorBrandID,OtherBrand,flgOther,OtherBrandCode from "+ TABLE_tblCompetitorBrand+" where NodeID='"+ScoutingDistributorID+"'", null);
        try {
            if (cursornew!=null && cursornew.getCount()>0 && cursornew.moveToFirst()) {
                for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                    TblPotentialDistributorCompetitorBrandMstr tblPotentialDistributorCompetitorBrandMstr=new TblPotentialDistributorCompetitorBrandMstr();
                    tblPotentialDistributorCompetitorBrandMstr.setNodeID(cursornew.getString(0));
                    tblPotentialDistributorCompetitorBrandMstr.setNodeType(cursornew.getInt(1));
                    tblPotentialDistributorCompetitorBrandMstr.setCompetitorBrandID(cursornew.getInt(2));
                    tblPotentialDistributorCompetitorBrandMstr.setOtherBrand(cursornew.getString(3));
                    tblPotentialDistributorCompetitorBrandMstr.setFlgOther(cursornew.getInt(4));
                    tblPotentialDistributorCompetitorBrandMstr.setOtherBrandCode(cursornew.getInt(5));
                    tblPotentialDistributorCompetitorBrandMstrList.add(tblPotentialDistributorCompetitorBrandMstr);
                    cursornew.moveToNext();
                }
            }

        } finally {
            if(cursornew!=null)
                cursornew.close();
        }
        return tblPotentialDistributorCompetitorBrandMstrList;
    }
    public List<TblPotentialDistributorVehicleMasterList> fnGetPotentialDistributorVechileList(String NodeID)
    {
        List<TblPotentialDistributorVehicleMasterList> tblPotentialDistributorVehicleMasterListList = new ArrayList<TblPotentialDistributorVehicleMasterList>();
        Cursor cursornew =db.rawQuery("SELECT  Distinct tblVehicalType.VehicleTypeID,tblVehicalType.VehicleType,Case when tblPotentialDistributorList.VehicleTypeID =tblVehicalType.VehicleTypeID  then 1 else 0 end AS FlgEnable ,Case when tblPotentialDistributorList.VehicleTypeID =tblVehicalType.VehicleTypeID  then ifnull(NoOfVehicles,'0') else 0 end AS  NoOfVehicles from "+ TABLE_tblVehicalType+" left outer join tblPotentialDistributorList on (tblPotentialDistributorList.VehicleTypeID=tblVehicalType.VehicleTypeID) and tblPotentialDistributorList.NodeID='"+NodeID+"'", null);
        //Cursor cursornew =db.rawQuery("SELECT  Distinct tblVehicalType.VehicleTypeID,tblVehicalType.VehicleType,Case when tblPotentialDistributorList.VehicleTypeID =tblVehicalType.VehicleTypeID  then 1 else 0 end AS FlgEnable ,Case when tblPotentialDistributorList.VehicleTypeID =tblVehicalType.VehicleTypeID  then ifnull(NoOfVehicles,'0') else 0 end AS  NoOfVehicles from tblPotentialDistributorList left outer join "+DBHelper.TABLE_tblVehicalType+"  on (tblPotentialDistributorList.VehicleTypeID=tblVehicalType.VehicleTypeID) and tblPotentialDistributorList.NodeID='"+NodeID+"'", null);
        try {
            if (cursornew!=null && cursornew.getCount()>0 && cursornew.moveToFirst()) {
                for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                    if(i==0)
                    {
                        TblPotentialDistributorVehicleMasterList tblPotentialDistributorVehicleMaster1=new TblPotentialDistributorVehicleMasterList();
                        tblPotentialDistributorVehicleMaster1.setVehicleTypeID(0);
                        tblPotentialDistributorVehicleMaster1.setVehicleType("Select Vehicle");
                        tblPotentialDistributorVehicleMaster1.setFlgEnable(0);
                        tblPotentialDistributorVehicleMaster1.setNoOfVechile("0");
                        tblPotentialDistributorVehicleMasterListList.add(tblPotentialDistributorVehicleMaster1);
                    }
                    TblPotentialDistributorVehicleMasterList tblPotentialDistributorVehicleMaster=new TblPotentialDistributorVehicleMasterList();
                    tblPotentialDistributorVehicleMaster.setVehicleTypeID(cursornew.getInt(0));
                    tblPotentialDistributorVehicleMaster.setVehicleType(cursornew.getString(1));
                    tblPotentialDistributorVehicleMaster.setFlgEnable(cursornew.getInt(2));
                    tblPotentialDistributorVehicleMaster.setNoOfVechile(cursornew.getString(3));
                    tblPotentialDistributorVehicleMasterListList.add(tblPotentialDistributorVehicleMaster);
                    cursornew.moveToNext();
                }
            }

        } finally {
            if(cursornew!=null)
                cursornew.close();
        }
        return tblPotentialDistributorVehicleMasterListList;
    }

    public void delete_tblPotentialDistributorRetailersFeedBackDetails() {
        db.delete(TABLE_PotentialDistributorRetailersFeedBackDetails, null, null);
    }

    public void insert_tblPotentialDistributorRetailersFeedBackDetails( List<TblPotentialDistributorRetailersFeedBackDetails> tblPotentialDistributorRetailersFeedBackDetailsList) {

        db.beginTransaction();
        String sql = "INSERT INTO " + TABLE_PotentialDistributorRetailersFeedBackDetails + " (RetailerSectionID, RetailerName,Address,Comment,Feedback,PDAcode,EntryDate,NodeID,NodeType,ContactNumber) VALUES (?,?, ?,?, ?,?, ?,?,?,?)";
        SQLiteStatement stmt = db.compileStatement(sql);
        for (TblPotentialDistributorRetailersFeedBackDetails tbl : tblPotentialDistributorRetailersFeedBackDetailsList) {


            stmt.bindString(1, tbl.getRetailerSectionID());
            stmt.bindString(2, tbl.getRetailerName());
            stmt.bindString(3, tbl.getAddress());
            stmt.bindString(4, tbl.getComment());
            stmt.bindLong(5, tbl.getFeedback());
            stmt.bindString(6, "NA");
            if(tbl.getEntryDate()!=null)
                stmt.bindString(7, tbl.getEntryDate());
            else
                stmt.bindString(7, "NA");
            stmt.bindString(8, tbl.getNodeID());
            stmt.bindLong(9, tbl.getNodeType());
            if(tbl.getContactNumber()!=null)
                stmt.bindString(10, tbl.getContactNumber());
            else
                stmt.bindString(10, "NA");
            stmt.execute();
        }

        stmt.close();
        db.setTransactionSuccessful();
        db.endTransaction();
    }




    public List<TblPotentialDistributorRetailersFeedBackDetails> fnGetPotentialDistributorRetailersFeedBackDetails(String ScoutingDistributorID,String PersonNodeID,int PersonNodeType)
    {
        List<TblPotentialDistributorRetailersFeedBackDetails> tblPotentialDistributorRetailersFeedBackDetailsList=new ArrayList<TblPotentialDistributorRetailersFeedBackDetails>();
        Cursor cursornew =db.rawQuery("SELECT RetailerSectionID,RetailerName,Address,Comment,Feedback,PDAcode,NodeID,NodeType,EntryDate,ContactNumber from "+DBHelper.TABLE_PotentialDistributorRetailersFeedBackDetails+" where NodeID='"+ScoutingDistributorID+"'", null);
        try {
            if (cursornew!=null && cursornew.getCount()>0 && cursornew.moveToFirst()) {
                for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                    TblPotentialDistributorRetailersFeedBackDetails tblPotentialDistributorRetailersFeedBackDetails = new TblPotentialDistributorRetailersFeedBackDetails();
                    tblPotentialDistributorRetailersFeedBackDetails.setRetailerSectionID(cursornew.getString(0));
                    tblPotentialDistributorRetailersFeedBackDetails.setRetailerName(cursornew.getString(1));
                    tblPotentialDistributorRetailersFeedBackDetails.setAddress(cursornew.getString(2));

                    tblPotentialDistributorRetailersFeedBackDetails.setComment(cursornew.getString(3));
                    tblPotentialDistributorRetailersFeedBackDetails.setFeedback(cursornew.getInt(4));
                    tblPotentialDistributorRetailersFeedBackDetails.setPDAcode(AppUtils.getToken(mContext));
                    tblPotentialDistributorRetailersFeedBackDetails.setNodeID(PersonNodeID);
                    tblPotentialDistributorRetailersFeedBackDetails.setNodeType(PersonNodeType);
                    tblPotentialDistributorRetailersFeedBackDetails.setContactNumber(cursornew.getString(9));

                    tblPotentialDistributorRetailersFeedBackDetailsList.add(tblPotentialDistributorRetailersFeedBackDetails);
                    cursornew.moveToNext();
                }

            }

        } finally {
            if(cursornew!=null)
                cursornew.close();
        }
        return tblPotentialDistributorRetailersFeedBackDetailsList;
    }

    public int fnGetExistingOwnerNumberFromScoutingDistributor(String ContactNumber, String crntScoutingDistributorID) {
        int existOutID = 0;
        //open();
        Cursor cursor = db.rawQuery("SELECT " + DBHelper.NodeID + "," + DBHelper.ContactPersonMobileNumber + "  from " + TABLE_tblPotentialDistributorList + " Where " + DBHelper.NodeID + "<>'" + crntScoutingDistributorID + "' and " + DBHelper.ContactPersonMobileNumber + " is not null", null);// where "+AESUtils.decrypt(DBHelper.MobileNumber)+" ='"+ContactNumber.trim()+"'
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                  /*  if(cursor.getInt(0)>0)
                    {
                        existOutID=1;
                    }*/

                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //AESUtils.decrypt(
                        String stContact = "0";

                        if (cursor.getString(1) != null && !cursor.getString(1).equals("0")) {
                            stContact = cursor.getString(1);

                        }

                        if (stContact.trim().equals(ContactNumber.trim())) {
                            existOutID = 1;

                            break;
                        }


                        cursor.moveToNext();
                    }

                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (cursor != null)
                cursor.close();
            // close();
        }
        return existOutID;
    }

    public String fnGetScoutingDistributorNamewithMobileNo(String ContactNumber) {
        String existOut = "0";
        //open();
        Cursor cursor = db.rawQuery("SELECT " + DBHelper.Descr + "," + DBHelper.ContactPersonName + "  from " + TABLE_tblPotentialDistributorList + "", null);// where "+AESUtils.decrypt(DBHelper.MobileNumber)+" ='"+ContactNumber.trim()+"' Limit 1
        // close();
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {
                    //  existOut=cursor.getString(0);
                    for (int i = 0; i <= (cursor.getCount() - 1); i++) {
                        //AESUtils.decrypt(
                        String stContact = "0";
                        String stName = "NA";
                        if (cursor.getString(1) != null && !cursor.getString(1).equals("NA")) {
                            stContact = cursor.getString(1);

                        }

                        if (stContact.trim().equals(ContactNumber.trim())) {

                            stName = cursor.getString(0);
                            existOut = stName;


                            break;

                        }


                        cursor.moveToNext();
                    }

                }
            }
            return existOut;
        } finally {
            if (cursor != null)
                cursor.close();
            // close();
        }
    }



    public void delete_tblDistRetAddressDetail() {
        db.delete(TABLE_tblDistRetAddressDetail, null, null);
    }

    public void insert_tblDistRetAddressDetail( List<TblPotentialDistributorRetailersFeedBackDetails> tblPotentialDistributorRetailersFeedBackDetailsList,HashMap<String,Integer>hmapDistributorRetailerSstatStaus) {

        db.beginTransaction();
        String sql = "INSERT INTO " + TABLE_tblDistRetAddressDetail + " (RetailerSectionID, RetailerName,Address,Comment,Feedback,PDAcode,EntryDate,NodeID,NodeType,DBRName,Sstat,ContactNumber) VALUES (?,?, ?,?, ?,?, ?,?,?,?,?,?)";
        SQLiteStatement stmt = db.compileStatement(sql);
        for (TblPotentialDistributorRetailersFeedBackDetails tbl : tblPotentialDistributorRetailersFeedBackDetailsList) {


            stmt.bindString(1, tbl.getRetailerSectionID());
            stmt.bindString(2, tbl.getRetailerName());
            stmt.bindString(3, tbl.getAddress());
            stmt.bindString(4, tbl.getComment());
            stmt.bindLong(5, tbl.getFeedback());
            stmt.bindString(6, "NA");
            if(tbl.getEntryDate()!=null)
                stmt.bindString(7, tbl.getEntryDate());
            else
                stmt.bindString(7, "NA");
            stmt.bindString(8, tbl.getNodeID());
            stmt.bindLong(9, tbl.getNodeType());
            stmt.bindString(10, tbl.getDBRName());
            if(hmapDistributorRetailerSstatStaus!=null && hmapDistributorRetailerSstatStaus.size()>0 && hmapDistributorRetailerSstatStaus.containsKey(tbl.getNodeID()+"^"+tbl.getRetailerSectionID()))
                stmt.bindLong(11, hmapDistributorRetailerSstatStaus.get(tbl.getNodeID()+"^"+tbl.getRetailerSectionID()));
            else
                stmt.bindLong(11, tbl.getSstat());

            if(tbl.getContactNumber()!=null)
                stmt.bindString(12, tbl.getContactNumber());
            else
                stmt.bindString(12, "0");

            stmt.execute();
        }

        stmt.close();
        db.setTransactionSuccessful();
        db.endTransaction();
    }


    public List<TblPotentialDistributorRetailersFeedBackDetails> fnGettblDistRetAddressDetailList()
    {
        List<TblPotentialDistributorRetailersFeedBackDetails> tblPotentialDistributorRetailersFeedBackDetailsList=new ArrayList<TblPotentialDistributorRetailersFeedBackDetails>();
        Cursor cursornew =db.rawQuery("SELECT RetailerSectionID,RetailerName,Address,Comment,Feedback,PDAcode,NodeID,NodeType,EntryDate,DBRName,Sstat from "+ TABLE_tblDistRetAddressDetail+"", null);
        try {
            if (cursornew!=null && cursornew.getCount()>0 && cursornew.moveToFirst()) {
                for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                    TblPotentialDistributorRetailersFeedBackDetails tblPotentialDistributorRetailersFeedBackDetails = new TblPotentialDistributorRetailersFeedBackDetails();
                    tblPotentialDistributorRetailersFeedBackDetails.setRetailerSectionID(cursornew.getString(0));
                    tblPotentialDistributorRetailersFeedBackDetails.setRetailerName(cursornew.getString(1));
                    tblPotentialDistributorRetailersFeedBackDetails.setAddress(cursornew.getString(2));

                    tblPotentialDistributorRetailersFeedBackDetails.setComment(cursornew.getString(3));
                    tblPotentialDistributorRetailersFeedBackDetails.setFeedback(cursornew.getInt(4));
                    tblPotentialDistributorRetailersFeedBackDetails.setPDAcode(AppUtils.getToken(mContext));
                    tblPotentialDistributorRetailersFeedBackDetails.setNodeID(cursornew.getString(6));
                    tblPotentialDistributorRetailersFeedBackDetails.setNodeType(cursornew.getInt(7));
                    tblPotentialDistributorRetailersFeedBackDetails.setDBRName(cursornew.getString(9));
                    tblPotentialDistributorRetailersFeedBackDetails.setSstat(cursornew.getInt(10));

                    tblPotentialDistributorRetailersFeedBackDetailsList.add(tblPotentialDistributorRetailersFeedBackDetails);
                    cursornew.moveToNext();
                }

            }

        } finally {
            if(cursornew!=null)
                cursornew.close();
        }
        return tblPotentialDistributorRetailersFeedBackDetailsList;
    }

    public  List<TblPotentialDistributorRetailersFeedBackDetails> fnGettblDistRetAddressDetailListParticualrDistributorRetailer(String NodeID,String RetaierCode)
    {
        List<TblPotentialDistributorRetailersFeedBackDetails>  tblPotentialDistributorRetailersFeedBackDetailsList = new ArrayList<TblPotentialDistributorRetailersFeedBackDetails>();
        Cursor cursornew =db.rawQuery("SELECT RetailerSectionID,RetailerName,Address,Comment,Feedback,PDAcode,NodeID,NodeType,EntryDate,DBRName,Sstat,ContactNumber from "+ TABLE_tblDistRetAddressDetail+" where NodeID='"+NodeID+"' and RetailerSectionID='"+RetaierCode+"'", null);
        try {
            if (cursornew!=null && cursornew.getCount()>0 && cursornew.moveToFirst()) {
                for (int i = 0; i <= (cursornew.getCount() - 1); i++) {
                    TblPotentialDistributorRetailersFeedBackDetails tblPotentialDistributorRetailersFeedBackDetails=new TblPotentialDistributorRetailersFeedBackDetails();
                    tblPotentialDistributorRetailersFeedBackDetails.setRetailerSectionID(cursornew.getString(0));
                    tblPotentialDistributorRetailersFeedBackDetails.setRetailerName(cursornew.getString(1));
                    tblPotentialDistributorRetailersFeedBackDetails.setAddress(cursornew.getString(2));

                    tblPotentialDistributorRetailersFeedBackDetails.setComment(cursornew.getString(3));
                    tblPotentialDistributorRetailersFeedBackDetails.setFeedback(cursornew.getInt(4));
                    tblPotentialDistributorRetailersFeedBackDetails.setPDAcode(AppUtils.getToken(mContext));
                    tblPotentialDistributorRetailersFeedBackDetails.setNodeID(cursornew.getString(6));
                    tblPotentialDistributorRetailersFeedBackDetails.setNodeType(cursornew.getInt(7));
                    tblPotentialDistributorRetailersFeedBackDetails.setDBRName(cursornew.getString(9));
                    tblPotentialDistributorRetailersFeedBackDetails.setSstat(cursornew.getInt(10));
                    tblPotentialDistributorRetailersFeedBackDetails.setContactNumber(cursornew.getString(11));
                    tblPotentialDistributorRetailersFeedBackDetailsList.add(tblPotentialDistributorRetailersFeedBackDetails);

                    cursornew.moveToNext();
                }

            }

        } finally {
            if(cursornew!=null)
                cursornew.close();
        }
        return tblPotentialDistributorRetailersFeedBackDetailsList;
    }
    public HashMap<String, Integer> fetchHmapDistributorRetailerSstat() {

        HashMap<String, Integer> hmapOrderIDandClickStatus = new HashMap<String, Integer>();
        //open();
        Cursor cursor = db.rawQuery("SELECT NodeID||'^'||RetailerSectionID,ifnull(Sstat,0) FROM tblDistRetAddressDetail", null);
        try {
            if (cursor.getCount() > 0) {
                if (cursor.moveToFirst()) {

                    for (int i = 0; i < cursor.getCount(); i++) {
                        if (cursor.getString(0) != null)
                            hmapOrderIDandClickStatus.put((String) cursor.getString(0).toString(), cursor.getInt(1));
                        cursor.moveToNext();
                    }
                }
            }
            return hmapOrderIDandClickStatus;
        } finally {
            cursor.close();
            // close();
        }

    }


    public void insert_tblDistRetAddressDetailSingleRetailer( TblPotentialDistributorRetailersFeedBackDetails tbl) {
        db.execSQL("DELETE FROM tblDistRetAddressDetail where NodeID='"+tbl.getNodeID()+"' and RetailerSectionID='"+tbl.getRetailerSectionID()+"'");
        db.beginTransaction();
        String sql = "INSERT INTO " + TABLE_tblDistRetAddressDetail + " (RetailerSectionID, RetailerName,Address,Comment,Feedback,PDAcode,EntryDate,NodeID,NodeType,DBRName,Sstat,flgFinalSubmit,ContactNumber) VALUES (?, ?,?, ?,?, ?,?,?,?,?,?,?,?)";
        SQLiteStatement stmt = db.compileStatement(sql);

        stmt.bindString(1, tbl.getRetailerSectionID());
        stmt.bindString(2, tbl.getRetailerName());
        stmt.bindString(3, tbl.getAddress());
        stmt.bindString(4, tbl.getComment());
        stmt.bindLong(5, tbl.getFeedback());
        stmt.bindString(6, tbl.getPDAcode());
        if(tbl.getEntryDate()!=null)
            stmt.bindString(7, tbl.getEntryDate());
        else
            stmt.bindString(7, "NA");
        stmt.bindString(8, tbl.getNodeID());
        stmt.bindLong(9, tbl.getNodeType());
        stmt.bindString(10, tbl.getDBRName());

        stmt.bindLong(11, tbl.getSstat());
        stmt.bindLong(12, tbl.getFlgFinalSubmit());
        stmt.bindString(13, tbl.getContactNumber());
        stmt.execute();


        stmt.close();
        db.setTransactionSuccessful();
        db.endTransaction();
    }
    public void UpdateDistributorRetailerFeedbackAfterSync(int flag2set,String flgForCondition) {

        try {
            //open();
            final ContentValues values = new ContentValues();
            values.put("Sstat", flag2set);

            int affected79 = db.update("tblDistRetAddressDetail", values, "Sstat=?", new String[]{flgForCondition});

        } catch (Exception ex) {
            Log.e(TAG, ex.toString());
        }
        // close();
    }
    public List<TblSupplierMstrList> fnGetSupplierListMaster(int flgWithOrWithoutSelectOption) {
        List<TblSupplierMstrList> tblSupplierMstrLists = new ArrayList<TblSupplierMstrList>();
        Cursor cursor2 = db.rawQuery("SELECT NodeID,NodeType,Descr,flgMapped,ifnull(Address,'NA'),ifnull(ContactNumber,'NA') FROM tblSupplierMstrList where flgMarkedForInActive=0", null);// where flgRequiredUpdate=1 and flgMarkedForInActive=0
        try {

            if (cursor2!=null && cursor2.getCount() > 0) {

                if (cursor2.moveToFirst()) {
                    for (int i = 0; i < cursor2.getCount(); i++) {
                        if (i == 0) {
                            if(flgWithOrWithoutSelectOption==1) {
                                TblSupplierMstrList tblSupplierMstrList = new TblSupplierMstrList();
                                tblSupplierMstrList.setNodeID(0);
                                tblSupplierMstrList.setNodeType(0);
                                tblSupplierMstrList.setDescr("Select Old Distributor");
                                tblSupplierMstrList.setFlgMapped(0);
                                tblSupplierMstrList.setAddress("NA");
                                tblSupplierMstrList.setPhoneNo("NA");
                                tblSupplierMstrLists.add(tblSupplierMstrList);

                            }

                        }
                        TblSupplierMstrList tblSupplierMstrList1=new TblSupplierMstrList();
                        tblSupplierMstrList1.setNodeID(cursor2.getInt(0));
                        tblSupplierMstrList1.setNodeType(cursor2.getInt(1));
                        tblSupplierMstrList1.setDescr(cursor2.getString(2));
                        tblSupplierMstrList1.setFlgMapped(cursor2.getInt(3));
                        tblSupplierMstrList1.setAddress(cursor2.getString(4));
                        tblSupplierMstrList1.setPhoneNo(cursor2.getString(5));
                        tblSupplierMstrLists.add(tblSupplierMstrList1);
                        cursor2.moveToNext();
                    }
                }
            } else {
                TblSupplierMstrList tblSupplierMstrList=new TblSupplierMstrList();
                tblSupplierMstrList.setNodeID(0);
                tblSupplierMstrList.setNodeType(0);
                tblSupplierMstrList.setDescr("Select Old Distributor");
                tblSupplierMstrList.setFlgMapped(1);
                tblSupplierMstrLists.add(tblSupplierMstrList);
            }



        }
        catch (Exception ex)
        {
            ex.printStackTrace();
            String exd=ex.getMessage().toString();
        }

        finally {
            if(cursor2!=null)
                cursor2.close();
        }
        return tblSupplierMstrLists;
    }
    public void fnMarkForInActiveExisitingDistributor(int NodeID) {

        db.execSQL("UPDATE tblSupplierMstrList SET flgMarkedForInActive=1 where NodeID=" + NodeID + "");

    }

    public HashMap<String, String> checkSupplierMarkedForInActive() {
        Cursor cursor = db.rawQuery("Select NodeID,flgMarkedForInActive from tblSupplierMstrList", null);// where Sstat in(1,3,4,5)
        HashMap<String, String> hmapStoreIDSstat = new HashMap<String, String>();
        if (cursor.getCount() > 0) {
            if (cursor.moveToFirst()) {
                for (int index = 0; index < cursor.getCount(); index++) {
                    hmapStoreIDSstat.put(cursor.getString(0), cursor.getString(1));
                    cursor.moveToNext();
                }
            }
        }
        return hmapStoreIDSstat;
    }


    public void Delete_tblProductSectorMappingList() {
        db.execSQL("DELETE FROM tblProductSectorMapping");

    }

    public void fnsavetblProductSectorMappingList(List<TblProductSectorMapping> tblProductSectorMappingList) {
        try {
            db.beginTransaction(); // the insertion of the impacts of one expense are considered to be ONE block
            String sql = "INSERT INTO " + DBHelper.TABLE_tblProductSectorMapping +
                    " (PrdNodeID, PrdNodeType, SectorID, FromDate, ToDate) VALUES (?, ?, ?, ?, ?)";
            SQLiteStatement stmt = db.compileStatement(sql);

            for (TblProductSectorMapping tbl : tblProductSectorMappingList) {
                stmt.bindLong(1, tbl.getPrdNodeID());
                stmt.bindLong(2, tbl.getPrdNodeType());
                stmt.bindLong(3, tbl.getSectorID());
                if(tbl.getFromDate()!=null)
                stmt.bindString(4, tbl.getFromDate());
                else
                    stmt.bindString(4, "NA");

                if(tbl.getToDate()!=null)
                    stmt.bindString(5, tbl.getToDate());
                else
                    stmt.bindString(5, "NA");


                stmt.execute();
            }

            stmt.close();
            db.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("insertImpacts() failed " + e.getMessage());
        } finally {
            db.endTransaction();
        }

    }

    public int fnGetSectorID() {
        Cursor cursorE2 = null;
        int chkI = 0;

        try {
            //open();
            cursorE2 = db.rawQuery("SELECT ifnull(SectorID,0) FROM tblUserAuthenticationMstr", null);

            if (cursorE2!=null && cursorE2.getCount()>0 && cursorE2.moveToFirst()) {

                    chkI = cursorE2.getInt(0);
            }

        } finally {
            if (cursorE2 != null) {
                cursorE2.close();
            }
            //close();
        }
        return chkI;
    }


    public void UpdateStoreEndVisittblStoreOrderVisitDayActivity(String StoreID, String VisitTimeEndStore, String TempStoreVisitCode) {
        final ContentValues values = new ContentValues();
        values.put("VisitTimeEndStore", VisitTimeEndStore);
        int affected = db.update("tblStoreOrderVisitDayActivity", values, "StoreID=? and TempStoreVisitCode=?", new String[]{StoreID, TempStoreVisitCode});
    }


}
